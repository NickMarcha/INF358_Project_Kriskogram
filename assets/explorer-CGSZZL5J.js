import{c as Ss,r as x,j as r,s as Ie,o as dr,a as Wt,z as Ar,i as Pr,C as Vr,G as kr,u as Dr,b as Lr,d as Tr,K as Or,e as on,f as zr,p as ze,g as ln,n as pt,h as Hr,k as Gr}from"./main-ZJ6HEeNY.js";import{p as gs,l as Mn}from"./csv-parser-BH7H656y.js";import{p as Br,g as cr,l as Ur}from"./gexf-parser-ChiJebeW.js";import{S as Wr,a as Hs}from"./stateMigrationFiles-CyfipyKt.js";/**
 * @license lucide-react v0.476.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qr=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],Kr=Ss("ChevronDown",qr);/**
 * @license lucide-react v0.476.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yr=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],Xr=Ss("ChevronUp",Yr);/**
 * @license lucide-react v0.476.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zr=[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],Gs=Ss("Settings",Zr);function Qr(e,n){return e==null||n==null?NaN:n<e?-1:n>e?1:n>=e?0:NaN}var Bs=Math.abs,Jn=Math.cos,es=Math.sin,gr=Math.PI,Rn=gr/2,Us=gr*2,Ws=Math.max,ts=1e-12;function qs(e,n){return Array.from({length:n-e},(t,s)=>e+s)}function Jr(e){return function(n,t){return e(n.source.value+n.target.value,t.source.value+t.target.value)}}function eo(){return to(!1)}function to(e,n){var t=0,s=null,o=null,a=null;function l(i){var d=i.length,m=new Array(d),c=qs(0,d),h=new Array(d*d),p=new Array(d),f=0,w;i=Float64Array.from({length:d*d},(_,S)=>i[S/d|0][S%d]);for(let _=0;_<d;++_){let S=0;for(let v=0;v<d;++v)S+=i[_*d+v]+e*i[v*d+_];f+=m[_]=S}f=Ws(0,Us-t*d)/f,w=f?t:Us/d;{let _=0;s&&c.sort((S,v)=>s(m[S],m[v]));for(const S of c){const v=_;{const b=qs(0,d).filter(y=>i[S*d+y]||i[y*d+S]);o&&b.sort((y,N)=>o(i[S*d+y],i[S*d+N]));for(const y of b){let N;if(S<y?(N=h[S*d+y]||(h[S*d+y]={source:null,target:null}),N.source={index:S,startAngle:_,endAngle:_+=i[S*d+y]*f,value:i[S*d+y]}):(N=h[y*d+S]||(h[y*d+S]={source:null,target:null}),N.target={index:S,startAngle:_,endAngle:_+=i[S*d+y]*f,value:i[S*d+y]},S===y&&(N.source=N.target)),N.source&&N.target&&N.source.value<N.target.value){const I=N.source;N.source=N.target,N.target=I}}p[S]={index:S,startAngle:v,endAngle:_,value:m[S]}}_+=w}}return h=Object.values(h),h.groups=p,a?h.sort(a):h}return l.padAngle=function(i){return arguments.length?(t=Ws(0,i),l):t},l.sortGroups=function(i){return arguments.length?(s=i,l):s},l.sortSubgroups=function(i){return arguments.length?(o=i,l):o},l.sortChords=function(i){return arguments.length?(i==null?a=null:(a=Jr(i))._=i,l):a&&a._},l}const ms=Math.PI,fs=2*ms,Bt=1e-6,no=fs-Bt;function mr(e){this._+=e[0];for(let n=1,t=e.length;n<t;++n)this._+=arguments[n]+e[n]}function so(e){let n=Math.floor(e);if(!(n>=0))throw new Error(`invalid digits: ${e}`);if(n>15)return mr;const t=10**n;return function(s){this._+=s[0];for(let o=1,a=s.length;o<a;++o)this._+=Math.round(arguments[o]*t)/t+s[o]}}class ws{constructor(n){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=n==null?mr:so(n)}moveTo(n,t){this._append`M${this._x0=this._x1=+n},${this._y0=this._y1=+t}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(n,t){this._append`L${this._x1=+n},${this._y1=+t}`}quadraticCurveTo(n,t,s,o){this._append`Q${+n},${+t},${this._x1=+s},${this._y1=+o}`}bezierCurveTo(n,t,s,o,a,l){this._append`C${+n},${+t},${+s},${+o},${this._x1=+a},${this._y1=+l}`}arcTo(n,t,s,o,a){if(n=+n,t=+t,s=+s,o=+o,a=+a,a<0)throw new Error(`negative radius: ${a}`);let l=this._x1,i=this._y1,d=s-n,m=o-t,c=l-n,h=i-t,p=c*c+h*h;if(this._x1===null)this._append`M${this._x1=n},${this._y1=t}`;else if(p>Bt)if(!(Math.abs(h*d-m*c)>Bt)||!a)this._append`L${this._x1=n},${this._y1=t}`;else{let f=s-l,w=o-i,_=d*d+m*m,S=f*f+w*w,v=Math.sqrt(_),b=Math.sqrt(p),y=a*Math.tan((ms-Math.acos((_+p-S)/(2*v*b)))/2),N=y/b,I=y/v;Math.abs(N-1)>Bt&&this._append`L${n+N*c},${t+N*h}`,this._append`A${a},${a},0,0,${+(h*f>c*w)},${this._x1=n+I*d},${this._y1=t+I*m}`}}arc(n,t,s,o,a,l){if(n=+n,t=+t,s=+s,l=!!l,s<0)throw new Error(`negative radius: ${s}`);let i=s*Math.cos(o),d=s*Math.sin(o),m=n+i,c=t+d,h=1^l,p=l?o-a:a-o;this._x1===null?this._append`M${m},${c}`:(Math.abs(this._x1-m)>Bt||Math.abs(this._y1-c)>Bt)&&this._append`L${m},${c}`,s&&(p<0&&(p=p%fs+fs),p>no?this._append`A${s},${s},0,1,${h},${n-i},${t-d}A${s},${s},0,1,${h},${this._x1=m},${this._y1=c}`:p>Bt&&this._append`A${s},${s},0,${+(p>=ms)},${h},${this._x1=n+s*Math.cos(a)},${this._y1=t+s*Math.sin(a)}`)}rect(n,t,s,o){this._append`M${this._x0=this._x1=+n},${this._y0=this._y1=+t}h${s=+s}v${+o}h${-s}Z`}toString(){return this._}}function _s(){return new ws}_s.prototype=ws.prototype;var ro=Array.prototype.slice;function sn(e){return function(){return e}}function oo(e){return e.source}function ao(e){return e.target}function Ks(e){return e.radius}function io(e){return e.startAngle}function lo(e){return e.endAngle}function uo(){return 0}function co(e){var n=oo,t=ao,s=Ks,o=Ks,a=io,l=lo,i=uo,d=null;function m(){var c,h=n.apply(this,arguments),p=t.apply(this,arguments),f=i.apply(this,arguments)/2,w=ro.call(arguments),_=+s.apply(this,(w[0]=h,w)),S=a.apply(this,w)-Rn,v=l.apply(this,w)-Rn,b=+o.apply(this,(w[0]=p,w)),y=a.apply(this,w)-Rn,N=l.apply(this,w)-Rn;if(d||(d=c=_s()),f>ts&&(Bs(v-S)>f*2+ts?v>S?(S+=f,v-=f):(S-=f,v+=f):S=v=(S+v)/2,Bs(N-y)>f*2+ts?N>y?(y+=f,N-=f):(y-=f,N+=f):y=N=(y+N)/2),d.moveTo(_*Jn(S),_*es(S)),d.arc(0,0,_,S,v),(S!==y||v!==N)&&(d.quadraticCurveTo(0,0,b*Jn(y),b*es(y)),d.arc(0,0,b,y,N)),d.quadraticCurveTo(0,0,_*Jn(S),_*es(S)),d.closePath(),c)return d=null,c+""||null}return m.radius=function(c){return arguments.length?(s=o=typeof c=="function"?c:sn(+c),m):s},m.sourceRadius=function(c){return arguments.length?(s=typeof c=="function"?c:sn(+c),m):s},m.targetRadius=function(c){return arguments.length?(o=typeof c=="function"?c:sn(+c),m):o},m.startAngle=function(c){return arguments.length?(a=typeof c=="function"?c:sn(+c),m):a},m.endAngle=function(c){return arguments.length?(l=typeof c=="function"?c:sn(+c),m):l},m.padAngle=function(c){return arguments.length?(i=typeof c=="function"?c:sn(+c),m):i},m.source=function(c){return arguments.length?(n=c,m):n},m.target=function(c){return arguments.length?(t=c,m):t},m.context=function(c){return arguments.length?(d=c??null,m):d},m}function go(){return co()}function mo(e){for(var n=e.length/6|0,t=new Array(n),s=0;s<n;)t[s]="#"+e.slice(s*6,++s*6);return t}const fr=mo("1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf");function wt(e){return function(){return e}}const Ys=Math.abs,Be=Math.atan2,zt=Math.cos,fo=Math.max,ns=Math.min,ut=Math.sin,an=Math.sqrt,Ke=1e-12,xn=Math.PI,An=xn/2,po=2*xn;function ho(e){return e>1?0:e<-1?xn:Math.acos(e)}function Xs(e){return e>=1?An:e<=-1?-An:Math.asin(e)}function xo(e){let n=3;return e.digits=function(t){if(!arguments.length)return n;if(t==null)n=null;else{const s=Math.floor(t);if(!(s>=0))throw new RangeError(`invalid digits: ${t}`);n=s}return e},()=>new ws(n)}function vo(e){return e.innerRadius}function yo(e){return e.outerRadius}function bo(e){return e.startAngle}function So(e){return e.endAngle}function wo(e){return e&&e.padAngle}function _o(e,n,t,s,o,a,l,i){var d=t-e,m=s-n,c=l-o,h=i-a,p=h*d-c*m;if(!(p*p<Ke))return p=(c*(n-a)-h*(e-o))/p,[e+p*d,n+p*m]}function Fn(e,n,t,s,o,a,l){var i=e-t,d=n-s,m=(l?a:-a)/an(i*i+d*d),c=m*d,h=-m*i,p=e+c,f=n+h,w=t+c,_=s+h,S=(p+w)/2,v=(f+_)/2,b=w-p,y=_-f,N=b*b+y*y,I=o-a,M=p*_-w*f,z=(y<0?-1:1)*an(fo(0,I*I*N-M*M)),P=(M*y-b*z)/N,D=(-M*b-y*z)/N,oe=(M*y+b*z)/N,H=(-M*b+y*z)/N,ie=P-S,F=D-v,Z=oe-S,ae=H-v;return ie*ie+F*F>Z*Z+ae*ae&&(P=oe,D=H),{cx:P,cy:D,x01:-c,y01:-h,x11:P*(o/I-1),y11:D*(o/I-1)}}function Co(){var e=vo,n=yo,t=wt(0),s=null,o=bo,a=So,l=wo,i=null,d=xo(m);function m(){var c,h,p=+e.apply(this,arguments),f=+n.apply(this,arguments),w=o.apply(this,arguments)-An,_=a.apply(this,arguments)-An,S=Ys(_-w),v=_>w;if(i||(i=c=d()),f<p&&(h=f,f=p,p=h),!(f>Ke))i.moveTo(0,0);else if(S>po-Ke)i.moveTo(f*zt(w),f*ut(w)),i.arc(0,0,f,w,_,!v),p>Ke&&(i.moveTo(p*zt(_),p*ut(_)),i.arc(0,0,p,_,w,v));else{var b=w,y=_,N=w,I=_,M=S,z=S,P=l.apply(this,arguments)/2,D=P>Ke&&(s?+s.apply(this,arguments):an(p*p+f*f)),oe=ns(Ys(f-p)/2,+t.apply(this,arguments)),H=oe,ie=oe,F,Z;if(D>Ke){var ae=Xs(D/p*ut(P)),xe=Xs(D/f*ut(P));(M-=ae*2)>Ke?(ae*=v?1:-1,N+=ae,I-=ae):(M=0,N=I=(w+_)/2),(z-=xe*2)>Ke?(xe*=v?1:-1,b+=xe,y-=xe):(z=0,b=y=(w+_)/2)}var le=f*zt(b),we=f*ut(b),Re=p*zt(I),R=p*ut(I);if(oe>Ke){var T=f*zt(y),_e=f*ut(y),ne=p*zt(N),Ye=p*ut(N),q;if(S<xn)if(q=_o(le,we,ne,Ye,T,_e,Re,R)){var De=le-q[0],K=we-q[1],He=T-q[0],Ce=_e-q[1],We=1/ut(ho((De*He+K*Ce)/(an(De*De+K*K)*an(He*He+Ce*Ce)))/2),$e=an(q[0]*q[0]+q[1]*q[1]);H=ns(oe,(p-$e)/(We-1)),ie=ns(oe,(f-$e)/(We+1))}else H=ie=0}z>Ke?ie>Ke?(F=Fn(ne,Ye,le,we,f,ie,v),Z=Fn(T,_e,Re,R,f,ie,v),i.moveTo(F.cx+F.x01,F.cy+F.y01),ie<oe?i.arc(F.cx,F.cy,ie,Be(F.y01,F.x01),Be(Z.y01,Z.x01),!v):(i.arc(F.cx,F.cy,ie,Be(F.y01,F.x01),Be(F.y11,F.x11),!v),i.arc(0,0,f,Be(F.cy+F.y11,F.cx+F.x11),Be(Z.cy+Z.y11,Z.cx+Z.x11),!v),i.arc(Z.cx,Z.cy,ie,Be(Z.y11,Z.x11),Be(Z.y01,Z.x01),!v))):(i.moveTo(le,we),i.arc(0,0,f,b,y,!v)):i.moveTo(le,we),!(p>Ke)||!(M>Ke)?i.lineTo(Re,R):H>Ke?(F=Fn(Re,R,T,_e,p,-H,v),Z=Fn(le,we,ne,Ye,p,-H,v),i.lineTo(F.cx+F.x01,F.cy+F.y01),H<oe?i.arc(F.cx,F.cy,H,Be(F.y01,F.x01),Be(Z.y01,Z.x01),!v):(i.arc(F.cx,F.cy,H,Be(F.y01,F.x01),Be(F.y11,F.x11),!v),i.arc(0,0,p,Be(F.cy+F.y11,F.cx+F.x11),Be(Z.cy+Z.y11,Z.cx+Z.x11),v),i.arc(Z.cx,Z.cy,H,Be(Z.y11,Z.x11),Be(Z.y01,Z.x01),!v))):i.arc(0,0,p,I,N,v)}if(i.closePath(),c)return i=null,c+""||null}return m.centroid=function(){var c=(+e.apply(this,arguments)+ +n.apply(this,arguments))/2,h=(+o.apply(this,arguments)+ +a.apply(this,arguments))/2-xn/2;return[zt(h)*c,ut(h)*c]},m.innerRadius=function(c){return arguments.length?(e=typeof c=="function"?c:wt(+c),m):e},m.outerRadius=function(c){return arguments.length?(n=typeof c=="function"?c:wt(+c),m):n},m.cornerRadius=function(c){return arguments.length?(t=typeof c=="function"?c:wt(+c),m):t},m.padRadius=function(c){return arguments.length?(s=c==null?null:typeof c=="function"?c:wt(+c),m):s},m.startAngle=function(c){return arguments.length?(o=typeof c=="function"?c:wt(+c),m):o},m.endAngle=function(c){return arguments.length?(a=typeof c=="function"?c:wt(+c),m):a},m.padAngle=function(c){return arguments.length?(l=typeof c=="function"?c:wt(+c),m):l},m.context=function(c){return arguments.length?(i=c??null,m):i},m}const No="/INF358_Project_Kriskogram/assets/state_to_state_migration_table_2022_t13_updated_2024_06_27_2022-D7hzY5-5.csv",jo="/INF358_Project_Kriskogram/assets/state_to_state_migration_table_2023_t13_2023-Da-tSzHC.csv",Mo="/INF358_Project_Kriskogram/assets/state_to_state_migrations_table_2005_2005-5D0dAV6T.csv",Ro="/INF358_Project_Kriskogram/assets/state_to_state_migrations_table_2005_2007_2005-2007-C2gBOjzD.csv",Fo="/INF358_Project_Kriskogram/assets/state_to_state_migrations_table_2005_2009_2005-2009-oSLcshdC.csv",Eo="/INF358_Project_Kriskogram/assets/state_to_state_migrations_table_2006_2006-C-EFanec.csv",Io="/INF358_Project_Kriskogram/assets/state_to_state_migrations_table_2006_2008_2006-2008-Cp1NRBpc.csv",$o="/INF358_Project_Kriskogram/assets/state_to_state_migrations_table_2007_2007-BXoQRRMn.csv",Ao="/INF358_Project_Kriskogram/assets/state_to_state_migrations_table_2007_2009_2007-2009-Qdd3KwND.csv",Po="/INF358_Project_Kriskogram/assets/state_to_state_migrations_table_2008_2008--00JWAqc.csv",Vo="/INF358_Project_Kriskogram/assets/state_to_state_migrations_table_2009_2009-5yGj8NCd.csv",ko="/INF358_Project_Kriskogram/assets/state_to_state_migrations_table_2010_2010-CSB90FrU.csv",Do="/INF358_Project_Kriskogram/assets/state_to_state_migrations_table_2011_2011-BzRnLs5h.csv",Lo="/INF358_Project_Kriskogram/assets/state_to_state_migrations_table_2012_2012-DrbWwk1R.csv",To="/INF358_Project_Kriskogram/assets/state_to_state_migrations_table_2013_2013-CTsYcw-F.csv",Oo="/INF358_Project_Kriskogram/assets/state_to_state_migrations_table_2014_2014-D8ze7hKk.csv",zo="/INF358_Project_Kriskogram/assets/state_to_state_migrations_table_2015_2015-Sg6Ir2qO.csv",Ho="/INF358_Project_Kriskogram/assets/state_to_state_migrations_table_2016_2016-C26kP0Bk.csv",Go="/INF358_Project_Kriskogram/assets/state_to_state_migrations_table_2017_2017-BNMbL_en.csv",Bo="/INF358_Project_Kriskogram/assets/state_to_state_migrations_table_2018_2018-DTnLPVgj.csv",Uo="/INF358_Project_Kriskogram/assets/state_to_state_migrations_table_2019_2019-Bd1nphS1.csv",Wo="/INF358_Project_Kriskogram/assets/State_to_State_Migrations_Table_2021-N7RTh5uH.csv";function Ut(e){const n=new Set,t=new Set,s=new Set,o=new Set,a=new Set,l=new Set;return e.nodes.forEach(i=>{Object.keys(i).forEach(d=>{if(d!=="id"&&d!=="label"){n.add(d);const m=i[d];typeof m=="number"?s.add(d):typeof m=="string"&&a.add(d)}})}),e.edges.forEach(i=>{Object.keys(i).forEach(d=>{if(d!=="source"&&d!=="target"&&d!=="value"){t.add(d);const m=i[d];typeof m=="number"?o.add(d):typeof m=="string"&&l.add(d)}})}),{nodeProperties:Array.from(n),edgeProperties:Array.from(t),hasNumericProperties:{nodes:Array.from(s),edges:Array.from(o)},hasCategoricalProperties:{nodes:Array.from(a),edges:Array.from(l)}}}const qo="kriskogram-db",Ko=1,et="datasets";function vn(){return new Promise((e,n)=>{const t=indexedDB.open(qo,Ko);t.onupgradeneeded=()=>{const s=t.result;s.objectStoreNames.contains(et)||s.createObjectStore(et,{keyPath:"id"})},t.onsuccess=()=>e(t.result),t.onerror=()=>n(t.error)})}async function Nt(e){const n=await vn();return new Promise((t,s)=>{const o=n.transaction(et,"readwrite");o.objectStore(et).put(e),o.oncomplete=()=>t(),o.onerror=()=>s(o.error),o.onabort=()=>s(o.error)})}async function jt(e){const n=await vn();return new Promise((t,s)=>{const l=n.transaction(et,"readonly").objectStore(et).get(e);l.onsuccess=()=>t(l.result),l.onerror=()=>s(l.error)})}async function Yo(){const e=await vn();return new Promise((n,t)=>{const a=e.transaction(et,"readonly").objectStore(et).getAll();a.onsuccess=()=>n(a.result||[]),a.onerror=()=>t(a.error)})}async function ps(e){const n=await vn();return new Promise((t,s)=>{const o=n.transaction(et,"readwrite");o.objectStore(et).delete(e),o.oncomplete=()=>t(),o.onerror=()=>s(o.error)})}async function Xo(e){const n=await jt(e);if(!n)throw new Error(`Dataset ${e} not found`);const t={...n,id:`${n.type}-${Date.now()}`,name:`${n.name} (Copy)`,createdAt:Date.now()};return await Nt(t),t}async function Zo(){const e=await vn();return new Promise((n,t)=>{const s=e.transaction(et,"readwrite");s.objectStore(et).clear(),s.oncomplete=()=>n(),s.onerror=()=>t(s.error)})}async function Qo(){if("storage"in navigator&&"persist"in navigator.storage)try{return await navigator.storage.persist()}catch{return!1}return!1}function Zs(e){const n=[];let t="",s=!1;for(let o=0;o<e.length;o++){const a=e[o];a==='"'?s=!s:a===","&&!s?(n.push(t),t=""):t+=a}return n.push(t),n}function Qs(e){const n=e.trim().split(`
`).filter(o=>o.trim());if(n.length===0)throw new Error("CSV file is empty");const t=Zs(n[0]).map(o=>o.trim()),s=n.slice(1).map(Zs);return{headers:t,rows:s}}function ss(e){const n=e.replace(/[",]/g,"").trim(),t=Number.parseFloat(n);return Number.isNaN(t)?n:t}function pr(e){var I;const{headers:n,rows:t}=Qs(e.nodesFile.content),s=n.map(M=>M.toLowerCase().trim()),o=e.nodesFile.idField.toLowerCase().trim(),a=((I=e.nodesFile.labelField)==null?void 0:I.toLowerCase().trim())||o,l=s.indexOf(o),i=e.nodesFile.labelField?s.indexOf(a):l;if(l===-1)throw new Error(`ID field "${e.nodesFile.idField}" not found in nodes file. Available fields: ${n.join(", ")}`);const d=t.map(M=>{const z={id:String(M[l]||"").trim(),label:i>=0?String(M[i]||"").trim():String(M[l]||"").trim()},P=n[l],D=e.nodesFile.labelField?n[i]:P;return n.forEach((oe,H)=>{var ie;if(oe!==P&&oe!==D){const F=((ie=M[H])==null?void 0:ie.trim())||"";z[oe]=ss(F)}}),z}).filter(M=>M.id),m=new Map(d.map(M=>[M.id,M])),{headers:c,rows:h}=Qs(e.edgesFile.content),p=c.map(M=>M.toLowerCase().trim()),f=e.edgesFile.sourceField.toLowerCase().trim(),w=e.edgesFile.targetField.toLowerCase().trim(),_=e.edgesFile.valueField.toLowerCase().trim(),S=p.indexOf(f),v=p.indexOf(w),b=p.indexOf(_);if(S===-1)throw new Error(`Source field "${e.edgesFile.sourceField}" not found in edges file. Available fields: ${c.join(", ")}`);if(v===-1)throw new Error(`Target field "${e.edgesFile.targetField}" not found in edges file. Available fields: ${c.join(", ")}`);if(b===-1)throw new Error(`Value field "${e.edgesFile.valueField}" not found in edges file. Available fields: ${c.join(", ")}`);const y=h.map(M=>{const z=String(M[S]||"").trim(),P=String(M[v]||"").trim(),D=String(M[b]||"").trim(),oe=ss(D);if(!z||!P||typeof oe!="number"||oe<=0)return null;(!m.has(z)||!m.has(P))&&console.warn(`Edge references missing node: ${z} -> ${P}`);const H={source:z,target:P,value:oe},ie=c[S],F=c[v],Z=c[b];return c.forEach((ae,xe)=>{var le;if(ae!==ie&&ae!==F&&ae!==Z){const we=((le=M[xe])==null?void 0:le.trim())||"";H[ae]=ss(we)}}),H}).filter(M=>M!==null&&m.has(M.source)&&m.has(M.target)),N=new Set;return y.forEach(M=>{N.add(M.source),N.add(M.target)}),N.forEach(M=>{m.has(M)||d.push({id:M,label:M})}),{nodes:d,edges:y}}function Jo({onClose:e,onImport:n,fileInputRef:t,onFilesSelected:s,existingFile:o}){const[a,l]=x.useState(""),[i,d]=x.useState(""),[m,c]=x.useState(!1),[h,p]=x.useState({}),[f,w]=x.useState(!1),[_,S]=x.useState(null),[v,b]=x.useState([]),[y,N]=x.useState([]),[I,M]=x.useState(null),z=x.useRef(null),P=x.useRef(null),[D,oe]=x.useState(null),[H,ie]=x.useState(null),[F,Z]=x.useState([]),[ae,xe]=x.useState([]),[le,we]=x.useState(""),[Re,R]=x.useState(""),[T,_e]=x.useState(""),[ne,Ye]=x.useState(""),[q,De]=x.useState(""),[K,He]=x.useState(null);function Ce(E){let V=E.replace(/\.(csv|gexf)$/i,"");return V=V.replace(/([a-z])([A-Z])/g,"$1 $2").replace(/[_-]/g," ").replace(/[^a-zA-Z0-9\s]/g," ").replace(/\s+/g," ").trim(),V.split(" ").map(B=>B.charAt(0).toUpperCase()+B.slice(1).toLowerCase()).join(" ")}x.useEffect(()=>{var E;if(o!=null&&o.parsedData){He(o.parsedData);const V=((E=o.files[0])==null?void 0:E.name)||"";l(Ce(V)),d(o.files.map(B=>B.name).join(", "))}},[o]),x.useEffect(()=>{var E;if(!o&&v.length>0){if(!a||a===Ce(((E=v[0])==null?void 0:E.name)||"")){const V=v[0].name;l(Ce(V))}i||d(v.map(V=>V.name).join(", "))}},[v]);function We(E){const V=[];let B="",ve=!1;for(let Q=0;Q<E.length;Q++){const fe=E[Q];fe==='"'?ve=!ve:fe===","&&!ve?(V.push(B),B=""):B+=fe}return V.push(B),V}function $e(E){const V=E.trim().split(`
`);if(V.length===0)return[];const B=V[0];return We(B).map(ve=>ve.trim().replace(/^"|"$/g,""))}async function qt(E){const V=Array.from(E.target.files||[]);if(V.length===0)return;b(V);const B=await Promise.all(V.map(Q=>Q.text()));N(B);const ve=V[0].name.toLowerCase();if(ve.endsWith(".gexf")){M("gexf"),S("single");try{const Q=Br(B[0]),fe=cr(Q);He({nodes:fe.length>0?fe[0].nodes:[],edges:fe.length>0?fe[0].edges:[],timeRange:Q.timeRange}),l(V[0].name.replace(".gexf",""))}catch(Q){p({general:Q instanceof Error?Q.message:"Failed to parse GEXF"})}}else if(ve.endsWith(".csv")){if(M("csv"),V.length===1){S("single");try{const Q=gs(B[0]);He({nodes:Q.nodes,edges:Q.edges,timeRange:{start:2021,end:2021}}),l(V[0].name.replace(".csv",""))}catch{S("two-file");const fe=$e(B[0]);Z(fe),xe(fe),oe(0);const pe=fe.find(ye=>ye.toLowerCase()==="id"||ye.toLowerCase()==="node"||ye.toLowerCase()==="name"),ot=fe.find(ye=>ye.toLowerCase()==="source"||ye.toLowerCase()==="origin"||ye.toLowerCase()==="from"),Ae=fe.find(ye=>ye.toLowerCase()==="target"||ye.toLowerCase()==="dest"||ye.toLowerCase()==="destination"||ye.toLowerCase()==="to"),dt=fe.find(ye=>ye.toLowerCase()==="value"||ye.toLowerCase()==="count"||ye.toLowerCase()==="weight");pe&&we(pe),ot&&_e(ot),Ae&&Ye(Ae),dt&&De(dt),p({general:"Could not parse as state migration format. Please select which file contains nodes and which contains edges."})}}else if(V.length===2){S("two-file");const Q=$e(B[0]),fe=$e(B[1]);Z(Q),xe(fe),oe(0),ie(1);const pe=Q.find(Ne=>Ne.toLowerCase()==="id"),ot=Q.find(Ne=>Ne.toLowerCase()==="name"||Ne.toLowerCase()==="label");pe&&we(pe),ot&&R(ot);const Ae=fe.find(Ne=>Ne.toLowerCase()==="source"||Ne.toLowerCase()==="origin"||Ne.toLowerCase()==="from"),dt=fe.find(Ne=>Ne.toLowerCase()==="target"||Ne.toLowerCase()==="dest"||Ne.toLowerCase()==="destination"||Ne.toLowerCase()==="to"),ye=fe.find(Ne=>Ne.toLowerCase()==="value"||Ne.toLowerCase()==="count"||Ne.toLowerCase()==="weight");Ae&&_e(Ae),dt&&Ye(dt),ye&&De(ye),qe()}}t.current&&(t.current.value="")}function qe(){if(D===null||H===null||!le||!T||!ne||!q){p({general:"Please select all required fields"}),He(null);return}try{const E=pr({nodesFile:{content:y[D],idField:le,labelField:Re||le},edgesFile:{content:y[H],sourceField:T,targetField:ne,valueField:q}});He({nodes:E.nodes,edges:E.edges,timeRange:{start:2016,end:2016}}),p({})}catch(E){p({general:E instanceof Error?E.message:"Failed to parse two-file CSV"}),He(null)}}x.useEffect(()=>{_==="two-file"&&D!==null&&H!==null&&qe()},[le,Re,T,ne,q,D,H]);function yn(){const E={},V=[];if(a.trim()||(E.name="Dataset name is required"),_==="two-file"&&(D===null&&(E.nodesFile="Please select which file contains nodes"),H===null&&(E.edgesFile="Please select which file contains edges"),D!==null&&!le&&(E.nodeIdField="Please select the ID field for nodes"),H!==null&&!T&&(E.edgeSourceField="Please select the source field for edges"),H!==null&&!ne&&(E.edgeTargetField="Please select the target field for edges"),H!==null&&!q&&(E.edgeValueField="Please select the value field for edges")),!K)return E.general="Data parsing failed - please check file format and field selections",E;K.nodes.length===0&&V.push("No nodes found in dataset"),K.edges.length===0&&V.push("No edges found in dataset");const B=new Set(K.nodes.map(Q=>Q.id));B.size!==K.nodes.length&&V.push(`${K.nodes.length-B.size} duplicate node IDs found`);const ve=K.edges.filter(Q=>!B.has(Q.source)||!B.has(Q.target));return ve.length>0&&V.push(`${ve.length} edges reference non-existent nodes`),V.length>0&&(E.summary=V.join("; ")),E}function xt(){h.name&&z.current?(z.current.scrollIntoView({behavior:"smooth",block:"center"}),z.current.focus()):h.summary&&P.current&&P.current.scrollIntoView({behavior:"smooth",block:"center"})}async function bn(){const E=yn();if(p(E),Object.keys(E).filter(B=>B!=="summary").length>0||!K){setTimeout(()=>xt(),100);return}c(!0);try{const B=K.timeRange||{start:2021,end:2021},ve={timestamp:B.start,nodes:K.nodes,edges:K.edges},Q=Ut(ve),fe=[ve],pe={name:a.trim(),filename:v.map(ot=>ot.name).join(", "),notes:i.trim()||void 0,type:_==="two-file"?"csv":I||"csv",timeRange:B,snapshots:fe,metadata:Q};await n(pe,{nodes:K.nodes,edges:K.edges,snapshots:fe,metadata:Q})}catch(B){console.error("Import error:",B),p({general:B instanceof Error?B.message:"Failed to import dataset"}),c(!1),setTimeout(()=>xt(),100)}}return r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:r.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-4xl w-full mx-4 max-h-[90vh] flex flex-col",children:[r.jsxs("div",{className:"p-6 border-b flex items-center justify-between",children:[r.jsx("h2",{className:"text-2xl font-bold",children:"Import Dataset"}),r.jsx("button",{onClick:e,className:"text-gray-400 hover:text-gray-600 text-2xl",children:"×"})]}),r.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:r.jsxs("div",{className:"space-y-6",children:[!_&&r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Select Files ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsxs("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-6 text-center",children:[r.jsx("button",{onClick:()=>{var E;return(E=t.current)==null?void 0:E.click()},className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700",children:"Choose Files"}),r.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"Select 1 file (GEXF or CSV) or 2 files (CSV nodes + CSV edges)"}),r.jsx("input",{ref:t,type:"file",accept:".csv,.gexf",multiple:!0,onChange:qt,className:"hidden"})]})]}),v.length>0&&r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Selected Files"}),r.jsxs("div",{className:"space-y-2",children:[v.map((E,V)=>r.jsxs("div",{className:"flex items-center justify-between bg-gray-50 p-3 rounded",children:[r.jsx("span",{className:"text-sm",children:E.name}),r.jsx("button",{onClick:()=>{const B=[...v];B.splice(V,1),b(B);const ve=[...y];ve.splice(V,1),N(ve),_==="two-file"&&(D===V&&oe(null),H===V&&ie(null),D&&D>V&&oe(D-1),H&&H>V&&ie(H-1))},className:"text-red-600 text-sm hover:text-red-800",children:"Remove"})]},V)),r.jsx("button",{type:"button",onClick:()=>{const E=document.createElement("input");E.type="file",E.accept=".csv,.gexf",E.multiple=!0,E.onchange=async V=>{const B=V.target,ve=Array.from(B.files||[]);if(ve.length>0){const Q=await Promise.all(ve.map(pe=>pe.text()));b([...v,...ve]),N([...y,...Q]);const fe=[...v,...ve];fe.length===2&&fe.every(pe=>pe.name.toLowerCase().endsWith(".csv"))&&(S("two-file"),M("csv"))}},E.click()},className:"text-sm text-blue-600 hover:text-blue-800",children:"+ Add More Files"})]})]}),_==="two-file"&&v.length>0&&r.jsxs("div",{className:"border-t pt-4 space-y-4","data-file-select":!0,children:[r.jsx("h3",{className:"font-semibold",children:"Map Files and Fields"}),r.jsxs("div",{"data-field-select":!0,children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Nodes File (Locations) ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsxs("select",{value:D??"",onChange:E=>{const V=parseInt(E.target.value);oe(V);const B=$e(y[V]);Z(B);const ve=B.find(Q=>Q.toLowerCase()==="id");if(ve&&we(ve),h.nodesFile){const Q={...h};delete Q.nodesFile,p(Q)}},className:`w-full px-3 py-2 border rounded-md ${h.nodesFile?"border-red-500":"border-gray-300"}`,children:[r.jsx("option",{value:"",children:"Select file..."}),v.map((E,V)=>r.jsx("option",{value:V,children:E.name},V))]}),h.nodesFile&&r.jsx("p",{className:"mt-1 text-sm text-red-600",children:h.nodesFile}),D!==null&&F.length>0&&r.jsxs("div",{className:"mt-2 space-y-2",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"ID Field *"}),r.jsxs("select",{value:le,onChange:E=>{if(we(E.target.value),h.nodeIdField){const V={...h};delete V.nodeIdField,p(V)}},className:`w-full px-2 py-1 border rounded text-sm ${h.nodeIdField?"border-red-500":"border-gray-300"}`,children:[r.jsx("option",{value:"",children:"Select field..."}),F.map(E=>r.jsx("option",{value:E,children:E},E))]}),h.nodeIdField&&r.jsx("p",{className:"mt-1 text-xs text-red-600",children:h.nodeIdField})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"Label Field (optional)"}),r.jsxs("select",{value:Re,onChange:E=>R(E.target.value),className:"w-full px-2 py-1 border border-gray-300 rounded text-sm",children:[r.jsx("option",{value:"",children:"Use ID field"}),F.map(E=>r.jsx("option",{value:E,children:E},E))]})]})]})]}),r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Edges File (Flows) ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsxs("select",{value:H??"",onChange:E=>{const V=parseInt(E.target.value);ie(V);const B=$e(y[V]);xe(B);const ve=B.find(pe=>pe.toLowerCase()==="source"||pe.toLowerCase()==="origin"||pe.toLowerCase()==="from"),Q=B.find(pe=>pe.toLowerCase()==="target"||pe.toLowerCase()==="dest"||pe.toLowerCase()==="to"),fe=B.find(pe=>pe.toLowerCase()==="value"||pe.toLowerCase()==="count"||pe.toLowerCase()==="weight");if(ve&&_e(ve),Q&&Ye(Q),fe&&De(fe),h.edgesFile){const pe={...h};delete pe.edgesFile,p(pe)}},className:`w-full px-3 py-2 border rounded-md ${h.edgesFile?"border-red-500":"border-gray-300"}`,children:[r.jsx("option",{value:"",children:"Select file..."}),v.map((E,V)=>r.jsx("option",{value:V,children:E.name},V))]}),h.edgesFile&&r.jsx("p",{className:"mt-1 text-sm text-red-600",children:h.edgesFile}),H!==null&&ae.length>0&&r.jsxs("div",{className:"mt-2 space-y-2",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"Source Field *"}),r.jsxs("select",{value:T,onChange:E=>{if(_e(E.target.value),h.edgeSourceField){const V={...h};delete V.edgeSourceField,p(V)}},className:`w-full px-2 py-1 border rounded text-sm ${h.edgeSourceField?"border-red-500":"border-gray-300"}`,children:[r.jsx("option",{value:"",children:"Select field..."}),ae.map(E=>r.jsx("option",{value:E,children:E},E))]}),h.edgeSourceField&&r.jsx("p",{className:"mt-1 text-xs text-red-600",children:h.edgeSourceField})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"Target Field *"}),r.jsxs("select",{value:ne,onChange:E=>{if(Ye(E.target.value),h.edgeTargetField){const V={...h};delete V.edgeTargetField,p(V)}},className:`w-full px-2 py-1 border rounded text-sm ${h.edgeTargetField?"border-red-500":"border-gray-300"}`,children:[r.jsx("option",{value:"",children:"Select field..."}),ae.map(E=>r.jsx("option",{value:E,children:E},E))]}),h.edgeTargetField&&r.jsx("p",{className:"mt-1 text-xs text-red-600",children:h.edgeTargetField})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"Value Field *"}),r.jsxs("select",{value:q,onChange:E=>{if(De(E.target.value),h.edgeValueField){const V={...h};delete V.edgeValueField,p(V)}},className:`w-full px-2 py-1 border rounded text-sm ${h.edgeValueField?"border-red-500":"border-gray-300"}`,children:[r.jsx("option",{value:"",children:"Select field..."}),ae.map(E=>r.jsx("option",{value:E,children:E},E))]}),h.edgeValueField&&r.jsx("p",{className:"mt-1 text-xs text-red-600",children:h.edgeValueField})]})]})]})]}),r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Dataset Name ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsx("input",{ref:z,type:"text",value:a,onChange:E=>{if(l(E.target.value),h.name){const V={...h};delete V.name,p(V)}},className:`w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 ${h.name?"border-red-500 focus:ring-red-500":"border-gray-300 focus:ring-blue-500"}`,placeholder:"Enter a name for this dataset"}),h.name&&r.jsx("p",{className:"mt-1 text-sm text-red-600",children:h.name})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Notes (optional)"}),r.jsx("textarea",{value:i,onChange:E=>d(E.target.value),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Add any notes about this dataset..."})]}),h.general&&r.jsxs("div",{className:"bg-red-50 border border-red-200 rounded p-3",children:[r.jsx("h4",{className:"font-semibold text-red-800 mb-2",children:"Error:"}),r.jsx("p",{className:"text-sm text-red-700",children:h.general})]}),K&&r.jsxs("div",{ref:P,className:"bg-blue-50 border border-blue-200 rounded p-3",children:[r.jsx("h4",{className:"font-semibold text-blue-800 mb-2",children:"Data Summary"}),r.jsxs("div",{className:"text-sm text-blue-700 space-y-1",children:[r.jsxs("div",{children:[r.jsx("span",{className:"font-medium",children:"Nodes:"})," ",K.nodes.length]}),r.jsxs("div",{children:[r.jsx("span",{className:"font-medium",children:"Edges:"})," ",K.edges.length]}),K.timeRange&&r.jsxs("div",{children:[r.jsx("span",{className:"font-medium",children:"Time Range:"})," ",K.timeRange.start,K.timeRange.end!==K.timeRange.start?` – ${K.timeRange.end}`:""]}),K.nodes.length>0&&r.jsxs("div",{className:"mt-2 text-xs",children:[r.jsx("span",{className:"font-medium",children:"Sample node properties:"})," ",Object.keys(K.nodes[0]).slice(0,5).join(", "),Object.keys(K.nodes[0]).length>5&&"..."]}),h.summary&&r.jsxs("div",{className:"mt-2 pt-2 border-t border-blue-300",children:[r.jsx("span",{className:"font-medium text-orange-700",children:"Warnings:"})," ",r.jsx("span",{className:"text-orange-600",children:h.summary})]})]})]})]})}),r.jsxs("div",{className:"p-6 border-t flex justify-end gap-3",children:[r.jsx("button",{onClick:e,type:"button",disabled:m,className:"px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50 disabled:opacity-50 cursor-pointer transition-colors",children:"Cancel"}),r.jsx("button",{onClick:bn,type:"button",disabled:m||(Object.keys(h).filter(V=>V!=="summary").length>0||!K),className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed cursor-pointer transition-colors",children:m?"Importing...":"Import Dataset"})]})]})})}/**
   * table-core
   *
   * Copyright (c) TanStack
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE.md file in the root directory of this source tree.
   *
   * @license MIT
   */function Mt(e,n){return typeof e=="function"?e(n):e}function Ze(e,n){return t=>{n.setState(s=>({...s,[e]:Mt(t,s[e])}))}}function Pn(e){return e instanceof Function}function ea(e){return Array.isArray(e)&&e.every(n=>typeof n=="number")}function ta(e,n){const t=[],s=o=>{o.forEach(a=>{t.push(a);const l=n(a);l!=null&&l.length&&s(l)})};return s(e),t}function Y(e,n,t){let s=[],o;return a=>{let l;t.key&&t.debug&&(l=Date.now());const i=e(a);if(!(i.length!==s.length||i.some((c,h)=>s[h]!==c)))return o;s=i;let m;if(t.key&&t.debug&&(m=Date.now()),o=n(...i),t==null||t.onChange==null||t.onChange(o),t.key&&t.debug&&t!=null&&t.debug()){const c=Math.round((Date.now()-l)*100)/100,h=Math.round((Date.now()-m)*100)/100,p=h/16,f=(w,_)=>{for(w=String(w);w.length<_;)w=" "+w;return w};console.info(`%c⏱ ${f(h,5)} /${f(c,5)} ms`,`
            font-size: .6rem;
            font-weight: bold;
            color: hsl(${Math.max(0,Math.min(120-120*p,120))}deg 100% 31%);`,t==null?void 0:t.key)}return o}}function X(e,n,t,s){return{debug:()=>{var o;return(o=e==null?void 0:e.debugAll)!=null?o:e[n]},key:!1,onChange:s}}function na(e,n,t,s){const o=()=>{var l;return(l=a.getValue())!=null?l:e.options.renderFallbackValue},a={id:`${n.id}_${t.id}`,row:n,column:t,getValue:()=>n.getValue(s),renderValue:o,getContext:Y(()=>[e,t,n,a],(l,i,d,m)=>({table:l,column:i,row:d,cell:m,getValue:m.getValue,renderValue:m.renderValue}),X(e.options,"debugCells"))};return e._features.forEach(l=>{l.createCell==null||l.createCell(a,t,n,e)},{}),a}function sa(e,n,t,s){var o,a;const i={...e._getDefaultColumnDef(),...n},d=i.accessorKey;let m=(o=(a=i.id)!=null?a:d?typeof String.prototype.replaceAll=="function"?d.replaceAll(".","_"):d.replace(/\./g,"_"):void 0)!=null?o:typeof i.header=="string"?i.header:void 0,c;if(i.accessorFn?c=i.accessorFn:d&&(d.includes(".")?c=p=>{let f=p;for(const _ of d.split(".")){var w;f=(w=f)==null?void 0:w[_]}return f}:c=p=>p[i.accessorKey]),!m)throw new Error;let h={id:`${String(m)}`,accessorFn:c,parent:s,depth:t,columnDef:i,columns:[],getFlatColumns:Y(()=>[!0],()=>{var p;return[h,...(p=h.columns)==null?void 0:p.flatMap(f=>f.getFlatColumns())]},X(e.options,"debugColumns")),getLeafColumns:Y(()=>[e._getOrderColumnsFn()],p=>{var f;if((f=h.columns)!=null&&f.length){let w=h.columns.flatMap(_=>_.getLeafColumns());return p(w)}return[h]},X(e.options,"debugColumns"))};for(const p of e._features)p.createColumn==null||p.createColumn(h,e);return h}const Ue="debugHeaders";function Js(e,n,t){var s;let a={id:(s=t.id)!=null?s:n.id,column:n,index:t.index,isPlaceholder:!!t.isPlaceholder,placeholderId:t.placeholderId,depth:t.depth,subHeaders:[],colSpan:0,rowSpan:0,headerGroup:null,getLeafHeaders:()=>{const l=[],i=d=>{d.subHeaders&&d.subHeaders.length&&d.subHeaders.map(i),l.push(d)};return i(a),l},getContext:()=>({table:e,header:a,column:n})};return e._features.forEach(l=>{l.createHeader==null||l.createHeader(a,e)}),a}const ra={createTable:e=>{e.getHeaderGroups=Y(()=>[e.getAllColumns(),e.getVisibleLeafColumns(),e.getState().columnPinning.left,e.getState().columnPinning.right],(n,t,s,o)=>{var a,l;const i=(a=s==null?void 0:s.map(h=>t.find(p=>p.id===h)).filter(Boolean))!=null?a:[],d=(l=o==null?void 0:o.map(h=>t.find(p=>p.id===h)).filter(Boolean))!=null?l:[],m=t.filter(h=>!(s!=null&&s.includes(h.id))&&!(o!=null&&o.includes(h.id)));return En(n,[...i,...m,...d],e)},X(e.options,Ue)),e.getCenterHeaderGroups=Y(()=>[e.getAllColumns(),e.getVisibleLeafColumns(),e.getState().columnPinning.left,e.getState().columnPinning.right],(n,t,s,o)=>(t=t.filter(a=>!(s!=null&&s.includes(a.id))&&!(o!=null&&o.includes(a.id))),En(n,t,e,"center")),X(e.options,Ue)),e.getLeftHeaderGroups=Y(()=>[e.getAllColumns(),e.getVisibleLeafColumns(),e.getState().columnPinning.left],(n,t,s)=>{var o;const a=(o=s==null?void 0:s.map(l=>t.find(i=>i.id===l)).filter(Boolean))!=null?o:[];return En(n,a,e,"left")},X(e.options,Ue)),e.getRightHeaderGroups=Y(()=>[e.getAllColumns(),e.getVisibleLeafColumns(),e.getState().columnPinning.right],(n,t,s)=>{var o;const a=(o=s==null?void 0:s.map(l=>t.find(i=>i.id===l)).filter(Boolean))!=null?o:[];return En(n,a,e,"right")},X(e.options,Ue)),e.getFooterGroups=Y(()=>[e.getHeaderGroups()],n=>[...n].reverse(),X(e.options,Ue)),e.getLeftFooterGroups=Y(()=>[e.getLeftHeaderGroups()],n=>[...n].reverse(),X(e.options,Ue)),e.getCenterFooterGroups=Y(()=>[e.getCenterHeaderGroups()],n=>[...n].reverse(),X(e.options,Ue)),e.getRightFooterGroups=Y(()=>[e.getRightHeaderGroups()],n=>[...n].reverse(),X(e.options,Ue)),e.getFlatHeaders=Y(()=>[e.getHeaderGroups()],n=>n.map(t=>t.headers).flat(),X(e.options,Ue)),e.getLeftFlatHeaders=Y(()=>[e.getLeftHeaderGroups()],n=>n.map(t=>t.headers).flat(),X(e.options,Ue)),e.getCenterFlatHeaders=Y(()=>[e.getCenterHeaderGroups()],n=>n.map(t=>t.headers).flat(),X(e.options,Ue)),e.getRightFlatHeaders=Y(()=>[e.getRightHeaderGroups()],n=>n.map(t=>t.headers).flat(),X(e.options,Ue)),e.getCenterLeafHeaders=Y(()=>[e.getCenterFlatHeaders()],n=>n.filter(t=>{var s;return!((s=t.subHeaders)!=null&&s.length)}),X(e.options,Ue)),e.getLeftLeafHeaders=Y(()=>[e.getLeftFlatHeaders()],n=>n.filter(t=>{var s;return!((s=t.subHeaders)!=null&&s.length)}),X(e.options,Ue)),e.getRightLeafHeaders=Y(()=>[e.getRightFlatHeaders()],n=>n.filter(t=>{var s;return!((s=t.subHeaders)!=null&&s.length)}),X(e.options,Ue)),e.getLeafHeaders=Y(()=>[e.getLeftHeaderGroups(),e.getCenterHeaderGroups(),e.getRightHeaderGroups()],(n,t,s)=>{var o,a,l,i,d,m;return[...(o=(a=n[0])==null?void 0:a.headers)!=null?o:[],...(l=(i=t[0])==null?void 0:i.headers)!=null?l:[],...(d=(m=s[0])==null?void 0:m.headers)!=null?d:[]].map(c=>c.getLeafHeaders()).flat()},X(e.options,Ue))}};function En(e,n,t,s){var o,a;let l=0;const i=function(p,f){f===void 0&&(f=1),l=Math.max(l,f),p.filter(w=>w.getIsVisible()).forEach(w=>{var _;(_=w.columns)!=null&&_.length&&i(w.columns,f+1)},0)};i(e);let d=[];const m=(p,f)=>{const w={depth:f,id:[s,`${f}`].filter(Boolean).join("_"),headers:[]},_=[];p.forEach(S=>{const v=[..._].reverse()[0],b=S.column.depth===w.depth;let y,N=!1;if(b&&S.column.parent?y=S.column.parent:(y=S.column,N=!0),v&&(v==null?void 0:v.column)===y)v.subHeaders.push(S);else{const I=Js(t,y,{id:[s,f,y.id,S==null?void 0:S.id].filter(Boolean).join("_"),isPlaceholder:N,placeholderId:N?`${_.filter(M=>M.column===y).length}`:void 0,depth:f,index:_.length});I.subHeaders.push(S),_.push(I)}w.headers.push(S),S.headerGroup=w}),d.push(w),f>0&&m(_,f-1)},c=n.map((p,f)=>Js(t,p,{depth:l,index:f}));m(c,l-1),d.reverse();const h=p=>p.filter(w=>w.column.getIsVisible()).map(w=>{let _=0,S=0,v=[0];w.subHeaders&&w.subHeaders.length?(v=[],h(w.subHeaders).forEach(y=>{let{colSpan:N,rowSpan:I}=y;_+=N,v.push(I)})):_=1;const b=Math.min(...v);return S=S+b,w.colSpan=_,w.rowSpan=S,{colSpan:_,rowSpan:S}});return h((o=(a=d[0])==null?void 0:a.headers)!=null?o:[]),d}const oa=(e,n,t,s,o,a,l)=>{let i={id:n,index:s,original:t,depth:o,parentId:l,_valuesCache:{},_uniqueValuesCache:{},getValue:d=>{if(i._valuesCache.hasOwnProperty(d))return i._valuesCache[d];const m=e.getColumn(d);if(m!=null&&m.accessorFn)return i._valuesCache[d]=m.accessorFn(i.original,s),i._valuesCache[d]},getUniqueValues:d=>{if(i._uniqueValuesCache.hasOwnProperty(d))return i._uniqueValuesCache[d];const m=e.getColumn(d);if(m!=null&&m.accessorFn)return m.columnDef.getUniqueValues?(i._uniqueValuesCache[d]=m.columnDef.getUniqueValues(i.original,s),i._uniqueValuesCache[d]):(i._uniqueValuesCache[d]=[i.getValue(d)],i._uniqueValuesCache[d])},renderValue:d=>{var m;return(m=i.getValue(d))!=null?m:e.options.renderFallbackValue},subRows:[],getLeafRows:()=>ta(i.subRows,d=>d.subRows),getParentRow:()=>i.parentId?e.getRow(i.parentId,!0):void 0,getParentRows:()=>{let d=[],m=i;for(;;){const c=m.getParentRow();if(!c)break;d.push(c),m=c}return d.reverse()},getAllCells:Y(()=>[e.getAllLeafColumns()],d=>d.map(m=>na(e,i,m,m.id)),X(e.options,"debugRows")),_getAllCellsByColumnId:Y(()=>[i.getAllCells()],d=>d.reduce((m,c)=>(m[c.column.id]=c,m),{}),X(e.options,"debugRows"))};for(let d=0;d<e._features.length;d++){const m=e._features[d];m==null||m.createRow==null||m.createRow(i,e)}return i},aa={createColumn:(e,n)=>{e._getFacetedRowModel=n.options.getFacetedRowModel&&n.options.getFacetedRowModel(n,e.id),e.getFacetedRowModel=()=>e._getFacetedRowModel?e._getFacetedRowModel():n.getPreFilteredRowModel(),e._getFacetedUniqueValues=n.options.getFacetedUniqueValues&&n.options.getFacetedUniqueValues(n,e.id),e.getFacetedUniqueValues=()=>e._getFacetedUniqueValues?e._getFacetedUniqueValues():new Map,e._getFacetedMinMaxValues=n.options.getFacetedMinMaxValues&&n.options.getFacetedMinMaxValues(n,e.id),e.getFacetedMinMaxValues=()=>{if(e._getFacetedMinMaxValues)return e._getFacetedMinMaxValues()}}},hr=(e,n,t)=>{var s,o;const a=t==null||(s=t.toString())==null?void 0:s.toLowerCase();return!!(!((o=e.getValue(n))==null||(o=o.toString())==null||(o=o.toLowerCase())==null)&&o.includes(a))};hr.autoRemove=e=>rt(e);const xr=(e,n,t)=>{var s;return!!(!((s=e.getValue(n))==null||(s=s.toString())==null)&&s.includes(t))};xr.autoRemove=e=>rt(e);const vr=(e,n,t)=>{var s;return((s=e.getValue(n))==null||(s=s.toString())==null?void 0:s.toLowerCase())===(t==null?void 0:t.toLowerCase())};vr.autoRemove=e=>rt(e);const yr=(e,n,t)=>{var s;return(s=e.getValue(n))==null?void 0:s.includes(t)};yr.autoRemove=e=>rt(e);const br=(e,n,t)=>!t.some(s=>{var o;return!((o=e.getValue(n))!=null&&o.includes(s))});br.autoRemove=e=>rt(e)||!(e!=null&&e.length);const Sr=(e,n,t)=>t.some(s=>{var o;return(o=e.getValue(n))==null?void 0:o.includes(s)});Sr.autoRemove=e=>rt(e)||!(e!=null&&e.length);const wr=(e,n,t)=>e.getValue(n)===t;wr.autoRemove=e=>rt(e);const _r=(e,n,t)=>e.getValue(n)==t;_r.autoRemove=e=>rt(e);const Cs=(e,n,t)=>{let[s,o]=t;const a=e.getValue(n);return a>=s&&a<=o};Cs.resolveFilterValue=e=>{let[n,t]=e,s=typeof n!="number"?parseFloat(n):n,o=typeof t!="number"?parseFloat(t):t,a=n===null||Number.isNaN(s)?-1/0:s,l=t===null||Number.isNaN(o)?1/0:o;if(a>l){const i=a;a=l,l=i}return[a,l]};Cs.autoRemove=e=>rt(e)||rt(e[0])&&rt(e[1]);const ht={includesString:hr,includesStringSensitive:xr,equalsString:vr,arrIncludes:yr,arrIncludesAll:br,arrIncludesSome:Sr,equals:wr,weakEquals:_r,inNumberRange:Cs};function rt(e){return e==null||e===""}const ia={getDefaultColumnDef:()=>({filterFn:"auto"}),getInitialState:e=>({columnFilters:[],...e}),getDefaultOptions:e=>({onColumnFiltersChange:Ze("columnFilters",e),filterFromLeafRows:!1,maxLeafRowFilterDepth:100}),createColumn:(e,n)=>{e.getAutoFilterFn=()=>{const t=n.getCoreRowModel().flatRows[0],s=t==null?void 0:t.getValue(e.id);return typeof s=="string"?ht.includesString:typeof s=="number"?ht.inNumberRange:typeof s=="boolean"||s!==null&&typeof s=="object"?ht.equals:Array.isArray(s)?ht.arrIncludes:ht.weakEquals},e.getFilterFn=()=>{var t,s;return Pn(e.columnDef.filterFn)?e.columnDef.filterFn:e.columnDef.filterFn==="auto"?e.getAutoFilterFn():(t=(s=n.options.filterFns)==null?void 0:s[e.columnDef.filterFn])!=null?t:ht[e.columnDef.filterFn]},e.getCanFilter=()=>{var t,s,o;return((t=e.columnDef.enableColumnFilter)!=null?t:!0)&&((s=n.options.enableColumnFilters)!=null?s:!0)&&((o=n.options.enableFilters)!=null?o:!0)&&!!e.accessorFn},e.getIsFiltered=()=>e.getFilterIndex()>-1,e.getFilterValue=()=>{var t;return(t=n.getState().columnFilters)==null||(t=t.find(s=>s.id===e.id))==null?void 0:t.value},e.getFilterIndex=()=>{var t,s;return(t=(s=n.getState().columnFilters)==null?void 0:s.findIndex(o=>o.id===e.id))!=null?t:-1},e.setFilterValue=t=>{n.setColumnFilters(s=>{const o=e.getFilterFn(),a=s==null?void 0:s.find(c=>c.id===e.id),l=Mt(t,a?a.value:void 0);if(er(o,l,e)){var i;return(i=s==null?void 0:s.filter(c=>c.id!==e.id))!=null?i:[]}const d={id:e.id,value:l};if(a){var m;return(m=s==null?void 0:s.map(c=>c.id===e.id?d:c))!=null?m:[]}return s!=null&&s.length?[...s,d]:[d]})}},createRow:(e,n)=>{e.columnFilters={},e.columnFiltersMeta={}},createTable:e=>{e.setColumnFilters=n=>{const t=e.getAllLeafColumns(),s=o=>{var a;return(a=Mt(n,o))==null?void 0:a.filter(l=>{const i=t.find(d=>d.id===l.id);if(i){const d=i.getFilterFn();if(er(d,l.value,i))return!1}return!0})};e.options.onColumnFiltersChange==null||e.options.onColumnFiltersChange(s)},e.resetColumnFilters=n=>{var t,s;e.setColumnFilters(n?[]:(t=(s=e.initialState)==null?void 0:s.columnFilters)!=null?t:[])},e.getPreFilteredRowModel=()=>e.getCoreRowModel(),e.getFilteredRowModel=()=>(!e._getFilteredRowModel&&e.options.getFilteredRowModel&&(e._getFilteredRowModel=e.options.getFilteredRowModel(e)),e.options.manualFiltering||!e._getFilteredRowModel?e.getPreFilteredRowModel():e._getFilteredRowModel())}};function er(e,n,t){return(e&&e.autoRemove?e.autoRemove(n,t):!1)||typeof n>"u"||typeof n=="string"&&!n}const la=(e,n,t)=>t.reduce((s,o)=>{const a=o.getValue(e);return s+(typeof a=="number"?a:0)},0),ua=(e,n,t)=>{let s;return t.forEach(o=>{const a=o.getValue(e);a!=null&&(s>a||s===void 0&&a>=a)&&(s=a)}),s},da=(e,n,t)=>{let s;return t.forEach(o=>{const a=o.getValue(e);a!=null&&(s<a||s===void 0&&a>=a)&&(s=a)}),s},ca=(e,n,t)=>{let s,o;return t.forEach(a=>{const l=a.getValue(e);l!=null&&(s===void 0?l>=l&&(s=o=l):(s>l&&(s=l),o<l&&(o=l)))}),[s,o]},ga=(e,n)=>{let t=0,s=0;if(n.forEach(o=>{let a=o.getValue(e);a!=null&&(a=+a)>=a&&(++t,s+=a)}),t)return s/t},ma=(e,n)=>{if(!n.length)return;const t=n.map(a=>a.getValue(e));if(!ea(t))return;if(t.length===1)return t[0];const s=Math.floor(t.length/2),o=t.sort((a,l)=>a-l);return t.length%2!==0?o[s]:(o[s-1]+o[s])/2},fa=(e,n)=>Array.from(new Set(n.map(t=>t.getValue(e))).values()),pa=(e,n)=>new Set(n.map(t=>t.getValue(e))).size,ha=(e,n)=>n.length,rs={sum:la,min:ua,max:da,extent:ca,mean:ga,median:ma,unique:fa,uniqueCount:pa,count:ha},xa={getDefaultColumnDef:()=>({aggregatedCell:e=>{var n,t;return(n=(t=e.getValue())==null||t.toString==null?void 0:t.toString())!=null?n:null},aggregationFn:"auto"}),getInitialState:e=>({grouping:[],...e}),getDefaultOptions:e=>({onGroupingChange:Ze("grouping",e),groupedColumnMode:"reorder"}),createColumn:(e,n)=>{e.toggleGrouping=()=>{n.setGrouping(t=>t!=null&&t.includes(e.id)?t.filter(s=>s!==e.id):[...t??[],e.id])},e.getCanGroup=()=>{var t,s;return((t=e.columnDef.enableGrouping)!=null?t:!0)&&((s=n.options.enableGrouping)!=null?s:!0)&&(!!e.accessorFn||!!e.columnDef.getGroupingValue)},e.getIsGrouped=()=>{var t;return(t=n.getState().grouping)==null?void 0:t.includes(e.id)},e.getGroupedIndex=()=>{var t;return(t=n.getState().grouping)==null?void 0:t.indexOf(e.id)},e.getToggleGroupingHandler=()=>{const t=e.getCanGroup();return()=>{t&&e.toggleGrouping()}},e.getAutoAggregationFn=()=>{const t=n.getCoreRowModel().flatRows[0],s=t==null?void 0:t.getValue(e.id);if(typeof s=="number")return rs.sum;if(Object.prototype.toString.call(s)==="[object Date]")return rs.extent},e.getAggregationFn=()=>{var t,s;if(!e)throw new Error;return Pn(e.columnDef.aggregationFn)?e.columnDef.aggregationFn:e.columnDef.aggregationFn==="auto"?e.getAutoAggregationFn():(t=(s=n.options.aggregationFns)==null?void 0:s[e.columnDef.aggregationFn])!=null?t:rs[e.columnDef.aggregationFn]}},createTable:e=>{e.setGrouping=n=>e.options.onGroupingChange==null?void 0:e.options.onGroupingChange(n),e.resetGrouping=n=>{var t,s;e.setGrouping(n?[]:(t=(s=e.initialState)==null?void 0:s.grouping)!=null?t:[])},e.getPreGroupedRowModel=()=>e.getFilteredRowModel(),e.getGroupedRowModel=()=>(!e._getGroupedRowModel&&e.options.getGroupedRowModel&&(e._getGroupedRowModel=e.options.getGroupedRowModel(e)),e.options.manualGrouping||!e._getGroupedRowModel?e.getPreGroupedRowModel():e._getGroupedRowModel())},createRow:(e,n)=>{e.getIsGrouped=()=>!!e.groupingColumnId,e.getGroupingValue=t=>{if(e._groupingValuesCache.hasOwnProperty(t))return e._groupingValuesCache[t];const s=n.getColumn(t);return s!=null&&s.columnDef.getGroupingValue?(e._groupingValuesCache[t]=s.columnDef.getGroupingValue(e.original),e._groupingValuesCache[t]):e.getValue(t)},e._groupingValuesCache={}},createCell:(e,n,t,s)=>{e.getIsGrouped=()=>n.getIsGrouped()&&n.id===t.groupingColumnId,e.getIsPlaceholder=()=>!e.getIsGrouped()&&n.getIsGrouped(),e.getIsAggregated=()=>{var o;return!e.getIsGrouped()&&!e.getIsPlaceholder()&&!!((o=t.subRows)!=null&&o.length)}}};function va(e,n,t){if(!(n!=null&&n.length)||!t)return e;const s=e.filter(a=>!n.includes(a.id));return t==="remove"?s:[...n.map(a=>e.find(l=>l.id===a)).filter(Boolean),...s]}const ya={getInitialState:e=>({columnOrder:[],...e}),getDefaultOptions:e=>({onColumnOrderChange:Ze("columnOrder",e)}),createColumn:(e,n)=>{e.getIndex=Y(t=>[hn(n,t)],t=>t.findIndex(s=>s.id===e.id),X(n.options,"debugColumns")),e.getIsFirstColumn=t=>{var s;return((s=hn(n,t)[0])==null?void 0:s.id)===e.id},e.getIsLastColumn=t=>{var s;const o=hn(n,t);return((s=o[o.length-1])==null?void 0:s.id)===e.id}},createTable:e=>{e.setColumnOrder=n=>e.options.onColumnOrderChange==null?void 0:e.options.onColumnOrderChange(n),e.resetColumnOrder=n=>{var t;e.setColumnOrder(n?[]:(t=e.initialState.columnOrder)!=null?t:[])},e._getOrderColumnsFn=Y(()=>[e.getState().columnOrder,e.getState().grouping,e.options.groupedColumnMode],(n,t,s)=>o=>{let a=[];if(!(n!=null&&n.length))a=o;else{const l=[...n],i=[...o];for(;i.length&&l.length;){const d=l.shift(),m=i.findIndex(c=>c.id===d);m>-1&&a.push(i.splice(m,1)[0])}a=[...a,...i]}return va(a,t,s)},X(e.options,"debugTable"))}},os=()=>({left:[],right:[]}),ba={getInitialState:e=>({columnPinning:os(),...e}),getDefaultOptions:e=>({onColumnPinningChange:Ze("columnPinning",e)}),createColumn:(e,n)=>{e.pin=t=>{const s=e.getLeafColumns().map(o=>o.id).filter(Boolean);n.setColumnPinning(o=>{var a,l;if(t==="right"){var i,d;return{left:((i=o==null?void 0:o.left)!=null?i:[]).filter(h=>!(s!=null&&s.includes(h))),right:[...((d=o==null?void 0:o.right)!=null?d:[]).filter(h=>!(s!=null&&s.includes(h))),...s]}}if(t==="left"){var m,c;return{left:[...((m=o==null?void 0:o.left)!=null?m:[]).filter(h=>!(s!=null&&s.includes(h))),...s],right:((c=o==null?void 0:o.right)!=null?c:[]).filter(h=>!(s!=null&&s.includes(h)))}}return{left:((a=o==null?void 0:o.left)!=null?a:[]).filter(h=>!(s!=null&&s.includes(h))),right:((l=o==null?void 0:o.right)!=null?l:[]).filter(h=>!(s!=null&&s.includes(h)))}})},e.getCanPin=()=>e.getLeafColumns().some(s=>{var o,a,l;return((o=s.columnDef.enablePinning)!=null?o:!0)&&((a=(l=n.options.enableColumnPinning)!=null?l:n.options.enablePinning)!=null?a:!0)}),e.getIsPinned=()=>{const t=e.getLeafColumns().map(i=>i.id),{left:s,right:o}=n.getState().columnPinning,a=t.some(i=>s==null?void 0:s.includes(i)),l=t.some(i=>o==null?void 0:o.includes(i));return a?"left":l?"right":!1},e.getPinnedIndex=()=>{var t,s;const o=e.getIsPinned();return o?(t=(s=n.getState().columnPinning)==null||(s=s[o])==null?void 0:s.indexOf(e.id))!=null?t:-1:0}},createRow:(e,n)=>{e.getCenterVisibleCells=Y(()=>[e._getAllVisibleCells(),n.getState().columnPinning.left,n.getState().columnPinning.right],(t,s,o)=>{const a=[...s??[],...o??[]];return t.filter(l=>!a.includes(l.column.id))},X(n.options,"debugRows")),e.getLeftVisibleCells=Y(()=>[e._getAllVisibleCells(),n.getState().columnPinning.left],(t,s)=>(s??[]).map(a=>t.find(l=>l.column.id===a)).filter(Boolean).map(a=>({...a,position:"left"})),X(n.options,"debugRows")),e.getRightVisibleCells=Y(()=>[e._getAllVisibleCells(),n.getState().columnPinning.right],(t,s)=>(s??[]).map(a=>t.find(l=>l.column.id===a)).filter(Boolean).map(a=>({...a,position:"right"})),X(n.options,"debugRows"))},createTable:e=>{e.setColumnPinning=n=>e.options.onColumnPinningChange==null?void 0:e.options.onColumnPinningChange(n),e.resetColumnPinning=n=>{var t,s;return e.setColumnPinning(n?os():(t=(s=e.initialState)==null?void 0:s.columnPinning)!=null?t:os())},e.getIsSomeColumnsPinned=n=>{var t;const s=e.getState().columnPinning;if(!n){var o,a;return!!((o=s.left)!=null&&o.length||(a=s.right)!=null&&a.length)}return!!((t=s[n])!=null&&t.length)},e.getLeftLeafColumns=Y(()=>[e.getAllLeafColumns(),e.getState().columnPinning.left],(n,t)=>(t??[]).map(s=>n.find(o=>o.id===s)).filter(Boolean),X(e.options,"debugColumns")),e.getRightLeafColumns=Y(()=>[e.getAllLeafColumns(),e.getState().columnPinning.right],(n,t)=>(t??[]).map(s=>n.find(o=>o.id===s)).filter(Boolean),X(e.options,"debugColumns")),e.getCenterLeafColumns=Y(()=>[e.getAllLeafColumns(),e.getState().columnPinning.left,e.getState().columnPinning.right],(n,t,s)=>{const o=[...t??[],...s??[]];return n.filter(a=>!o.includes(a.id))},X(e.options,"debugColumns"))}};function Sa(e){return e||(typeof document<"u"?document:null)}const In={size:150,minSize:20,maxSize:Number.MAX_SAFE_INTEGER},as=()=>({startOffset:null,startSize:null,deltaOffset:null,deltaPercentage:null,isResizingColumn:!1,columnSizingStart:[]}),wa={getDefaultColumnDef:()=>In,getInitialState:e=>({columnSizing:{},columnSizingInfo:as(),...e}),getDefaultOptions:e=>({columnResizeMode:"onEnd",columnResizeDirection:"ltr",onColumnSizingChange:Ze("columnSizing",e),onColumnSizingInfoChange:Ze("columnSizingInfo",e)}),createColumn:(e,n)=>{e.getSize=()=>{var t,s,o;const a=n.getState().columnSizing[e.id];return Math.min(Math.max((t=e.columnDef.minSize)!=null?t:In.minSize,(s=a??e.columnDef.size)!=null?s:In.size),(o=e.columnDef.maxSize)!=null?o:In.maxSize)},e.getStart=Y(t=>[t,hn(n,t),n.getState().columnSizing],(t,s)=>s.slice(0,e.getIndex(t)).reduce((o,a)=>o+a.getSize(),0),X(n.options,"debugColumns")),e.getAfter=Y(t=>[t,hn(n,t),n.getState().columnSizing],(t,s)=>s.slice(e.getIndex(t)+1).reduce((o,a)=>o+a.getSize(),0),X(n.options,"debugColumns")),e.resetSize=()=>{n.setColumnSizing(t=>{let{[e.id]:s,...o}=t;return o})},e.getCanResize=()=>{var t,s;return((t=e.columnDef.enableResizing)!=null?t:!0)&&((s=n.options.enableColumnResizing)!=null?s:!0)},e.getIsResizing=()=>n.getState().columnSizingInfo.isResizingColumn===e.id},createHeader:(e,n)=>{e.getSize=()=>{let t=0;const s=o=>{if(o.subHeaders.length)o.subHeaders.forEach(s);else{var a;t+=(a=o.column.getSize())!=null?a:0}};return s(e),t},e.getStart=()=>{if(e.index>0){const t=e.headerGroup.headers[e.index-1];return t.getStart()+t.getSize()}return 0},e.getResizeHandler=t=>{const s=n.getColumn(e.column.id),o=s==null?void 0:s.getCanResize();return a=>{if(!s||!o||(a.persist==null||a.persist(),is(a)&&a.touches&&a.touches.length>1))return;const l=e.getSize(),i=e?e.getLeafHeaders().map(v=>[v.column.id,v.column.getSize()]):[[s.id,s.getSize()]],d=is(a)?Math.round(a.touches[0].clientX):a.clientX,m={},c=(v,b)=>{typeof b=="number"&&(n.setColumnSizingInfo(y=>{var N,I;const M=n.options.columnResizeDirection==="rtl"?-1:1,z=(b-((N=y==null?void 0:y.startOffset)!=null?N:0))*M,P=Math.max(z/((I=y==null?void 0:y.startSize)!=null?I:0),-.999999);return y.columnSizingStart.forEach(D=>{let[oe,H]=D;m[oe]=Math.round(Math.max(H+H*P,0)*100)/100}),{...y,deltaOffset:z,deltaPercentage:P}}),(n.options.columnResizeMode==="onChange"||v==="end")&&n.setColumnSizing(y=>({...y,...m})))},h=v=>c("move",v),p=v=>{c("end",v),n.setColumnSizingInfo(b=>({...b,isResizingColumn:!1,startOffset:null,startSize:null,deltaOffset:null,deltaPercentage:null,columnSizingStart:[]}))},f=Sa(t),w={moveHandler:v=>h(v.clientX),upHandler:v=>{f==null||f.removeEventListener("mousemove",w.moveHandler),f==null||f.removeEventListener("mouseup",w.upHandler),p(v.clientX)}},_={moveHandler:v=>(v.cancelable&&(v.preventDefault(),v.stopPropagation()),h(v.touches[0].clientX),!1),upHandler:v=>{var b;f==null||f.removeEventListener("touchmove",_.moveHandler),f==null||f.removeEventListener("touchend",_.upHandler),v.cancelable&&(v.preventDefault(),v.stopPropagation()),p((b=v.touches[0])==null?void 0:b.clientX)}},S=_a()?{passive:!1}:!1;is(a)?(f==null||f.addEventListener("touchmove",_.moveHandler,S),f==null||f.addEventListener("touchend",_.upHandler,S)):(f==null||f.addEventListener("mousemove",w.moveHandler,S),f==null||f.addEventListener("mouseup",w.upHandler,S)),n.setColumnSizingInfo(v=>({...v,startOffset:d,startSize:l,deltaOffset:0,deltaPercentage:0,columnSizingStart:i,isResizingColumn:s.id}))}}},createTable:e=>{e.setColumnSizing=n=>e.options.onColumnSizingChange==null?void 0:e.options.onColumnSizingChange(n),e.setColumnSizingInfo=n=>e.options.onColumnSizingInfoChange==null?void 0:e.options.onColumnSizingInfoChange(n),e.resetColumnSizing=n=>{var t;e.setColumnSizing(n?{}:(t=e.initialState.columnSizing)!=null?t:{})},e.resetHeaderSizeInfo=n=>{var t;e.setColumnSizingInfo(n?as():(t=e.initialState.columnSizingInfo)!=null?t:as())},e.getTotalSize=()=>{var n,t;return(n=(t=e.getHeaderGroups()[0])==null?void 0:t.headers.reduce((s,o)=>s+o.getSize(),0))!=null?n:0},e.getLeftTotalSize=()=>{var n,t;return(n=(t=e.getLeftHeaderGroups()[0])==null?void 0:t.headers.reduce((s,o)=>s+o.getSize(),0))!=null?n:0},e.getCenterTotalSize=()=>{var n,t;return(n=(t=e.getCenterHeaderGroups()[0])==null?void 0:t.headers.reduce((s,o)=>s+o.getSize(),0))!=null?n:0},e.getRightTotalSize=()=>{var n,t;return(n=(t=e.getRightHeaderGroups()[0])==null?void 0:t.headers.reduce((s,o)=>s+o.getSize(),0))!=null?n:0}}};let $n=null;function _a(){if(typeof $n=="boolean")return $n;let e=!1;try{const n={get passive(){return e=!0,!1}},t=()=>{};window.addEventListener("test",t,n),window.removeEventListener("test",t)}catch{e=!1}return $n=e,$n}function is(e){return e.type==="touchstart"}const Ca={getInitialState:e=>({columnVisibility:{},...e}),getDefaultOptions:e=>({onColumnVisibilityChange:Ze("columnVisibility",e)}),createColumn:(e,n)=>{e.toggleVisibility=t=>{e.getCanHide()&&n.setColumnVisibility(s=>({...s,[e.id]:t??!e.getIsVisible()}))},e.getIsVisible=()=>{var t,s;const o=e.columns;return(t=o.length?o.some(a=>a.getIsVisible()):(s=n.getState().columnVisibility)==null?void 0:s[e.id])!=null?t:!0},e.getCanHide=()=>{var t,s;return((t=e.columnDef.enableHiding)!=null?t:!0)&&((s=n.options.enableHiding)!=null?s:!0)},e.getToggleVisibilityHandler=()=>t=>{e.toggleVisibility==null||e.toggleVisibility(t.target.checked)}},createRow:(e,n)=>{e._getAllVisibleCells=Y(()=>[e.getAllCells(),n.getState().columnVisibility],t=>t.filter(s=>s.column.getIsVisible()),X(n.options,"debugRows")),e.getVisibleCells=Y(()=>[e.getLeftVisibleCells(),e.getCenterVisibleCells(),e.getRightVisibleCells()],(t,s,o)=>[...t,...s,...o],X(n.options,"debugRows"))},createTable:e=>{const n=(t,s)=>Y(()=>[s(),s().filter(o=>o.getIsVisible()).map(o=>o.id).join("_")],o=>o.filter(a=>a.getIsVisible==null?void 0:a.getIsVisible()),X(e.options,"debugColumns"));e.getVisibleFlatColumns=n("getVisibleFlatColumns",()=>e.getAllFlatColumns()),e.getVisibleLeafColumns=n("getVisibleLeafColumns",()=>e.getAllLeafColumns()),e.getLeftVisibleLeafColumns=n("getLeftVisibleLeafColumns",()=>e.getLeftLeafColumns()),e.getRightVisibleLeafColumns=n("getRightVisibleLeafColumns",()=>e.getRightLeafColumns()),e.getCenterVisibleLeafColumns=n("getCenterVisibleLeafColumns",()=>e.getCenterLeafColumns()),e.setColumnVisibility=t=>e.options.onColumnVisibilityChange==null?void 0:e.options.onColumnVisibilityChange(t),e.resetColumnVisibility=t=>{var s;e.setColumnVisibility(t?{}:(s=e.initialState.columnVisibility)!=null?s:{})},e.toggleAllColumnsVisible=t=>{var s;t=(s=t)!=null?s:!e.getIsAllColumnsVisible(),e.setColumnVisibility(e.getAllLeafColumns().reduce((o,a)=>({...o,[a.id]:t||!(a.getCanHide!=null&&a.getCanHide())}),{}))},e.getIsAllColumnsVisible=()=>!e.getAllLeafColumns().some(t=>!(t.getIsVisible!=null&&t.getIsVisible())),e.getIsSomeColumnsVisible=()=>e.getAllLeafColumns().some(t=>t.getIsVisible==null?void 0:t.getIsVisible()),e.getToggleAllColumnsVisibilityHandler=()=>t=>{var s;e.toggleAllColumnsVisible((s=t.target)==null?void 0:s.checked)}}};function hn(e,n){return n?n==="center"?e.getCenterVisibleLeafColumns():n==="left"?e.getLeftVisibleLeafColumns():e.getRightVisibleLeafColumns():e.getVisibleLeafColumns()}const Na={createTable:e=>{e._getGlobalFacetedRowModel=e.options.getFacetedRowModel&&e.options.getFacetedRowModel(e,"__global__"),e.getGlobalFacetedRowModel=()=>e.options.manualFiltering||!e._getGlobalFacetedRowModel?e.getPreFilteredRowModel():e._getGlobalFacetedRowModel(),e._getGlobalFacetedUniqueValues=e.options.getFacetedUniqueValues&&e.options.getFacetedUniqueValues(e,"__global__"),e.getGlobalFacetedUniqueValues=()=>e._getGlobalFacetedUniqueValues?e._getGlobalFacetedUniqueValues():new Map,e._getGlobalFacetedMinMaxValues=e.options.getFacetedMinMaxValues&&e.options.getFacetedMinMaxValues(e,"__global__"),e.getGlobalFacetedMinMaxValues=()=>{if(e._getGlobalFacetedMinMaxValues)return e._getGlobalFacetedMinMaxValues()}}},ja={getInitialState:e=>({globalFilter:void 0,...e}),getDefaultOptions:e=>({onGlobalFilterChange:Ze("globalFilter",e),globalFilterFn:"auto",getColumnCanGlobalFilter:n=>{var t;const s=(t=e.getCoreRowModel().flatRows[0])==null||(t=t._getAllCellsByColumnId()[n.id])==null?void 0:t.getValue();return typeof s=="string"||typeof s=="number"}}),createColumn:(e,n)=>{e.getCanGlobalFilter=()=>{var t,s,o,a;return((t=e.columnDef.enableGlobalFilter)!=null?t:!0)&&((s=n.options.enableGlobalFilter)!=null?s:!0)&&((o=n.options.enableFilters)!=null?o:!0)&&((a=n.options.getColumnCanGlobalFilter==null?void 0:n.options.getColumnCanGlobalFilter(e))!=null?a:!0)&&!!e.accessorFn}},createTable:e=>{e.getGlobalAutoFilterFn=()=>ht.includesString,e.getGlobalFilterFn=()=>{var n,t;const{globalFilterFn:s}=e.options;return Pn(s)?s:s==="auto"?e.getGlobalAutoFilterFn():(n=(t=e.options.filterFns)==null?void 0:t[s])!=null?n:ht[s]},e.setGlobalFilter=n=>{e.options.onGlobalFilterChange==null||e.options.onGlobalFilterChange(n)},e.resetGlobalFilter=n=>{e.setGlobalFilter(n?void 0:e.initialState.globalFilter)}}},Ma={getInitialState:e=>({expanded:{},...e}),getDefaultOptions:e=>({onExpandedChange:Ze("expanded",e),paginateExpandedRows:!0}),createTable:e=>{let n=!1,t=!1;e._autoResetExpanded=()=>{var s,o;if(!n){e._queue(()=>{n=!0});return}if((s=(o=e.options.autoResetAll)!=null?o:e.options.autoResetExpanded)!=null?s:!e.options.manualExpanding){if(t)return;t=!0,e._queue(()=>{e.resetExpanded(),t=!1})}},e.setExpanded=s=>e.options.onExpandedChange==null?void 0:e.options.onExpandedChange(s),e.toggleAllRowsExpanded=s=>{s??!e.getIsAllRowsExpanded()?e.setExpanded(!0):e.setExpanded({})},e.resetExpanded=s=>{var o,a;e.setExpanded(s?{}:(o=(a=e.initialState)==null?void 0:a.expanded)!=null?o:{})},e.getCanSomeRowsExpand=()=>e.getPrePaginationRowModel().flatRows.some(s=>s.getCanExpand()),e.getToggleAllRowsExpandedHandler=()=>s=>{s.persist==null||s.persist(),e.toggleAllRowsExpanded()},e.getIsSomeRowsExpanded=()=>{const s=e.getState().expanded;return s===!0||Object.values(s).some(Boolean)},e.getIsAllRowsExpanded=()=>{const s=e.getState().expanded;return typeof s=="boolean"?s===!0:!(!Object.keys(s).length||e.getRowModel().flatRows.some(o=>!o.getIsExpanded()))},e.getExpandedDepth=()=>{let s=0;return(e.getState().expanded===!0?Object.keys(e.getRowModel().rowsById):Object.keys(e.getState().expanded)).forEach(a=>{const l=a.split(".");s=Math.max(s,l.length)}),s},e.getPreExpandedRowModel=()=>e.getSortedRowModel(),e.getExpandedRowModel=()=>(!e._getExpandedRowModel&&e.options.getExpandedRowModel&&(e._getExpandedRowModel=e.options.getExpandedRowModel(e)),e.options.manualExpanding||!e._getExpandedRowModel?e.getPreExpandedRowModel():e._getExpandedRowModel())},createRow:(e,n)=>{e.toggleExpanded=t=>{n.setExpanded(s=>{var o;const a=s===!0?!0:!!(s!=null&&s[e.id]);let l={};if(s===!0?Object.keys(n.getRowModel().rowsById).forEach(i=>{l[i]=!0}):l=s,t=(o=t)!=null?o:!a,!a&&t)return{...l,[e.id]:!0};if(a&&!t){const{[e.id]:i,...d}=l;return d}return s})},e.getIsExpanded=()=>{var t;const s=n.getState().expanded;return!!((t=n.options.getIsRowExpanded==null?void 0:n.options.getIsRowExpanded(e))!=null?t:s===!0||s!=null&&s[e.id])},e.getCanExpand=()=>{var t,s,o;return(t=n.options.getRowCanExpand==null?void 0:n.options.getRowCanExpand(e))!=null?t:((s=n.options.enableExpanding)!=null?s:!0)&&!!((o=e.subRows)!=null&&o.length)},e.getIsAllParentsExpanded=()=>{let t=!0,s=e;for(;t&&s.parentId;)s=n.getRow(s.parentId,!0),t=s.getIsExpanded();return t},e.getToggleExpandedHandler=()=>{const t=e.getCanExpand();return()=>{t&&e.toggleExpanded()}}}},hs=0,xs=10,ls=()=>({pageIndex:hs,pageSize:xs}),Ra={getInitialState:e=>({...e,pagination:{...ls(),...e==null?void 0:e.pagination}}),getDefaultOptions:e=>({onPaginationChange:Ze("pagination",e)}),createTable:e=>{let n=!1,t=!1;e._autoResetPageIndex=()=>{var s,o;if(!n){e._queue(()=>{n=!0});return}if((s=(o=e.options.autoResetAll)!=null?o:e.options.autoResetPageIndex)!=null?s:!e.options.manualPagination){if(t)return;t=!0,e._queue(()=>{e.resetPageIndex(),t=!1})}},e.setPagination=s=>{const o=a=>Mt(s,a);return e.options.onPaginationChange==null?void 0:e.options.onPaginationChange(o)},e.resetPagination=s=>{var o;e.setPagination(s?ls():(o=e.initialState.pagination)!=null?o:ls())},e.setPageIndex=s=>{e.setPagination(o=>{let a=Mt(s,o.pageIndex);const l=typeof e.options.pageCount>"u"||e.options.pageCount===-1?Number.MAX_SAFE_INTEGER:e.options.pageCount-1;return a=Math.max(0,Math.min(a,l)),{...o,pageIndex:a}})},e.resetPageIndex=s=>{var o,a;e.setPageIndex(s?hs:(o=(a=e.initialState)==null||(a=a.pagination)==null?void 0:a.pageIndex)!=null?o:hs)},e.resetPageSize=s=>{var o,a;e.setPageSize(s?xs:(o=(a=e.initialState)==null||(a=a.pagination)==null?void 0:a.pageSize)!=null?o:xs)},e.setPageSize=s=>{e.setPagination(o=>{const a=Math.max(1,Mt(s,o.pageSize)),l=o.pageSize*o.pageIndex,i=Math.floor(l/a);return{...o,pageIndex:i,pageSize:a}})},e.setPageCount=s=>e.setPagination(o=>{var a;let l=Mt(s,(a=e.options.pageCount)!=null?a:-1);return typeof l=="number"&&(l=Math.max(-1,l)),{...o,pageCount:l}}),e.getPageOptions=Y(()=>[e.getPageCount()],s=>{let o=[];return s&&s>0&&(o=[...new Array(s)].fill(null).map((a,l)=>l)),o},X(e.options,"debugTable")),e.getCanPreviousPage=()=>e.getState().pagination.pageIndex>0,e.getCanNextPage=()=>{const{pageIndex:s}=e.getState().pagination,o=e.getPageCount();return o===-1?!0:o===0?!1:s<o-1},e.previousPage=()=>e.setPageIndex(s=>s-1),e.nextPage=()=>e.setPageIndex(s=>s+1),e.firstPage=()=>e.setPageIndex(0),e.lastPage=()=>e.setPageIndex(e.getPageCount()-1),e.getPrePaginationRowModel=()=>e.getExpandedRowModel(),e.getPaginationRowModel=()=>(!e._getPaginationRowModel&&e.options.getPaginationRowModel&&(e._getPaginationRowModel=e.options.getPaginationRowModel(e)),e.options.manualPagination||!e._getPaginationRowModel?e.getPrePaginationRowModel():e._getPaginationRowModel()),e.getPageCount=()=>{var s;return(s=e.options.pageCount)!=null?s:Math.ceil(e.getRowCount()/e.getState().pagination.pageSize)},e.getRowCount=()=>{var s;return(s=e.options.rowCount)!=null?s:e.getPrePaginationRowModel().rows.length}}},us=()=>({top:[],bottom:[]}),Fa={getInitialState:e=>({rowPinning:us(),...e}),getDefaultOptions:e=>({onRowPinningChange:Ze("rowPinning",e)}),createRow:(e,n)=>{e.pin=(t,s,o)=>{const a=s?e.getLeafRows().map(d=>{let{id:m}=d;return m}):[],l=o?e.getParentRows().map(d=>{let{id:m}=d;return m}):[],i=new Set([...l,e.id,...a]);n.setRowPinning(d=>{var m,c;if(t==="bottom"){var h,p;return{top:((h=d==null?void 0:d.top)!=null?h:[]).filter(_=>!(i!=null&&i.has(_))),bottom:[...((p=d==null?void 0:d.bottom)!=null?p:[]).filter(_=>!(i!=null&&i.has(_))),...Array.from(i)]}}if(t==="top"){var f,w;return{top:[...((f=d==null?void 0:d.top)!=null?f:[]).filter(_=>!(i!=null&&i.has(_))),...Array.from(i)],bottom:((w=d==null?void 0:d.bottom)!=null?w:[]).filter(_=>!(i!=null&&i.has(_)))}}return{top:((m=d==null?void 0:d.top)!=null?m:[]).filter(_=>!(i!=null&&i.has(_))),bottom:((c=d==null?void 0:d.bottom)!=null?c:[]).filter(_=>!(i!=null&&i.has(_)))}})},e.getCanPin=()=>{var t;const{enableRowPinning:s,enablePinning:o}=n.options;return typeof s=="function"?s(e):(t=s??o)!=null?t:!0},e.getIsPinned=()=>{const t=[e.id],{top:s,bottom:o}=n.getState().rowPinning,a=t.some(i=>s==null?void 0:s.includes(i)),l=t.some(i=>o==null?void 0:o.includes(i));return a?"top":l?"bottom":!1},e.getPinnedIndex=()=>{var t,s;const o=e.getIsPinned();if(!o)return-1;const a=(t=o==="top"?n.getTopRows():n.getBottomRows())==null?void 0:t.map(l=>{let{id:i}=l;return i});return(s=a==null?void 0:a.indexOf(e.id))!=null?s:-1}},createTable:e=>{e.setRowPinning=n=>e.options.onRowPinningChange==null?void 0:e.options.onRowPinningChange(n),e.resetRowPinning=n=>{var t,s;return e.setRowPinning(n?us():(t=(s=e.initialState)==null?void 0:s.rowPinning)!=null?t:us())},e.getIsSomeRowsPinned=n=>{var t;const s=e.getState().rowPinning;if(!n){var o,a;return!!((o=s.top)!=null&&o.length||(a=s.bottom)!=null&&a.length)}return!!((t=s[n])!=null&&t.length)},e._getPinnedRows=(n,t,s)=>{var o;return((o=e.options.keepPinnedRows)==null||o?(t??[]).map(l=>{const i=e.getRow(l,!0);return i.getIsAllParentsExpanded()?i:null}):(t??[]).map(l=>n.find(i=>i.id===l))).filter(Boolean).map(l=>({...l,position:s}))},e.getTopRows=Y(()=>[e.getRowModel().rows,e.getState().rowPinning.top],(n,t)=>e._getPinnedRows(n,t,"top"),X(e.options,"debugRows")),e.getBottomRows=Y(()=>[e.getRowModel().rows,e.getState().rowPinning.bottom],(n,t)=>e._getPinnedRows(n,t,"bottom"),X(e.options,"debugRows")),e.getCenterRows=Y(()=>[e.getRowModel().rows,e.getState().rowPinning.top,e.getState().rowPinning.bottom],(n,t,s)=>{const o=new Set([...t??[],...s??[]]);return n.filter(a=>!o.has(a.id))},X(e.options,"debugRows"))}},Ea={getInitialState:e=>({rowSelection:{},...e}),getDefaultOptions:e=>({onRowSelectionChange:Ze("rowSelection",e),enableRowSelection:!0,enableMultiRowSelection:!0,enableSubRowSelection:!0}),createTable:e=>{e.setRowSelection=n=>e.options.onRowSelectionChange==null?void 0:e.options.onRowSelectionChange(n),e.resetRowSelection=n=>{var t;return e.setRowSelection(n?{}:(t=e.initialState.rowSelection)!=null?t:{})},e.toggleAllRowsSelected=n=>{e.setRowSelection(t=>{n=typeof n<"u"?n:!e.getIsAllRowsSelected();const s={...t},o=e.getPreGroupedRowModel().flatRows;return n?o.forEach(a=>{a.getCanSelect()&&(s[a.id]=!0)}):o.forEach(a=>{delete s[a.id]}),s})},e.toggleAllPageRowsSelected=n=>e.setRowSelection(t=>{const s=typeof n<"u"?n:!e.getIsAllPageRowsSelected(),o={...t};return e.getRowModel().rows.forEach(a=>{vs(o,a.id,s,!0,e)}),o}),e.getPreSelectedRowModel=()=>e.getCoreRowModel(),e.getSelectedRowModel=Y(()=>[e.getState().rowSelection,e.getCoreRowModel()],(n,t)=>Object.keys(n).length?ds(e,t):{rows:[],flatRows:[],rowsById:{}},X(e.options,"debugTable")),e.getFilteredSelectedRowModel=Y(()=>[e.getState().rowSelection,e.getFilteredRowModel()],(n,t)=>Object.keys(n).length?ds(e,t):{rows:[],flatRows:[],rowsById:{}},X(e.options,"debugTable")),e.getGroupedSelectedRowModel=Y(()=>[e.getState().rowSelection,e.getSortedRowModel()],(n,t)=>Object.keys(n).length?ds(e,t):{rows:[],flatRows:[],rowsById:{}},X(e.options,"debugTable")),e.getIsAllRowsSelected=()=>{const n=e.getFilteredRowModel().flatRows,{rowSelection:t}=e.getState();let s=!!(n.length&&Object.keys(t).length);return s&&n.some(o=>o.getCanSelect()&&!t[o.id])&&(s=!1),s},e.getIsAllPageRowsSelected=()=>{const n=e.getPaginationRowModel().flatRows.filter(o=>o.getCanSelect()),{rowSelection:t}=e.getState();let s=!!n.length;return s&&n.some(o=>!t[o.id])&&(s=!1),s},e.getIsSomeRowsSelected=()=>{var n;const t=Object.keys((n=e.getState().rowSelection)!=null?n:{}).length;return t>0&&t<e.getFilteredRowModel().flatRows.length},e.getIsSomePageRowsSelected=()=>{const n=e.getPaginationRowModel().flatRows;return e.getIsAllPageRowsSelected()?!1:n.filter(t=>t.getCanSelect()).some(t=>t.getIsSelected()||t.getIsSomeSelected())},e.getToggleAllRowsSelectedHandler=()=>n=>{e.toggleAllRowsSelected(n.target.checked)},e.getToggleAllPageRowsSelectedHandler=()=>n=>{e.toggleAllPageRowsSelected(n.target.checked)}},createRow:(e,n)=>{e.toggleSelected=(t,s)=>{const o=e.getIsSelected();n.setRowSelection(a=>{var l;if(t=typeof t<"u"?t:!o,e.getCanSelect()&&o===t)return a;const i={...a};return vs(i,e.id,t,(l=s==null?void 0:s.selectChildren)!=null?l:!0,n),i})},e.getIsSelected=()=>{const{rowSelection:t}=n.getState();return Ns(e,t)},e.getIsSomeSelected=()=>{const{rowSelection:t}=n.getState();return ys(e,t)==="some"},e.getIsAllSubRowsSelected=()=>{const{rowSelection:t}=n.getState();return ys(e,t)==="all"},e.getCanSelect=()=>{var t;return typeof n.options.enableRowSelection=="function"?n.options.enableRowSelection(e):(t=n.options.enableRowSelection)!=null?t:!0},e.getCanSelectSubRows=()=>{var t;return typeof n.options.enableSubRowSelection=="function"?n.options.enableSubRowSelection(e):(t=n.options.enableSubRowSelection)!=null?t:!0},e.getCanMultiSelect=()=>{var t;return typeof n.options.enableMultiRowSelection=="function"?n.options.enableMultiRowSelection(e):(t=n.options.enableMultiRowSelection)!=null?t:!0},e.getToggleSelectedHandler=()=>{const t=e.getCanSelect();return s=>{var o;t&&e.toggleSelected((o=s.target)==null?void 0:o.checked)}}}},vs=(e,n,t,s,o)=>{var a;const l=o.getRow(n,!0);t?(l.getCanMultiSelect()||Object.keys(e).forEach(i=>delete e[i]),l.getCanSelect()&&(e[n]=!0)):delete e[n],s&&(a=l.subRows)!=null&&a.length&&l.getCanSelectSubRows()&&l.subRows.forEach(i=>vs(e,i.id,t,s,o))};function ds(e,n){const t=e.getState().rowSelection,s=[],o={},a=function(l,i){return l.map(d=>{var m;const c=Ns(d,t);if(c&&(s.push(d),o[d.id]=d),(m=d.subRows)!=null&&m.length&&(d={...d,subRows:a(d.subRows)}),c)return d}).filter(Boolean)};return{rows:a(n.rows),flatRows:s,rowsById:o}}function Ns(e,n){var t;return(t=n[e.id])!=null?t:!1}function ys(e,n,t){var s;if(!((s=e.subRows)!=null&&s.length))return!1;let o=!0,a=!1;return e.subRows.forEach(l=>{if(!(a&&!o)&&(l.getCanSelect()&&(Ns(l,n)?a=!0:o=!1),l.subRows&&l.subRows.length)){const i=ys(l,n);i==="all"?a=!0:(i==="some"&&(a=!0),o=!1)}}),o?"all":a?"some":!1}const bs=/([0-9]+)/gm,Ia=(e,n,t)=>Cr(Rt(e.getValue(t)).toLowerCase(),Rt(n.getValue(t)).toLowerCase()),$a=(e,n,t)=>Cr(Rt(e.getValue(t)),Rt(n.getValue(t))),Aa=(e,n,t)=>js(Rt(e.getValue(t)).toLowerCase(),Rt(n.getValue(t)).toLowerCase()),Pa=(e,n,t)=>js(Rt(e.getValue(t)),Rt(n.getValue(t))),Va=(e,n,t)=>{const s=e.getValue(t),o=n.getValue(t);return s>o?1:s<o?-1:0},ka=(e,n,t)=>js(e.getValue(t),n.getValue(t));function js(e,n){return e===n?0:e>n?1:-1}function Rt(e){return typeof e=="number"?isNaN(e)||e===1/0||e===-1/0?"":String(e):typeof e=="string"?e:""}function Cr(e,n){const t=e.split(bs).filter(Boolean),s=n.split(bs).filter(Boolean);for(;t.length&&s.length;){const o=t.shift(),a=s.shift(),l=parseInt(o,10),i=parseInt(a,10),d=[l,i].sort();if(isNaN(d[0])){if(o>a)return 1;if(a>o)return-1;continue}if(isNaN(d[1]))return isNaN(l)?-1:1;if(l>i)return 1;if(i>l)return-1}return t.length-s.length}const fn={alphanumeric:Ia,alphanumericCaseSensitive:$a,text:Aa,textCaseSensitive:Pa,datetime:Va,basic:ka},Da={getInitialState:e=>({sorting:[],...e}),getDefaultColumnDef:()=>({sortingFn:"auto",sortUndefined:1}),getDefaultOptions:e=>({onSortingChange:Ze("sorting",e),isMultiSortEvent:n=>n.shiftKey}),createColumn:(e,n)=>{e.getAutoSortingFn=()=>{const t=n.getFilteredRowModel().flatRows.slice(10);let s=!1;for(const o of t){const a=o==null?void 0:o.getValue(e.id);if(Object.prototype.toString.call(a)==="[object Date]")return fn.datetime;if(typeof a=="string"&&(s=!0,a.split(bs).length>1))return fn.alphanumeric}return s?fn.text:fn.basic},e.getAutoSortDir=()=>{const t=n.getFilteredRowModel().flatRows[0];return typeof(t==null?void 0:t.getValue(e.id))=="string"?"asc":"desc"},e.getSortingFn=()=>{var t,s;if(!e)throw new Error;return Pn(e.columnDef.sortingFn)?e.columnDef.sortingFn:e.columnDef.sortingFn==="auto"?e.getAutoSortingFn():(t=(s=n.options.sortingFns)==null?void 0:s[e.columnDef.sortingFn])!=null?t:fn[e.columnDef.sortingFn]},e.toggleSorting=(t,s)=>{const o=e.getNextSortingOrder(),a=typeof t<"u"&&t!==null;n.setSorting(l=>{const i=l==null?void 0:l.find(f=>f.id===e.id),d=l==null?void 0:l.findIndex(f=>f.id===e.id);let m=[],c,h=a?t:o==="desc";if(l!=null&&l.length&&e.getCanMultiSort()&&s?i?c="toggle":c="add":l!=null&&l.length&&d!==l.length-1?c="replace":i?c="toggle":c="replace",c==="toggle"&&(a||o||(c="remove")),c==="add"){var p;m=[...l,{id:e.id,desc:h}],m.splice(0,m.length-((p=n.options.maxMultiSortColCount)!=null?p:Number.MAX_SAFE_INTEGER))}else c==="toggle"?m=l.map(f=>f.id===e.id?{...f,desc:h}:f):c==="remove"?m=l.filter(f=>f.id!==e.id):m=[{id:e.id,desc:h}];return m})},e.getFirstSortDir=()=>{var t,s;return((t=(s=e.columnDef.sortDescFirst)!=null?s:n.options.sortDescFirst)!=null?t:e.getAutoSortDir()==="desc")?"desc":"asc"},e.getNextSortingOrder=t=>{var s,o;const a=e.getFirstSortDir(),l=e.getIsSorted();return l?l!==a&&((s=n.options.enableSortingRemoval)==null||s)&&(!(t&&(o=n.options.enableMultiRemove)!=null)||o)?!1:l==="desc"?"asc":"desc":a},e.getCanSort=()=>{var t,s;return((t=e.columnDef.enableSorting)!=null?t:!0)&&((s=n.options.enableSorting)!=null?s:!0)&&!!e.accessorFn},e.getCanMultiSort=()=>{var t,s;return(t=(s=e.columnDef.enableMultiSort)!=null?s:n.options.enableMultiSort)!=null?t:!!e.accessorFn},e.getIsSorted=()=>{var t;const s=(t=n.getState().sorting)==null?void 0:t.find(o=>o.id===e.id);return s?s.desc?"desc":"asc":!1},e.getSortIndex=()=>{var t,s;return(t=(s=n.getState().sorting)==null?void 0:s.findIndex(o=>o.id===e.id))!=null?t:-1},e.clearSorting=()=>{n.setSorting(t=>t!=null&&t.length?t.filter(s=>s.id!==e.id):[])},e.getToggleSortingHandler=()=>{const t=e.getCanSort();return s=>{t&&(s.persist==null||s.persist(),e.toggleSorting==null||e.toggleSorting(void 0,e.getCanMultiSort()?n.options.isMultiSortEvent==null?void 0:n.options.isMultiSortEvent(s):!1))}}},createTable:e=>{e.setSorting=n=>e.options.onSortingChange==null?void 0:e.options.onSortingChange(n),e.resetSorting=n=>{var t,s;e.setSorting(n?[]:(t=(s=e.initialState)==null?void 0:s.sorting)!=null?t:[])},e.getPreSortedRowModel=()=>e.getGroupedRowModel(),e.getSortedRowModel=()=>(!e._getSortedRowModel&&e.options.getSortedRowModel&&(e._getSortedRowModel=e.options.getSortedRowModel(e)),e.options.manualSorting||!e._getSortedRowModel?e.getPreSortedRowModel():e._getSortedRowModel())}},La=[ra,Ca,ya,ba,aa,ia,Na,ja,Da,xa,Ma,Ra,Fa,Ea,wa];function Ta(e){var n,t;const s=[...La,...(n=e._features)!=null?n:[]];let o={_features:s};const a=o._features.reduce((p,f)=>Object.assign(p,f.getDefaultOptions==null?void 0:f.getDefaultOptions(o)),{}),l=p=>o.options.mergeOptions?o.options.mergeOptions(a,p):{...a,...p};let d={...{},...(t=e.initialState)!=null?t:{}};o._features.forEach(p=>{var f;d=(f=p.getInitialState==null?void 0:p.getInitialState(d))!=null?f:d});const m=[];let c=!1;const h={_features:s,options:{...a,...e},initialState:d,_queue:p=>{m.push(p),c||(c=!0,Promise.resolve().then(()=>{for(;m.length;)m.shift()();c=!1}).catch(f=>setTimeout(()=>{throw f})))},reset:()=>{o.setState(o.initialState)},setOptions:p=>{const f=Mt(p,o.options);o.options=l(f)},getState:()=>o.options.state,setState:p=>{o.options.onStateChange==null||o.options.onStateChange(p)},_getRowId:(p,f,w)=>{var _;return(_=o.options.getRowId==null?void 0:o.options.getRowId(p,f,w))!=null?_:`${w?[w.id,f].join("."):f}`},getCoreRowModel:()=>(o._getCoreRowModel||(o._getCoreRowModel=o.options.getCoreRowModel(o)),o._getCoreRowModel()),getRowModel:()=>o.getPaginationRowModel(),getRow:(p,f)=>{let w=(f?o.getPrePaginationRowModel():o.getRowModel()).rowsById[p];if(!w&&(w=o.getCoreRowModel().rowsById[p],!w))throw new Error;return w},_getDefaultColumnDef:Y(()=>[o.options.defaultColumn],p=>{var f;return p=(f=p)!=null?f:{},{header:w=>{const _=w.header.column.columnDef;return _.accessorKey?_.accessorKey:_.accessorFn?_.id:null},cell:w=>{var _,S;return(_=(S=w.renderValue())==null||S.toString==null?void 0:S.toString())!=null?_:null},...o._features.reduce((w,_)=>Object.assign(w,_.getDefaultColumnDef==null?void 0:_.getDefaultColumnDef()),{}),...p}},X(e,"debugColumns")),_getColumnDefs:()=>o.options.columns,getAllColumns:Y(()=>[o._getColumnDefs()],p=>{const f=function(w,_,S){return S===void 0&&(S=0),w.map(v=>{const b=sa(o,v,S,_),y=v;return b.columns=y.columns?f(y.columns,b,S+1):[],b})};return f(p)},X(e,"debugColumns")),getAllFlatColumns:Y(()=>[o.getAllColumns()],p=>p.flatMap(f=>f.getFlatColumns()),X(e,"debugColumns")),_getAllFlatColumnsById:Y(()=>[o.getAllFlatColumns()],p=>p.reduce((f,w)=>(f[w.id]=w,f),{}),X(e,"debugColumns")),getAllLeafColumns:Y(()=>[o.getAllColumns(),o._getOrderColumnsFn()],(p,f)=>{let w=p.flatMap(_=>_.getLeafColumns());return f(w)},X(e,"debugColumns")),getColumn:p=>o._getAllFlatColumnsById()[p]};Object.assign(o,h);for(let p=0;p<o._features.length;p++){const f=o._features[p];f==null||f.createTable==null||f.createTable(o)}return o}function tr(){return e=>Y(()=>[e.options.data],n=>{const t={rows:[],flatRows:[],rowsById:{}},s=function(o,a,l){a===void 0&&(a=0);const i=[];for(let m=0;m<o.length;m++){const c=oa(e,e._getRowId(o[m],m,l),o[m],m,a,void 0,l==null?void 0:l.id);if(t.flatRows.push(c),t.rowsById[c.id]=c,i.push(c),e.options.getSubRows){var d;c.originalSubRows=e.options.getSubRows(o[m],m),(d=c.originalSubRows)!=null&&d.length&&(c.subRows=s(c.originalSubRows,a+1,c))}}return i};return t.rows=s(n),t},X(e.options,"debugTable","getRowModel",()=>e._autoResetPageIndex()))}function Oa(e){const n=[],t=s=>{var o;n.push(s),(o=s.subRows)!=null&&o.length&&s.getIsExpanded()&&s.subRows.forEach(t)};return e.rows.forEach(t),{rows:n,flatRows:e.flatRows,rowsById:e.rowsById}}function nr(e){return n=>Y(()=>[n.getState().pagination,n.getPrePaginationRowModel(),n.options.paginateExpandedRows?void 0:n.getState().expanded],(t,s)=>{if(!s.rows.length)return s;const{pageSize:o,pageIndex:a}=t;let{rows:l,flatRows:i,rowsById:d}=s;const m=o*a,c=m+o;l=l.slice(m,c);let h;n.options.paginateExpandedRows?h={rows:l,flatRows:i,rowsById:d}:h=Oa({rows:l,flatRows:i,rowsById:d}),h.flatRows=[];const p=f=>{h.flatRows.push(f),f.subRows.length&&f.subRows.forEach(p)};return h.rows.forEach(p),h},X(n.options,"debugTable"))}function sr(){return e=>Y(()=>[e.getState().sorting,e.getPreSortedRowModel()],(n,t)=>{if(!t.rows.length||!(n!=null&&n.length))return t;const s=e.getState().sorting,o=[],a=s.filter(d=>{var m;return(m=e.getColumn(d.id))==null?void 0:m.getCanSort()}),l={};a.forEach(d=>{const m=e.getColumn(d.id);m&&(l[d.id]={sortUndefined:m.columnDef.sortUndefined,invertSorting:m.columnDef.invertSorting,sortingFn:m.getSortingFn()})});const i=d=>{const m=d.map(c=>({...c}));return m.sort((c,h)=>{for(let f=0;f<a.length;f+=1){var p;const w=a[f],_=l[w.id],S=_.sortUndefined,v=(p=w==null?void 0:w.desc)!=null?p:!1;let b=0;if(S){const y=c.getValue(w.id),N=h.getValue(w.id),I=y===void 0,M=N===void 0;if(I||M){if(S==="first")return I?-1:1;if(S==="last")return I?1:-1;b=I&&M?0:I?S:-S}}if(b===0&&(b=_.sortingFn(c,h,w.id)),b!==0)return v&&(b*=-1),_.invertSorting&&(b*=-1),b}return c.index-h.index}),m.forEach(c=>{var h;o.push(c),(h=c.subRows)!=null&&h.length&&(c.subRows=i(c.subRows))}),m};return{rows:i(t.rows),flatRows:o,rowsById:t.rowsById}},X(e.options,"debugTable","getSortedRowModel",()=>e._autoResetPageIndex()))}/**
   * react-table
   *
   * Copyright (c) TanStack
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE.md file in the root directory of this source tree.
   *
   * @license MIT
   */function rr(e,n){return e?za(e)?x.createElement(e,n):e:null}function za(e){return Ha(e)||typeof e=="function"||Ga(e)}function Ha(e){return typeof e=="function"&&(()=>{const n=Object.getPrototypeOf(e);return n.prototype&&n.prototype.isReactComponent})()}function Ga(e){return typeof e=="object"&&typeof e.$$typeof=="symbol"&&["react.memo","react.forward_ref"].includes(e.$$typeof.description)}function or(e){const n={state:{},onStateChange:()=>{},renderFallbackValue:null,...e},[t]=x.useState(()=>({current:Ta(n)})),[s,o]=x.useState(()=>t.current.initialState);return t.current.setOptions(a=>({...a,...e,state:{...s,...e.state},onStateChange:l=>{o(l),e.onStateChange==null||e.onStateChange(l)}})),t.current}function Nr({nodes:e,edges:n,onNodesChange:t,onEdgesChange:s,onBlur:o,editable:a=!1}){const[l,i]=x.useState("nodes"),[d,m]=x.useState(e),[c,h]=x.useState(n),p=x.useRef(new Map),f=x.useRef(new Map);x.useEffect(()=>{m([...e]),h([...n]),p.current.clear(),f.current.clear()},[e,n]);const w=x.useMemo(()=>{if(e.length===0)return[];const y=new Set;e.forEach(M=>{Object.keys(M).forEach(z=>{z==="_totalIncoming"||z==="_totalOutgoing"||y.add(z)})});const N=Array.from(y);return[...N.includes("id")?["id"]:[],...N.includes("label")?["label"]:[],...N.filter(M=>M!=="id"&&M!=="label")].map(M=>({header:M.charAt(0).toUpperCase()+M.slice(1).replace(/_/g," "),accessorKey:M,cell:z=>{var D;const P=z.getValue();if(a&&M!=="id"){const H=z.row.original.id,ie=d.findIndex(ae=>ae.id===H);if(ie===-1)return r.jsx("span",{children:"-"});const F=((D=d[ie])==null?void 0:D[M])??P,Z=`${H}-${M}`;return r.jsx(cs,{id:Z,type:typeof F=="number"?"number":"text",initialValue:F==null?"":String(F),isNumber:typeof F=="number",onBlur:ae=>{const xe=[...d],le=typeof F=="number"?parseFloat(ae)||0:ae;xe[ie]={...xe[ie],[M]:le},m(xe),t==null||t(xe),o==null||o()}},Z)}return P==null?"-":typeof P=="number"?P.toLocaleString():String(P)}}))},[e,a]),_=x.useMemo(()=>{if(n.length===0)return[];const y=new Set;n.forEach(M=>{Object.keys(M).forEach(z=>y.add(z))});const N=Array.from(y);return[...N.includes("source")?["source"]:[],...N.includes("target")?["target"]:[],...N.includes("value")?["value"]:[],...N.filter(M=>M!=="source"&&M!=="target"&&M!=="value")].map(M=>({header:M.charAt(0).toUpperCase()+M.slice(1).replace(/_/g," "),accessorKey:M,cell:z=>{var D,oe;const P=z.getValue();if(a&&M!=="source"&&M!=="target"){const H=z.row.original,ie=c.findIndex(ae=>ae.source===H.source&&ae.target===H.target&&ae.value===H.value);if(ie===-1){const ae=c.findIndex(we=>we.source===H.source&&we.target===H.target);if(ae===-1)return r.jsx("span",{children:"-"});const xe=((D=c[ae])==null?void 0:D[M])??P,le=`${H.source}-${H.target}-${M}-fallback`;return r.jsx(cs,{id:le,type:typeof xe=="number"?"number":"text",initialValue:xe==null?"":String(xe),isNumber:typeof xe=="number",onBlur:we=>{const Re=[...c],R=typeof xe=="number"?parseFloat(we)||0:we;Re[ae]={...Re[ae],[M]:R},h(Re),s==null||s(Re),o==null||o()}},le)}const F=((oe=c[ie])==null?void 0:oe[M])??P,Z=`${H.source}-${H.target}-${M}`;return r.jsx(cs,{id:Z,type:typeof F=="number"?"number":"text",initialValue:F==null?"":String(F),isNumber:typeof F=="number",onBlur:ae=>{const xe=[...c],le=typeof F=="number"?parseFloat(ae)||0:ae;xe[ie]={...xe[ie],[M]:le},h(xe),s==null||s(xe),o==null||o()}},Z)}return P==null?"-":typeof P=="number"?P.toLocaleString():String(P)}}))},[n,a]),S=or({data:a?d:e,columns:w,getCoreRowModel:tr(),getSortedRowModel:sr(),getPaginationRowModel:nr(),initialState:{pagination:{pageSize:25}}}),v=or({data:a?c:n,columns:_,getCoreRowModel:tr(),getSortedRowModel:sr(),getPaginationRowModel:nr(),initialState:{pagination:{pageSize:25}}}),b=l==="nodes"?S:v;return r.jsxs("div",{className:"h-full w-full flex flex-col",style:{height:"100%",maxHeight:"100%"},children:[r.jsxs("div",{className:"flex border-b mb-4 flex-shrink-0",children:[r.jsxs("button",{onClick:()=>i("nodes"),className:`px-4 py-2 font-medium text-sm transition-colors ${l==="nodes"?"border-b-2 border-blue-600 text-blue-600":"text-gray-600 hover:text-gray-900"}`,children:["Nodes (",e.length,")"]}),r.jsxs("button",{onClick:()=>i("edges"),className:`px-4 py-2 font-medium text-sm transition-colors ${l==="edges"?"border-b-2 border-blue-600 text-blue-600":"text-gray-600 hover:text-gray-900"}`,children:["Edges (",n.length,")"]})]}),r.jsx("div",{className:"flex-1 flex flex-col min-h-0 overflow-hidden",children:r.jsxs("div",{className:"overflow-auto flex-1 min-h-0",children:[r.jsxs("table",{className:"min-w-full text-sm",children:[r.jsx("thead",{className:"bg-gray-50 border-b sticky top-0 z-10",children:b.getHeaderGroups().map(y=>r.jsx("tr",{children:y.headers.map(N=>r.jsx("th",{className:"px-4 py-2 text-left font-semibold text-gray-700 bg-gray-50",children:N.isPlaceholder?null:r.jsxs("div",{className:N.column.getCanSort()?"cursor-pointer select-none hover:text-blue-600":"",onClick:N.column.getToggleSortingHandler(),children:[rr(N.column.columnDef.header,N.getContext()),{asc:" ↑",desc:" ↓"}[N.column.getIsSorted()]??null]})},N.id))},y.id))}),r.jsx("tbody",{className:"divide-y divide-gray-200 bg-white",children:b.getRowModel().rows.map(y=>r.jsx("tr",{className:"hover:bg-gray-50",children:y.getVisibleCells().map(N=>r.jsx("td",{className:"px-4 py-2",children:rr(N.column.columnDef.cell,N.getContext())},N.id))},y.id))})]}),b.getRowModel().rows.length===0&&r.jsxs("div",{className:"text-center text-gray-500 py-8",children:["No ",l," to display"]})]})}),r.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-t border-gray-200 bg-white flex-shrink-0",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("span",{className:"text-sm text-gray-700",children:"Show"}),r.jsx("select",{value:b.getState().pagination.pageSize,onChange:y=>{b.setPageSize(Number(y.target.value))},className:"border border-gray-300 rounded px-2 py-1 text-sm",children:[10,25,50,100].map(y=>r.jsx("option",{value:y,children:y},y))}),r.jsx("span",{className:"text-sm text-gray-700",children:"entries"})]}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsxs("span",{className:"text-sm text-gray-700",children:["Page ",b.getState().pagination.pageIndex+1," of"," ",b.getPageCount()]}),r.jsxs("div",{className:"flex gap-1",children:[r.jsx("button",{onClick:()=>b.setPageIndex(0),disabled:!b.getCanPreviousPage(),className:"px-2 py-1 text-sm border border-gray-300 rounded disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-50",children:"<<"}),r.jsx("button",{onClick:()=>b.previousPage(),disabled:!b.getCanPreviousPage(),className:"px-2 py-1 text-sm border border-gray-300 rounded disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-50",children:"<"}),r.jsx("button",{onClick:()=>b.nextPage(),disabled:!b.getCanNextPage(),className:"px-2 py-1 text-sm border border-gray-300 rounded disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-50",children:">"}),r.jsx("button",{onClick:()=>b.setPageIndex(b.getPageCount()-1),disabled:!b.getCanNextPage(),className:"px-2 py-1 text-sm border border-gray-300 rounded disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-50",children:">>"})]})]})]})]})}function cs({id:e,type:n,initialValue:t,onBlur:s}){const o=x.useRef(null),[a,l]=x.useState(t);return x.useEffect(()=>{o.current&&document.activeElement!==o.current&&l(t)},[t]),r.jsx("input",{ref:o,id:e,type:n,value:a,onChange:i=>{l(i.target.value)},onBlur:i=>{s(i.target.value)},className:"w-full px-2 py-1 border border-gray-300 rounded text-sm focus:outline-none focus:ring-2 focus:ring-blue-500",autoComplete:"off"})}function Ba({dataset:e,onClose:n,onSave:t,onDelete:s,onDuplicate:o}){const[a,l]=x.useState(e.name),[i,d]=x.useState(e.notes||""),[m,c]=x.useState(!1),[h,p]=x.useState(!1),[f,w]=x.useState(!1),[_,S]=x.useState("info"),[v,b]=x.useState(null),y=e.snapshots[0]||{timestamp:e.timeRange.start,nodes:[],edges:[]};x.useEffect(()=>{l(e.name),d(e.notes||""),b(null)},[e]);async function N(){c(!0);try{const P={...e,name:a.trim(),notes:i.trim()||void 0};if(v){P.snapshots=v.snapshots;const D=P.snapshots[0]||y;P.metadata=Ut(D)}await t(P),n()}catch(P){console.error("Save error:",P),alert("Failed to save dataset: "+(P instanceof Error?P.message:"Unknown error"))}finally{c(!1)}}async function I(){p(!0);try{await s(),n()}catch(P){console.error("Delete error:",P),alert("Failed to delete dataset: "+(P instanceof Error?P.message:"Unknown error"))}finally{p(!1),w(!1)}}function M(P,D){const oe={...y,nodes:P,edges:D};b({...e,snapshots:[oe]})}const z=a!==e.name||i!==(e.notes||"")||v!==null;return r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:r.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-6xl w-full mx-4 max-h-[90vh] flex flex-col",children:[r.jsxs("div",{className:"p-6 border-b flex items-center justify-between",children:[r.jsx("h2",{className:"text-2xl font-bold",children:"Edit Dataset"}),r.jsx("button",{onClick:n,type:"button",className:"text-gray-400 hover:text-gray-600 text-2xl cursor-pointer transition-colors",children:"×"})]}),r.jsxs("div",{className:"border-b flex",children:[r.jsx("button",{onClick:()=>S("info"),type:"button",className:`px-6 py-3 font-medium cursor-pointer transition-colors ${_==="info"?"border-b-2 border-blue-600 text-blue-600":"text-gray-600 hover:text-gray-900"}`,children:"Information"}),r.jsxs("button",{onClick:()=>S("data"),type:"button",className:`px-6 py-3 font-medium cursor-pointer transition-colors ${_==="data"?"border-b-2 border-blue-600 text-blue-600":"text-gray-600 hover:text-gray-900"}`,children:["Data (",y.nodes.length," nodes, ",y.edges.length," edges)"]})]}),r.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:_==="info"?r.jsxs("div",{className:"space-y-6 max-w-2xl",children:[r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Dataset Name ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsx("input",{type:"text",value:a,onChange:P=>l(P.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Enter a name for this dataset"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Notes"}),r.jsx("textarea",{value:i,onChange:P=>d(P.target.value),rows:5,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Add any notes about this dataset..."})]}),r.jsxs("div",{className:"bg-gray-50 p-4 rounded",children:[r.jsx("h3",{className:"font-medium text-gray-700 mb-2",children:"Dataset Information"}),r.jsxs("div",{className:"text-sm text-gray-600 space-y-1",children:[r.jsxs("div",{children:[r.jsx("span",{className:"font-medium",children:"Type:"})," ",e.type.toUpperCase()]}),r.jsxs("div",{children:[r.jsx("span",{className:"font-medium",children:"Time Range:"})," ",e.timeRange.start,e.timeRange.end!==e.timeRange.start?` – ${e.timeRange.end}`:""]}),r.jsxs("div",{children:[r.jsx("span",{className:"font-medium",children:"Snapshots:"})," ",e.snapshots.length]}),e.filename&&r.jsxs("div",{children:[r.jsx("span",{className:"font-medium",children:"Original File:"})," ",e.filename]}),r.jsxs("div",{children:[r.jsx("span",{className:"font-medium",children:"Created:"})," ",new Date(e.createdAt).toLocaleDateString()]})]})]}),r.jsxs("div",{className:"border-t pt-4 space-y-3",children:[r.jsx("button",{onClick:o,type:"button",className:"w-full px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50 cursor-pointer transition-colors",children:"Duplicate Dataset"}),r.jsx("button",{onClick:()=>w(!0),type:"button",className:"w-full px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 cursor-pointer transition-colors",children:"Delete Dataset"})]})]}):r.jsx("div",{className:"h-full",children:r.jsx(Ua,{nodes:y.nodes,edges:y.edges,onUpdate:M})})}),r.jsxs("div",{className:"p-6 border-t flex justify-end gap-3",children:[r.jsx("button",{onClick:n,type:"button",disabled:m||h,className:"px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50 disabled:opacity-50 cursor-pointer transition-colors",children:"Cancel"}),r.jsx("button",{onClick:N,type:"button",disabled:m||h||!z&&_==="info"||!a.trim(),className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed cursor-pointer transition-colors",children:m?"Saving...":v?"Save All Changes":"Save Changes"})]}),f&&r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-60",children:r.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md mx-4",children:[r.jsx("h3",{className:"text-lg font-bold mb-2",children:"Delete Dataset?"}),r.jsxs("p",{className:"text-gray-600 mb-4",children:['Are you sure you want to delete "',e.name,'"? This action cannot be undone.']}),r.jsxs("div",{className:"flex justify-end gap-3",children:[r.jsx("button",{onClick:()=>w(!1),type:"button",disabled:h,className:"px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50 cursor-pointer transition-colors",children:"Cancel"}),r.jsx("button",{onClick:I,type:"button",disabled:h,className:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 disabled:opacity-50 cursor-pointer transition-colors",children:h?"Deleting...":"Delete"})]})]})})]})})}function Ua({nodes:e,edges:n,onUpdate:t}){const[s,o]=x.useState(e),[a,l]=x.useState(n);x.useEffect(()=>{o([...e]),l([...n])},[e,n]);const i=x.useRef(s),d=x.useRef(a);x.useEffect(()=>{i.current=s,d.current=a},[s,a]);const m=x.useCallback(f=>{o(f),i.current=f},[]),c=x.useCallback(f=>{l(f),d.current=f},[]),h=x.useRef(!1),p=x.useCallback(()=>{h.current&&(t(i.current,d.current),h.current=!1)},[t]);return r.jsx("div",{className:"h-full",children:r.jsx(Nr,{nodes:s,edges:a,onNodesChange:f=>{m(f),h.current=!0},onEdgesChange:f=>{c(f),h.current=!0},onBlur:p,editable:!0})})}class Ct extends x.Component{constructor(n){super(n),this.state={hasError:!1,error:null}}static getDerivedStateFromError(n){return{hasError:!0,error:n}}componentDidCatch(n,t){var s,o;console.error("ErrorBoundary caught an error:",n,t),(o=(s=this.props).onError)==null||o.call(s,n,t)}render(){var n;return this.state.hasError?this.props.fallback?this.props.fallback:r.jsxs("div",{className:"p-4 bg-red-50 border border-red-200 rounded-md",children:[r.jsx("h3",{className:"text-lg font-semibold text-red-800 mb-2",children:"Something went wrong"}),r.jsx("p",{className:"text-sm text-red-700 mb-2",children:((n=this.state.error)==null?void 0:n.message)||"An error occurred"}),r.jsx("button",{onClick:()=>this.setState({hasError:!1,error:null}),className:"px-3 py-1 bg-red-600 text-white text-sm rounded hover:bg-red-700 cursor-pointer transition-colors",children:"Try again"})]}):this.props.children}}function Wa({selectedId:e,onSelect:n,onRefresh:t}){const[s,o]=x.useState([]),[a,l]=x.useState(!1),[i,d]=x.useState(null),[m,c]=x.useState(!1),[h,p]=x.useState(null),f=x.useRef(null);x.useEffect(()=>{w()},[]);async function w(){const I=await Yo();o(I)}async function _(I,M){try{const P=`${I.type||"csv"}-${Date.now()}`,D={...I,id:P,snapshots:M.snapshots,metadata:M.metadata,createdAt:Date.now()};await Nt(D),await w(),l(!1),p(null),n(P)}catch(z){throw console.error("Import error:",z),z}finally{f.current&&(f.current.value="")}}async function S(I,M){M.stopPropagation();const z=await jt(I);z&&d(z)}async function v(I){await Nt(I),await w(),e===I.id&&(t==null||t())}async function b(){i&&(await ps(i.id),await w(),e===i.id&&n(""),d(null))}async function y(){if(!i)return;const I=await Xo(i.id);await w(),d(null),n(I.id)}async function N(){await Zo(),await w(),c(!1),n(""),window.location.reload()}return r.jsxs("aside",{className:"h-full overflow-y-auto flex flex-col",children:[r.jsxs("div",{className:"p-4 border-b",children:[r.jsx("h2",{className:"text-lg font-bold",children:"Datasets"}),r.jsx("p",{className:"text-xs text-gray-500",children:"Stored in your browser"}),r.jsx("button",{onClick:()=>l(!0),className:"mt-3 w-full px-3 py-2 bg-blue-600 text-white text-sm rounded hover:bg-blue-700",children:"Import Dataset"}),r.jsx("input",{ref:f,type:"file",accept:".csv,.gexf",multiple:!0,className:"hidden"}),a&&r.jsx(Ct,{fallback:r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:r.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md mx-4",children:[r.jsx("h3",{className:"text-lg font-bold text-red-800 mb-2",children:"Import Panel Error"}),r.jsx("p",{className:"text-gray-600 mb-4",children:"The import panel encountered an error."}),r.jsx("button",{onClick:()=>l(!1),className:"px-4 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-700 cursor-pointer transition-colors",children:"Close"})]})}),children:r.jsx(Jo,{onClose:()=>{l(!1),p(null),f.current&&(f.current.value="")},onImport:_,fileInputRef:f,onFilesSelected:p,existingFile:h})})]}),r.jsxs("ul",{className:"divide-y flex-1 overflow-y-auto",children:[s.map(I=>r.jsx("li",{children:r.jsxs("div",{className:`flex items-center group ${e===I.id?"bg-blue-50":""}`,children:[r.jsxs("button",{className:"flex-1 text-left p-3 hover:bg-gray-50",onClick:()=>n(I.id),children:[r.jsx("div",{className:"flex items-center justify-between",children:r.jsxs("div",{children:[r.jsx("div",{className:"font-medium",children:I.name}),r.jsxs("div",{className:"text-xs text-gray-500",children:[I.type.toUpperCase()," · ",I.timeRange.start,I.timeRange.end!==I.timeRange.start?`–${I.timeRange.end}`:""]})]})}),I.notes&&r.jsx("div",{className:"text-xs text-gray-600 mt-1 line-clamp-2",children:I.notes})]}),r.jsx("button",{onClick:M=>S(I.id,M),className:"px-2 py-1 text-gray-400 hover:text-blue-600 hover:bg-gray-100 rounded transition-all mr-2 cursor-pointer",title:"Edit dataset",type:"button",children:r.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})})})]})},I.id)),s.length===0&&r.jsx("li",{className:"p-3 text-sm text-gray-500",children:"No datasets yet"})]}),r.jsxs("div",{className:"p-4 border-t",children:[r.jsx("button",{onClick:()=>c(!0),type:"button",className:"w-full px-3 py-2 bg-red-600 text-white text-sm rounded hover:bg-red-700 cursor-pointer transition-colors",children:"Reset All Data"}),r.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"Delete all datasets and reload defaults"})]}),i&&r.jsx(Ct,{fallback:r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:r.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md mx-4",children:[r.jsx("h3",{className:"text-lg font-bold text-red-800 mb-2",children:"Edit Panel Error"}),r.jsx("p",{className:"text-gray-600 mb-4",children:"The edit panel encountered an error."}),r.jsx("button",{onClick:()=>d(null),className:"px-4 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-700 cursor-pointer transition-colors",children:"Close"})]})}),children:r.jsx(Ba,{dataset:i,onClose:()=>d(null),onSave:v,onDelete:b,onDuplicate:y})}),m&&r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-60",children:r.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md mx-4",children:[r.jsx("h3",{className:"text-lg font-bold mb-2",children:"Reset All Data?"}),r.jsx("p",{className:"text-gray-600 mb-4",children:"This will delete all datasets and reload the default test data. This action cannot be undone."}),r.jsxs("div",{className:"flex justify-end gap-3",children:[r.jsx("button",{onClick:()=>c(!1),type:"button",className:"px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50 cursor-pointer transition-colors",children:"Cancel"}),r.jsx("button",{onClick:N,type:"button",className:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 cursor-pointer transition-colors",children:"Reset All Data"})]})]})})]})}function qa({nodes:e,edges:n,width:t=1200,height:s=800}){const o=x.useRef(null),[a,l]=x.useState(null),[i,d]=x.useState(null);return x.useEffect(()=>{var we,Re;if(!o.current||n.length===0||e.length===0){o.current&&Ie(o.current).selectAll("*").remove();return}Ie(o.current).selectAll("*").remove();const m=new Map;e.forEach(R=>{m.set(R.id,{id:R.id,label:R.label||R.id,outgoing:0,incoming:0})}),n.forEach(R=>{const T=m.get(R.source),_e=m.get(R.target);T&&(T.outgoing+=R.value),_e&&(_e.incoming+=R.value)});const c=Array.from(m.values()).filter(R=>R.outgoing>0||R.incoming>0);if(c.length===0){Ie(o.current).append("text").attr("x",t/2).attr("y",s/2).attr("text-anchor","middle").attr("font-size","14px").attr("fill","#666").text("No active nodes with flows");return}c.sort((R,T)=>T.outgoing+T.incoming-(R.outgoing+R.incoming));const h=50,p=t-50,f=20,w=15,_=2,S=5,v=c.reduce((R,T)=>R+T.outgoing,0),b=c.reduce((R,T)=>R+T.incoming,0),y=Math.max(s-2*f,400);let N=f;c.forEach(R=>{const T=v>0?Math.max(S,R.outgoing/v*y):Math.max(S,y/c.length);N+=T+_});let I=f;c.forEach(R=>{const T=b>0?Math.max(S,R.incoming/b*y):Math.max(S,y/c.length);I+=T+_});const M=Math.max(s,Math.max(N,I)+100),z=M-2*f,P=Ie(o.current).attr("width",t).attr("height",M).style("font","12px sans-serif");let D=f;const oe=c.map((R,T)=>{const _e=v>0?Math.max(S,R.outgoing/v*z):Math.max(S,z/c.length),ne=D;return D+=_e+_,{node:R,x:h,y:ne,height:Math.max(S,_e-_),side:"left",index:T}});D=f;const H=c.map((R,T)=>{const _e=b>0?Math.max(S,R.incoming/b*z):Math.max(S,z/c.length),ne=D;return D+=_e+_,{node:R,x:p,y:ne,height:Math.max(S,_e-_),side:"right",index:T}});let ie=[];a&&i&&(i==="left"?ie=n.filter(R=>R.source===a&&R.source!==R.target):ie=n.filter(R=>R.target===a&&R.source!==R.target));const F=dr(fr);if(ie.length>0){const R=ie.map(q=>{const De=oe.find(We=>We.node.id===q.source),K=H.find(We=>We.node.id===q.target);if(!De||!K)return null;const He=De.y+De.height/2,Ce=K.y+K.height/2;return{edge:q,sourceX:De.x+w,sourceY:He,targetX:K.x,targetY:Ce,value:q.value,leftIndex:De.index,rightIndex:K.index}}).filter(q=>q!==null),T=Math.max(...R.map(q=>q.value),1),_e=2,ne=20,Ye=P.append("g").attr("class","links");R.forEach(q=>{const De=_e+q.value/T*(ne-_e),K=`gradient-${q.leftIndex}-${q.rightIndex}`,He=P.append("defs").append("linearGradient").attr("id",K).attr("gradientUnits","userSpaceOnUse").attr("x1",q.sourceX).attr("x2",q.targetX).attr("y1",q.sourceY).attr("y2",q.targetY);He.append("stop").attr("offset","0%").attr("stop-color",F(String(q.leftIndex))).attr("stop-opacity",.6),He.append("stop").attr("offset","100%").attr("stop-color",F(String(q.rightIndex))).attr("stop-opacity",.6);const Ce=_s(),We=(q.sourceX+q.targetX)/2;Ce.moveTo(q.sourceX,q.sourceY),Ce.bezierCurveTo(We,q.sourceY,We,q.targetY,q.targetX,q.targetY),Ye.append("path").attr("d",Ce.toString()).attr("stroke",`url(#${K})`).attr("stroke-width",De).attr("fill","none").attr("stroke-opacity",.6).style("cursor","pointer").on("mouseover",function($e){Ie(this).attr("stroke-opacity",1).attr("stroke-width",De+2),Ie("body").append("div").attr("class","tooltip").style("position","absolute").style("background","rgba(0, 0, 0, 0.8)").style("color","white").style("padding","8px").style("border-radius","4px").style("pointer-events","none").style("opacity",0).html(`${q.edge.source} → ${q.edge.target}<br/>${q.value.toLocaleString()}`).style("opacity",1)}).on("mousemove",function($e){Ie(".tooltip").style("left",`${$e.pageX+10}px`).style("top",`${$e.pageY-10}px`)}).on("mouseout",function(){Ie(this).attr("stroke-opacity",.6).attr("stroke-width",De),Ie(".tooltip").remove()})})}const ae=P.append("g").attr("class","left-nodes").selectAll("g.node").data(oe).join("g").attr("class","node").attr("transform",R=>`translate(${R.x}, ${R.y})`).style("cursor","pointer").on("click",function(R,T){R.stopPropagation(),a===T.node.id&&i==="left"?(l(null),d(null)):(l(T.node.id),d("left"))});ae.append("rect").attr("width",w).attr("height",R=>R.height).attr("fill",(R,T)=>F(String(T))).attr("stroke",(R,T)=>Wt(F(String(T))).darker().formatHex()).attr("stroke-width",R=>a===R.node.id&&i==="left"?3:1).attr("opacity",R=>a&&i==="left"&&a!==R.node.id?.3:1).on("mouseover",function(R,T){Ie(this).attr("fill",Wt(F(String(T.index))).brighter(.5).formatHex())}).on("mouseout",function(R,T){Ie(this).attr("fill",F(String(T.index)))}),ae.append("text").attr("x",w+6).attr("y",R=>R.height/2).attr("dy","0.35em").attr("text-anchor","start").text(R=>`${R.node.label} (${R.node.outgoing.toLocaleString()})`).style("font-size","11px").style("font-weight","500").style("fill","#333").attr("opacity",R=>a&&i==="left"&&a!==R.node.id?.3:1);const le=P.append("g").attr("class","right-nodes").selectAll("g.node").data(H).join("g").attr("class","node").attr("transform",R=>`translate(${R.x}, ${R.y})`).style("cursor","pointer").on("click",function(R,T){R.stopPropagation(),a===T.node.id&&i==="right"?(l(null),d(null)):(l(T.node.id),d("right"))});le.append("rect").attr("x",-w).attr("width",w).attr("height",R=>R.height).attr("fill",(R,T)=>F(String(T))).attr("stroke",(R,T)=>Wt(F(String(T))).darker().formatHex()).attr("stroke-width",R=>a===R.node.id&&i==="right"?3:1).attr("opacity",R=>a&&i==="right"&&a!==R.node.id?.3:1).on("mouseover",function(R,T){Ie(this).attr("fill",Wt(F(String(T.index))).brighter(.5).formatHex())}).on("mouseout",function(R,T){Ie(this).attr("fill",F(String(T.index)))}),le.append("text").attr("x",-w-6).attr("y",R=>R.height/2).attr("dy","0.35em").attr("text-anchor","end").text(R=>`${R.node.label} (${R.node.incoming.toLocaleString()})`).style("font-size","11px").style("font-weight","500").style("fill","#333").attr("opacity",R=>a&&i==="right"&&a!==R.node.id?.3:1),a?P.append("text").attr("x",t/2).attr("y",20).attr("text-anchor","middle").attr("font-size","14px").attr("fill","#333").text(i==="left"?`Showing outgoing flows from ${(we=oe.find(R=>R.node.id===a))==null?void 0:we.node.label}`:`Showing incoming flows to ${(Re=H.find(R=>R.node.id===a))==null?void 0:Re.node.label}`):P.append("text").attr("x",t/2).attr("y",20).attr("text-anchor","middle").attr("font-size","14px").attr("fill","#666").text("Click a node to see its connections"),P.append("text").attr("x",h+w/2).attr("y",M-10).attr("text-anchor","middle").attr("font-size","12px").attr("font-weight","bold").attr("fill","#333").text("Outgoing"),P.append("text").attr("x",p-w/2).attr("y",M-10).attr("text-anchor","middle").attr("font-size","12px").attr("font-weight","bold").attr("fill","#333").text("Incoming"),P.on("click",function(R){(R.target===o.current||R.target.tagName==="svg")&&(l(null),d(null))})},[e,n,t,s,a,i]),r.jsxs("div",{className:"w-full h-full flex flex-col min-h-0",children:[r.jsxs("div",{className:"text-center text-xs text-gray-500 mb-2 flex-shrink-0",children:["Interaction design inspired by"," ",r.jsx("a",{href:"https://peoplemov.in/#f_AF",target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-800 underline",children:"peoplemov.in by Carlo Zapponi"})]}),r.jsx("div",{className:"flex-1 overflow-auto min-h-0",children:r.jsx("svg",{ref:o,className:"border border-gray-200 rounded bg-white"})})]})}function Ka(e,n){const t=e.length,s=new Map;e.forEach((l,i)=>{s.set(l.id,i)});const o=Array(t).fill(null).map(()=>Array(t).fill(0));n.forEach(l=>{const i=s.get(l.source),d=s.get(l.target);i!==void 0&&d!==void 0&&(o[i][d]+=l.value)});const a=e.map(l=>l.label||l.id);return{matrix:o,labels:a,nodes:e}}function ar(e,n,t){return!t||t==="all"?e:e.filter(s=>{const o=s[n];return Array.isArray(o)?o.includes(t):o===t})}function Ya(e,n){const t=new Set;return e.forEach(s=>{const o=s[n];o!=null&&(Array.isArray(o)?o.forEach(a=>t.add(a)):t.add(o))}),Array.from(t).sort((s,o)=>typeof s=="number"&&typeof o=="number"?s-o:String(s).localeCompare(String(o)))}function Xa({nodes:e,edges:n,width:t=1e3,height:s=800}){const o=x.useRef(null);return x.useEffect(()=>{if(!o.current||n.length===0||e.length===0){o.current&&Ie(o.current).selectAll("*").remove();return}Ie(o.current).selectAll("*").remove();const a=Ka(e,n),l=Ie(o.current).attr("width","100%").attr("height","100%").attr("viewBox",`0 0 ${t} ${s}`).attr("preserveAspectRatio","xMidYMid meet"),i=Math.min(t,s)*.5-40,d=i-20,m=Ar().scaleExtent([.1,4]).on("zoom",function(b){_.attr("transform",b.transform.toString())});l.call(m);const c=l.append("g").attr("class","reset-button").style("cursor","pointer").attr("transform",`translate(${t-120}, 10)`).on("click",function(){l.transition().duration(750).call(m.transform,Pr)});c.append("rect").attr("width",110).attr("height",30).attr("rx",4).attr("fill","white").attr("stroke","#ccc").attr("stroke-width",1),c.append("text").attr("x",55).attr("y",20).attr("text-anchor","middle").attr("font-size","12px").attr("fill","#333").text("Reset View");const p=eo().padAngle(.05).sortSubgroups(Qr)(a.matrix),f=go().radius(d),w=dr(fr),_=l.append("g").attr("class","zoom-group"),S=_.append("g").attr("transform",`translate(${t/2}, ${s/2})`),v=S.append("g").selectAll("g").data(p.groups).join("g");v.append("path").attr("fill",b=>w(String(b.index))).attr("stroke",b=>Wt(w(String(b.index))).darker().formatHex()).attr("d",Co().innerRadius(d).outerRadius(i)).on("mouseover",function(b,y){Ie(this).attr("fill",Wt(w(String(y.index))).brighter(1).formatHex()),S.selectAll("path.chord").style("opacity",N=>N.source.index===y.index||N.target.index===y.index?1:.2)}).on("mouseout",function(){Ie(this).attr("fill",b=>w(String(b.index))),S.selectAll("path.chord").style("opacity",1)}),v.append("text").attr("dy",".35em").attr("transform",b=>`
        rotate(${(b.startAngle+b.endAngle)/2*180/Math.PI-90})
        translate(${i+10})
        ${(b.startAngle+b.endAngle)/2>Math.PI?"rotate(180)":""}
      `).attr("text-anchor",b=>(b.startAngle+b.endAngle)/2>Math.PI?"end":"start").text(b=>a.labels[b.index]).style("font-size","12px").style("font-weight","500"),S.append("g").attr("fill-opacity",.67).selectAll("path").data(p).join("path").attr("class","chord").attr("d",b=>f(b)??"").attr("fill",b=>w(String(b.source.index))).attr("stroke",b=>Wt(w(String(b.source.index))).darker().formatHex()).style("stroke-width","1px").on("mouseover",function(b,y){Ie(this).attr("fill-opacity",1).style("stroke-width","2px"),Ie("body").append("div").attr("class","tooltip").style("position","absolute").style("background","rgba(0, 0, 0, 0.8)").style("color","white").style("padding","8px").style("border-radius","4px").style("pointer-events","none").style("opacity",0).style("transition","opacity 0.2s").html(`${a.labels[y.source.index]} → ${a.labels[y.target.index]}: ${y.source.value.toLocaleString()}`).style("opacity",1)}).on("mousemove",function(b){Ie(".tooltip").style("left",`${b.pageX+10}px`).style("top",`${b.pageY-10}px`)}).on("mouseout",function(){Ie(this).attr("fill-opacity",.67).style("stroke-width","1px"),Ie(".tooltip").remove()})},[e,n,t,s]),r.jsx("div",{className:"w-full h-full",children:r.jsx("svg",{ref:o,className:"border border-gray-200 rounded bg-white"})})}const Za=200,Qa=600,Ja=384,ir=4;function ei({isCollapsed:e,onToggle:n,onResize:t,children:s,title:o="Settings",bottomContent:a}){const[l,i]=x.useState(Ja),[d,m]=x.useState(!1),c=x.useRef(null),h=x.useRef(null);return x.useEffect(()=>{if(!d)return;const p=w=>{var _;if(!e&&((_=c.current)==null?void 0:_.getBoundingClientRect())){const v=Math.max(Za,Math.min(Qa,window.innerWidth-w.clientX));i(v),t==null||t(v)}},f=()=>{m(!1)};return document.addEventListener("mousemove",p),document.addEventListener("mouseup",f),()=>{document.removeEventListener("mousemove",p),document.removeEventListener("mouseup",f)}},[d,e,t]),r.jsxs("div",{ref:c,className:"bg-white border-l border-gray-200 flex flex-col transition-all duration-300  overflow-hidden relative",style:{minHeight:"100vh",width:e?`${ir}px`:`${l}px`},children:[e&&r.jsxs(r.Fragment,{children:[r.jsx("div",{onClick:n,className:"w-full h-full bg-gray-100 hover:bg-blue-400 cursor-pointer transition-colors",style:{width:`${ir}px`},title:"Click to expand settings"}),r.jsx("button",{onClick:n,className:"fixed bottom-4 right-4 z-50 p-3 bg-blue-600 hover:bg-blue-700 text-white rounded-full shadow-lg cursor-pointer transition-all hover:scale-110 flex items-center justify-center",style:{width:"48px",height:"48px"},title:"Open visualization settings","aria-label":"Open visualization settings",children:r.jsx(Gs,{className:"w-5 h-5"})})]}),!e&&r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:s}),a&&r.jsx("div",{className:"flex-shrink-0 border-t border-gray-200 bg-white",children:a}),r.jsxs("button",{onClick:n,className:"w-full flex items-center justify-between p-2 border-t border-gray-200 flex-shrink-0 bg-gray-50 hover:bg-gray-100 transition-colors cursor-pointer","aria-label":"Collapse settings",children:[r.jsxs("div",{className:"flex items-center gap-2 flex-1",children:[r.jsx(Gs,{className:"w-4 h-4 text-gray-600"}),r.jsx("span",{className:"text-sm font-medium text-gray-700",children:o})]}),r.jsx(Vr,{className:"w-4 h-4 text-gray-600 flex-shrink-0"})]}),r.jsx("div",{ref:h,onMouseDown:p=>{p.preventDefault(),m(!0)},className:"absolute top-0 left-0 w-1 h-full cursor-col-resize hover:bg-blue-400 bg-gray-300 transition-colors z-10",style:{touchAction:"none"},children:r.jsx("div",{className:"absolute top-1/2 left-0 transform -translate-y-1/2 -translate-x-0.5",children:r.jsx(kr,{className:"w-3 h-6 text-gray-500"})})})]})]})}const jr=["Alabama","Alaska","Arizona","Arkansas","California","Colorado","Connecticut","Delaware","District of Columbia","Florida","Georgia","Hawaii","Idaho","Illinois","Indiana","Iowa","Kansas","Kentucky","Louisiana","Maine","Maryland","Massachusetts","Michigan","Minnesota","Mississippi","Missouri","Montana","Nebraska","Nevada","New Hampshire","New Jersey","New Mexico","New York","North Carolina","North Dakota","Ohio","Oklahoma","Oregon","Pennsylvania","Rhode Island","South Carolina","South Dakota","Tennessee","Texas","Utah","Vermont","Virginia","Washington","West Virginia","Wisconsin","Wyoming"],ti=new Set(jr),ni=jr.length,lr=Wr.reduce((e,n)=>(e[n]=n===2020?"ACS 1-year state-to-state migration flows for 2020 were not released by the Census Bureau due to pandemic-related data quality concerns.":"State-to-state migration data is unavailable for this year in the ACS 1-year series.",e),{});function rn({title:e,subtitle:n,children:t,defaultOpen:s=!1,onReset:o}){const[a,l]=x.useState(s);return r.jsxs("div",{className:"border border-gray-200 rounded-md",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("button",{onClick:()=>l(!a),className:"flex-1 flex items-center justify-between p-3 hover:bg-gray-50 transition-colors text-left",children:[r.jsxs("div",{className:"flex-1",children:[r.jsx("div",{className:"font-semibold text-sm",children:e}),n&&r.jsx("div",{className:"text-xs text-gray-600 mt-0.5",children:n})]}),a?r.jsx(Xr,{className:"w-4 h-4 text-gray-600 flex-shrink-0"}):r.jsx(Kr,{className:"w-4 h-4 text-gray-600 flex-shrink-0"})]}),o&&r.jsx("button",{type:"button",onClick:i=>{i.stopPropagation(),o()},className:"pr-3 text-[11px] font-medium text-blue-600 hover:text-blue-800 transition-colors",children:"Reset"})]}),a&&r.jsx("div",{className:"p-3 pt-0 border-t border-gray-200",children:t})]})}const ur=on(["kriskogram","table","sankey","chord"]),_t=e=>{const n=e!==void 0?pt().default(e):pt().optional();return ze(t=>{if(t==null||t==="")return e;const s=typeof t=="string"?parseFloat(t):Number(t);return Number.isNaN(s)?e:s},n)},Ht=e=>ze(n=>{if(typeof n=="boolean")return n;if(typeof n=="string"){if(n.toLowerCase()==="true")return!0;if(n.toLowerCase()==="false")return!1}return e},Gr().default(e));function Gt(e,n){return ze(t=>{if(typeof t=="string"){const s=t.toLowerCase(),o=e.find(a=>a.toLowerCase()===s);if(o)return o}return n},on(e).default(n))}function si(e){return ze(n=>typeof n=="string"&&n.trim()!==""?n:e,ln().default(e))}const pn=()=>ze(e=>e==null||e===""?null:typeof e=="string"?e:null,ln().nullable().default(null)),ri=()=>ze(e=>Array.isArray(e)?e.map(n=>n==null?null:String(n)).filter(n=>!!(n&&n.trim())):typeof e=="string"?e.trim()===""?[]:e.split(",").map(n=>n.trim()).filter(n=>n.length>0):[],Hr(ln()).default([]));zr({dataset:ln().optional(),view:ze(e=>typeof e=="string"&&ur.safeParse(e).success?e:"kriskogram",ur.default("kriskogram")),year:_t(void 0),minThreshold:_t(0),maxThreshold:_t(2e5),maxEdges:_t(500),edgeWeightScale:ze(e=>{if(typeof e!="string")return"linear";const n=e.toLowerCase();return["linear","sqrt","log"].includes(n)?n:"linear"},on(["linear","sqrt","log"]).default("linear")),egoNodeId:ze(e=>e==null||e===""||e==="null"?null:typeof e=="string"?e:void 0,ln().nullable().optional()),egoNeighborSteps:ze(e=>{if(e==null||e==="")return 1;const n=typeof e=="string"?parseInt(e,10):Number(e);return Number.isNaN(n)||n<1?1:Math.max(1,Math.round(n))},pt().min(1).default(1)),egoStepColoring:Ht(!1),edgeType:ze(e=>e==="null"||e===""?null:typeof e=="string"?e:void 0,ln().nullable().optional()),showAllNodes:Ht(!1),temporalOverlay:Ht(!1),temporalOverlayEdgeStyle:ze(e=>{if(typeof e=="string"){const n=e.toLowerCase();if(["segmented","filled","outline"].includes(n))return n}return"filled"},on(["segmented","filled","outline"]).default("filled")),temporalOverlayNodeStyle:ze(e=>{if(typeof e=="string"){const n=e.toLowerCase();if(["filled","outline"].includes(n))return n}return"filled"},on(["filled","outline"]).default("filled")),temporalOverlayYears:ze(e=>{if(e==null||e==="")return 1;const n=typeof e=="string"?parseInt(e,10):Number(e);return Number.isNaN(n)||n<1?1:Math.max(1,Math.round(n))},pt().min(1).default(1)),nodeOrderMode:si("alphabetical"),arcOpacity:ze(e=>{if(e==null||e==="")return .85;const n=typeof e=="string"?parseFloat(e):Number(e);return Number.isNaN(n)?.85:Math.max(0,Math.min(1,n))},pt().min(0).max(1).default(.85)),edgeWidthMode:Gt(["fixed","weight"],"weight"),edgeColorAdvanced:Ht(!1),edgeColorHue:Gt(["direction","region","division","attribute","single"],"direction"),edgeColorHueAttribute:pn(),edgeColorIntensity:Gt(["constant","weight","attribute"],"weight"),edgeColorIntensityAttribute:pn(),edgeColorIntensityConst:ze(e=>{if(e==null||e==="")return .6;const n=typeof e=="string"?parseFloat(e):Number(e);return Number.isNaN(n)?.6:Math.max(0,Math.min(1,n))},pt().min(0).max(1).default(.6)),edgeColorInterGrayscale:Ht(!0),intraFilter:Gt(["none","region","division","interRegion","interDivision"],"none"),baseEdgeWidth:ze(e=>{if(e==null||e==="")return 2;const n=typeof e=="string"?parseFloat(e):Number(e);return Number.isNaN(n)?2:Math.max(.5,Math.min(12,n))},pt().min(.5).max(12).default(2)),nodeColorMode:Gt(["single","attribute","visible_outgoing","visible_incoming","year_outgoing","year_incoming","net_year","outgoing","incoming","self_year"],"single"),nodeColorAttribute:pn(),nodeSizeMode:Gt(["fixed","attribute","visible_outgoing","visible_incoming","year_outgoing","year_incoming","net_visible","net_year","outgoing","incoming","self_year"],"fixed"),nodeSizeAttribute:pn(),interactionMode:Gt(["pan","lens"],"pan"),lensRadius:ze(e=>{if(e==null||e==="")return 80;const n=typeof e=="string"?parseFloat(e):Number(e);return Number.isNaN(n)?80:Math.max(20,Math.min(300,n))},pt().min(20).max(300).default(80)),edgeSegmentLength:_t(8),edgeSegmentGap:_t(4),edgeSegmentAnimate:Ht(!1),edgeSegmentOffset:_t(15),edgeSegmentSpeed:_t(1),edgeSegmentScaleByWeight:Ht(!1),edgeSegmentCap:ze(e=>{if(typeof e=="string"){const n=e.toLowerCase();if(["round","butt"].includes(n))return n}return"round"},on(["round","butt"]).default("round")),edgeOutlineGap:ze(e=>{if(e==null||e==="")return 3;const n=typeof e=="string"?parseFloat(e):Number(e);return Number.isNaN(n)?3:Math.max(.5,n)},pt().min(.5).default(3)),nodeFilterAttribute:pn(),nodeFilterValues:ri()});function ci(){const e=Dr({from:"/explorer"}),n=Lr(),{leftSidebarCollapsed:t,leftSidebarWidth:s,setSidebarContent:o}=Tr(),[a,l]=x.useState(e.dataset),[i,d]=x.useState(void 0),[m,c]=x.useState(e.year),[h,p]=x.useState(!1),[f,w]=x.useState(null),[_,S]=x.useState(0),[v,b]=x.useState(e.minThreshold??0),[y,N]=x.useState(e.maxThreshold??2e5),[I,M]=x.useState(e.maxEdges??500),[z,P]=x.useState(e.edgeType??null),[D,oe]=x.useState(e.view),[H,ie]=x.useState(e.showAllNodes??!1),[F,Z]=x.useState(e.egoNodeId??null),[ae,xe]=x.useState(e.egoNeighborSteps??1),[le,we]=x.useState(e.egoStepColoring??!1),[Re,R]=x.useState(e.edgeWeightScale??"linear"),[T,_e]=x.useState(e.temporalOverlay??!1),[ne,Ye]=x.useState(e.temporalOverlayEdgeStyle??"filled"),[q,De]=x.useState(e.temporalOverlayNodeStyle??"filled"),[K,He]=x.useState(e.edgeSegmentLength??8),[Ce,We]=x.useState(e.edgeSegmentGap??4),[$e,qt]=x.useState(e.edgeSegmentAnimate??!1),[qe,yn]=x.useState(e.edgeSegmentOffset??15),[xt,bn]=x.useState(Math.max(.1,e.edgeSegmentSpeed??1)),[E,V]=x.useState(e.edgeSegmentScaleByWeight??!1),[B,ve]=x.useState(e.edgeSegmentCap??"round"),[Q,fe]=x.useState(Math.max(.5,e.edgeOutlineGap??3)),[pe,ot]=x.useState(e.temporalOverlayYears??1),[Ae,dt]=x.useState(e.nodeFilterAttribute??null),[ye,Ne]=x.useState(e.nodeFilterValues??[]),Vn=x.useRef(null),[Kt,Mr]=x.useState(!1),[Sn,Rr]=x.useState(384),[Yt,Ms]=x.useState({width:typeof window<"u"?window.innerWidth:1200,height:typeof window<"u"?window.innerHeight:800});x.useEffect(()=>(o(r.jsx(Ct,{fallback:r.jsxs("div",{className:"p-4",children:[r.jsx("h2",{className:"text-lg font-bold text-red-800 mb-2",children:"Dataset Sidebar Error"}),r.jsx("p",{className:"text-sm text-red-700",children:"The dataset sidebar encountered an error."})]}),children:r.jsx(Wa,{selectedId:a,onSelect:u=>{l(u),A({dataset:u})},onRefresh:()=>S(u=>u+1)})})),()=>{o(null)}),[a,_]),x.useEffect(()=>{if(typeof window>"u")return;const u=()=>{Ms({width:window.innerWidth,height:window.innerHeight})};return u(),window.addEventListener("resize",u),()=>window.removeEventListener("resize",u)},[]),x.useEffect(()=>{typeof window<"u"&&setTimeout(()=>{Ms({width:window.innerWidth,height:window.innerHeight})},100)},[t,Kt,s,Sn]);const[kn,Rs]=x.useState(e.nodeOrderMode??"alphabetical"),[Dn,Fs]=x.useState(e.arcOpacity??.85),[Ft,Ln]=x.useState(e.edgeWidthMode??"weight"),[un,Es]=x.useState(e.edgeColorAdvanced??!1),[je,Et]=x.useState(e.edgeColorHue??"direction"),[Xt,wn]=x.useState(e.edgeColorHueAttribute??null),[vt,Tn]=x.useState(e.edgeColorIntensity??"weight"),[dn,_n]=x.useState(e.edgeColorIntensityAttribute??null),[On,zn]=x.useState(e.edgeColorIntensityConst??.6),[Hn,Is]=x.useState(e.edgeColorInterGrayscale??!0),[Qe,$s]=x.useState(e.intraFilter??"none"),[It,As]=x.useState(e.baseEdgeWidth??2),[Gn,Ps]=x.useState(e.nodeColorMode??"single"),[Zt,Bn]=x.useState(e.nodeColorAttribute??null),[Xe,Vs]=x.useState(e.nodeSizeMode??"fixed"),[Cn,Un]=x.useState(e.nodeSizeAttribute??null),[Qt,Wn]=x.useState(e.interactionMode??"pan"),[ks,Ds]=x.useState(e.lensRadius??80),[Ls,Ts]=x.useState({x:0,y:0}),A=x.useMemo(()=>u=>{n({to:"/explorer",search:g=>({view:g.view??"kriskogram",...g,...u}),replace:!0})},[n]),Nn=x.useMemo(()=>{var u,g;return((g=(u=i==null?void 0:i.metadata)==null?void 0:u.hasCategoricalProperties)==null?void 0:g.nodes)??[]},[i]);x.useEffect(()=>{i&&Ae&&(Nn.includes(Ae)||(dt(null),Ne([]),A({nodeFilterAttribute:null,nodeFilterValues:[]})))},[i,Nn,Ae,A]);const Fr=x.useMemo(()=>i&&i.timeRange.start!==i.timeRange.end,[i]);x.useMemo(()=>{var j,J;if(!i)return 0;const u=(j=i.timeRange)==null?void 0:j.start,g=(J=i.timeRange)==null?void 0:J.end;return typeof u!="number"||typeof g!="number"?0:Math.max(0,g-u)},[i]);const ct=x.useRef(!0);x.useEffect(()=>{Qo().catch(()=>{}),oi().then(u=>{const g=e.dataset||u;g&&(l(g),!e.dataset&&ct.current&&A({dataset:g})),ct.current=!1}).catch(u=>w(u instanceof Error?u.message:"Failed to preload datasets"))},[]),x.useEffect(()=>{if(!a){d(void 0);return}p(!0),w(null),jt(a).then(u=>{if(d(u),u){const{start:g,end:j}=u.timeRange??{};c(J=>{const ee=se=>typeof se=="number"&&typeof g=="number"&&typeof j=="number"&&se>=g&&se<=j;return ee(J)?J:ee(e.year)?e.year:typeof g=="number"?g:J??g??void 0})}}).catch(u=>w(u instanceof Error?u.message:"Failed to load dataset")).finally(()=>p(!1))},[a,_,e.year]);const be=x.useMemo(()=>{if(!(!i||m===void 0))return i.snapshots.find(u=>(typeof u.timestamp=="string"?parseInt(u.timestamp,10):u.timestamp)===m)},[i,m]),cn=x.useMemo(()=>{if(!be||!Ae)return[];const u=new Set;return be.nodes.forEach(g=>{const j=g==null?void 0:g[Ae];j!=null&&j!==""&&u.add(String(j))}),Array.from(u).sort((g,j)=>g.localeCompare(j))},[be,Ae]);x.useEffect(()=>{if(!Ae||!be||ye.length===0)return;const u=ye.filter(g=>cn.includes(g));u.length!==ye.length&&(Ne(u),A({nodeFilterValues:u}))},[Ae,ye,cn,be,A]),x.useMemo(()=>{if(!i)return new Map;const u=new Map;return i.snapshots.forEach(g=>{const j=typeof g.timestamp=="string"?parseInt(g.timestamp,10):g.timestamp;Number.isFinite(j)&&u.set(j,g)}),u},[i]);const Fe=x.useMemo(()=>{if(!i)return null;let u=1/0,g=-1/0,j=0;return i.snapshots.forEach(J=>{const ee=Array.isArray(J==null?void 0:J.edges)?J.edges:[];let se=0;ee.forEach(ce=>{if(ce!=null&&ce.source&&ce.source===ce.target)return;const de=Number(ce==null?void 0:ce.value);Number.isFinite(de)&&(se+=1,de<u&&(u=de),de>g&&(g=de))}),se>j&&(j=se)}),u===1/0||g===-1/0?{min:0,max:0,maxEdgesCount:j}:{min:u,max:g,maxEdgesCount:j}},[i]),Jt=x.useMemo(()=>{if(!i)return null;let u=1/0,g=-1/0;return i.snapshots.forEach(j=>{const J=new Map,ee=new Map;(Array.isArray(j==null?void 0:j.edges)?j.edges:[]).forEach(de=>{const he=ee.get(de.source)||0;ee.set(de.source,he+de.value);const Oe=J.get(de.target)||0;J.set(de.target,Oe+de.value)}),(Array.isArray(j==null?void 0:j.nodes)?j.nodes:[]).forEach(de=>{const he=(J.get(de.id)||0)-(ee.get(de.id)||0);he<u&&(u=he),he>g&&(g=he)})}),u===1/0||g===-1/0?{min:0,max:0}:{min:u,max:g}},[i]),en=x.useMemo(()=>{if(!i)return null;let u=0,g=0;return i.snapshots.forEach(j=>{const J=new Map,ee=new Map;(Array.isArray(j==null?void 0:j.edges)?j.edges:[]).forEach(de=>{const he=ee.get(de.source)||0;ee.set(de.source,he+de.value);const Oe=J.get(de.target)||0;J.set(de.target,Oe+de.value)}),(Array.isArray(j==null?void 0:j.nodes)?j.nodes:[]).forEach(de=>{const he=J.get(de.id)||0,Oe=ee.get(de.id)||0;he>u&&(u=he),Oe>g&&(g=Oe)})}),{maxIncoming:u,maxOutgoing:g}},[i]),tn=x.useMemo(()=>{if(!i)return null;let u=0;return i.snapshots.forEach(g=>{const j=Array.isArray(g==null?void 0:g.edges)?g.edges:[],J=new Map;j.forEach(ee=>{if(ee!=null&&ee.source&&ee.source===ee.target){const se=Number(ee.value);if(!Number.isFinite(se)||se<=0)return;const ce=J.get(ee.source)||0;J.set(ee.source,ce+se)}}),J.forEach(ee=>{ee>u&&(u=ee)})}),{max:u}},[i]);x.useEffect(()=>{if(!Fe)return;const{min:u,max:g,maxEdgesCount:j}=Fe;if(!Number.isFinite(u)||!Number.isFinite(g))return;const J=(he,Oe,Ge)=>Ge<Oe||!Number.isFinite(he)||he<Oe?Oe:he>Ge?Ge:he,ee=J(v,u,g);let se=J(y,u,g);se<ee&&(se=ee);const ce=Math.max(1,j),de=Math.max(1,Math.min(I,ce));ee!==v&&b(ee),se!==y&&N(se),de!==I&&M(de)},[Fe,v,y,I]);const at=x.useMemo(()=>{if(!be||!(i!=null&&i.metadata))return null;const g=["migration_type","type","category","edge_type"].find(J=>{var ee,se;return((ee=i.metadata)==null?void 0:ee.edgeProperties.includes(J))||((se=i.metadata)==null?void 0:se.hasCategoricalProperties.edges.includes(J))});if(!g)return null;const j=Ya(be.edges,g);return{property:g,values:j.map(J=>String(J))}},[be,i]);x.useEffect(()=>{P(null)},[a]),x.useEffect(()=>{be&&F&&(be.nodes.some(g=>g.id===F)||(Z(null),le&&we(!1),A({egoNodeId:null,egoStepColoring:!1})))},[be,F,le,A]);const G=x.useMemo(()=>{if(!i||!be)return{nodes:[],edges:[],baseEdges:[],overlayEdges:[],egoStepMax:0,overlayMeta:{hasPast:!1,hasFuture:!1,maxDelta:0}};const u=typeof m=="number"?m:null,g=!!(Ae&&ye.length>0),j=new Set(ye.map($=>String($))),J=be.nodes,ee=g?J.filter($=>{const C=$==null?void 0:$[Ae];if(C==null)return!1;const O=String(C);return j.has(O)}):J,se=new Set(ee.map($=>$.id));if(se.size===0)return{nodes:[],baseEdges:[],edges:[],currentEdgeCount:0,egoStepMax:0,temporalOverlay:null};const ce=new Map,de=new Map,he=new Map;be.edges.forEach($=>{if(!se.has($.source)||!se.has($.target))return;const C=de.get($.source)||0;de.set($.source,C+$.value);const O=ce.get($.target)||0;if(ce.set($.target,O+$.value),$.source===$.target){const U=he.get($.source)||0;he.set($.source,U+$.value)}});const Oe=($,C)=>{if(Qe==="none")return $;const O=new Map(C.map(U=>[U.id,U]));return $.filter(U=>{const W=O.get(U.source),ue=O.get(U.target);return!W||!ue?!1:Qe==="region"?W.region&&ue.region&&W.region===ue.region:Qe==="division"?W.division&&ue.division&&W.division===ue.division:Qe==="interRegion"?W.region&&ue.region&&W.region!==ue.region:Qe==="interDivision"?W.division&&ue.division&&W.division!==ue.division:!0})};let Ge=ar(be.edges,(at==null?void 0:at.property)||"",z);Ge=Ge.filter($=>se.has($.source)&&se.has($.target)),Ge=Oe(Ge,ee),Ge=Ge.filter($=>($==null?void 0:$.source)!==($==null?void 0:$.target));const Ve=Ge.filter($=>$.value>=v&&$.value<=y).sort(($,C)=>C.value-$.value).slice(0,I).map(($,C)=>({edge:$,idx:C}));let ke=Ve;const me=new Map;let Le=0;if(D==="kriskogram"&&F){const $=Math.max(1,Math.round(ae)),C=new Set;let O=new Set;const U=new Set;O.add(F),U.add(F);for(let W=1;W<=$&&O.size>0;W+=1){const ue=new Set;Ve.forEach(({edge:L,idx:Se})=>{if(O.has(L.source)||O.has(L.target)){C.add(Se);const Me=me.get(Se);(Me===void 0||W<Me)&&me.set(Se,W),U.has(L.source)||(U.add(L.source),ue.add(L.source)),U.has(L.target)||(U.add(L.target),ue.add(L.target))}}),O=ue}ke=Ve.filter(({idx:W})=>C.has(W)),me.forEach(W=>{W>Le&&(Le=W)})}const gt=ne,nt=ne==="segmented"?`${Math.max(1,K)} ${Math.max(.5,Ce)}`:null,Pt=ne==="segmented"?Math.max(0,qe):0,Vt=ne==="segmented"?B:"round",mt=ke.map(({edge:$,idx:C})=>{const O=me.get(C),U={...$,__isOverlay:!1,__displayYear:u,__temporalDelta:0,_overlayType:void 0,_overlayYear:u,__overlayStyle:gt,__overlayDash:nt,__overlayDashOffset:Pt,__overlayLineCap:Vt,__segmentInitialGap:ne==="segmented"?Math.max(0,qe):0,__segmentSpeed:Math.max(.1,xt),__segmentScaleByWeight:ne==="segmented"&&E,__segmentCycle:ne==="segmented"?Math.max(1,K+Ce):0,__segmentAnimate:ne==="segmented"&&$e,__outlineGap:Q};return O!==void 0&&(U._egoStep=O),U}),ft=new Set;mt.forEach($=>{ft.add($.source),ft.add($.target)}),F&&ft.add(F);const kt=new Map,Dt=new Map;mt.forEach($=>{const C=Dt.get($.source)||0;Dt.set($.source,C+$.value);const O=kt.get($.target)||0;kt.set($.target,O+$.value)});const Lt=[],Tt=new Map,it=new Map;let yt=0,jn=!1,Ot=!1;const mn=new Map;if(i&&i.snapshots.forEach($=>{const C=typeof $.timestamp=="string"?parseInt($.timestamp,10):$.timestamp;Number.isFinite(C)&&mn.set(C,$)}),T&&i&&typeof m=="number"&&i.timeRange.start!==i.timeRange.end){const $=Math.max(1,Math.round(pe));for(let C=-$;C<=$;C+=1){if(C===0)continue;const O=m+C,U=mn.get(O);if(!U)continue;const W=Array.isArray(U.edges)?U.edges:[];let ue=null;if(g&&(ue=new Set(U.nodes.filter(k=>{const te=k==null?void 0:k[Ae];return te==null?!1:j.has(String(te))}).map(k=>k.id)),ue.size===0))continue;let L=ar(W,(at==null?void 0:at.property)||"",z);if(Qe!=="none"){const k=new Map(U.nodes.map(te=>[te.id,te]));Qe==="region"?L=L.filter(te=>{const ge=k.get(te.source),re=k.get(te.target);return ge&&re&&ge.region&&re.region&&ge.region===re.region}):Qe==="division"?L=L.filter(te=>{const ge=k.get(te.source),re=k.get(te.target);return ge&&re&&ge.division&&re.division&&ge.division===re.division}):Qe==="interRegion"?L=L.filter(te=>{const ge=k.get(te.source),re=k.get(te.target);return ge&&re&&ge.region&&re.region&&ge.region!==re.region}):Qe==="interDivision"&&(L=L.filter(te=>{const ge=k.get(te.source),re=k.get(te.target);return ge&&re&&ge.division&&re.division&&ge.division!==re.division}))}ue&&(L=L.filter(k=>ue.has(k.source)&&ue.has(k.target)));const Se=ne==="segmented"?`${Math.max(1,K)} ${Math.max(.5,Ce)}`:null,Me=ne==="segmented"?Math.max(0,qe):0,Te=ne==="segmented"?B:"round";L.filter(k=>k.value>=v&&k.value<=y).sort((k,te)=>te.value-k.value).slice(0,I).map(k=>({...k,_overlayType:C<0?"past":"future",_overlayYear:O,__isOverlay:!0,__displayYear:O,__temporalDelta:C,__overlayStyle:ne,__overlayDash:Se,__overlayDashOffset:Me,__overlayLineCap:Te,__segmentInitialGap:ne==="segmented"?Math.max(0,qe):0,__segmentSpeed:Math.max(.1,xt),__segmentScaleByWeight:ne==="segmented"&&E,__segmentCycle:ne==="segmented"?Math.max(1,K+Ce):0,__segmentAnimate:ne==="segmented"&&$e,__outlineGap:Q})).forEach(k=>{if(Lt.push(k),k._overlayType==="past"){jn=!0;const te=Tt.get(k.source)||0;Tt.set(k.source,te+k.value);const ge=Tt.get(k.target)||0;Tt.set(k.target,ge+k.value)}else{Ot=!0;const te=it.get(k.source)||0;it.set(k.source,te+k.value);const ge=it.get(k.target)||0;it.set(k.target,ge+k.value)}})}}Lt.length>0&&Lt.forEach($=>{ft.add($.source),ft.add($.target)});const lt=(D==="kriskogram"&&H?ee:ee.filter($=>ft.has($.id))).map($=>{const C=kt.get($.id)||0,O=Dt.get($.id)||0,U=ce.get($.id)||0,W=de.get($.id)||0,ue=C-O,L=U-W,Se=he.get($.id)||0,Me=Tt.get($.id)||0,Te=it.get($.id)||0,Ee=Te-Me;return Math.abs(Ee)>yt&&(yt=Math.abs(Ee)),{...$,_totalIncoming:C,_totalOutgoing:O,total_incoming_visible:C,total_outgoing_visible:O,total_incoming_year:U,total_outgoing_year:W,net_flow_visible:ue,net_flow_year:L,self_flow_year:Se,temporal_overlay_past_total:Me,temporal_overlay_future_total:Te,temporal_overlay_delta:Ee,_overlayPastTotal:Me,_overlayFutureTotal:Te,_overlayDelta:Ee}});T?lt.forEach($=>{const C=$._overlayDelta??0;if(yt>0&&C!==0){const O=Math.max(0,Math.min(1,Math.abs(C)/yt));$._overlayStrokeWidth=1.5+O*3,$._overlayStrokeColor=C>0?"hsl(0, 75%, 55%)":"hsl(210, 75%, 55%)"}else yt>0?($._overlayStrokeWidth=1.5,$._overlayStrokeColor="#cbd5f5"):($._overlayStrokeWidth=2,$._overlayStrokeColor="#fff")}):lt.forEach($=>{$._overlayStrokeWidth=2,$._overlayStrokeColor="#fff"});const bt=T?{hasPast:jn,hasFuture:Ot,nodeDeltaAbsMax:yt,style:ne,edgeSegmentLength:K,edgeSegmentGap:Ce,edgeSegmentOffset:qe,edgeSegmentSpeed:xt,edgeSegmentScaleByWeight:E,edgeSegmentCap:B,edgeSegmentAnimate:$e,edgeOutlineGap:Q}:null,Zn=T&&Lt.length>0?[...mt,...Lt]:mt;return{nodes:lt,baseEdges:mt,edges:Zn,currentEdgeCount:mt.length,egoStepMax:Le,temporalOverlay:bt}},[be,v,y,I,z,at,Qe,H,D,F,ae,Re,T,ne,q,pe,K,Ce,qe,xt,E,B,$e,Q,Ae,ye,i]),Je=x.useMemo(()=>{if(!be)return null;const u=be.edges.length,g=be.nodes.length,j=be.edges.reduce((se,ce)=>se+ce.value,0),J=u>0?j/u:0,ee=u>0?Math.max(...be.edges.map(se=>se.value)):0;return{totalNodes:g,totalEdges:u,visibleNodes:G.nodes.length,visibleEdges:G.currentEdgeCount??G.edges.filter(se=>!se._overlayType).length,avgValue:J,maxValue:ee}},[be,G]),tt=(Fe==null?void 0:Fe.min)??0,gn=(Fe==null?void 0:Fe.max)??(Je==null?void 0:Je.maxValue)??tt,nn=Math.max(tt,gn),Er=Math.max(nn,1),Os=Math.max(1,Math.floor(Er/1e3)),qn=(Fe==null?void 0:Fe.maxEdgesCount)??(Je==null?void 0:Je.totalEdges)??0,Kn=Math.max(500,qn),Yn=x.useMemo(()=>{if(!G||G.currentEdgeCount===0)return;const u=G.edges.filter(g=>!g._overlayType);if(u.length!==0)return Math.min(...u.map(g=>g.value))},[G]),$t=x.useMemo(()=>G.nodes.some(u=>u&&u.region),[G]),At=x.useMemo(()=>G.nodes.some(u=>u&&u.division),[G]);x.useEffect(()=>{!$t&&je==="region"&&Et("direction"),!At&&je==="division"&&Et("direction")},[$t,At,je]);const Xn=x.useMemo(()=>{if(!G||G.currentEdgeCount===0)return;const u=G.edges.filter(g=>!g._overlayType);if(u.length!==0)return Math.max(...u.map(g=>g.value))},[G]);x.useEffect(()=>{D==="kriskogram"&&G.nodes.length>0&&Vn.current&&Vn.current.updateData(G.nodes,G.edges)},[G,D]);const Ir=u=>{c(u),ct.current||A({year:u})};return x.useEffect(()=>{ct.current||A({minThreshold:v,maxThreshold:y,maxEdges:I})},[v,y,I]),x.useEffect(()=>{ct.current||A({view:D})},[D]),x.useEffect(()=>{ct.current||A({edgeType:z})},[z]),x.useEffect(()=>{!ct.current&&a&&A({dataset:a})},[a]),x.useEffect(()=>{ct.current},[]),x.useEffect(()=>{be&&F&&(be.nodes.some(g=>g.id===F)||(Z(null),le&&we(!1),A({egoNodeId:null,egoStepColoring:!1})))},[be,F,le,A]),x.useEffect(()=>{if(!i)return;const u=i.timeRange&&typeof i.timeRange.start=="number"&&typeof i.timeRange.end=="number"&&i.timeRange.start!==i.timeRange.end;(!u||!(typeof m=="number"&&u))&&T&&(_e(!1),A({temporalOverlay:!1,temporalOverlayEdgeStyle:ne,temporalOverlayNodeStyle:q,edgeSegmentLength:K,edgeSegmentGap:Ce,edgeSegmentOffset:qe,edgeSegmentCap:B,edgeSegmentAnimate:$e,edgeOutlineGap:Q}))},[i,m,T,ne,q,K,Ce,qe,B,$e,Q,A]),x.useEffect(()=>{ct.current||A({temporalOverlay:T,temporalOverlayYears:pe,temporalOverlayEdgeStyle:ne,temporalOverlayNodeStyle:q,edgeSegmentLength:K,edgeSegmentGap:Ce,edgeSegmentOffset:qe,edgeSegmentCap:B,edgeSegmentAnimate:$e,edgeOutlineGap:Q})},[T,pe,ne,q,K,Ce,qe,B,$e,Q,A]),r.jsx(Ct,{fallback:r.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center",children:r.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-8 max-w-lg mx-4",children:[r.jsx("h2",{className:"text-2xl font-bold text-red-800 mb-4",children:"Explorer Error"}),r.jsx("p",{className:"text-gray-700 mb-4",children:"The explorer page encountered an error. Please refresh the page."}),r.jsx("button",{onClick:()=>window.location.reload(),className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 cursor-pointer transition-colors",children:"Reload Page"})]})}),children:r.jsxs("div",{className:"flex flex-1 h-full overflow-hidden",children:[r.jsxs("main",{className:"flex-1 flex flex-col overflow-hidden h-full relative",children:[h&&r.jsx("div",{className:"p-4 bg-yellow-50 text-yellow-800",children:"Loading…"}),f&&r.jsx("div",{className:"p-4 bg-red-50 text-red-600",children:f}),i?r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"flex-1 flex flex-col overflow-hidden bg-white",children:r.jsx("div",{className:`flex-1 overflow-hidden ${D==="table"?"":"p-4"}`,children:G.nodes.length>0&&G.baseEdges.length>0?r.jsxs(r.Fragment,{children:[D==="kriskogram"&&r.jsx(Ct,{fallback:r.jsxs("div",{className:"p-4 bg-red-50 border border-red-200 rounded-md",children:[r.jsx("h3",{className:"text-lg font-semibold text-red-800 mb-2",children:"Kriskogram Error"}),r.jsx("p",{className:"text-sm text-red-700",children:"The Kriskogram visualization encountered an error."})]}),children:r.jsx("div",{className:"w-full h-full",children:r.jsx(Or,{ref:Vn,nodes:G.nodes,edges:G.edges,width:Math.max(800,Yt.width-(t?64:s)-(Kt?4:Sn)-40),height:Math.max(600,Yt.height-80),margin:{top:60,right:40,bottom:60,left:40},arcOpacity:Dn,title:i.name,accessors:(()=>{const u=G.baseEdges.map(C=>C.value),g=u.length>0?Math.min(...u):0,j=u.length>0?Math.max(...u):1,J=(Fe==null?void 0:Fe.min)??g,ee=(Fe==null?void 0:Fe.max)??j,se=Math.max(ee-J,0),ce=G.egoStepMax??0,de=!!(F&&le&&ce>0),he=C=>{if(ce<=1)return"hsl(210, 80%, 55%)";const O=Math.max(1,Math.min(C,ce)),U=ce<=1?0:(O-1)/(ce-1),W=210-U*150,ue=60-U*20;return`hsl(${Math.round(W)}, 80%, ${Math.round(ue)}%)`},Oe=C=>{if(!Number.isFinite(C)||se<=0)return 0;const U=Math.min(Math.max(C,J),ee)-J;switch(Re){case"sqrt":{const W=Math.sqrt(se);return W<=0?0:Math.max(0,Math.min(1,Math.sqrt(U)/W))}case"log":{const W=Math.log10(se+1);return!Number.isFinite(W)||W<=0?0:Math.max(0,Math.min(1,Math.log10(U+1)/W))}case"linear":default:{const W=se;return W<=0?0:Math.max(0,Math.min(1,U/W))}}},Ge=G.nodes.map(C=>C.total_outgoing_visible||C._totalOutgoing||0),Pe=G.nodes.map(C=>C.total_incoming_visible||C._totalIncoming||0),Ve=G.nodes.map(C=>C.total_outgoing_year||0),ke=G.nodes.map(C=>C.total_incoming_year||0),me=G.nodes.map(C=>C.net_flow_visible||0),Le=G.nodes.map(C=>C.net_flow_year||0),gt=Ge.length>0?Math.max(...Ge):1,nt=Pe.length>0?Math.max(...Pe):1,Pt=Ve.length>0?Math.max(...Ve):1,Vt=ke.length>0?Math.max(...ke):1,mt=me.length>0?Math.max(...me.map(C=>Math.abs(C))):1,ft=Le.length>0?Math.max(...Le.map(C=>Math.abs(C))):1,kt=(en==null?void 0:en.maxOutgoing)??Pt,Dt=(en==null?void 0:en.maxIncoming)??Vt,Lt=(Jt==null?void 0:Jt.min)??-ft,Tt=(Jt==null?void 0:Jt.max)??ft,it=Math.max(Math.abs(Lt),Math.abs(Tt))||1,yt=(C,O,U)=>{const W=Array.from(new Set(G.nodes.map(L=>L[C]).filter(L=>L!=null))),ue=new Map;return W.forEach((L,Se)=>{ue.set(L,U[Se%U.length])}),ue.get(O)||U[0]},jn=["#3b82f6","#f59e0b","#ef4444","#10b981","#8b5cf6","#ec4899","#14b8a6","#f97316"],Ot=G.temporalOverlay,mn=!!Ot,zs=ne,lt=q==="outline",bt=(Ot==null?void 0:Ot.nodeDeltaAbsMax)??0,Zn=C=>{if(C===0)return"#6b7280";const O=Math.max(-bt,Math.min(bt,C)),W=65-(bt>0?Math.abs(O)/bt:.5)*20;return C<0?`hsl(210, 75%, ${Math.round(W)}%)`:`hsl(0, 75%, ${Math.round(W)}%)`},$=C=>{var ue;const O=(L,Se)=>!Number.isFinite(L)||Se<=0?0:Math.max(0,Math.min(1,L/Se)),U=(L,Se,Me)=>{const Ee=85-Math.max(0,Math.min(1,Me))*45;return`hsl(${L}, ${Se}%, ${Ee}%)`},W=L=>{if(!Number.isFinite(L)||it<=0)return"#6b7280";if(Math.abs(L)<1e-6)return"#9ca3af";const Me=85-Math.max(0,Math.min(1,Math.abs(L)/it))*45;return L>=0?`hsl(0, 75%, ${Me}%)`:`hsl(210, 75%, ${Me}%)`};switch(Gn){case"single":return"#2563eb";case"outgoing":case"visible_outgoing":{const L=O(C.total_outgoing_visible||C._totalOutgoing||0,gt);return U(24,85,L)}case"incoming":case"visible_incoming":{const L=O(C.total_incoming_visible||C._totalIncoming||0,nt);return U(160,70,L)}case"year_outgoing":{const L=O(C.total_outgoing_year||0,kt);return U(24,85,L)}case"year_incoming":{const L=O(C.total_incoming_year||0,Dt);return U(160,70,L)}case"net_year":return W(C.net_flow_year||0);case"self_year":{const L=O(C.self_flow_year||0,(tn==null?void 0:tn.max)??0);return U(280,70,L)}case"attribute":{if(!Zt)return"#2563eb";const L=C[Zt];if(L==null)return"#9ca3af";if((ue=i==null?void 0:i.metadata)!=null&&ue.hasNumericProperties.nodes.includes(Zt)){const Se=G.nodes.map(ge=>ge[Zt]).filter(ge=>typeof ge=="number");if(Se.length===0)return"#2563eb";const Me=Math.min(...Se),Ee=Math.max(...Se)-Me||1,k=(Number(L)-Me)/Ee;return`hsl(${120-Math.max(0,Math.min(1,k))*120}, 70%, 50%)`}return yt(Zt,L,jn)}default:return"#2563eb"}};return{nodeOrder:C=>{if(kn==="alphabetical")return C.label||C.id;const O=C[kn];return O==null?`ZZZ_${C.label||C.id}`:typeof O=="number"?`${String(1e6-O).padStart(10,"0")}_${C.label||C.id}`:`${String(O)}_${C.label||C.id}`},nodeColor:C=>{const O=$(C);return C.__baseFillColor=O,lt?"transparent":O},nodeRadius:C=>{const O=C.total_outgoing_visible||C._totalOutgoing||0,U=C.total_incoming_visible||C._totalIncoming||0,W=C.total_outgoing_year||0,ue=C.total_incoming_year||0,L=Math.abs(C.net_flow_visible||0),Se=Math.abs(C.net_flow_year||0),Me=C.self_flow_year||0,Te=Ee=>3+Math.max(0,Math.min(1,Ee))*9;if(Xe==="fixed")return 6;if(Xe==="visible_outgoing"||Xe==="outgoing")return Te(gt>0?O/gt:0);if(Xe==="visible_incoming"||Xe==="incoming")return Te(nt>0?U/nt:0);if(Xe==="year_outgoing")return Te(kt>0?W/kt:0);if(Xe==="year_incoming")return Te(Dt>0?ue/Dt:0);if(Xe==="net_visible"){const Ee=mt>0?mt:1;return Te(L/Ee)}if(Xe==="net_year"){const Ee=it>0?it:1;return Te(Se/Ee)}if(Xe==="self_year"){const Ee=(tn==null?void 0:tn.max)??0,k=Ee>0?Me/Ee:0;return Te(k)}if(Xe==="attribute"&&Cn){const Ee=C[Cn];if(typeof Ee!="number")return 6;const k=G.nodes.map(St=>St[Cn]).filter(St=>typeof St=="number");if(k.length===0)return 6;const te=Math.min(...k),re=Math.max(...k)-te||1,st=(Ee-te)/re;return Te(st)}return 6},edgeWidth:C=>{const O=(C==null?void 0:C.__overlayStyle)??zs,U=Oe(C.value),W=Ft==="weight"?.5+U*(O==="segmented"?12:15):It;return O==="outline"?Math.max(2.5,It):O==="segmented"?Ft==="weight"?W:Math.max(It,2):W},edgeColor:(C,O)=>{var Te,Ee;const U=C==null?void 0:C.__temporalDelta;if(mn&&U)return Zn(U);if(de){const k=(C==null?void 0:C._egoStep)??0;if(k>0)return he(k)}const W=Oe(C.value),ue=["#3b82f6","#f59e0b","#ef4444","#10b981","#8b5cf6","#ec4899","#14b8a6","#f97316"];if(!un&&je==="direction")return O?"#1f77b4":"#d62728";let L="#2563eb";if(je==="direction")L=O?"#1f77b4":"#d62728";else if(je==="region"){const k=G.nodes.find(re=>re.id===C.source),te=Array.from(new Set(G.nodes.map(re=>re.region).filter(Boolean))),ge=new Map(te.map((re,st)=>[re,ue[st%ue.length]]));L=k&&k.region&&ge.get(k.region)||"#2563eb"}else if(je==="division"){const k=G.nodes.find(re=>re.id===C.source),te=Array.from(new Set(G.nodes.map(re=>re.division).filter(Boolean))),ge=new Map(te.map((re,st)=>[re,ue[st%ue.length]]));L=k&&k.division&&ge.get(k.division)||"#2563eb"}else if(je==="attribute"&&Xt){const k=C[Xt];if(k!=null)if((Te=i==null?void 0:i.metadata)!=null&&Te.hasNumericProperties.edges.includes(Xt)){const te=G.baseEdges.map(Qn=>Qn[Xt]).filter(Qn=>typeof Qn=="number"),ge=Math.min(...te),st=Math.max(...te)-ge||1;L=`hsl(${120-(Number(k)-ge)/st*120}, 70%, 50%)`}else{const te=Array.from(new Set(G.baseEdges.map(re=>re[Xt]).filter(re=>re!=null)));L=new Map(te.map((re,st)=>[re,ue[st%ue.length]])).get(k)||"#2563eb"}}else je==="single"&&(L="#2563eb");let Se=.6;if(vt==="weight")Se=Math.max(0,Math.min(1,W));else if(vt==="attribute"&&dn){const k=C[dn];if(k!=null&&((Ee=i==null?void 0:i.metadata)!=null&&Ee.hasNumericProperties.edges.includes(dn))){const te=G.baseEdges.map(St=>St[dn]).filter(St=>typeof St=="number"),ge=Math.min(...te),st=Math.max(...te)-ge||1;Se=Math.max(0,Math.min(1,(Number(k)-ge)/st))}}else vt==="constant"&&(Se=Math.max(0,Math.min(1,On)));if(Hn&&(je==="region"||je==="division")){const k=G.nodes.find(re=>re.id===C.source),te=G.nodes.find(re=>re.id===C.target);if(!(je==="region"?(k==null?void 0:k.region)&&k.region===(te==null?void 0:te.region):(k==null?void 0:k.division)&&k.division===(te==null?void 0:te.division)))return`hsl(0, 0%, ${80-Se*50}%)`}const Me=80-Se*55;return je==="direction"?`hsl(${O?0:200}, 70%, ${Math.round(Me)}%)`:je==="single"?`hsl(210, 70%, ${Math.round(Me)}%)`:L},nodeStroke:C=>{const O=C.temporal_overlay_delta??0,U=C.__baseFillColor??$(C);if(!mn||bt<=0)return{color:lt?U:"#fff",width:lt?2.5:2};if(!O)return{color:lt?U:"#d1d5db",width:lt?2.5:1.5};const W=Math.min(1,Math.abs(O)/bt);if(lt){const Me=2.5+W*1.5;return{color:U,width:Me}}const ue=O>=0?0:210,L=70-W*25,Se=2+W*2;return{color:`hsl(${Math.round(ue)}, 75%, ${Math.round(L)}%)`,width:Se}}}})(),legend:(()=>{const u=G.temporalOverlay;if(u&&(u.hasPast||u.hasFuture)){const Pe=[];return u.hasPast&&Pe.push({label:"Past years",color:"hsl(210, 75%, 55%)"}),u.hasFuture&&Pe.push({label:"Future years",color:"hsl(0, 75%, 55%)"}),{type:"temporalOverlay",entries:Pe}}const g=G.egoStepMax??0;if(!!(F&&le&&g>0)){const Pe=ke=>{if(g<=1)return"hsl(210, 80%, 55%)";const me=Math.max(1,Math.min(ke,g)),Le=g<=1?0:(me-1)/(g-1),gt=210-Le*150,nt=60-Le*20;return`hsl(${Math.round(gt)}, 80%, ${Math.round(nt)}%)`};return{type:"egoSteps",entries:Array.from({length:g},(ke,me)=>({step:me+1,color:Pe(me+1)}))}}const J=G.baseEdges.map(Pe=>Pe.value),ee=J.length>0?Math.min(...J):0,se=J.length>0?Math.max(...J):1,ce=(Fe==null?void 0:Fe.min)??ee,de=(Fe==null?void 0:Fe.max)??se,he=Math.max(de-ce,0),Oe=Pe=>{if(!Number.isFinite(Pe)||he<=0)return 0;const ke=Math.min(Math.max(Pe,ce),de)-ce;switch(Re){case"sqrt":{const me=Math.sqrt(he);return me<=0?0:Math.max(0,Math.min(1,Math.sqrt(ke)/me))}case"log":{const me=Math.log10(he+1);return!Number.isFinite(me)||me<=0?0:Math.max(0,Math.min(1,Math.log10(ke+1)/me))}case"linear":default:return he<=0?0:Math.max(0,Math.min(1,ke/he))}},Ge=Pe=>{if(he<=0)return ce;const Ve=Math.max(0,Math.min(1,Pe));switch(Re){case"sqrt":return ce+Math.pow(Ve,2)*he;case"log":{const ke=Math.log10(he+1);if(!Number.isFinite(ke)||ke<=0)return ce;const me=Math.pow(10,Ve*ke)-1;return ce+me}case"linear":default:return ce+Ve*he}};if(un){if(je==="region"&&$t){const Pe=Array.from(new Set(G.nodes.map(me=>me.region).filter(Boolean))),Ve=["#3b82f6","#f59e0b","#ef4444","#10b981","#8b5cf6","#ec4899","#14b8a6","#f97316"];return{type:"categorical",title:"Regions",entries:Pe.slice(0,10).map((me,Le)=>({label:me,color:Ve[Le%Ve.length]})),interNote:Hn?"Inter edges: grayscale by intensity":void 0}}if(je==="division"&&At){const Pe=Array.from(new Set(G.nodes.map(me=>me.division).filter(Boolean))),Ve=["#3b82f6","#f59e0b","#ef4444","#10b981","#8b5cf6","#ec4899","#14b8a6","#f97316"];return{type:"categorical",title:"Divisions",entries:Pe.slice(0,10).map((me,Le)=>({label:me,color:Ve[Le%Ve.length]})),interNote:Hn?"Inter edges: grayscale by intensity":void 0}}if(je==="single"&&vt==="weight"){const Ve=[0,.5,1].map(ke=>{const me=Ge(ke),Le=Oe(me),nt=80-Le*55,Pt=`hsl(210, 70%, ${Math.round(nt)}%)`,Vt=Ft==="weight"?.5+Le*15:It;return{fraction:Le,value:me,color:Pt,width:Vt}});return{type:"weight",color:"#1f77b4",scale:Re,min:ce,max:de,samples:Ve}}}else{if(je==="direction")return{type:"direction"};if(je==="single"&&vt==="weight"){const Ve=[0,.5,1].map(ke=>{const me=Ge(ke),Le=Oe(me),nt=80-Le*55,Pt=`hsl(210, 70%, ${Math.round(nt)}%)`,Vt=Ft==="weight"?.5+Le*15:It;return{fraction:Le,value:me,color:Pt,width:Vt}});return{type:"weight",color:"#1f77b4",scale:Re,min:ce,max:de,samples:Ve}}}})(),lens:{enabled:Qt==="lens",x:Ls.x,y:Ls.y,radius:ks},onMouseMoveInCanvas:u=>{Qt==="lens"&&Ts(u)},onWheelInCanvas:u=>{Qt==="lens"&&Ds(g=>{const j=Math.max(20,Math.min(300,g+(u>0?-10:10)));return A({lensRadius:j}),j})}})})}),D==="table"&&r.jsx(Ct,{fallback:r.jsxs("div",{className:"p-4 bg-red-50 border border-red-200 rounded-md",children:[r.jsx("h3",{className:"text-lg font-semibold text-red-800 mb-2",children:"Table View Error"}),r.jsx("p",{className:"text-sm text-red-700",children:"The table view encountered an error."})]}),children:r.jsx("div",{className:"h-full w-full flex flex-col min-h-0",children:r.jsx(Nr,{nodes:G.nodes,edges:G.baseEdges})})}),D==="sankey"&&r.jsx(Ct,{fallback:r.jsxs("div",{className:"p-4 bg-red-50 border border-red-200 rounded-md",children:[r.jsx("h3",{className:"text-lg font-semibold text-red-800 mb-2",children:"Sankey Diagram Error"}),r.jsx("p",{className:"text-sm text-red-700",children:"The Sankey diagram encountered an error."})]}),children:r.jsx("div",{className:"h-full min-h-0",children:r.jsx(qa,{nodes:G.nodes,edges:G.baseEdges,width:Math.max(800,Yt.width-(t?64:s)-(Kt?4:Sn)-40),height:Math.max(600,Yt.height-80)})})}),D==="chord"&&r.jsx(Ct,{fallback:r.jsxs("div",{className:"p-4 bg-red-50 border border-red-200 rounded-md",children:[r.jsx("h3",{className:"text-lg font-semibold text-red-800 mb-2",children:"Chord Diagram Error"}),r.jsx("p",{className:"text-sm text-red-700",children:"The chord diagram encountered an error."})]}),children:r.jsx(Xa,{nodes:G.nodes,edges:G.baseEdges,width:Math.max(800,Yt.width-(t?64:s)-(Kt?4:Sn)-40),height:Math.max(600,Yt.height-80)})})]}):be?r.jsxs("div",{className:"text-center text-gray-500 py-8",children:["No data meets the current threshold range (",v.toLocaleString()," - ",y.toLocaleString(),"). Try adjusting the filters."]}):r.jsx("div",{className:"px-6 py-8 text-center text-gray-600 space-y-3",children:typeof m=="number"&&lr[m]?r.jsxs(r.Fragment,{children:[r.jsxs("p",{className:"text-lg font-semibold text-gray-700",children:["No state-to-state migration snapshot for ",m]}),r.jsx("p",{className:"text-sm leading-relaxed",children:lr[m]})]}):r.jsx("p",{children:"No snapshot to display."})})})}),D==="kriskogram"&&r.jsxs("div",{className:"absolute bottom-4 right-4 flex items-center gap-2 bg-white/90 backdrop-blur px-3 py-2 rounded shadow border border-gray-200",children:[r.jsx("label",{className:"text-xs font-medium text-gray-700",children:"Mode:"}),r.jsx("button",{type:"button",onClick:()=>{Wn("pan"),A({interactionMode:"pan"})},className:["text-xs px-2 py-1 rounded border",Qt==="pan"?"bg-blue-600 text-white border-blue-600":"bg-white text-gray-700 border-gray-300"].join(" "),children:"Pan"}),r.jsx("button",{type:"button",onClick:()=>{Wn("lens"),A({interactionMode:"lens"})},className:["text-xs px-2 py-1 rounded border",Qt==="lens"?"bg-blue-600 text-white border-blue-600":"bg-white text-gray-700 border-gray-300"].join(" "),children:"Edge Lens"}),Qt==="lens"&&r.jsxs("span",{className:"text-[10px] text-gray-600",children:["Wheel: radius (",ks,"px)"]})]})]}):r.jsx("div",{className:"flex-1 flex items-center justify-center text-gray-500",children:r.jsxs("div",{className:"text-center",children:[r.jsx("p",{className:"text-lg mb-2",children:"No dataset selected"}),r.jsx("p",{className:"text-sm",children:"Select a dataset from the sidebar to begin exploring"})]})})]}),i&&r.jsx(ei,{isCollapsed:Kt,onToggle:()=>Mr(!Kt),onResize:Rr,title:"Visualization Settings",bottomContent:r.jsxs("div",{className:"p-3",children:[r.jsx("label",{className:"text-xs font-medium text-gray-600 block mb-2",children:"Visualization Type"}),r.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[r.jsx("button",{onClick:()=>{oe("kriskogram"),A({view:"kriskogram"})},className:`px-3 py-2.5 rounded text-sm font-medium transition-colors ${D==="kriskogram"?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"Kriskogram"}),r.jsx("button",{onClick:()=>{oe("table"),A({view:"table"})},className:`px-3 py-2.5 rounded text-sm font-medium transition-colors ${D==="table"?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"Table"}),r.jsx("button",{onClick:()=>{oe("sankey"),A({view:"sankey"})},className:`px-3 py-2.5 rounded text-sm font-medium transition-colors ${D==="sankey"?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"Sankey"}),r.jsx("button",{onClick:()=>{oe("chord"),A({view:"chord"})},className:`px-3 py-2.5 rounded text-sm font-medium transition-colors ${D==="chord"?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"Chord"})]})]}),children:r.jsxs("div",{className:"space-y-4",children:[r.jsxs(rn,{title:i.name,defaultOpen:!0,subtitle:`${i.type.toUpperCase()} · ${i.timeRange.start}${i.timeRange.end!==i.timeRange.start?`–${i.timeRange.end}`:""}`,children:[i.notes&&r.jsx("div",{className:"text-xs text-gray-600 mt-2 whitespace-pre-wrap",children:i.notes}),!i.notes&&r.jsx("div",{className:"text-xs text-gray-500 italic mt-2",children:"No description available"})]}),Je&&r.jsxs("div",{className:"p-3 bg-gray-50 rounded grid grid-cols-2 gap-3 text-sm",children:[r.jsxs("div",{children:[r.jsx("div",{className:"text-xs text-gray-600",children:"Nodes"}),r.jsxs("div",{className:"text-lg font-bold",children:[Je.visibleNodes,"/",Je.totalNodes]})]}),r.jsxs("div",{children:[r.jsx("div",{className:"text-xs text-gray-600",children:"Edges"}),r.jsxs("div",{className:"text-lg font-bold",children:[Je.visibleEdges.toLocaleString(),"/",Je.totalEdges.toLocaleString()]})]})]}),r.jsx(rn,{title:"General Settings",defaultOpen:!0,onReset:()=>{const u=Math.max(1,qn);P(null),$s("none"),dt(null),Ne([]),b(tt),N(gn),M(u),A({edgeType:null,intraFilter:"none",nodeFilterAttribute:null,nodeFilterValues:[],minThreshold:tt,maxThreshold:gn,maxEdges:u})},children:r.jsxs("div",{className:"space-y-4",children:[Fr&&m!==void 0&&r.jsxs("div",{className:"space-y-2",children:[r.jsxs("label",{className:"text-sm font-medium",children:["Year: ",m]}),r.jsx("input",{type:"range",min:i.timeRange.start,max:i.timeRange.end,value:m,onChange:u=>Ir(parseInt(u.target.value)),className:"w-full"})]}),at&&r.jsxs("div",{className:"space-y-2",children:[r.jsxs("label",{className:"text-sm font-medium",children:["Edge Type (",at.property,")"]}),r.jsxs("select",{value:z||"all",onChange:u=>{const g=u.target.value==="all"?null:u.target.value;P(g),A({edgeType:g})},className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[r.jsx("option",{value:"all",children:"All Types"}),at.values.map(u=>r.jsx("option",{value:u,children:u},u))]})]}),($t||At)&&r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-sm font-medium",children:"Edge Scope"}),r.jsxs("select",{value:Qe,onChange:u=>{const g=u.target.value;$s(g),A({intraFilter:g})},className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[r.jsx("option",{value:"none",children:"All"}),$t&&r.jsx("option",{value:"region",children:"Intra Region"}),At&&r.jsx("option",{value:"division",children:"Intra Division"}),$t&&r.jsx("option",{value:"interRegion",children:"Inter Region"}),At&&r.jsx("option",{value:"interDivision",children:"Inter Division"})]})]}),Nn.length>0&&r.jsxs("div",{className:"space-y-2",children:[r.jsx("label",{className:"text-sm font-medium",children:"Node Filter"}),r.jsxs("select",{value:Ae??"",onChange:u=>{const g=u.target.value||null;dt(g),Ne([]),A({nodeFilterAttribute:g,nodeFilterValues:[]})},className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[r.jsx("option",{value:"",children:"All nodes"}),Nn.map(u=>r.jsx("option",{value:u,children:u},u))]}),Ae&&(cn.length>0?r.jsxs("div",{className:"space-y-2",children:[r.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-600",children:[r.jsx("button",{type:"button",className:"rounded px-2 py-1 hover:bg-gray-100",onClick:()=>{const u=[...cn];Ne(u),A({nodeFilterValues:u})},children:"Select all"}),r.jsx("button",{type:"button",className:"rounded px-2 py-1 hover:bg-gray-100",onClick:()=>{Ne([]),A({nodeFilterValues:[]})},children:"Clear"})]}),r.jsx("div",{className:"max-h-48 overflow-y-auto rounded-md border border-gray-200 divide-y divide-gray-100",children:cn.map(u=>{const g=ye.includes(u);return r.jsxs("label",{className:"flex items-center gap-2 px-3 py-2 text-sm cursor-pointer hover:bg-gray-50",children:[r.jsx("input",{type:"checkbox",className:"h-3.5 w-3.5",checked:g,onChange:j=>{const J=j.target.checked?Array.from(new Set([...ye,u])).sort((ee,se)=>ee.localeCompare(se)):ye.filter(ee=>ee!==u);Ne(J),A({nodeFilterValues:J})}}),r.jsx("span",{children:u})]},u)})}),ye.length===0&&r.jsxs("p",{className:"text-xs text-gray-500",children:["No specific values selected. All nodes for ",Ae," remain visible."]})]}):r.jsxs("p",{className:"text-xs text-gray-500 italic",children:["No values available for ",Ae," in this snapshot."]}))]}),be&&Je&&r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("label",{className:"text-sm font-medium flex items-center gap-2",children:[r.jsxs("span",{children:["Min: ",v.toLocaleString()]}),Yn!==void 0&&Yn>v&&r.jsxs("span",{className:"text-xs text-gray-400",children:["(actual ",Yn.toLocaleString(),")"]})]}),(()=>{const u=Math.max(1,qn),g=v>tt||y<gn||I<u;return r.jsx("button",{onClick:()=>{b(tt),N(gn),M(u)},disabled:!g,type:"button",className:`text-xs transition-colors ${g?"text-blue-600 hover:text-blue-800":"text-gray-400 cursor-not-allowed"}`,children:"Show All"})})()]}),r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("input",{type:"range",min:tt,max:nn||1,step:Os,value:v,onChange:u=>{const g=parseInt(u.target.value),j=Math.min(g,y);b(j),A({minThreshold:j})},className:"w-full"}),r.jsx("input",{type:"number",min:tt,max:nn||1,value:v,onChange:u=>{const g=Number.parseInt(u.target.value);if(Number.isNaN(g))return;const j=Math.max(tt,Math.min(g,y));b(j),A({minThreshold:j})},className:"w-24 px-2 py-1 text-sm border border-gray-300 rounded-md"})]})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsxs("label",{className:"text-sm font-medium flex items-center gap-2",children:[r.jsxs("span",{children:["Max: ",y.toLocaleString()]}),Xn!==void 0&&Xn<y&&r.jsxs("span",{className:"text-xs text-gray-400",children:["(actual ",Xn.toLocaleString(),")"]})]}),r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("input",{type:"range",min:tt,max:nn||1,step:Os,value:y,onChange:u=>{const g=parseInt(u.target.value),j=Math.max(g,v);N(j),A({maxThreshold:j})},className:"w-full"}),r.jsx("input",{type:"number",min:tt,max:nn||1,value:y,onChange:u=>{const g=Number.parseInt(u.target.value);if(Number.isNaN(g))return;const j=Math.min(nn||1,Math.max(g,v));N(j),A({maxThreshold:j})},className:"w-24 px-2 py-1 text-sm border border-gray-300 rounded-md"})]})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsxs("label",{className:"text-sm font-medium",children:["Max Edges: ",I]}),r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("input",{type:"range",min:10,max:Kn,step:10,value:I,onChange:u=>{const g=parseInt(u.target.value);M(g),A({maxEdges:g})},className:"w-full"}),r.jsx("input",{type:"number",min:1,max:Kn,value:I,onChange:u=>{const g=Number.parseInt(u.target.value);if(Number.isNaN(g))return;const j=Math.max(1,Math.min(g,Kn));M(j),A({maxEdges:j})},className:"w-24 px-2 py-1 text-sm border border-gray-300 rounded-md"})]}),r.jsxs("p",{className:"text-xs text-gray-600 italic",children:["After filtering by thresholds and edge type, edges are sorted by value (highest first) and the top ",I," edges are displayed."]})]})]})]})}),D==="kriskogram"&&r.jsx(rn,{title:"Kriskogram Settings",defaultOpen:!0,onReset:()=>{ie(!1),Rs("alphabetical"),Fs(.85),Ln("weight"),As(2),Ps("single"),Bn(null),Vs("fixed"),Un(null),Es(!1),Et("direction"),wn(null),Is(!0),Tn("weight"),_n(null),zn(.6),Wn("pan"),Ds(80),Ts({x:0,y:0}),Z(null),xe(1),we(!1),R("linear"),_e(!1),Ye("filled"),De("filled"),ot(1),He(8),We(4),yn(15),bn(1),V(!1),ve("round"),qt(!1),fe(3),A({showAllNodes:!1,nodeOrderMode:"alphabetical",arcOpacity:.85,edgeWidthMode:"weight",baseEdgeWidth:2,nodeColorMode:"single",nodeColorAttribute:null,nodeSizeMode:"fixed",nodeSizeAttribute:null,edgeColorAdvanced:!1,edgeColorHue:"direction",edgeColorHueAttribute:null,edgeColorInterGrayscale:!0,edgeColorIntensity:"weight",edgeColorIntensityAttribute:null,edgeColorIntensityConst:.6,interactionMode:"pan",lensRadius:80,egoNodeId:null,egoNeighborSteps:1,egoStepColoring:!1,temporalOverlay:!1,temporalOverlayYears:1,temporalOverlayEdgeStyle:"filled",temporalOverlayNodeStyle:"filled",edgeSegmentLength:8,edgeSegmentGap:4,edgeSegmentOffset:15,edgeSegmentSpeed:1,edgeSegmentScaleByWeight:!1,edgeSegmentCap:"round",edgeSegmentAnimate:!1,edgeWeightScale:"linear",edgeOutlineGap:3})},children:i!=null&&i.metadata?r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{className:"flex items-center justify-between p-2 bg-gray-50 rounded border border-gray-200",children:[r.jsxs("div",{children:[r.jsx("label",{htmlFor:"kriskogram-show-all-nodes",className:"text-sm font-medium text-gray-700",children:"Always show all nodes"}),r.jsx("p",{className:"text-xs text-gray-500",children:"Keeps every location visible even if its edges fall outside the filters."})]}),r.jsx("input",{id:"kriskogram-show-all-nodes",type:"checkbox",className:"w-4 h-4",checked:H,onChange:u=>{const g=u.target.checked;ie(g),A({showAllNodes:g})}})]}),r.jsxs("div",{className:"space-y-3 border border-gray-200 rounded-md p-3",children:[r.jsx("div",{className:"text-xs font-semibold text-gray-600 uppercase tracking-wide",children:"Ego Focus"}),r.jsxs("div",{children:[r.jsx("label",{htmlFor:"kriskogram-ego-node",className:"text-xs font-medium text-gray-700",children:"Ego focus (optional)"}),r.jsxs("select",{id:"kriskogram-ego-node",value:F??"",onChange:u=>{const g=u.target.value,j=g===""?null:g;j===null?(Z(null),le&&we(!1),A({egoNodeId:null,egoStepColoring:!1})):(Z(j),A({egoNodeId:j}))},className:"mt-1 w-full px-2 py-1.5 text-xs border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[r.jsx("option",{value:"",children:"No ego focus (show all eligible edges)"}),((be==null?void 0:be.nodes)??[]).map(u=>r.jsx("option",{value:u.id,children:u.label||u.id},u.id))]}),r.jsx("p",{className:"mt-1 text-[11px] text-gray-500",children:"Limit the visualization to flows centered on a selected node."})]}),r.jsxs("div",{children:[r.jsx("label",{htmlFor:"kriskogram-ego-steps",className:"text-xs font-medium text-gray-700",children:"Neighbor steps"}),r.jsxs("div",{className:"mt-1 flex items-center gap-2",children:[r.jsx("input",{id:"kriskogram-ego-steps",type:"number",min:1,max:10,value:ae,disabled:!F,onChange:u=>{const g=Number.parseInt(u.target.value,10);if(Number.isNaN(g))return;const j=Math.max(1,Math.min(g,10));xe(j),A({egoNeighborSteps:j})},className:"w-20 px-2 py-1 text-xs border border-gray-300 rounded-md disabled:bg-gray-100 disabled:text-gray-500"}),r.jsx("span",{className:"text-[11px] text-gray-500",children:"How many hops from the ego node to include (based on currently visible edges)."})]})]}),r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("label",{htmlFor:"kriskogram-ego-step-coloring",className:"text-xs font-medium text-gray-700",children:"Color edges by neighbor step"}),r.jsx("p",{className:"text-[11px] text-gray-500",children:"Apply a step-based gradient for ego flows and show it in the legend."})]}),r.jsx("input",{id:"kriskogram-ego-step-coloring",type:"checkbox",className:"w-4 h-4",disabled:!F,checked:le&&!!F,onChange:u=>{const g=u.target.checked&&!!F;we(g),A({egoStepColoring:g})}})]}),r.jsx("p",{className:"text-[11px] text-gray-500",children:"Edge and node styling options are available in the sections below."})]}),r.jsxs("div",{className:"space-y-3 border border-gray-200 rounded-md p-3",children:[r.jsx("div",{className:"text-xs font-semibold text-gray-600 uppercase tracking-wide",children:"Temporal Overlay"}),r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("label",{className:"text-xs font-medium text-gray-700",htmlFor:"kriskogram-temporal-overlay",children:"Show neighboring years"}),r.jsx("p",{className:"text-[11px] text-gray-500",children:"Overlay edges from nearby years to compare past and future flows."})]}),r.jsx("input",{id:"kriskogram-temporal-overlay",type:"checkbox",className:"w-4 h-4",disabled:!i||i.timeRange.start===i.timeRange.end||typeof m!="number",checked:T&&(i==null?void 0:i.timeRange.start)!==(i==null?void 0:i.timeRange.end),onChange:u=>{const g=u.target.checked;_e(g),A({temporalOverlay:g})}})]}),r.jsxs("div",{children:[r.jsx("label",{className:"text-xs font-medium text-gray-700",htmlFor:"kriskogram-temporal-overlay-years",children:"Neighbor years"}),r.jsxs("div",{className:"mt-1 flex items-center gap-2",children:[r.jsx("input",{id:"kriskogram-temporal-overlay-years",type:"number",min:1,max:10,value:pe,disabled:!T,onChange:u=>{const g=Number.parseInt(u.target.value,10);if(Number.isNaN(g))return;const j=Math.max(1,Math.min(g,10));ot(j),A({temporalOverlayYears:j})},className:"w-20 px-2 py-1 text-xs border border-gray-300 rounded-md disabled:bg-gray-100 disabled:text-gray-500"}),r.jsx("span",{className:"text-[11px] text-gray-500",children:"Include the selected number of years before and after the current year."})]}),(!i||i.timeRange.start===i.timeRange.end)&&r.jsx("p",{className:"mt-2 text-[11px] text-gray-400 italic",children:"Temporal overlay is unavailable because this dataset has a single year."})]})]}),r.jsxs("div",{className:"space-y-3 border border-gray-200 rounded-md p-3",children:[r.jsx("div",{className:"text-xs font-semibold text-gray-600 uppercase tracking-wide",children:"Node"}),r.jsxs("div",{className:"space-y-2",children:[r.jsx("label",{className:"text-xs font-medium text-gray-700",children:"Node Ordering"}),r.jsxs("select",{value:kn,onChange:u=>{const g=u.target.value;Rs(g),A({nodeOrderMode:g})},className:"w-full px-2 py-1.5 text-xs border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[r.jsx("option",{value:"alphabetical",children:"Alphabetical"}),i.metadata.hasCategoricalProperties.nodes.map(u=>r.jsxs("option",{value:u,children:["By ",u]},u)),i.metadata.hasNumericProperties.nodes.map(u=>r.jsxs("option",{value:u,children:["By ",u]},u))]})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx("label",{className:"text-xs font-medium text-gray-700",children:"Node Color"}),r.jsxs("select",{value:Gn,onChange:u=>{const g=u.target.value;Ps(g);const j={nodeColorMode:g};g!=="attribute"&&(Bn(null),j.nodeColorAttribute=null),A(j)},className:"w-full px-2 py-1.5 text-xs border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[r.jsx("option",{value:"single",children:"Single Color"}),r.jsx("option",{value:"visible_outgoing",children:"Visible Outgoing Flow"}),r.jsx("option",{value:"visible_incoming",children:"Visible Incoming Flow"}),r.jsx("option",{value:"year_outgoing",children:"Year Outgoing Flow"}),r.jsx("option",{value:"year_incoming",children:"Year Incoming Flow"}),r.jsx("option",{value:"net_year",children:"Net Flow (year)"}),r.jsx("option",{value:"self_year",children:"Self Flow (year)"}),r.jsx("option",{value:"attribute",children:"By Attribute"})]}),Gn==="attribute"&&r.jsxs("select",{value:Zt||"",onChange:u=>{const g=u.target.value||null;Bn(g),A({nodeColorAttribute:g})},className:"w-full px-2 py-1.5 text-xs border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[r.jsx("option",{value:"",children:"Select..."}),i.metadata.hasCategoricalProperties.nodes.map(u=>r.jsx("option",{value:u,children:u},u)),i.metadata.hasNumericProperties.nodes.map(u=>r.jsx("option",{value:u,children:u},u))]})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx("label",{className:"text-xs font-medium text-gray-700",children:"Node Size"}),r.jsxs("select",{value:Xe,onChange:u=>{const g=u.target.value;Vs(g);const j={nodeSizeMode:g};g!=="attribute"&&(Un(null),j.nodeSizeAttribute=null),A(j)},className:"w-full px-2 py-1.5 text-xs border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[r.jsx("option",{value:"fixed",children:"Fixed"}),r.jsx("option",{value:"visible_outgoing",children:"Visible Outgoing Flow"}),r.jsx("option",{value:"visible_incoming",children:"Visible Incoming Flow"}),r.jsx("option",{value:"year_outgoing",children:"Year Outgoing Flow"}),r.jsx("option",{value:"year_incoming",children:"Year Incoming Flow"}),r.jsx("option",{value:"net_visible",children:"Net Flow (visible)"}),r.jsx("option",{value:"net_year",children:"Net Flow (year)"}),r.jsx("option",{value:"self_year",children:"Self Flow (year)"}),r.jsx("option",{value:"attribute",children:"By Attribute"})]}),Xe==="attribute"&&r.jsxs("select",{value:Cn||"",onChange:u=>{const g=u.target.value||null;Un(g),A({nodeSizeAttribute:g})},className:"w-full px-2 py-1.5 text-xs border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[r.jsx("option",{value:"",children:"Select..."}),i.metadata.hasNumericProperties.nodes.map(u=>r.jsx("option",{value:u,children:u},u))]})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx("label",{className:"text-xs font-medium text-gray-700",htmlFor:"kriskogram-node-styling",children:"Node styling"}),r.jsx("p",{className:"text-[11px] text-gray-500",children:"Control how nodes are rendered. Outline mode hides the fill and emphasizes the stroke."}),r.jsxs("select",{id:"kriskogram-node-styling",value:q,onChange:u=>{const g=u.target.value;De(g),A({temporalOverlayNodeStyle:g})},className:"w-full px-2 py-1.5 text-xs border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[r.jsx("option",{value:"filled",children:"Filled nodes"}),r.jsx("option",{value:"outline",children:"Outline only"})]})]})]}),r.jsxs("div",{className:"space-y-3 border border-gray-200 rounded-md p-3",children:[r.jsx("div",{className:"text-xs font-semibold text-gray-600 uppercase tracking-wide",children:"Edge"}),r.jsxs("div",{className:"space-y-2",children:[r.jsxs("label",{className:"text-xs font-medium text-gray-700",children:["Arc Opacity: ",Math.round(Dn*100),"%"]}),r.jsx("input",{type:"range",min:0,max:1,step:.05,value:Dn,onChange:u=>{const g=Number.parseFloat(u.target.value);Number.isNaN(g)||(Fs(g),A({arcOpacity:g}))},className:"w-full"})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx("label",{className:"text-xs font-medium text-gray-700",children:"Edge Width"}),r.jsxs("div",{className:"flex items-center gap-3 text-xs",children:[r.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[r.jsx("input",{type:"radio",name:"edgeWidthMode",value:"weight",checked:Ft==="weight",onChange:()=>{Ln("weight"),A({edgeWidthMode:"weight"})},className:"w-3.5 h-3.5"}),r.jsx("span",{children:"By Weight"})]}),r.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[r.jsx("input",{type:"radio",name:"edgeWidthMode",value:"fixed",checked:Ft==="fixed",onChange:()=>{Ln("fixed"),A({edgeWidthMode:"fixed"})},className:"w-3.5 h-3.5"}),r.jsx("span",{children:"Fixed"})]})]}),Ft==="fixed"&&r.jsxs("div",{className:"mt-2",children:[r.jsxs("label",{className:"text-xs font-medium text-gray-700",children:["Base Edge Width: ",It.toFixed(1),"px"]}),r.jsx("input",{type:"range",min:.5,max:8,step:.1,value:It,onChange:u=>{const g=Number.parseFloat(u.target.value);Number.isNaN(g)||(As(g),A({baseEdgeWidth:g}))},className:"w-full"})]}),r.jsxs("div",{className:"mt-2 space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-gray-700",children:"Weight scaling"}),r.jsxs("select",{value:Re,onChange:u=>{const g=u.target.value;R(g),A({edgeWeightScale:g})},className:"w-full px-2 py-1.5 text-xs border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[r.jsx("option",{value:"linear",children:"Linear (use raw weight differences)"}),r.jsx("option",{value:"sqrt",children:"Square root (compress extremes)"}),r.jsx("option",{value:"log",children:"Logarithmic (highlight small flows)"})]}),r.jsx("p",{className:"text-[11px] text-gray-500",children:"Applies to both edge widths and weight-based color intensity."})]})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx("label",{className:"text-xs font-medium text-gray-700",htmlFor:"kriskogram-edge-style",children:"Line styling"}),r.jsx("p",{className:"text-[11px] text-gray-500",children:"Choose how edges are drawn. Segmented uses dashed arcs; outline shows a thin perimeter."}),r.jsxs("select",{id:"kriskogram-edge-style",value:ne,onChange:u=>{const g=u.target.value;Ye(g),A({temporalOverlayEdgeStyle:g})},className:"w-full px-2 py-1.5 text-xs border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[r.jsx("option",{value:"filled",children:"Filled (solid weight)"}),r.jsx("option",{value:"segmented",children:"Segmented (dashed)"}),r.jsx("option",{value:"outline",children:"Outline only"})]}),ne==="segmented"&&r.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-3 text-xs mt-2",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-[11px] font-medium text-gray-600",children:"Dash length (px)"}),r.jsx("input",{type:"number",min:1,step:.5,value:K,onChange:u=>{const g=Number.parseFloat(u.target.value);if(Number.isNaN(g))return;const j=Math.max(1,g);He(j),A({edgeSegmentLength:j})},className:"mt-1 w-full px-2 py-1 text-xs border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-[11px] font-medium text-gray-600",children:"Gap length (px)"}),r.jsx("input",{type:"number",min:.5,step:.5,value:Ce,onChange:u=>{const g=Number.parseFloat(u.target.value);if(Number.isNaN(g))return;const j=Math.max(.5,g);We(j),A({edgeSegmentGap:j})},className:"mt-1 w-full px-2 py-1 text-xs border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-[11px] font-medium text-gray-600",children:"Initial gap (px)"}),r.jsx("input",{type:"number",min:0,step:.5,value:qe,onChange:u=>{const g=Number.parseFloat(u.target.value);if(Number.isNaN(g))return;const j=Math.max(0,g);yn(j),A({edgeSegmentOffset:j})},className:"mt-1 w-full px-2 py-1 text-xs border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]}),ne==="segmented"&&r.jsxs("div",{className:"mt-2 space-y-2",children:[r.jsxs("div",{children:[r.jsx("label",{className:"text-[11px] font-medium text-gray-600",htmlFor:"kriskogram-edge-cap",children:"Segment cap style"}),r.jsxs("select",{id:"kriskogram-edge-cap",value:B,onChange:u=>{const g=u.target.value;ve(g),A({edgeSegmentCap:g})},className:"mt-1 w-full px-2 py-1.5 text-xs border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[r.jsx("option",{value:"round",children:"Rounded segment ends"}),r.jsx("option",{value:"butt",children:"Sharp segment ends"})]})]}),r.jsxs("label",{className:"flex items-center justify-between text-[11px] font-medium text-gray-600",children:[r.jsx("span",{children:"Animate flow"}),r.jsx("input",{type:"checkbox",className:"w-3.5 h-3.5",checked:$e,onChange:u=>{const g=u.target.checked;qt(g),A({edgeSegmentAnimate:g})}})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-[11px] font-medium text-gray-600",children:"Animation speed multiplier"}),r.jsx("input",{type:"number",min:.1,step:.1,value:xt,onChange:u=>{const g=Number.parseFloat(u.target.value);if(Number.isNaN(g))return;const j=Math.max(.1,g);bn(j),A({edgeSegmentSpeed:j})},className:"mt-1 w-full px-2 py-1 text-xs border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"}),r.jsx("p",{className:"mt-1 text-[10px] text-gray-500",children:"Higher values move dashes faster. 1.0 matches the legacy speed."})]}),r.jsxs("label",{className:"flex items-center justify-between text-[11px] font-medium text-gray-600",children:[r.jsx("span",{children:"Multiply speed by flow weight"}),r.jsx("input",{type:"checkbox",className:"w-3.5 h-3.5",checked:E,onChange:u=>{const g=u.target.checked;V(g),A({edgeSegmentScaleByWeight:g})}})]})]}),ne==="outline"&&r.jsxs("div",{className:"mt-2 grid grid-cols-1 sm:grid-cols-2 gap-3 text-xs",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-[11px] font-medium text-gray-600",children:"Outline thickness (px)"}),r.jsx("input",{type:"range",min:.5,max:12,step:.5,value:Q,onChange:u=>{const g=Number.parseFloat(u.target.value);if(Number.isNaN(g))return;const j=Math.max(.5,g);fe(j),A({edgeOutlineGap:j})},className:"mt-1 w-full"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-[11px] font-medium text-gray-600",children:"Precise value"}),r.jsx("input",{type:"number",min:.5,step:.5,value:Q,onChange:u=>{const g=Number.parseFloat(u.target.value);if(Number.isNaN(g))return;const j=Math.max(.5,g);fe(j),A({edgeOutlineGap:j})},className:"mt-1 w-full px-2 py-1 text-xs border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("label",{className:"text-xs font-medium text-gray-700",children:"Edge Color"}),F&&le&&r.jsx("span",{className:"text-[11px] text-gray-400",children:"(disabled by neighbor step coloring)"})]}),r.jsxs("label",{className:"flex items-center gap-1 text-[11px] text-gray-600 cursor-pointer",children:[r.jsx("input",{type:"checkbox",className:"w-3.5 h-3.5",disabled:!!(F&&le),checked:un,onChange:u=>{const g=u.target.checked;F&&le||(Es(g),A({edgeColorAdvanced:g}),g||(Et("direction"),wn(null),Is(!0),Tn("weight"),_n(null),zn(.6),A({edgeColorHue:"direction",edgeColorHueAttribute:null,edgeColorInterGrayscale:!0,edgeColorIntensity:"weight",edgeColorIntensityAttribute:null,edgeColorIntensityConst:.6})))}}),"Advanced"]})]}),!un&&!(F&&le)&&r.jsxs("div",{className:"flex flex-col gap-1.5 text-xs",children:[r.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[r.jsx("input",{type:"radio",name:"edgeColorHueSimple",value:"direction",checked:je==="direction",onChange:()=>{Et("direction"),A({edgeColorHue:"direction"})},className:"w-3.5 h-3.5"}),r.jsx("span",{children:"By Direction (Above/Below)"})]}),r.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[r.jsx("input",{type:"radio",name:"edgeColorHueSimple",value:"single",checked:je==="single",onChange:()=>{Et("single"),A({edgeColorHue:"single"})},className:"w-3.5 h-3.5"}),r.jsx("span",{children:"Single Color"})]})]}),un&&!(F&&le)&&r.jsxs("div",{className:"mt-2 space-y-3 border border-gray-200 rounded-md p-3 bg-gray-50/60",children:[r.jsxs("div",{children:[r.jsx("label",{className:"text-xs font-medium text-gray-700",children:"Hue Source"}),r.jsxs("select",{value:je,onChange:u=>{const g=u.target.value;Et(g),A({edgeColorHue:g}),g!=="attribute"&&(wn(null),A({edgeColorHueAttribute:null}))},className:"mt-1 w-full px-2 py-1.5 text-xs border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[r.jsx("option",{value:"direction",children:"Direction (Above/Below)"}),r.jsx("option",{value:"single",children:"Single"}),r.jsx("option",{value:"region",disabled:!$t,children:"Region"}),r.jsx("option",{value:"division",disabled:!At,children:"Division"}),r.jsx("option",{value:"attribute",children:"Attribute"})]}),je==="attribute"&&(i==null?void 0:i.metadata)&&r.jsxs("div",{className:"mt-2",children:[r.jsx("label",{className:"text-xs text-gray-600",children:"Hue Attribute"}),r.jsxs("select",{className:"w-full px-2 py-1.5 text-xs border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",value:Xt||"",onChange:u=>{const g=u.target.value||null;wn(g),A({edgeColorHueAttribute:g})},children:[r.jsx("option",{value:"",children:"Select attribute…"}),i.metadata.hasCategoricalProperties.edges.concat(i.metadata.hasNumericProperties.edges).map(u=>r.jsx("option",{value:u,children:u},u))]})]})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-gray-700",children:"Intensity Source"}),r.jsxs("select",{value:vt,onChange:u=>{const g=u.target.value;Tn(g),A({edgeColorIntensity:g}),g!=="attribute"&&(_n(null),A({edgeColorIntensityAttribute:null}))},className:"w-full px-2 py-1.5 text-xs border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[r.jsx("option",{value:"weight",children:"Weight"}),r.jsx("option",{value:"constant",children:"Constant"}),r.jsx("option",{value:"attribute",children:"Attribute"})]}),vt==="constant"&&r.jsxs("div",{className:"mt-2",children:[r.jsxs("label",{className:"text-xs text-gray-600",children:["Constant Intensity: ",(On*100).toFixed(0),"%"]}),r.jsx("input",{type:"range",min:0,max:1,step:.01,value:On,onChange:u=>{const g=Number.parseFloat(u.target.value);Number.isNaN(g)||(zn(g),A({edgeColorIntensityConst:g}))},className:"w-full"})]}),vt==="attribute"&&(i==null?void 0:i.metadata)&&r.jsxs("div",{className:"mt-2",children:[r.jsx("label",{className:"text-xs text-gray-600",children:"Intensity Attribute"}),r.jsxs("select",{className:"w-full px-2 py-1.5 text-xs border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",value:dn||"",onChange:u=>{const g=u.target.value||null;_n(g),A({edgeColorIntensityAttribute:g})},children:[r.jsx("option",{value:"",children:"Select attribute…"}),i.metadata.hasNumericProperties.edges.map(u=>r.jsx("option",{value:u,children:u},u))]})]})]})]})]})]})]}):r.jsx("div",{className:"text-xs text-gray-500 italic",children:"No dataset metadata available"})}),D==="table"&&r.jsx(rn,{title:"Table Settings",defaultOpen:!1,children:r.jsx("div",{className:"text-xs text-gray-500 italic",children:"Settings to be added"})}),D==="sankey"&&r.jsx(rn,{title:"Sankey Settings",defaultOpen:!1,children:r.jsx("div",{className:"text-xs text-gray-500 italic",children:"Settings to be added"})}),D==="chord"&&r.jsx(rn,{title:"Chord Settings",defaultOpen:!1,children:r.jsx("div",{className:"text-xs text-gray-500 italic",children:"Settings to be added"})})]})})]})})}async function oi(){const e="csv-usa-pre-2020",n="csv-usa-post-2020",t="csv-2021",s="gexf-sample",o="swiss-2016";let a=await jt(e),l=await jt(n);const i=S=>S?S.snapshots.every(v=>{const b=new Set(v.nodes.map(y=>y.label));if(b.size!==ni)return!1;for(const y of b)if(!ti.has(y))return!1;return!0}):!1;(a?!i(a):!1)&&(await ps(e).catch(()=>{}),a=void 0),(l?!i(l):!1)&&(await ps(n).catch(()=>{}),l=void 0);let c=!!a,h=!!l;const p=await jt(t),f=await jt(s),w=await jt(o),_=async S=>{const v=[];for(const b of S)try{const y=new URL(Object.assign({"../data/StateToStateMigrationUSCSV/state_to_state_migration_table_2022_t13_updated_2024_06_27_2022.csv":No,"../data/StateToStateMigrationUSCSV/state_to_state_migration_table_2023_t13_2023.csv":jo,"../data/StateToStateMigrationUSCSV/state_to_state_migrations_table_2005_2005.csv":Mo,"../data/StateToStateMigrationUSCSV/state_to_state_migrations_table_2005_2007_2005-2007.csv":Ro,"../data/StateToStateMigrationUSCSV/state_to_state_migrations_table_2005_2009_2005-2009.csv":Fo,"../data/StateToStateMigrationUSCSV/state_to_state_migrations_table_2006_2006.csv":Eo,"../data/StateToStateMigrationUSCSV/state_to_state_migrations_table_2006_2008_2006-2008.csv":Io,"../data/StateToStateMigrationUSCSV/state_to_state_migrations_table_2007_2007.csv":$o,"../data/StateToStateMigrationUSCSV/state_to_state_migrations_table_2007_2009_2007-2009.csv":Ao,"../data/StateToStateMigrationUSCSV/state_to_state_migrations_table_2008_2008.csv":Po,"../data/StateToStateMigrationUSCSV/state_to_state_migrations_table_2009_2009.csv":Vo,"../data/StateToStateMigrationUSCSV/state_to_state_migrations_table_2010_2010.csv":ko,"../data/StateToStateMigrationUSCSV/state_to_state_migrations_table_2011_2011.csv":Do,"../data/StateToStateMigrationUSCSV/state_to_state_migrations_table_2012_2012.csv":Lo,"../data/StateToStateMigrationUSCSV/state_to_state_migrations_table_2013_2013.csv":To,"../data/StateToStateMigrationUSCSV/state_to_state_migrations_table_2014_2014.csv":Oo,"../data/StateToStateMigrationUSCSV/state_to_state_migrations_table_2015_2015.csv":zo,"../data/StateToStateMigrationUSCSV/state_to_state_migrations_table_2016_2016.csv":Ho,"../data/StateToStateMigrationUSCSV/state_to_state_migrations_table_2017_2017.csv":Go,"../data/StateToStateMigrationUSCSV/state_to_state_migrations_table_2018_2018.csv":Bo,"../data/StateToStateMigrationUSCSV/state_to_state_migrations_table_2019_2019.csv":Uo,"../data/StateToStateMigrationUSCSV/state_to_state_migrations_table_2021_2021.csv":Wo})[`../data/StateToStateMigrationUSCSV/${b.filename}`],import.meta.url),N=await Mn(y.toString()),I=gs(N);v.push({timestamp:b.year,nodes:I.nodes,edges:I.edges})}catch(y){console.warn(`⚠️ Failed to load snapshot for ${b.filename}:`,y)}return v.sort((b,y)=>{const N=typeof b.timestamp=="string"?Number.parseInt(b.timestamp,10):b.timestamp,I=typeof y.timestamp=="string"?Number.parseInt(y.timestamp,10):y.timestamp;return N-I}),v};if(!a){const S=Hs.filter(b=>b.year<=2019),v=await _(S);if(v.length>0){const b=v[0],y=v[v.length-1],N=Ut(b),I={id:e,name:"US State-to-State Migration (2005-2019)",notes:"Tidy ACS 1-year state-to-state migration flows from 2005 through 2019. The Census Bureau did not release 2020 1-year migration flows, so the series stops before the pandemic.",type:"csv",timeRange:{start:typeof b.timestamp=="string"?Number.parseInt(b.timestamp,10):b.timestamp,end:typeof y.timestamp=="string"?Number.parseInt(y.timestamp,10):y.timestamp},snapshots:v,metadata:N,createdAt:Date.now()};await Nt(I),c=!0}}if(!l){const S=Hs.filter(b=>b.year>=2021),v=await _(S);if(v.length>0){const b=v[0],y=v[v.length-1],N=Ut(b),I={id:n,name:"US State-to-State Migration (2021-2023)",notes:"Post-2020 ACS 1-year state-to-state migration flows. The 2022 release includes revised Connecticut flows per Census errata guidance.",type:"csv",timeRange:{start:typeof b.timestamp=="string"?Number.parseInt(b.timestamp,10):b.timestamp,end:typeof y.timestamp=="string"?Number.parseInt(y.timestamp,10):y.timestamp},snapshots:v,metadata:N,createdAt:Date.now()};await Nt(I),h=!0}}if(!p){const S=new URL("/INF358_Project_Kriskogram/assets/State_to_State_Migrations_Table_2021-N7RTh5uH.csv",import.meta.url),v=await Mn(S.toString()),b=gs(v),y={timestamp:2021,nodes:b.nodes,edges:b.edges},N=Ut(y),I={id:t,name:"US State-to-State Migration (2021)",notes:"Real U.S. Census Bureau data showing migration flows between all 50 states from the American Community Survey 1-Year Estimates.",type:"csv",timeRange:{start:2021,end:2021},snapshots:[y],metadata:N,createdAt:Date.now()};await Nt(I)}if(!f){const S=new URL("/INF358_Project_Kriskogram/assets/sample-migration-data-Dify6Mt1.gexf",import.meta.url),v=await Ur(S.toString()),b=cr(v),y=b.length>0?Ut(b[0]):void 0,N={id:s,name:"Sample Migration (GEXF)",notes:"AI-generated sample network dataset in GEXF format demonstrating temporal migration patterns with multiple time slices. This example dataset includes economic, geographic, and migration type attributes for demonstration purposes.",type:"gexf",timeRange:v.timeRange,snapshots:b,metadata:y,createdAt:Date.now()};await Nt(N)}if(!w){const S="/INF358_Project_Kriskogram/",v=`${S}data/Swiss_Relocations_2016_locations.csv`,b=`${S}data/Swiss_Relocations_2016_flows.csv`,y=await Mn(v),N=await Mn(b),I=pr({nodesFile:{content:y,idField:"id",labelField:"name"},edgesFile:{content:N,sourceField:"origin",targetField:"dest",valueField:"count"}}),M={timestamp:2016,nodes:I.nodes,edges:I.edges},z=Ut(M),P={id:o,name:"Swiss Relocations (2016)",notes:"Relocations between Swiss cantons in 2016. This dataset contains 521,510 trips and uses a two-file CSV format with separate files for locations (cantons) and flows (relocations). Created by Ilya Boyandin.",type:"csv-two-file",timeRange:{start:2016,end:2016},snapshots:[M],metadata:z,createdAt:Date.now()};await Nt(P)}if(c)return e;if(h)return n;if(p)return t}export{ci as component};
