import{r,j as e,K as E}from"./main-BmmB7oxK.js";import{l as I,g as M,c as K}from"./gexf-parser-ChiJebeW.js";function F({gexfUrl:x}){const[c,h]=r.useState(2020),[g,b]=r.useState([]),[v,p]=r.useState(!1),[f,j]=r.useState(null),[d,N]=r.useState({start:2020,end:2024}),m=r.useRef(null),a=r.useRef(null);r.useEffect(()=>{let t=!0;return(async()=>{p(!0),j(null);try{let s,n;if(x){const o=await I(x);s=M(o),n=o.timeRange}else{const o=K(),u=2020;s=[{nodes:o.nodes,edges:o.edges,timestamp:u}],n={start:u,end:u}}t&&(b(s),N(n),h(n.start))}catch(s){t&&j(s instanceof Error?s.message:"Failed to load data")}finally{t&&p(!1)}})(),()=>{t=!1}},[x]),r.useEffect(()=>()=>{a.current!==null&&window.clearInterval(a.current)},[]);const i=g.find(t=>t.timestamp===c),y=t=>{h(t);const l=g.find(s=>s.timestamp===t);l&&m.current&&m.current.updateData(l.nodes,l.edges)},w=()=>{a.current!==null&&(window.clearInterval(a.current),a.current=null);let t=d.start;const l=window.setInterval(()=>{if(t<=d.end){h(t);const s=g.find(n=>n.timestamp===t);s&&m.current&&m.current.updateData(s.nodes,s.edges),t++}else a.current!==null&&(window.clearInterval(a.current),a.current=null)},1e3);a.current=l};return v?e.jsx("div",{className:"flex items-center justify-center p-8",children:e.jsx("div",{className:"text-lg",children:"Loading GEXF data..."})}):f?e.jsx("div",{className:"flex items-center justify-center p-8",children:e.jsxs("div",{className:"text-red-600",children:["Error: ",f]})}):e.jsx("div",{className:"p-6 space-y-6",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[e.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Kriskogram Demo"}),e.jsxs("div",{className:"mb-6 space-y-4",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("label",{className:"text-sm font-medium",htmlFor:"kriskogram-year-slider",children:"Year:"}),e.jsx("input",{type:"range",min:d.start,max:d.end,value:c,id:"kriskogram-year-slider",onChange:t=>y(Number.parseInt(t.target.value,10)),className:"flex-1"}),e.jsx("span",{className:"text-lg font-mono w-16",children:c})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("button",{type:"button",onClick:w,className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700",children:"Play Animation"}),e.jsx("button",{type:"button",onClick:()=>h(d.start),className:"px-4 py-2 bg-gray-600 text-white rounded hover:bg-gray-700",children:"Reset"})]})]}),i&&e.jsxs("div",{className:"mb-6 p-4 bg-gray-50 rounded",children:[e.jsxs("h3",{className:"font-semibold mb-2",children:["Current Snapshot (",c,")"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Nodes:"})," ",i.nodes.length]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Edges:"})," ",i.edges.length]})]})]}),e.jsx("div",{className:"border-2 border-gray-200 rounded-lg p-4",children:i?e.jsxs("div",{children:[e.jsx(E,{ref:m,nodes:i.nodes,edges:i.edges,width:1e3,height:600,margin:{top:60,right:40,bottom:60,left:40},accessors:{nodeOrder:t=>t.id,nodeColor:t=>typeof t.economic_index=="number"?`hsl(${Math.max(0,Math.min(1,t.economic_index))*120}, 70%, 50%)`:"#555",nodeRadius:t=>typeof t.population=="number"&&Number.isFinite(t.population)?Math.sqrt(Math.max(0,t.population))/1e3:6,edgeWidth:t=>Math.sqrt(t.value)/10,edgeColor:(t,l)=>{const s=i.edges.map(D=>D.value);if(s.length===0)return"hsl(200, 70%, 50%)";const n=Math.min(...s),u=Math.max(...s)-n||1,k=(t.value-n)/u,S=200,R=70,C=75-k*50;return`hsl(${S}, ${R}%, ${C}%)`}}}),e.jsxs("details",{className:"mt-4 text-left",children:[e.jsx("summary",{className:"cursor-pointer text-sm font-medium",children:"Debug Data"}),e.jsx("pre",{className:"mt-2 text-xs bg-gray-100 p-2 rounded overflow-auto max-h-40",children:JSON.stringify(i,null,2)})]})]}):e.jsxs("div",{className:"text-center text-gray-500 py-8",children:["No data available for year ",c]})}),e.jsxs("div",{className:"mt-6 p-4 bg-blue-50 rounded",children:[e.jsx("h3",{className:"font-semibold text-blue-900 mb-2",children:"Usage Instructions"}),e.jsxs("ul",{className:"text-sm text-blue-800 space-y-1",children:[e.jsx("li",{children:"• Use the slider to navigate through different years"}),e.jsx("li",{children:'• Click "Play Animation" to see the temporal changes'}),e.jsx("li",{children:"• The data includes migration flows between major US cities"}),e.jsx("li",{children:"• Each edge represents migration volume and includes attributes like distance and economic factors"})]})]})]})})}const T=F;export{T as component};
