import{c as is,r as p,j as r,s as Ae,o as Js,a as nn,z as No,i as jo,C as Mo,G as Fo,u as Ro,b as $o,d as Eo,K as Io,e as en,f as Ao,p as Me,g as rn,n as ot,h as ko,k as Po}from"./main-C1uW_bER.js";import{p as Qr,l as cr}from"./csv-parser-BH7H656y.js";import{p as Vo,g as eo,l as Do}from"./gexf-parser-ChiJebeW.js";import{S as Oo,a as Es}from"./stateMigrationFiles-CyfipyKt.js";/**
 * @license lucide-react v0.476.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const To=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],Lo=is("ChevronDown",To);/**
 * @license lucide-react v0.476.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zo=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],Ho=is("ChevronUp",zo);/**
 * @license lucide-react v0.476.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Go=[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],Is=is("Settings",Go);function Bo(e,n){return e==null||n==null?NaN:n<e?-1:n>e?1:n>=e?0:NaN}var As=Math.abs,Or=Math.cos,Tr=Math.sin,to=Math.PI,gr=to/2,ks=to*2,Ps=Math.max,Lr=1e-12;function Vs(e,n){return Array.from({length:n-e},(t,s)=>e+s)}function Uo(e){return function(n,t){return e(n.source.value+n.target.value,t.source.value+t.target.value)}}function Wo(){return qo(!1)}function qo(e,n){var t=0,s=null,o=null,a=null;function u(i){var d=i.length,m=new Array(d),g=Vs(0,d),x=new Array(d*d),h=new Array(d),f=0,_;i=Float64Array.from({length:d*d},(C,w)=>i[w/d|0][w%d]);for(let C=0;C<d;++C){let w=0;for(let y=0;y<d;++y)w+=i[C*d+y]+e*i[y*d+C];f+=m[C]=w}f=Ps(0,ks-t*d)/f,_=f?t:ks/d;{let C=0;s&&g.sort((w,y)=>s(m[w],m[y]));for(const w of g){const y=C;{const S=Vs(0,d).filter(v=>i[w*d+v]||i[v*d+w]);o&&S.sort((v,j)=>o(i[w*d+v],i[w*d+j]));for(const v of S){let j;if(w<v?(j=x[w*d+v]||(x[w*d+v]={source:null,target:null}),j.source={index:w,startAngle:C,endAngle:C+=i[w*d+v]*f,value:i[w*d+v]}):(j=x[v*d+w]||(x[v*d+w]={source:null,target:null}),j.target={index:w,startAngle:C,endAngle:C+=i[w*d+v]*f,value:i[w*d+v]},w===v&&(j.source=j.target)),j.source&&j.target&&j.source.value<j.target.value){const A=j.source;j.source=j.target,j.target=A}}h[w]={index:w,startAngle:y,endAngle:C,value:m[w]}}C+=_}}return x=Object.values(x),x.groups=h,a?x.sort(a):x}return u.padAngle=function(i){return arguments.length?(t=Ps(0,i),u):t},u.sortGroups=function(i){return arguments.length?(s=i,u):s},u.sortSubgroups=function(i){return arguments.length?(o=i,u):o},u.sortChords=function(i){return arguments.length?(i==null?a=null:(a=Uo(i))._=i,u):a&&a._},u}const Jr=Math.PI,es=2*Jr,Jt=1e-6,Yo=es-Jt;function no(e){this._+=e[0];for(let n=1,t=e.length;n<t;++n)this._+=arguments[n]+e[n]}function Ko(e){let n=Math.floor(e);if(!(n>=0))throw new Error(`invalid digits: ${e}`);if(n>15)return no;const t=10**n;return function(s){this._+=s[0];for(let o=1,a=s.length;o<a;++o)this._+=Math.round(arguments[o]*t)/t+s[o]}}class ls{constructor(n){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=n==null?no:Ko(n)}moveTo(n,t){this._append`M${this._x0=this._x1=+n},${this._y0=this._y1=+t}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(n,t){this._append`L${this._x1=+n},${this._y1=+t}`}quadraticCurveTo(n,t,s,o){this._append`Q${+n},${+t},${this._x1=+s},${this._y1=+o}`}bezierCurveTo(n,t,s,o,a,u){this._append`C${+n},${+t},${+s},${+o},${this._x1=+a},${this._y1=+u}`}arcTo(n,t,s,o,a){if(n=+n,t=+t,s=+s,o=+o,a=+a,a<0)throw new Error(`negative radius: ${a}`);let u=this._x1,i=this._y1,d=s-n,m=o-t,g=u-n,x=i-t,h=g*g+x*x;if(this._x1===null)this._append`M${this._x1=n},${this._y1=t}`;else if(h>Jt)if(!(Math.abs(x*d-m*g)>Jt)||!a)this._append`L${this._x1=n},${this._y1=t}`;else{let f=s-u,_=o-i,C=d*d+m*m,w=f*f+_*_,y=Math.sqrt(C),S=Math.sqrt(h),v=a*Math.tan((Jr-Math.acos((C+h-w)/(2*y*S)))/2),j=v/S,A=v/y;Math.abs(j-1)>Jt&&this._append`L${n+j*g},${t+j*x}`,this._append`A${a},${a},0,0,${+(x*f>g*_)},${this._x1=n+A*d},${this._y1=t+A*m}`}}arc(n,t,s,o,a,u){if(n=+n,t=+t,s=+s,u=!!u,s<0)throw new Error(`negative radius: ${s}`);let i=s*Math.cos(o),d=s*Math.sin(o),m=n+i,g=t+d,x=1^u,h=u?o-a:a-o;this._x1===null?this._append`M${m},${g}`:(Math.abs(this._x1-m)>Jt||Math.abs(this._y1-g)>Jt)&&this._append`L${m},${g}`,s&&(h<0&&(h=h%es+es),h>Yo?this._append`A${s},${s},0,1,${x},${n-i},${t-d}A${s},${s},0,1,${x},${this._x1=m},${this._y1=g}`:h>Jt&&this._append`A${s},${s},0,${+(h>=Jr)},${x},${this._x1=n+s*Math.cos(a)},${this._y1=t+s*Math.sin(a)}`)}rect(n,t,s,o){this._append`M${this._x0=this._x1=+n},${this._y0=this._y1=+t}h${s=+s}v${+o}h${-s}Z`}toString(){return this._}}function us(){return new ls}us.prototype=ls.prototype;var Xo=Array.prototype.slice;function bn(e){return function(){return e}}function Zo(e){return e.source}function Qo(e){return e.target}function Ds(e){return e.radius}function Jo(e){return e.startAngle}function ea(e){return e.endAngle}function ta(){return 0}function na(e){var n=Zo,t=Qo,s=Ds,o=Ds,a=Jo,u=ea,i=ta,d=null;function m(){var g,x=n.apply(this,arguments),h=t.apply(this,arguments),f=i.apply(this,arguments)/2,_=Xo.call(arguments),C=+s.apply(this,(_[0]=x,_)),w=a.apply(this,_)-gr,y=u.apply(this,_)-gr,S=+o.apply(this,(_[0]=h,_)),v=a.apply(this,_)-gr,j=u.apply(this,_)-gr;if(d||(d=g=us()),f>Lr&&(As(y-w)>f*2+Lr?y>w?(w+=f,y-=f):(w-=f,y+=f):w=y=(w+y)/2,As(j-v)>f*2+Lr?j>v?(v+=f,j-=f):(v-=f,j+=f):v=j=(v+j)/2),d.moveTo(C*Or(w),C*Tr(w)),d.arc(0,0,C,w,y),(w!==v||y!==j)&&(d.quadraticCurveTo(0,0,S*Or(v),S*Tr(v)),d.arc(0,0,S,v,j)),d.quadraticCurveTo(0,0,C*Or(w),C*Tr(w)),d.closePath(),g)return d=null,g+""||null}return m.radius=function(g){return arguments.length?(s=o=typeof g=="function"?g:bn(+g),m):s},m.sourceRadius=function(g){return arguments.length?(s=typeof g=="function"?g:bn(+g),m):s},m.targetRadius=function(g){return arguments.length?(o=typeof g=="function"?g:bn(+g),m):o},m.startAngle=function(g){return arguments.length?(a=typeof g=="function"?g:bn(+g),m):a},m.endAngle=function(g){return arguments.length?(u=typeof g=="function"?g:bn(+g),m):u},m.padAngle=function(g){return arguments.length?(i=typeof g=="function"?g:bn(+g),m):i},m.source=function(g){return arguments.length?(n=g,m):n},m.target=function(g){return arguments.length?(t=g,m):t},m.context=function(g){return arguments.length?(d=g??null,m):d},m}function ra(){return na()}function sa(e){for(var n=e.length/6|0,t=new Array(n),s=0;s<n;)t[s]="#"+e.slice(s*6,++s*6);return t}const ro=sa("1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf");function It(e){return function(){return e}}const Os=Math.abs,ze=Math.atan2,Xt=Math.cos,oa=Math.max,zr=Math.min,pt=Math.sin,Sn=Math.sqrt,Qe=1e-12,Ln=Math.PI,yr=Ln/2,aa=2*Ln;function ia(e){return e>1?0:e<-1?Ln:Math.acos(e)}function Ts(e){return e>=1?yr:e<=-1?-yr:Math.asin(e)}function la(e){let n=3;return e.digits=function(t){if(!arguments.length)return n;if(t==null)n=null;else{const s=Math.floor(t);if(!(s>=0))throw new RangeError(`invalid digits: ${t}`);n=s}return e},()=>new ls(n)}function ua(e){return e.innerRadius}function da(e){return e.outerRadius}function ca(e){return e.startAngle}function ga(e){return e.endAngle}function ma(e){return e&&e.padAngle}function fa(e,n,t,s,o,a,u,i){var d=t-e,m=s-n,g=u-o,x=i-a,h=x*d-g*m;if(!(h*h<Qe))return h=(g*(n-a)-x*(e-o))/h,[e+h*d,n+h*m]}function mr(e,n,t,s,o,a,u){var i=e-t,d=n-s,m=(u?a:-a)/Sn(i*i+d*d),g=m*d,x=-m*i,h=e+g,f=n+x,_=t+g,C=s+x,w=(h+_)/2,y=(f+C)/2,S=_-h,v=C-f,j=S*S+v*v,A=o-a,F=h*C-_*f,B=(v<0?-1:1)*Sn(oa(0,A*A*j-F*F)),V=(F*v-S*B)/j,H=(-F*S-v*B)/j,ie=(F*v+S*B)/j,q=(-F*S+v*B)/j,ue=V-w,E=H-y,ee=ie-w,le=q-y;return ue*ue+E*E>ee*ee+le*le&&(V=ie,H=q),{cx:V,cy:H,x01:-g,y01:-x,x11:V*(o/A-1),y11:H*(o/A-1)}}function pa(){var e=ua,n=da,t=It(0),s=null,o=ca,a=ga,u=ma,i=null,d=la(m);function m(){var g,x,h=+e.apply(this,arguments),f=+n.apply(this,arguments),_=o.apply(this,arguments)-yr,C=a.apply(this,arguments)-yr,w=Os(C-_),y=C>_;if(i||(i=g=d()),f<h&&(x=f,f=h,h=x),!(f>Qe))i.moveTo(0,0);else if(w>aa-Qe)i.moveTo(f*Xt(_),f*pt(_)),i.arc(0,0,f,_,C,!y),h>Qe&&(i.moveTo(h*Xt(C),h*pt(C)),i.arc(0,0,h,C,_,y));else{var S=_,v=C,j=_,A=C,F=w,B=w,V=u.apply(this,arguments)/2,H=V>Qe&&(s?+s.apply(this,arguments):Sn(h*h+f*f)),ie=zr(Os(f-h)/2,+t.apply(this,arguments)),q=ie,ue=ie,E,ee;if(H>Qe){var le=Ts(H/h*pt(V)),xe=Ts(H/f*pt(V));(F-=le*2)>Qe?(le*=y?1:-1,j+=le,A-=le):(F=0,j=A=(_+C)/2),(B-=xe*2)>Qe?(xe*=y?1:-1,S+=xe,v-=xe):(B=0,S=v=(_+C)/2)}var de=f*Xt(S),we=f*pt(S),Fe=h*Xt(A),R=h*pt(A);if(ie>Qe){var W=f*Xt(v),Re=f*pt(v),ge=h*Xt(j),Be=h*pt(j),T;if(w<Ln)if(T=fa(de,we,ge,Be,W,Re,Fe,R)){var ke=de-T[0],Z=we-T[1],Oe=W-T[0],je=Re-T[1],Ue=1/pt(ia((ke*Oe+Z*je)/(Sn(ke*ke+Z*Z)*Sn(Oe*Oe+je*je)))/2),$e=Sn(T[0]*T[0]+T[1]*T[1]);q=zr(ie,(h-$e)/(Ue-1)),ue=zr(ie,(f-$e)/(Ue+1))}else q=ue=0}B>Qe?ue>Qe?(E=mr(ge,Be,de,we,f,ue,y),ee=mr(W,Re,Fe,R,f,ue,y),i.moveTo(E.cx+E.x01,E.cy+E.y01),ue<ie?i.arc(E.cx,E.cy,ue,ze(E.y01,E.x01),ze(ee.y01,ee.x01),!y):(i.arc(E.cx,E.cy,ue,ze(E.y01,E.x01),ze(E.y11,E.x11),!y),i.arc(0,0,f,ze(E.cy+E.y11,E.cx+E.x11),ze(ee.cy+ee.y11,ee.cx+ee.x11),!y),i.arc(ee.cx,ee.cy,ue,ze(ee.y11,ee.x11),ze(ee.y01,ee.x01),!y))):(i.moveTo(de,we),i.arc(0,0,f,S,v,!y)):i.moveTo(de,we),!(h>Qe)||!(F>Qe)?i.lineTo(Fe,R):q>Qe?(E=mr(Fe,R,W,Re,h,-q,y),ee=mr(de,we,ge,Be,h,-q,y),i.lineTo(E.cx+E.x01,E.cy+E.y01),q<ie?i.arc(E.cx,E.cy,q,ze(E.y01,E.x01),ze(ee.y01,ee.x01),!y):(i.arc(E.cx,E.cy,q,ze(E.y01,E.x01),ze(E.y11,E.x11),!y),i.arc(0,0,h,ze(E.cy+E.y11,E.cx+E.x11),ze(ee.cy+ee.y11,ee.cx+ee.x11),y),i.arc(ee.cx,ee.cy,q,ze(ee.y11,ee.x11),ze(ee.y01,ee.x01),!y))):i.arc(0,0,h,A,j,y)}if(i.closePath(),g)return i=null,g+""||null}return m.centroid=function(){var g=(+e.apply(this,arguments)+ +n.apply(this,arguments))/2,x=(+o.apply(this,arguments)+ +a.apply(this,arguments))/2-Ln/2;return[Xt(x)*g,pt(x)*g]},m.innerRadius=function(g){return arguments.length?(e=typeof g=="function"?g:It(+g),m):e},m.outerRadius=function(g){return arguments.length?(n=typeof g=="function"?g:It(+g),m):n},m.cornerRadius=function(g){return arguments.length?(t=typeof g=="function"?g:It(+g),m):t},m.padRadius=function(g){return arguments.length?(s=g==null?null:typeof g=="function"?g:It(+g),m):s},m.startAngle=function(g){return arguments.length?(o=typeof g=="function"?g:It(+g),m):o},m.endAngle=function(g){return arguments.length?(a=typeof g=="function"?g:It(+g),m):a},m.padAngle=function(g){return arguments.length?(u=typeof g=="function"?g:It(+g),m):u},m.context=function(g){return arguments.length?(i=g??null,m):i},m}const ha="/INF358_Project_Kriskogram/assets/state_to_state_migration_table_2022_t13_updated_2024_06_27_2022-D7hzY5-5.csv",xa="/INF358_Project_Kriskogram/assets/state_to_state_migration_table_2023_t13_2023-Da-tSzHC.csv",ya="/INF358_Project_Kriskogram/assets/state_to_state_migrations_table_2005_2005-5D0dAV6T.csv",va="/INF358_Project_Kriskogram/assets/state_to_state_migrations_table_2005_2007_2005-2007-C2gBOjzD.csv",ba="/INF358_Project_Kriskogram/assets/state_to_state_migrations_table_2005_2009_2005-2009-oSLcshdC.csv",Sa="/INF358_Project_Kriskogram/assets/state_to_state_migrations_table_2006_2006-C-EFanec.csv",wa="/INF358_Project_Kriskogram/assets/state_to_state_migrations_table_2006_2008_2006-2008-Cp1NRBpc.csv",_a="/INF358_Project_Kriskogram/assets/state_to_state_migrations_table_2007_2007-BXoQRRMn.csv",Ca="/INF358_Project_Kriskogram/assets/state_to_state_migrations_table_2007_2009_2007-2009-Qdd3KwND.csv",Na="/INF358_Project_Kriskogram/assets/state_to_state_migrations_table_2008_2008--00JWAqc.csv",ja="/INF358_Project_Kriskogram/assets/state_to_state_migrations_table_2009_2009-5yGj8NCd.csv",Ma="/INF358_Project_Kriskogram/assets/state_to_state_migrations_table_2010_2010-CSB90FrU.csv",Fa="/INF358_Project_Kriskogram/assets/state_to_state_migrations_table_2011_2011-BzRnLs5h.csv",Ra="/INF358_Project_Kriskogram/assets/state_to_state_migrations_table_2012_2012-DrbWwk1R.csv",$a="/INF358_Project_Kriskogram/assets/state_to_state_migrations_table_2013_2013-CTsYcw-F.csv",Ea="/INF358_Project_Kriskogram/assets/state_to_state_migrations_table_2014_2014-D8ze7hKk.csv",Ia="/INF358_Project_Kriskogram/assets/state_to_state_migrations_table_2015_2015-Sg6Ir2qO.csv",Aa="/INF358_Project_Kriskogram/assets/state_to_state_migrations_table_2016_2016-C26kP0Bk.csv",ka="/INF358_Project_Kriskogram/assets/state_to_state_migrations_table_2017_2017-BNMbL_en.csv",Pa="/INF358_Project_Kriskogram/assets/state_to_state_migrations_table_2018_2018-DTnLPVgj.csv",Va="/INF358_Project_Kriskogram/assets/state_to_state_migrations_table_2019_2019-Bd1nphS1.csv",Da="/INF358_Project_Kriskogram/assets/State_to_State_Migrations_Table_2021-N7RTh5uH.csv";function tn(e){const n=new Set,t=new Set,s=new Set,o=new Set,a=new Set,u=new Set;return e.nodes.forEach(i=>{Object.keys(i).forEach(d=>{if(d!=="id"&&d!=="label"){n.add(d);const m=i[d];typeof m=="number"?s.add(d):typeof m=="string"&&a.add(d)}})}),e.edges.forEach(i=>{Object.keys(i).forEach(d=>{if(d!=="source"&&d!=="target"&&d!=="value"){t.add(d);const m=i[d];typeof m=="number"?o.add(d):typeof m=="string"&&u.add(d)}})}),{nodeProperties:Array.from(n),edgeProperties:Array.from(t),hasNumericProperties:{nodes:Array.from(s),edges:Array.from(o)},hasCategoricalProperties:{nodes:Array.from(a),edges:Array.from(u)}}}const Oa="kriskogram-db",Ta=1,at="datasets";function zn(){return new Promise((e,n)=>{const t=indexedDB.open(Oa,Ta);t.onupgradeneeded=()=>{const s=t.result;s.objectStoreNames.contains(at)||s.createObjectStore(at,{keyPath:"id"})},t.onsuccess=()=>e(t.result),t.onerror=()=>n(t.error)})}async function Vt(e){const n=await zn();return new Promise((t,s)=>{const o=n.transaction(at,"readwrite");o.objectStore(at).put(e),o.oncomplete=()=>t(),o.onerror=()=>s(o.error),o.onabort=()=>s(o.error)})}async function Dt(e){const n=await zn();return new Promise((t,s)=>{const u=n.transaction(at,"readonly").objectStore(at).get(e);u.onsuccess=()=>t(u.result),u.onerror=()=>s(u.error)})}async function La(){const e=await zn();return new Promise((n,t)=>{const a=e.transaction(at,"readonly").objectStore(at).getAll();a.onsuccess=()=>n(a.result||[]),a.onerror=()=>t(a.error)})}async function ts(e){const n=await zn();return new Promise((t,s)=>{const o=n.transaction(at,"readwrite");o.objectStore(at).delete(e),o.oncomplete=()=>t(),o.onerror=()=>s(o.error)})}async function za(e){const n=await Dt(e);if(!n)throw new Error(`Dataset ${e} not found`);const t={...n,id:`${n.type}-${Date.now()}`,name:`${n.name} (Copy)`,createdAt:Date.now()};return await Vt(t),t}async function Ha(){const e=await zn();return new Promise((n,t)=>{const s=e.transaction(at,"readwrite");s.objectStore(at).clear(),s.oncomplete=()=>n(),s.onerror=()=>t(s.error)})}async function Ga(){if("storage"in navigator&&"persist"in navigator.storage)try{return await navigator.storage.persist()}catch{return!1}return!1}function Ls(e){const n=[];let t="",s=!1;for(let o=0;o<e.length;o++){const a=e[o];a==='"'?s=!s:a===","&&!s?(n.push(t),t=""):t+=a}return n.push(t),n}function zs(e){const n=e.trim().split(`
`).filter(o=>o.trim());if(n.length===0)throw new Error("CSV file is empty");const t=Ls(n[0]).map(o=>o.trim()),s=n.slice(1).map(Ls);return{headers:t,rows:s}}function Hr(e){const n=e.replace(/[",]/g,"").trim(),t=Number.parseFloat(n);return Number.isNaN(t)?n:t}function so(e){var A;const{headers:n,rows:t}=zs(e.nodesFile.content),s=n.map(F=>F.toLowerCase().trim()),o=e.nodesFile.idField.toLowerCase().trim(),a=((A=e.nodesFile.labelField)==null?void 0:A.toLowerCase().trim())||o,u=s.indexOf(o),i=e.nodesFile.labelField?s.indexOf(a):u;if(u===-1)throw new Error(`ID field "${e.nodesFile.idField}" not found in nodes file. Available fields: ${n.join(", ")}`);const d=t.map(F=>{const B={id:String(F[u]||"").trim(),label:i>=0?String(F[i]||"").trim():String(F[u]||"").trim()},V=n[u],H=e.nodesFile.labelField?n[i]:V;return n.forEach((ie,q)=>{var ue;if(ie!==V&&ie!==H){const E=((ue=F[q])==null?void 0:ue.trim())||"";B[ie]=Hr(E)}}),B}).filter(F=>F.id),m=new Map(d.map(F=>[F.id,F])),{headers:g,rows:x}=zs(e.edgesFile.content),h=g.map(F=>F.toLowerCase().trim()),f=e.edgesFile.sourceField.toLowerCase().trim(),_=e.edgesFile.targetField.toLowerCase().trim(),C=e.edgesFile.valueField.toLowerCase().trim(),w=h.indexOf(f),y=h.indexOf(_),S=h.indexOf(C);if(w===-1)throw new Error(`Source field "${e.edgesFile.sourceField}" not found in edges file. Available fields: ${g.join(", ")}`);if(y===-1)throw new Error(`Target field "${e.edgesFile.targetField}" not found in edges file. Available fields: ${g.join(", ")}`);if(S===-1)throw new Error(`Value field "${e.edgesFile.valueField}" not found in edges file. Available fields: ${g.join(", ")}`);const v=x.map(F=>{const B=String(F[w]||"").trim(),V=String(F[y]||"").trim(),H=String(F[S]||"").trim(),ie=Hr(H);if(!B||!V||typeof ie!="number"||ie<=0)return null;(!m.has(B)||!m.has(V))&&console.warn(`Edge references missing node: ${B} -> ${V}`);const q={source:B,target:V,value:ie},ue=g[w],E=g[y],ee=g[S];return g.forEach((le,xe)=>{var de;if(le!==ue&&le!==E&&le!==ee){const we=((de=F[xe])==null?void 0:de.trim())||"";q[le]=Hr(we)}}),q}).filter(F=>F!==null&&m.has(F.source)&&m.has(F.target)),j=new Set;return v.forEach(F=>{j.add(F.source),j.add(F.target)}),j.forEach(F=>{m.has(F)||d.push({id:F,label:F})}),{nodes:d,edges:v}}function Ba({onClose:e,onImport:n,fileInputRef:t,onFilesSelected:s,existingFile:o}){const[a,u]=p.useState(""),[i,d]=p.useState(""),[m,g]=p.useState(!1),[x,h]=p.useState({}),[f,_]=p.useState(!1),[C,w]=p.useState(null),[y,S]=p.useState([]),[v,j]=p.useState([]),[A,F]=p.useState(null),B=p.useRef(null),V=p.useRef(null),[H,ie]=p.useState(null),[q,ue]=p.useState(null),[E,ee]=p.useState([]),[le,xe]=p.useState([]),[de,we]=p.useState(""),[Fe,R]=p.useState(""),[W,Re]=p.useState(""),[ge,Be]=p.useState(""),[T,ke]=p.useState(""),[Z,Oe]=p.useState(null);function je(I){let O=I.replace(/\.(csv|gexf)$/i,"");return O=O.replace(/([a-z])([A-Z])/g,"$1 $2").replace(/[_-]/g," ").replace(/[^a-zA-Z0-9\s]/g," ").replace(/\s+/g," ").trim(),O.split(" ").map(K=>K.charAt(0).toUpperCase()+K.slice(1).toLowerCase()).join(" ")}p.useEffect(()=>{var I;if(o!=null&&o.parsedData){Oe(o.parsedData);const O=((I=o.files[0])==null?void 0:I.name)||"";u(je(O)),d(o.files.map(K=>K.name).join(", "))}},[o]),p.useEffect(()=>{var I;if(!o&&y.length>0){if(!a||a===je(((I=y[0])==null?void 0:I.name)||"")){const O=y[0].name;u(je(O))}i||d(y.map(O=>O.name).join(", "))}},[y]);function Ue(I){const O=[];let K="",ye=!1;for(let ne=0;ne<I.length;ne++){const he=I[ne];he==='"'?ye=!ye:he===","&&!ye?(O.push(K),K=""):K+=he}return O.push(K),O}function $e(I){const O=I.trim().split(`
`);if(O.length===0)return[];const K=O[0];return Ue(K).map(ye=>ye.trim().replace(/^"|"$/g,""))}async function sn(I){const O=Array.from(I.target.files||[]);if(O.length===0)return;S(O);const K=await Promise.all(O.map(ne=>ne.text()));j(K);const ye=O[0].name.toLowerCase();if(ye.endsWith(".gexf")){F("gexf"),w("single");try{const ne=Vo(K[0]),he=eo(ne);Oe({nodes:he.length>0?he[0].nodes:[],edges:he.length>0?he[0].edges:[],timeRange:ne.timeRange}),u(O[0].name.replace(".gexf",""))}catch(ne){h({general:ne instanceof Error?ne.message:"Failed to parse GEXF"})}}else if(ye.endsWith(".csv")){if(F("csv"),O.length===1){w("single");try{const ne=Qr(K[0]);Oe({nodes:ne.nodes,edges:ne.edges,timeRange:{start:2021,end:2021}}),u(O[0].name.replace(".csv",""))}catch{w("two-file");const he=$e(K[0]);ee(he),xe(he),ie(0);const me=he.find(_e=>_e.toLowerCase()==="id"||_e.toLowerCase()==="node"||_e.toLowerCase()==="name"),it=he.find(_e=>_e.toLowerCase()==="source"||_e.toLowerCase()==="origin"||_e.toLowerCase()==="from"),qe=he.find(_e=>_e.toLowerCase()==="target"||_e.toLowerCase()==="dest"||_e.toLowerCase()==="destination"||_e.toLowerCase()==="to"),Ct=he.find(_e=>_e.toLowerCase()==="value"||_e.toLowerCase()==="count"||_e.toLowerCase()==="weight");me&&we(me),it&&Re(it),qe&&Be(qe),Ct&&ke(Ct),h({general:"Could not parse as state migration format. Please select which file contains nodes and which contains edges."})}}else if(O.length===2){w("two-file");const ne=$e(K[0]),he=$e(K[1]);ee(ne),xe(he),ie(0),ue(1);const me=ne.find(Pe=>Pe.toLowerCase()==="id"),it=ne.find(Pe=>Pe.toLowerCase()==="name"||Pe.toLowerCase()==="label");me&&we(me),it&&R(it);const qe=he.find(Pe=>Pe.toLowerCase()==="source"||Pe.toLowerCase()==="origin"||Pe.toLowerCase()==="from"),Ct=he.find(Pe=>Pe.toLowerCase()==="target"||Pe.toLowerCase()==="dest"||Pe.toLowerCase()==="destination"||Pe.toLowerCase()==="to"),_e=he.find(Pe=>Pe.toLowerCase()==="value"||Pe.toLowerCase()==="count"||Pe.toLowerCase()==="weight");qe&&Re(qe),Ct&&Be(Ct),_e&&ke(_e),nt()}}t.current&&(t.current.value="")}function nt(){if(H===null||q===null||!de||!W||!ge||!T){h({general:"Please select all required fields"}),Oe(null);return}try{const I=so({nodesFile:{content:v[H],idField:de,labelField:Fe||de},edgesFile:{content:v[q],sourceField:W,targetField:ge,valueField:T}});Oe({nodes:I.nodes,edges:I.edges,timeRange:{start:2016,end:2016}}),h({})}catch(I){h({general:I instanceof Error?I.message:"Failed to parse two-file CSV"}),Oe(null)}}p.useEffect(()=>{C==="two-file"&&H!==null&&q!==null&&nt()},[de,Fe,W,ge,T,H,q]);function Hn(){const I={},O=[];if(a.trim()||(I.name="Dataset name is required"),C==="two-file"&&(H===null&&(I.nodesFile="Please select which file contains nodes"),q===null&&(I.edgesFile="Please select which file contains edges"),H!==null&&!de&&(I.nodeIdField="Please select the ID field for nodes"),q!==null&&!W&&(I.edgeSourceField="Please select the source field for edges"),q!==null&&!ge&&(I.edgeTargetField="Please select the target field for edges"),q!==null&&!T&&(I.edgeValueField="Please select the value field for edges")),!Z)return I.general="Data parsing failed - please check file format and field selections",I;Z.nodes.length===0&&O.push("No nodes found in dataset"),Z.edges.length===0&&O.push("No edges found in dataset");const K=new Set(Z.nodes.map(ne=>ne.id));K.size!==Z.nodes.length&&O.push(`${Z.nodes.length-K.size} duplicate node IDs found`);const ye=Z.edges.filter(ne=>!K.has(ne.source)||!K.has(ne.target));return ye.length>0&&O.push(`${ye.length} edges reference non-existent nodes`),O.length>0&&(I.summary=O.join("; ")),I}function We(){x.name&&B.current?(B.current.scrollIntoView({behavior:"smooth",block:"center"}),B.current.focus()):x.summary&&V.current&&V.current.scrollIntoView({behavior:"smooth",block:"center"})}async function Gn(){const I=Hn();if(h(I),Object.keys(I).filter(K=>K!=="summary").length>0||!Z){setTimeout(()=>We(),100);return}g(!0);try{const K=Z.timeRange||{start:2021,end:2021},ye={timestamp:K.start,nodes:Z.nodes,edges:Z.edges},ne=tn(ye),he=[ye],me={name:a.trim(),filename:y.map(it=>it.name).join(", "),notes:i.trim()||void 0,type:C==="two-file"?"csv":A||"csv",timeRange:K,snapshots:he,metadata:ne};await n(me,{nodes:Z.nodes,edges:Z.edges,snapshots:he,metadata:ne})}catch(K){console.error("Import error:",K),h({general:K instanceof Error?K.message:"Failed to import dataset"}),g(!1),setTimeout(()=>We(),100)}}return r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:r.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-4xl w-full mx-4 max-h-[90vh] flex flex-col",children:[r.jsxs("div",{className:"p-6 border-b flex items-center justify-between",children:[r.jsx("h2",{className:"text-2xl font-bold",children:"Import Dataset"}),r.jsx("button",{onClick:e,className:"text-gray-400 hover:text-gray-600 text-2xl",children:"×"})]}),r.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:r.jsxs("div",{className:"space-y-6",children:[!C&&r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Select Files ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsxs("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-6 text-center",children:[r.jsx("button",{onClick:()=>{var I;return(I=t.current)==null?void 0:I.click()},className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700",children:"Choose Files"}),r.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"Select 1 file (GEXF or CSV) or 2 files (CSV nodes + CSV edges)"}),r.jsx("input",{ref:t,type:"file",accept:".csv,.gexf",multiple:!0,onChange:sn,className:"hidden"})]})]}),y.length>0&&r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Selected Files"}),r.jsxs("div",{className:"space-y-2",children:[y.map((I,O)=>r.jsxs("div",{className:"flex items-center justify-between bg-gray-50 p-3 rounded",children:[r.jsx("span",{className:"text-sm",children:I.name}),r.jsx("button",{onClick:()=>{const K=[...y];K.splice(O,1),S(K);const ye=[...v];ye.splice(O,1),j(ye),C==="two-file"&&(H===O&&ie(null),q===O&&ue(null),H&&H>O&&ie(H-1),q&&q>O&&ue(q-1))},className:"text-red-600 text-sm hover:text-red-800",children:"Remove"})]},O)),r.jsx("button",{type:"button",onClick:()=>{const I=document.createElement("input");I.type="file",I.accept=".csv,.gexf",I.multiple=!0,I.onchange=async O=>{const K=O.target,ye=Array.from(K.files||[]);if(ye.length>0){const ne=await Promise.all(ye.map(me=>me.text()));S([...y,...ye]),j([...v,...ne]);const he=[...y,...ye];he.length===2&&he.every(me=>me.name.toLowerCase().endsWith(".csv"))&&(w("two-file"),F("csv"))}},I.click()},className:"text-sm text-blue-600 hover:text-blue-800",children:"+ Add More Files"})]})]}),C==="two-file"&&y.length>0&&r.jsxs("div",{className:"border-t pt-4 space-y-4","data-file-select":!0,children:[r.jsx("h3",{className:"font-semibold",children:"Map Files and Fields"}),r.jsxs("div",{"data-field-select":!0,children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Nodes File (Locations) ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsxs("select",{value:H??"",onChange:I=>{const O=parseInt(I.target.value);ie(O);const K=$e(v[O]);ee(K);const ye=K.find(ne=>ne.toLowerCase()==="id");if(ye&&we(ye),x.nodesFile){const ne={...x};delete ne.nodesFile,h(ne)}},className:`w-full px-3 py-2 border rounded-md ${x.nodesFile?"border-red-500":"border-gray-300"}`,children:[r.jsx("option",{value:"",children:"Select file..."}),y.map((I,O)=>r.jsx("option",{value:O,children:I.name},O))]}),x.nodesFile&&r.jsx("p",{className:"mt-1 text-sm text-red-600",children:x.nodesFile}),H!==null&&E.length>0&&r.jsxs("div",{className:"mt-2 space-y-2",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"ID Field *"}),r.jsxs("select",{value:de,onChange:I=>{if(we(I.target.value),x.nodeIdField){const O={...x};delete O.nodeIdField,h(O)}},className:`w-full px-2 py-1 border rounded text-sm ${x.nodeIdField?"border-red-500":"border-gray-300"}`,children:[r.jsx("option",{value:"",children:"Select field..."}),E.map(I=>r.jsx("option",{value:I,children:I},I))]}),x.nodeIdField&&r.jsx("p",{className:"mt-1 text-xs text-red-600",children:x.nodeIdField})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"Label Field (optional)"}),r.jsxs("select",{value:Fe,onChange:I=>R(I.target.value),className:"w-full px-2 py-1 border border-gray-300 rounded text-sm",children:[r.jsx("option",{value:"",children:"Use ID field"}),E.map(I=>r.jsx("option",{value:I,children:I},I))]})]})]})]}),r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Edges File (Flows) ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsxs("select",{value:q??"",onChange:I=>{const O=parseInt(I.target.value);ue(O);const K=$e(v[O]);xe(K);const ye=K.find(me=>me.toLowerCase()==="source"||me.toLowerCase()==="origin"||me.toLowerCase()==="from"),ne=K.find(me=>me.toLowerCase()==="target"||me.toLowerCase()==="dest"||me.toLowerCase()==="to"),he=K.find(me=>me.toLowerCase()==="value"||me.toLowerCase()==="count"||me.toLowerCase()==="weight");if(ye&&Re(ye),ne&&Be(ne),he&&ke(he),x.edgesFile){const me={...x};delete me.edgesFile,h(me)}},className:`w-full px-3 py-2 border rounded-md ${x.edgesFile?"border-red-500":"border-gray-300"}`,children:[r.jsx("option",{value:"",children:"Select file..."}),y.map((I,O)=>r.jsx("option",{value:O,children:I.name},O))]}),x.edgesFile&&r.jsx("p",{className:"mt-1 text-sm text-red-600",children:x.edgesFile}),q!==null&&le.length>0&&r.jsxs("div",{className:"mt-2 space-y-2",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"Source Field *"}),r.jsxs("select",{value:W,onChange:I=>{if(Re(I.target.value),x.edgeSourceField){const O={...x};delete O.edgeSourceField,h(O)}},className:`w-full px-2 py-1 border rounded text-sm ${x.edgeSourceField?"border-red-500":"border-gray-300"}`,children:[r.jsx("option",{value:"",children:"Select field..."}),le.map(I=>r.jsx("option",{value:I,children:I},I))]}),x.edgeSourceField&&r.jsx("p",{className:"mt-1 text-xs text-red-600",children:x.edgeSourceField})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"Target Field *"}),r.jsxs("select",{value:ge,onChange:I=>{if(Be(I.target.value),x.edgeTargetField){const O={...x};delete O.edgeTargetField,h(O)}},className:`w-full px-2 py-1 border rounded text-sm ${x.edgeTargetField?"border-red-500":"border-gray-300"}`,children:[r.jsx("option",{value:"",children:"Select field..."}),le.map(I=>r.jsx("option",{value:I,children:I},I))]}),x.edgeTargetField&&r.jsx("p",{className:"mt-1 text-xs text-red-600",children:x.edgeTargetField})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"Value Field *"}),r.jsxs("select",{value:T,onChange:I=>{if(ke(I.target.value),x.edgeValueField){const O={...x};delete O.edgeValueField,h(O)}},className:`w-full px-2 py-1 border rounded text-sm ${x.edgeValueField?"border-red-500":"border-gray-300"}`,children:[r.jsx("option",{value:"",children:"Select field..."}),le.map(I=>r.jsx("option",{value:I,children:I},I))]}),x.edgeValueField&&r.jsx("p",{className:"mt-1 text-xs text-red-600",children:x.edgeValueField})]})]})]})]}),r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Dataset Name ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsx("input",{ref:B,type:"text",value:a,onChange:I=>{if(u(I.target.value),x.name){const O={...x};delete O.name,h(O)}},className:`w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 ${x.name?"border-red-500 focus:ring-red-500":"border-gray-300 focus:ring-blue-500"}`,placeholder:"Enter a name for this dataset"}),x.name&&r.jsx("p",{className:"mt-1 text-sm text-red-600",children:x.name})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Notes (optional)"}),r.jsx("textarea",{value:i,onChange:I=>d(I.target.value),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Add any notes about this dataset..."})]}),x.general&&r.jsxs("div",{className:"bg-red-50 border border-red-200 rounded p-3",children:[r.jsx("h4",{className:"font-semibold text-red-800 mb-2",children:"Error:"}),r.jsx("p",{className:"text-sm text-red-700",children:x.general})]}),Z&&r.jsxs("div",{ref:V,className:"bg-blue-50 border border-blue-200 rounded p-3",children:[r.jsx("h4",{className:"font-semibold text-blue-800 mb-2",children:"Data Summary"}),r.jsxs("div",{className:"text-sm text-blue-700 space-y-1",children:[r.jsxs("div",{children:[r.jsx("span",{className:"font-medium",children:"Nodes:"})," ",Z.nodes.length]}),r.jsxs("div",{children:[r.jsx("span",{className:"font-medium",children:"Edges:"})," ",Z.edges.length]}),Z.timeRange&&r.jsxs("div",{children:[r.jsx("span",{className:"font-medium",children:"Time Range:"})," ",Z.timeRange.start,Z.timeRange.end!==Z.timeRange.start?` – ${Z.timeRange.end}`:""]}),Z.nodes.length>0&&r.jsxs("div",{className:"mt-2 text-xs",children:[r.jsx("span",{className:"font-medium",children:"Sample node properties:"})," ",Object.keys(Z.nodes[0]).slice(0,5).join(", "),Object.keys(Z.nodes[0]).length>5&&"..."]}),x.summary&&r.jsxs("div",{className:"mt-2 pt-2 border-t border-blue-300",children:[r.jsx("span",{className:"font-medium text-orange-700",children:"Warnings:"})," ",r.jsx("span",{className:"text-orange-600",children:x.summary})]})]})]})]})}),r.jsxs("div",{className:"p-6 border-t flex justify-end gap-3",children:[r.jsx("button",{onClick:e,type:"button",disabled:m,className:"px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50 disabled:opacity-50 cursor-pointer transition-colors",children:"Cancel"}),r.jsx("button",{onClick:Gn,type:"button",disabled:m||(Object.keys(x).filter(O=>O!=="summary").length>0||!Z),className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed cursor-pointer transition-colors",children:m?"Importing...":"Import Dataset"})]})]})})}/**
   * table-core
   *
   * Copyright (c) TanStack
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE.md file in the root directory of this source tree.
   *
   * @license MIT
   */function Ot(e,n){return typeof e=="function"?e(n):e}function tt(e,n){return t=>{n.setState(s=>({...s,[e]:Ot(t,s[e])}))}}function vr(e){return e instanceof Function}function Ua(e){return Array.isArray(e)&&e.every(n=>typeof n=="number")}function Wa(e,n){const t=[],s=o=>{o.forEach(a=>{t.push(a);const u=n(a);u!=null&&u.length&&s(u)})};return s(e),t}function Q(e,n,t){let s=[],o;return a=>{let u;t.key&&t.debug&&(u=Date.now());const i=e(a);if(!(i.length!==s.length||i.some((g,x)=>s[x]!==g)))return o;s=i;let m;if(t.key&&t.debug&&(m=Date.now()),o=n(...i),t==null||t.onChange==null||t.onChange(o),t.key&&t.debug&&t!=null&&t.debug()){const g=Math.round((Date.now()-u)*100)/100,x=Math.round((Date.now()-m)*100)/100,h=x/16,f=(_,C)=>{for(_=String(_);_.length<C;)_=" "+_;return _};console.info(`%c⏱ ${f(x,5)} /${f(g,5)} ms`,`
            font-size: .6rem;
            font-weight: bold;
            color: hsl(${Math.max(0,Math.min(120-120*h,120))}deg 100% 31%);`,t==null?void 0:t.key)}return o}}function J(e,n,t,s){return{debug:()=>{var o;return(o=e==null?void 0:e.debugAll)!=null?o:e[n]},key:!1,onChange:s}}function qa(e,n,t,s){const o=()=>{var u;return(u=a.getValue())!=null?u:e.options.renderFallbackValue},a={id:`${n.id}_${t.id}`,row:n,column:t,getValue:()=>n.getValue(s),renderValue:o,getContext:Q(()=>[e,t,n,a],(u,i,d,m)=>({table:u,column:i,row:d,cell:m,getValue:m.getValue,renderValue:m.renderValue}),J(e.options,"debugCells"))};return e._features.forEach(u=>{u.createCell==null||u.createCell(a,t,n,e)},{}),a}function Ya(e,n,t,s){var o,a;const i={...e._getDefaultColumnDef(),...n},d=i.accessorKey;let m=(o=(a=i.id)!=null?a:d?typeof String.prototype.replaceAll=="function"?d.replaceAll(".","_"):d.replace(/\./g,"_"):void 0)!=null?o:typeof i.header=="string"?i.header:void 0,g;if(i.accessorFn?g=i.accessorFn:d&&(d.includes(".")?g=h=>{let f=h;for(const C of d.split(".")){var _;f=(_=f)==null?void 0:_[C]}return f}:g=h=>h[i.accessorKey]),!m)throw new Error;let x={id:`${String(m)}`,accessorFn:g,parent:s,depth:t,columnDef:i,columns:[],getFlatColumns:Q(()=>[!0],()=>{var h;return[x,...(h=x.columns)==null?void 0:h.flatMap(f=>f.getFlatColumns())]},J(e.options,"debugColumns")),getLeafColumns:Q(()=>[e._getOrderColumnsFn()],h=>{var f;if((f=x.columns)!=null&&f.length){let _=x.columns.flatMap(C=>C.getLeafColumns());return h(_)}return[x]},J(e.options,"debugColumns"))};for(const h of e._features)h.createColumn==null||h.createColumn(x,e);return x}const He="debugHeaders";function Hs(e,n,t){var s;let a={id:(s=t.id)!=null?s:n.id,column:n,index:t.index,isPlaceholder:!!t.isPlaceholder,placeholderId:t.placeholderId,depth:t.depth,subHeaders:[],colSpan:0,rowSpan:0,headerGroup:null,getLeafHeaders:()=>{const u=[],i=d=>{d.subHeaders&&d.subHeaders.length&&d.subHeaders.map(i),u.push(d)};return i(a),u},getContext:()=>({table:e,header:a,column:n})};return e._features.forEach(u=>{u.createHeader==null||u.createHeader(a,e)}),a}const Ka={createTable:e=>{e.getHeaderGroups=Q(()=>[e.getAllColumns(),e.getVisibleLeafColumns(),e.getState().columnPinning.left,e.getState().columnPinning.right],(n,t,s,o)=>{var a,u;const i=(a=s==null?void 0:s.map(x=>t.find(h=>h.id===x)).filter(Boolean))!=null?a:[],d=(u=o==null?void 0:o.map(x=>t.find(h=>h.id===x)).filter(Boolean))!=null?u:[],m=t.filter(x=>!(s!=null&&s.includes(x.id))&&!(o!=null&&o.includes(x.id)));return fr(n,[...i,...m,...d],e)},J(e.options,He)),e.getCenterHeaderGroups=Q(()=>[e.getAllColumns(),e.getVisibleLeafColumns(),e.getState().columnPinning.left,e.getState().columnPinning.right],(n,t,s,o)=>(t=t.filter(a=>!(s!=null&&s.includes(a.id))&&!(o!=null&&o.includes(a.id))),fr(n,t,e,"center")),J(e.options,He)),e.getLeftHeaderGroups=Q(()=>[e.getAllColumns(),e.getVisibleLeafColumns(),e.getState().columnPinning.left],(n,t,s)=>{var o;const a=(o=s==null?void 0:s.map(u=>t.find(i=>i.id===u)).filter(Boolean))!=null?o:[];return fr(n,a,e,"left")},J(e.options,He)),e.getRightHeaderGroups=Q(()=>[e.getAllColumns(),e.getVisibleLeafColumns(),e.getState().columnPinning.right],(n,t,s)=>{var o;const a=(o=s==null?void 0:s.map(u=>t.find(i=>i.id===u)).filter(Boolean))!=null?o:[];return fr(n,a,e,"right")},J(e.options,He)),e.getFooterGroups=Q(()=>[e.getHeaderGroups()],n=>[...n].reverse(),J(e.options,He)),e.getLeftFooterGroups=Q(()=>[e.getLeftHeaderGroups()],n=>[...n].reverse(),J(e.options,He)),e.getCenterFooterGroups=Q(()=>[e.getCenterHeaderGroups()],n=>[...n].reverse(),J(e.options,He)),e.getRightFooterGroups=Q(()=>[e.getRightHeaderGroups()],n=>[...n].reverse(),J(e.options,He)),e.getFlatHeaders=Q(()=>[e.getHeaderGroups()],n=>n.map(t=>t.headers).flat(),J(e.options,He)),e.getLeftFlatHeaders=Q(()=>[e.getLeftHeaderGroups()],n=>n.map(t=>t.headers).flat(),J(e.options,He)),e.getCenterFlatHeaders=Q(()=>[e.getCenterHeaderGroups()],n=>n.map(t=>t.headers).flat(),J(e.options,He)),e.getRightFlatHeaders=Q(()=>[e.getRightHeaderGroups()],n=>n.map(t=>t.headers).flat(),J(e.options,He)),e.getCenterLeafHeaders=Q(()=>[e.getCenterFlatHeaders()],n=>n.filter(t=>{var s;return!((s=t.subHeaders)!=null&&s.length)}),J(e.options,He)),e.getLeftLeafHeaders=Q(()=>[e.getLeftFlatHeaders()],n=>n.filter(t=>{var s;return!((s=t.subHeaders)!=null&&s.length)}),J(e.options,He)),e.getRightLeafHeaders=Q(()=>[e.getRightFlatHeaders()],n=>n.filter(t=>{var s;return!((s=t.subHeaders)!=null&&s.length)}),J(e.options,He)),e.getLeafHeaders=Q(()=>[e.getLeftHeaderGroups(),e.getCenterHeaderGroups(),e.getRightHeaderGroups()],(n,t,s)=>{var o,a,u,i,d,m;return[...(o=(a=n[0])==null?void 0:a.headers)!=null?o:[],...(u=(i=t[0])==null?void 0:i.headers)!=null?u:[],...(d=(m=s[0])==null?void 0:m.headers)!=null?d:[]].map(g=>g.getLeafHeaders()).flat()},J(e.options,He))}};function fr(e,n,t,s){var o,a;let u=0;const i=function(h,f){f===void 0&&(f=1),u=Math.max(u,f),h.filter(_=>_.getIsVisible()).forEach(_=>{var C;(C=_.columns)!=null&&C.length&&i(_.columns,f+1)},0)};i(e);let d=[];const m=(h,f)=>{const _={depth:f,id:[s,`${f}`].filter(Boolean).join("_"),headers:[]},C=[];h.forEach(w=>{const y=[...C].reverse()[0],S=w.column.depth===_.depth;let v,j=!1;if(S&&w.column.parent?v=w.column.parent:(v=w.column,j=!0),y&&(y==null?void 0:y.column)===v)y.subHeaders.push(w);else{const A=Hs(t,v,{id:[s,f,v.id,w==null?void 0:w.id].filter(Boolean).join("_"),isPlaceholder:j,placeholderId:j?`${C.filter(F=>F.column===v).length}`:void 0,depth:f,index:C.length});A.subHeaders.push(w),C.push(A)}_.headers.push(w),w.headerGroup=_}),d.push(_),f>0&&m(C,f-1)},g=n.map((h,f)=>Hs(t,h,{depth:u,index:f}));m(g,u-1),d.reverse();const x=h=>h.filter(_=>_.column.getIsVisible()).map(_=>{let C=0,w=0,y=[0];_.subHeaders&&_.subHeaders.length?(y=[],x(_.subHeaders).forEach(v=>{let{colSpan:j,rowSpan:A}=v;C+=j,y.push(A)})):C=1;const S=Math.min(...y);return w=w+S,_.colSpan=C,_.rowSpan=w,{colSpan:C,rowSpan:w}});return x((o=(a=d[0])==null?void 0:a.headers)!=null?o:[]),d}const Xa=(e,n,t,s,o,a,u)=>{let i={id:n,index:s,original:t,depth:o,parentId:u,_valuesCache:{},_uniqueValuesCache:{},getValue:d=>{if(i._valuesCache.hasOwnProperty(d))return i._valuesCache[d];const m=e.getColumn(d);if(m!=null&&m.accessorFn)return i._valuesCache[d]=m.accessorFn(i.original,s),i._valuesCache[d]},getUniqueValues:d=>{if(i._uniqueValuesCache.hasOwnProperty(d))return i._uniqueValuesCache[d];const m=e.getColumn(d);if(m!=null&&m.accessorFn)return m.columnDef.getUniqueValues?(i._uniqueValuesCache[d]=m.columnDef.getUniqueValues(i.original,s),i._uniqueValuesCache[d]):(i._uniqueValuesCache[d]=[i.getValue(d)],i._uniqueValuesCache[d])},renderValue:d=>{var m;return(m=i.getValue(d))!=null?m:e.options.renderFallbackValue},subRows:[],getLeafRows:()=>Wa(i.subRows,d=>d.subRows),getParentRow:()=>i.parentId?e.getRow(i.parentId,!0):void 0,getParentRows:()=>{let d=[],m=i;for(;;){const g=m.getParentRow();if(!g)break;d.push(g),m=g}return d.reverse()},getAllCells:Q(()=>[e.getAllLeafColumns()],d=>d.map(m=>qa(e,i,m,m.id)),J(e.options,"debugRows")),_getAllCellsByColumnId:Q(()=>[i.getAllCells()],d=>d.reduce((m,g)=>(m[g.column.id]=g,m),{}),J(e.options,"debugRows"))};for(let d=0;d<e._features.length;d++){const m=e._features[d];m==null||m.createRow==null||m.createRow(i,e)}return i},Za={createColumn:(e,n)=>{e._getFacetedRowModel=n.options.getFacetedRowModel&&n.options.getFacetedRowModel(n,e.id),e.getFacetedRowModel=()=>e._getFacetedRowModel?e._getFacetedRowModel():n.getPreFilteredRowModel(),e._getFacetedUniqueValues=n.options.getFacetedUniqueValues&&n.options.getFacetedUniqueValues(n,e.id),e.getFacetedUniqueValues=()=>e._getFacetedUniqueValues?e._getFacetedUniqueValues():new Map,e._getFacetedMinMaxValues=n.options.getFacetedMinMaxValues&&n.options.getFacetedMinMaxValues(n,e.id),e.getFacetedMinMaxValues=()=>{if(e._getFacetedMinMaxValues)return e._getFacetedMinMaxValues()}}},oo=(e,n,t)=>{var s,o;const a=t==null||(s=t.toString())==null?void 0:s.toLowerCase();return!!(!((o=e.getValue(n))==null||(o=o.toString())==null||(o=o.toLowerCase())==null)&&o.includes(a))};oo.autoRemove=e=>gt(e);const ao=(e,n,t)=>{var s;return!!(!((s=e.getValue(n))==null||(s=s.toString())==null)&&s.includes(t))};ao.autoRemove=e=>gt(e);const io=(e,n,t)=>{var s;return((s=e.getValue(n))==null||(s=s.toString())==null?void 0:s.toLowerCase())===(t==null?void 0:t.toLowerCase())};io.autoRemove=e=>gt(e);const lo=(e,n,t)=>{var s;return(s=e.getValue(n))==null?void 0:s.includes(t)};lo.autoRemove=e=>gt(e);const uo=(e,n,t)=>!t.some(s=>{var o;return!((o=e.getValue(n))!=null&&o.includes(s))});uo.autoRemove=e=>gt(e)||!(e!=null&&e.length);const co=(e,n,t)=>t.some(s=>{var o;return(o=e.getValue(n))==null?void 0:o.includes(s)});co.autoRemove=e=>gt(e)||!(e!=null&&e.length);const go=(e,n,t)=>e.getValue(n)===t;go.autoRemove=e=>gt(e);const mo=(e,n,t)=>e.getValue(n)==t;mo.autoRemove=e=>gt(e);const ds=(e,n,t)=>{let[s,o]=t;const a=e.getValue(n);return a>=s&&a<=o};ds.resolveFilterValue=e=>{let[n,t]=e,s=typeof n!="number"?parseFloat(n):n,o=typeof t!="number"?parseFloat(t):t,a=n===null||Number.isNaN(s)?-1/0:s,u=t===null||Number.isNaN(o)?1/0:o;if(a>u){const i=a;a=u,u=i}return[a,u]};ds.autoRemove=e=>gt(e)||gt(e[0])&&gt(e[1]);const _t={includesString:oo,includesStringSensitive:ao,equalsString:io,arrIncludes:lo,arrIncludesAll:uo,arrIncludesSome:co,equals:go,weakEquals:mo,inNumberRange:ds};function gt(e){return e==null||e===""}const Qa={getDefaultColumnDef:()=>({filterFn:"auto"}),getInitialState:e=>({columnFilters:[],...e}),getDefaultOptions:e=>({onColumnFiltersChange:tt("columnFilters",e),filterFromLeafRows:!1,maxLeafRowFilterDepth:100}),createColumn:(e,n)=>{e.getAutoFilterFn=()=>{const t=n.getCoreRowModel().flatRows[0],s=t==null?void 0:t.getValue(e.id);return typeof s=="string"?_t.includesString:typeof s=="number"?_t.inNumberRange:typeof s=="boolean"||s!==null&&typeof s=="object"?_t.equals:Array.isArray(s)?_t.arrIncludes:_t.weakEquals},e.getFilterFn=()=>{var t,s;return vr(e.columnDef.filterFn)?e.columnDef.filterFn:e.columnDef.filterFn==="auto"?e.getAutoFilterFn():(t=(s=n.options.filterFns)==null?void 0:s[e.columnDef.filterFn])!=null?t:_t[e.columnDef.filterFn]},e.getCanFilter=()=>{var t,s,o;return((t=e.columnDef.enableColumnFilter)!=null?t:!0)&&((s=n.options.enableColumnFilters)!=null?s:!0)&&((o=n.options.enableFilters)!=null?o:!0)&&!!e.accessorFn},e.getIsFiltered=()=>e.getFilterIndex()>-1,e.getFilterValue=()=>{var t;return(t=n.getState().columnFilters)==null||(t=t.find(s=>s.id===e.id))==null?void 0:t.value},e.getFilterIndex=()=>{var t,s;return(t=(s=n.getState().columnFilters)==null?void 0:s.findIndex(o=>o.id===e.id))!=null?t:-1},e.setFilterValue=t=>{n.setColumnFilters(s=>{const o=e.getFilterFn(),a=s==null?void 0:s.find(g=>g.id===e.id),u=Ot(t,a?a.value:void 0);if(Gs(o,u,e)){var i;return(i=s==null?void 0:s.filter(g=>g.id!==e.id))!=null?i:[]}const d={id:e.id,value:u};if(a){var m;return(m=s==null?void 0:s.map(g=>g.id===e.id?d:g))!=null?m:[]}return s!=null&&s.length?[...s,d]:[d]})}},createRow:(e,n)=>{e.columnFilters={},e.columnFiltersMeta={}},createTable:e=>{e.setColumnFilters=n=>{const t=e.getAllLeafColumns(),s=o=>{var a;return(a=Ot(n,o))==null?void 0:a.filter(u=>{const i=t.find(d=>d.id===u.id);if(i){const d=i.getFilterFn();if(Gs(d,u.value,i))return!1}return!0})};e.options.onColumnFiltersChange==null||e.options.onColumnFiltersChange(s)},e.resetColumnFilters=n=>{var t,s;e.setColumnFilters(n?[]:(t=(s=e.initialState)==null?void 0:s.columnFilters)!=null?t:[])},e.getPreFilteredRowModel=()=>e.getCoreRowModel(),e.getFilteredRowModel=()=>(!e._getFilteredRowModel&&e.options.getFilteredRowModel&&(e._getFilteredRowModel=e.options.getFilteredRowModel(e)),e.options.manualFiltering||!e._getFilteredRowModel?e.getPreFilteredRowModel():e._getFilteredRowModel())}};function Gs(e,n,t){return(e&&e.autoRemove?e.autoRemove(n,t):!1)||typeof n>"u"||typeof n=="string"&&!n}const Ja=(e,n,t)=>t.reduce((s,o)=>{const a=o.getValue(e);return s+(typeof a=="number"?a:0)},0),ei=(e,n,t)=>{let s;return t.forEach(o=>{const a=o.getValue(e);a!=null&&(s>a||s===void 0&&a>=a)&&(s=a)}),s},ti=(e,n,t)=>{let s;return t.forEach(o=>{const a=o.getValue(e);a!=null&&(s<a||s===void 0&&a>=a)&&(s=a)}),s},ni=(e,n,t)=>{let s,o;return t.forEach(a=>{const u=a.getValue(e);u!=null&&(s===void 0?u>=u&&(s=o=u):(s>u&&(s=u),o<u&&(o=u)))}),[s,o]},ri=(e,n)=>{let t=0,s=0;if(n.forEach(o=>{let a=o.getValue(e);a!=null&&(a=+a)>=a&&(++t,s+=a)}),t)return s/t},si=(e,n)=>{if(!n.length)return;const t=n.map(a=>a.getValue(e));if(!Ua(t))return;if(t.length===1)return t[0];const s=Math.floor(t.length/2),o=t.sort((a,u)=>a-u);return t.length%2!==0?o[s]:(o[s-1]+o[s])/2},oi=(e,n)=>Array.from(new Set(n.map(t=>t.getValue(e))).values()),ai=(e,n)=>new Set(n.map(t=>t.getValue(e))).size,ii=(e,n)=>n.length,Gr={sum:Ja,min:ei,max:ti,extent:ni,mean:ri,median:si,unique:oi,uniqueCount:ai,count:ii},li={getDefaultColumnDef:()=>({aggregatedCell:e=>{var n,t;return(n=(t=e.getValue())==null||t.toString==null?void 0:t.toString())!=null?n:null},aggregationFn:"auto"}),getInitialState:e=>({grouping:[],...e}),getDefaultOptions:e=>({onGroupingChange:tt("grouping",e),groupedColumnMode:"reorder"}),createColumn:(e,n)=>{e.toggleGrouping=()=>{n.setGrouping(t=>t!=null&&t.includes(e.id)?t.filter(s=>s!==e.id):[...t??[],e.id])},e.getCanGroup=()=>{var t,s;return((t=e.columnDef.enableGrouping)!=null?t:!0)&&((s=n.options.enableGrouping)!=null?s:!0)&&(!!e.accessorFn||!!e.columnDef.getGroupingValue)},e.getIsGrouped=()=>{var t;return(t=n.getState().grouping)==null?void 0:t.includes(e.id)},e.getGroupedIndex=()=>{var t;return(t=n.getState().grouping)==null?void 0:t.indexOf(e.id)},e.getToggleGroupingHandler=()=>{const t=e.getCanGroup();return()=>{t&&e.toggleGrouping()}},e.getAutoAggregationFn=()=>{const t=n.getCoreRowModel().flatRows[0],s=t==null?void 0:t.getValue(e.id);if(typeof s=="number")return Gr.sum;if(Object.prototype.toString.call(s)==="[object Date]")return Gr.extent},e.getAggregationFn=()=>{var t,s;if(!e)throw new Error;return vr(e.columnDef.aggregationFn)?e.columnDef.aggregationFn:e.columnDef.aggregationFn==="auto"?e.getAutoAggregationFn():(t=(s=n.options.aggregationFns)==null?void 0:s[e.columnDef.aggregationFn])!=null?t:Gr[e.columnDef.aggregationFn]}},createTable:e=>{e.setGrouping=n=>e.options.onGroupingChange==null?void 0:e.options.onGroupingChange(n),e.resetGrouping=n=>{var t,s;e.setGrouping(n?[]:(t=(s=e.initialState)==null?void 0:s.grouping)!=null?t:[])},e.getPreGroupedRowModel=()=>e.getFilteredRowModel(),e.getGroupedRowModel=()=>(!e._getGroupedRowModel&&e.options.getGroupedRowModel&&(e._getGroupedRowModel=e.options.getGroupedRowModel(e)),e.options.manualGrouping||!e._getGroupedRowModel?e.getPreGroupedRowModel():e._getGroupedRowModel())},createRow:(e,n)=>{e.getIsGrouped=()=>!!e.groupingColumnId,e.getGroupingValue=t=>{if(e._groupingValuesCache.hasOwnProperty(t))return e._groupingValuesCache[t];const s=n.getColumn(t);return s!=null&&s.columnDef.getGroupingValue?(e._groupingValuesCache[t]=s.columnDef.getGroupingValue(e.original),e._groupingValuesCache[t]):e.getValue(t)},e._groupingValuesCache={}},createCell:(e,n,t,s)=>{e.getIsGrouped=()=>n.getIsGrouped()&&n.id===t.groupingColumnId,e.getIsPlaceholder=()=>!e.getIsGrouped()&&n.getIsGrouped(),e.getIsAggregated=()=>{var o;return!e.getIsGrouped()&&!e.getIsPlaceholder()&&!!((o=t.subRows)!=null&&o.length)}}};function ui(e,n,t){if(!(n!=null&&n.length)||!t)return e;const s=e.filter(a=>!n.includes(a.id));return t==="remove"?s:[...n.map(a=>e.find(u=>u.id===a)).filter(Boolean),...s]}const di={getInitialState:e=>({columnOrder:[],...e}),getDefaultOptions:e=>({onColumnOrderChange:tt("columnOrder",e)}),createColumn:(e,n)=>{e.getIndex=Q(t=>[Tn(n,t)],t=>t.findIndex(s=>s.id===e.id),J(n.options,"debugColumns")),e.getIsFirstColumn=t=>{var s;return((s=Tn(n,t)[0])==null?void 0:s.id)===e.id},e.getIsLastColumn=t=>{var s;const o=Tn(n,t);return((s=o[o.length-1])==null?void 0:s.id)===e.id}},createTable:e=>{e.setColumnOrder=n=>e.options.onColumnOrderChange==null?void 0:e.options.onColumnOrderChange(n),e.resetColumnOrder=n=>{var t;e.setColumnOrder(n?[]:(t=e.initialState.columnOrder)!=null?t:[])},e._getOrderColumnsFn=Q(()=>[e.getState().columnOrder,e.getState().grouping,e.options.groupedColumnMode],(n,t,s)=>o=>{let a=[];if(!(n!=null&&n.length))a=o;else{const u=[...n],i=[...o];for(;i.length&&u.length;){const d=u.shift(),m=i.findIndex(g=>g.id===d);m>-1&&a.push(i.splice(m,1)[0])}a=[...a,...i]}return ui(a,t,s)},J(e.options,"debugTable"))}},Br=()=>({left:[],right:[]}),ci={getInitialState:e=>({columnPinning:Br(),...e}),getDefaultOptions:e=>({onColumnPinningChange:tt("columnPinning",e)}),createColumn:(e,n)=>{e.pin=t=>{const s=e.getLeafColumns().map(o=>o.id).filter(Boolean);n.setColumnPinning(o=>{var a,u;if(t==="right"){var i,d;return{left:((i=o==null?void 0:o.left)!=null?i:[]).filter(x=>!(s!=null&&s.includes(x))),right:[...((d=o==null?void 0:o.right)!=null?d:[]).filter(x=>!(s!=null&&s.includes(x))),...s]}}if(t==="left"){var m,g;return{left:[...((m=o==null?void 0:o.left)!=null?m:[]).filter(x=>!(s!=null&&s.includes(x))),...s],right:((g=o==null?void 0:o.right)!=null?g:[]).filter(x=>!(s!=null&&s.includes(x)))}}return{left:((a=o==null?void 0:o.left)!=null?a:[]).filter(x=>!(s!=null&&s.includes(x))),right:((u=o==null?void 0:o.right)!=null?u:[]).filter(x=>!(s!=null&&s.includes(x)))}})},e.getCanPin=()=>e.getLeafColumns().some(s=>{var o,a,u;return((o=s.columnDef.enablePinning)!=null?o:!0)&&((a=(u=n.options.enableColumnPinning)!=null?u:n.options.enablePinning)!=null?a:!0)}),e.getIsPinned=()=>{const t=e.getLeafColumns().map(i=>i.id),{left:s,right:o}=n.getState().columnPinning,a=t.some(i=>s==null?void 0:s.includes(i)),u=t.some(i=>o==null?void 0:o.includes(i));return a?"left":u?"right":!1},e.getPinnedIndex=()=>{var t,s;const o=e.getIsPinned();return o?(t=(s=n.getState().columnPinning)==null||(s=s[o])==null?void 0:s.indexOf(e.id))!=null?t:-1:0}},createRow:(e,n)=>{e.getCenterVisibleCells=Q(()=>[e._getAllVisibleCells(),n.getState().columnPinning.left,n.getState().columnPinning.right],(t,s,o)=>{const a=[...s??[],...o??[]];return t.filter(u=>!a.includes(u.column.id))},J(n.options,"debugRows")),e.getLeftVisibleCells=Q(()=>[e._getAllVisibleCells(),n.getState().columnPinning.left],(t,s)=>(s??[]).map(a=>t.find(u=>u.column.id===a)).filter(Boolean).map(a=>({...a,position:"left"})),J(n.options,"debugRows")),e.getRightVisibleCells=Q(()=>[e._getAllVisibleCells(),n.getState().columnPinning.right],(t,s)=>(s??[]).map(a=>t.find(u=>u.column.id===a)).filter(Boolean).map(a=>({...a,position:"right"})),J(n.options,"debugRows"))},createTable:e=>{e.setColumnPinning=n=>e.options.onColumnPinningChange==null?void 0:e.options.onColumnPinningChange(n),e.resetColumnPinning=n=>{var t,s;return e.setColumnPinning(n?Br():(t=(s=e.initialState)==null?void 0:s.columnPinning)!=null?t:Br())},e.getIsSomeColumnsPinned=n=>{var t;const s=e.getState().columnPinning;if(!n){var o,a;return!!((o=s.left)!=null&&o.length||(a=s.right)!=null&&a.length)}return!!((t=s[n])!=null&&t.length)},e.getLeftLeafColumns=Q(()=>[e.getAllLeafColumns(),e.getState().columnPinning.left],(n,t)=>(t??[]).map(s=>n.find(o=>o.id===s)).filter(Boolean),J(e.options,"debugColumns")),e.getRightLeafColumns=Q(()=>[e.getAllLeafColumns(),e.getState().columnPinning.right],(n,t)=>(t??[]).map(s=>n.find(o=>o.id===s)).filter(Boolean),J(e.options,"debugColumns")),e.getCenterLeafColumns=Q(()=>[e.getAllLeafColumns(),e.getState().columnPinning.left,e.getState().columnPinning.right],(n,t,s)=>{const o=[...t??[],...s??[]];return n.filter(a=>!o.includes(a.id))},J(e.options,"debugColumns"))}};function gi(e){return e||(typeof document<"u"?document:null)}const pr={size:150,minSize:20,maxSize:Number.MAX_SAFE_INTEGER},Ur=()=>({startOffset:null,startSize:null,deltaOffset:null,deltaPercentage:null,isResizingColumn:!1,columnSizingStart:[]}),mi={getDefaultColumnDef:()=>pr,getInitialState:e=>({columnSizing:{},columnSizingInfo:Ur(),...e}),getDefaultOptions:e=>({columnResizeMode:"onEnd",columnResizeDirection:"ltr",onColumnSizingChange:tt("columnSizing",e),onColumnSizingInfoChange:tt("columnSizingInfo",e)}),createColumn:(e,n)=>{e.getSize=()=>{var t,s,o;const a=n.getState().columnSizing[e.id];return Math.min(Math.max((t=e.columnDef.minSize)!=null?t:pr.minSize,(s=a??e.columnDef.size)!=null?s:pr.size),(o=e.columnDef.maxSize)!=null?o:pr.maxSize)},e.getStart=Q(t=>[t,Tn(n,t),n.getState().columnSizing],(t,s)=>s.slice(0,e.getIndex(t)).reduce((o,a)=>o+a.getSize(),0),J(n.options,"debugColumns")),e.getAfter=Q(t=>[t,Tn(n,t),n.getState().columnSizing],(t,s)=>s.slice(e.getIndex(t)+1).reduce((o,a)=>o+a.getSize(),0),J(n.options,"debugColumns")),e.resetSize=()=>{n.setColumnSizing(t=>{let{[e.id]:s,...o}=t;return o})},e.getCanResize=()=>{var t,s;return((t=e.columnDef.enableResizing)!=null?t:!0)&&((s=n.options.enableColumnResizing)!=null?s:!0)},e.getIsResizing=()=>n.getState().columnSizingInfo.isResizingColumn===e.id},createHeader:(e,n)=>{e.getSize=()=>{let t=0;const s=o=>{if(o.subHeaders.length)o.subHeaders.forEach(s);else{var a;t+=(a=o.column.getSize())!=null?a:0}};return s(e),t},e.getStart=()=>{if(e.index>0){const t=e.headerGroup.headers[e.index-1];return t.getStart()+t.getSize()}return 0},e.getResizeHandler=t=>{const s=n.getColumn(e.column.id),o=s==null?void 0:s.getCanResize();return a=>{if(!s||!o||(a.persist==null||a.persist(),Wr(a)&&a.touches&&a.touches.length>1))return;const u=e.getSize(),i=e?e.getLeafHeaders().map(y=>[y.column.id,y.column.getSize()]):[[s.id,s.getSize()]],d=Wr(a)?Math.round(a.touches[0].clientX):a.clientX,m={},g=(y,S)=>{typeof S=="number"&&(n.setColumnSizingInfo(v=>{var j,A;const F=n.options.columnResizeDirection==="rtl"?-1:1,B=(S-((j=v==null?void 0:v.startOffset)!=null?j:0))*F,V=Math.max(B/((A=v==null?void 0:v.startSize)!=null?A:0),-.999999);return v.columnSizingStart.forEach(H=>{let[ie,q]=H;m[ie]=Math.round(Math.max(q+q*V,0)*100)/100}),{...v,deltaOffset:B,deltaPercentage:V}}),(n.options.columnResizeMode==="onChange"||y==="end")&&n.setColumnSizing(v=>({...v,...m})))},x=y=>g("move",y),h=y=>{g("end",y),n.setColumnSizingInfo(S=>({...S,isResizingColumn:!1,startOffset:null,startSize:null,deltaOffset:null,deltaPercentage:null,columnSizingStart:[]}))},f=gi(t),_={moveHandler:y=>x(y.clientX),upHandler:y=>{f==null||f.removeEventListener("mousemove",_.moveHandler),f==null||f.removeEventListener("mouseup",_.upHandler),h(y.clientX)}},C={moveHandler:y=>(y.cancelable&&(y.preventDefault(),y.stopPropagation()),x(y.touches[0].clientX),!1),upHandler:y=>{var S;f==null||f.removeEventListener("touchmove",C.moveHandler),f==null||f.removeEventListener("touchend",C.upHandler),y.cancelable&&(y.preventDefault(),y.stopPropagation()),h((S=y.touches[0])==null?void 0:S.clientX)}},w=fi()?{passive:!1}:!1;Wr(a)?(f==null||f.addEventListener("touchmove",C.moveHandler,w),f==null||f.addEventListener("touchend",C.upHandler,w)):(f==null||f.addEventListener("mousemove",_.moveHandler,w),f==null||f.addEventListener("mouseup",_.upHandler,w)),n.setColumnSizingInfo(y=>({...y,startOffset:d,startSize:u,deltaOffset:0,deltaPercentage:0,columnSizingStart:i,isResizingColumn:s.id}))}}},createTable:e=>{e.setColumnSizing=n=>e.options.onColumnSizingChange==null?void 0:e.options.onColumnSizingChange(n),e.setColumnSizingInfo=n=>e.options.onColumnSizingInfoChange==null?void 0:e.options.onColumnSizingInfoChange(n),e.resetColumnSizing=n=>{var t;e.setColumnSizing(n?{}:(t=e.initialState.columnSizing)!=null?t:{})},e.resetHeaderSizeInfo=n=>{var t;e.setColumnSizingInfo(n?Ur():(t=e.initialState.columnSizingInfo)!=null?t:Ur())},e.getTotalSize=()=>{var n,t;return(n=(t=e.getHeaderGroups()[0])==null?void 0:t.headers.reduce((s,o)=>s+o.getSize(),0))!=null?n:0},e.getLeftTotalSize=()=>{var n,t;return(n=(t=e.getLeftHeaderGroups()[0])==null?void 0:t.headers.reduce((s,o)=>s+o.getSize(),0))!=null?n:0},e.getCenterTotalSize=()=>{var n,t;return(n=(t=e.getCenterHeaderGroups()[0])==null?void 0:t.headers.reduce((s,o)=>s+o.getSize(),0))!=null?n:0},e.getRightTotalSize=()=>{var n,t;return(n=(t=e.getRightHeaderGroups()[0])==null?void 0:t.headers.reduce((s,o)=>s+o.getSize(),0))!=null?n:0}}};let hr=null;function fi(){if(typeof hr=="boolean")return hr;let e=!1;try{const n={get passive(){return e=!0,!1}},t=()=>{};window.addEventListener("test",t,n),window.removeEventListener("test",t)}catch{e=!1}return hr=e,hr}function Wr(e){return e.type==="touchstart"}const pi={getInitialState:e=>({columnVisibility:{},...e}),getDefaultOptions:e=>({onColumnVisibilityChange:tt("columnVisibility",e)}),createColumn:(e,n)=>{e.toggleVisibility=t=>{e.getCanHide()&&n.setColumnVisibility(s=>({...s,[e.id]:t??!e.getIsVisible()}))},e.getIsVisible=()=>{var t,s;const o=e.columns;return(t=o.length?o.some(a=>a.getIsVisible()):(s=n.getState().columnVisibility)==null?void 0:s[e.id])!=null?t:!0},e.getCanHide=()=>{var t,s;return((t=e.columnDef.enableHiding)!=null?t:!0)&&((s=n.options.enableHiding)!=null?s:!0)},e.getToggleVisibilityHandler=()=>t=>{e.toggleVisibility==null||e.toggleVisibility(t.target.checked)}},createRow:(e,n)=>{e._getAllVisibleCells=Q(()=>[e.getAllCells(),n.getState().columnVisibility],t=>t.filter(s=>s.column.getIsVisible()),J(n.options,"debugRows")),e.getVisibleCells=Q(()=>[e.getLeftVisibleCells(),e.getCenterVisibleCells(),e.getRightVisibleCells()],(t,s,o)=>[...t,...s,...o],J(n.options,"debugRows"))},createTable:e=>{const n=(t,s)=>Q(()=>[s(),s().filter(o=>o.getIsVisible()).map(o=>o.id).join("_")],o=>o.filter(a=>a.getIsVisible==null?void 0:a.getIsVisible()),J(e.options,"debugColumns"));e.getVisibleFlatColumns=n("getVisibleFlatColumns",()=>e.getAllFlatColumns()),e.getVisibleLeafColumns=n("getVisibleLeafColumns",()=>e.getAllLeafColumns()),e.getLeftVisibleLeafColumns=n("getLeftVisibleLeafColumns",()=>e.getLeftLeafColumns()),e.getRightVisibleLeafColumns=n("getRightVisibleLeafColumns",()=>e.getRightLeafColumns()),e.getCenterVisibleLeafColumns=n("getCenterVisibleLeafColumns",()=>e.getCenterLeafColumns()),e.setColumnVisibility=t=>e.options.onColumnVisibilityChange==null?void 0:e.options.onColumnVisibilityChange(t),e.resetColumnVisibility=t=>{var s;e.setColumnVisibility(t?{}:(s=e.initialState.columnVisibility)!=null?s:{})},e.toggleAllColumnsVisible=t=>{var s;t=(s=t)!=null?s:!e.getIsAllColumnsVisible(),e.setColumnVisibility(e.getAllLeafColumns().reduce((o,a)=>({...o,[a.id]:t||!(a.getCanHide!=null&&a.getCanHide())}),{}))},e.getIsAllColumnsVisible=()=>!e.getAllLeafColumns().some(t=>!(t.getIsVisible!=null&&t.getIsVisible())),e.getIsSomeColumnsVisible=()=>e.getAllLeafColumns().some(t=>t.getIsVisible==null?void 0:t.getIsVisible()),e.getToggleAllColumnsVisibilityHandler=()=>t=>{var s;e.toggleAllColumnsVisible((s=t.target)==null?void 0:s.checked)}}};function Tn(e,n){return n?n==="center"?e.getCenterVisibleLeafColumns():n==="left"?e.getLeftVisibleLeafColumns():e.getRightVisibleLeafColumns():e.getVisibleLeafColumns()}const hi={createTable:e=>{e._getGlobalFacetedRowModel=e.options.getFacetedRowModel&&e.options.getFacetedRowModel(e,"__global__"),e.getGlobalFacetedRowModel=()=>e.options.manualFiltering||!e._getGlobalFacetedRowModel?e.getPreFilteredRowModel():e._getGlobalFacetedRowModel(),e._getGlobalFacetedUniqueValues=e.options.getFacetedUniqueValues&&e.options.getFacetedUniqueValues(e,"__global__"),e.getGlobalFacetedUniqueValues=()=>e._getGlobalFacetedUniqueValues?e._getGlobalFacetedUniqueValues():new Map,e._getGlobalFacetedMinMaxValues=e.options.getFacetedMinMaxValues&&e.options.getFacetedMinMaxValues(e,"__global__"),e.getGlobalFacetedMinMaxValues=()=>{if(e._getGlobalFacetedMinMaxValues)return e._getGlobalFacetedMinMaxValues()}}},xi={getInitialState:e=>({globalFilter:void 0,...e}),getDefaultOptions:e=>({onGlobalFilterChange:tt("globalFilter",e),globalFilterFn:"auto",getColumnCanGlobalFilter:n=>{var t;const s=(t=e.getCoreRowModel().flatRows[0])==null||(t=t._getAllCellsByColumnId()[n.id])==null?void 0:t.getValue();return typeof s=="string"||typeof s=="number"}}),createColumn:(e,n)=>{e.getCanGlobalFilter=()=>{var t,s,o,a;return((t=e.columnDef.enableGlobalFilter)!=null?t:!0)&&((s=n.options.enableGlobalFilter)!=null?s:!0)&&((o=n.options.enableFilters)!=null?o:!0)&&((a=n.options.getColumnCanGlobalFilter==null?void 0:n.options.getColumnCanGlobalFilter(e))!=null?a:!0)&&!!e.accessorFn}},createTable:e=>{e.getGlobalAutoFilterFn=()=>_t.includesString,e.getGlobalFilterFn=()=>{var n,t;const{globalFilterFn:s}=e.options;return vr(s)?s:s==="auto"?e.getGlobalAutoFilterFn():(n=(t=e.options.filterFns)==null?void 0:t[s])!=null?n:_t[s]},e.setGlobalFilter=n=>{e.options.onGlobalFilterChange==null||e.options.onGlobalFilterChange(n)},e.resetGlobalFilter=n=>{e.setGlobalFilter(n?void 0:e.initialState.globalFilter)}}},yi={getInitialState:e=>({expanded:{},...e}),getDefaultOptions:e=>({onExpandedChange:tt("expanded",e),paginateExpandedRows:!0}),createTable:e=>{let n=!1,t=!1;e._autoResetExpanded=()=>{var s,o;if(!n){e._queue(()=>{n=!0});return}if((s=(o=e.options.autoResetAll)!=null?o:e.options.autoResetExpanded)!=null?s:!e.options.manualExpanding){if(t)return;t=!0,e._queue(()=>{e.resetExpanded(),t=!1})}},e.setExpanded=s=>e.options.onExpandedChange==null?void 0:e.options.onExpandedChange(s),e.toggleAllRowsExpanded=s=>{s??!e.getIsAllRowsExpanded()?e.setExpanded(!0):e.setExpanded({})},e.resetExpanded=s=>{var o,a;e.setExpanded(s?{}:(o=(a=e.initialState)==null?void 0:a.expanded)!=null?o:{})},e.getCanSomeRowsExpand=()=>e.getPrePaginationRowModel().flatRows.some(s=>s.getCanExpand()),e.getToggleAllRowsExpandedHandler=()=>s=>{s.persist==null||s.persist(),e.toggleAllRowsExpanded()},e.getIsSomeRowsExpanded=()=>{const s=e.getState().expanded;return s===!0||Object.values(s).some(Boolean)},e.getIsAllRowsExpanded=()=>{const s=e.getState().expanded;return typeof s=="boolean"?s===!0:!(!Object.keys(s).length||e.getRowModel().flatRows.some(o=>!o.getIsExpanded()))},e.getExpandedDepth=()=>{let s=0;return(e.getState().expanded===!0?Object.keys(e.getRowModel().rowsById):Object.keys(e.getState().expanded)).forEach(a=>{const u=a.split(".");s=Math.max(s,u.length)}),s},e.getPreExpandedRowModel=()=>e.getSortedRowModel(),e.getExpandedRowModel=()=>(!e._getExpandedRowModel&&e.options.getExpandedRowModel&&(e._getExpandedRowModel=e.options.getExpandedRowModel(e)),e.options.manualExpanding||!e._getExpandedRowModel?e.getPreExpandedRowModel():e._getExpandedRowModel())},createRow:(e,n)=>{e.toggleExpanded=t=>{n.setExpanded(s=>{var o;const a=s===!0?!0:!!(s!=null&&s[e.id]);let u={};if(s===!0?Object.keys(n.getRowModel().rowsById).forEach(i=>{u[i]=!0}):u=s,t=(o=t)!=null?o:!a,!a&&t)return{...u,[e.id]:!0};if(a&&!t){const{[e.id]:i,...d}=u;return d}return s})},e.getIsExpanded=()=>{var t;const s=n.getState().expanded;return!!((t=n.options.getIsRowExpanded==null?void 0:n.options.getIsRowExpanded(e))!=null?t:s===!0||s!=null&&s[e.id])},e.getCanExpand=()=>{var t,s,o;return(t=n.options.getRowCanExpand==null?void 0:n.options.getRowCanExpand(e))!=null?t:((s=n.options.enableExpanding)!=null?s:!0)&&!!((o=e.subRows)!=null&&o.length)},e.getIsAllParentsExpanded=()=>{let t=!0,s=e;for(;t&&s.parentId;)s=n.getRow(s.parentId,!0),t=s.getIsExpanded();return t},e.getToggleExpandedHandler=()=>{const t=e.getCanExpand();return()=>{t&&e.toggleExpanded()}}}},ns=0,rs=10,qr=()=>({pageIndex:ns,pageSize:rs}),vi={getInitialState:e=>({...e,pagination:{...qr(),...e==null?void 0:e.pagination}}),getDefaultOptions:e=>({onPaginationChange:tt("pagination",e)}),createTable:e=>{let n=!1,t=!1;e._autoResetPageIndex=()=>{var s,o;if(!n){e._queue(()=>{n=!0});return}if((s=(o=e.options.autoResetAll)!=null?o:e.options.autoResetPageIndex)!=null?s:!e.options.manualPagination){if(t)return;t=!0,e._queue(()=>{e.resetPageIndex(),t=!1})}},e.setPagination=s=>{const o=a=>Ot(s,a);return e.options.onPaginationChange==null?void 0:e.options.onPaginationChange(o)},e.resetPagination=s=>{var o;e.setPagination(s?qr():(o=e.initialState.pagination)!=null?o:qr())},e.setPageIndex=s=>{e.setPagination(o=>{let a=Ot(s,o.pageIndex);const u=typeof e.options.pageCount>"u"||e.options.pageCount===-1?Number.MAX_SAFE_INTEGER:e.options.pageCount-1;return a=Math.max(0,Math.min(a,u)),{...o,pageIndex:a}})},e.resetPageIndex=s=>{var o,a;e.setPageIndex(s?ns:(o=(a=e.initialState)==null||(a=a.pagination)==null?void 0:a.pageIndex)!=null?o:ns)},e.resetPageSize=s=>{var o,a;e.setPageSize(s?rs:(o=(a=e.initialState)==null||(a=a.pagination)==null?void 0:a.pageSize)!=null?o:rs)},e.setPageSize=s=>{e.setPagination(o=>{const a=Math.max(1,Ot(s,o.pageSize)),u=o.pageSize*o.pageIndex,i=Math.floor(u/a);return{...o,pageIndex:i,pageSize:a}})},e.setPageCount=s=>e.setPagination(o=>{var a;let u=Ot(s,(a=e.options.pageCount)!=null?a:-1);return typeof u=="number"&&(u=Math.max(-1,u)),{...o,pageCount:u}}),e.getPageOptions=Q(()=>[e.getPageCount()],s=>{let o=[];return s&&s>0&&(o=[...new Array(s)].fill(null).map((a,u)=>u)),o},J(e.options,"debugTable")),e.getCanPreviousPage=()=>e.getState().pagination.pageIndex>0,e.getCanNextPage=()=>{const{pageIndex:s}=e.getState().pagination,o=e.getPageCount();return o===-1?!0:o===0?!1:s<o-1},e.previousPage=()=>e.setPageIndex(s=>s-1),e.nextPage=()=>e.setPageIndex(s=>s+1),e.firstPage=()=>e.setPageIndex(0),e.lastPage=()=>e.setPageIndex(e.getPageCount()-1),e.getPrePaginationRowModel=()=>e.getExpandedRowModel(),e.getPaginationRowModel=()=>(!e._getPaginationRowModel&&e.options.getPaginationRowModel&&(e._getPaginationRowModel=e.options.getPaginationRowModel(e)),e.options.manualPagination||!e._getPaginationRowModel?e.getPrePaginationRowModel():e._getPaginationRowModel()),e.getPageCount=()=>{var s;return(s=e.options.pageCount)!=null?s:Math.ceil(e.getRowCount()/e.getState().pagination.pageSize)},e.getRowCount=()=>{var s;return(s=e.options.rowCount)!=null?s:e.getPrePaginationRowModel().rows.length}}},Yr=()=>({top:[],bottom:[]}),bi={getInitialState:e=>({rowPinning:Yr(),...e}),getDefaultOptions:e=>({onRowPinningChange:tt("rowPinning",e)}),createRow:(e,n)=>{e.pin=(t,s,o)=>{const a=s?e.getLeafRows().map(d=>{let{id:m}=d;return m}):[],u=o?e.getParentRows().map(d=>{let{id:m}=d;return m}):[],i=new Set([...u,e.id,...a]);n.setRowPinning(d=>{var m,g;if(t==="bottom"){var x,h;return{top:((x=d==null?void 0:d.top)!=null?x:[]).filter(C=>!(i!=null&&i.has(C))),bottom:[...((h=d==null?void 0:d.bottom)!=null?h:[]).filter(C=>!(i!=null&&i.has(C))),...Array.from(i)]}}if(t==="top"){var f,_;return{top:[...((f=d==null?void 0:d.top)!=null?f:[]).filter(C=>!(i!=null&&i.has(C))),...Array.from(i)],bottom:((_=d==null?void 0:d.bottom)!=null?_:[]).filter(C=>!(i!=null&&i.has(C)))}}return{top:((m=d==null?void 0:d.top)!=null?m:[]).filter(C=>!(i!=null&&i.has(C))),bottom:((g=d==null?void 0:d.bottom)!=null?g:[]).filter(C=>!(i!=null&&i.has(C)))}})},e.getCanPin=()=>{var t;const{enableRowPinning:s,enablePinning:o}=n.options;return typeof s=="function"?s(e):(t=s??o)!=null?t:!0},e.getIsPinned=()=>{const t=[e.id],{top:s,bottom:o}=n.getState().rowPinning,a=t.some(i=>s==null?void 0:s.includes(i)),u=t.some(i=>o==null?void 0:o.includes(i));return a?"top":u?"bottom":!1},e.getPinnedIndex=()=>{var t,s;const o=e.getIsPinned();if(!o)return-1;const a=(t=o==="top"?n.getTopRows():n.getBottomRows())==null?void 0:t.map(u=>{let{id:i}=u;return i});return(s=a==null?void 0:a.indexOf(e.id))!=null?s:-1}},createTable:e=>{e.setRowPinning=n=>e.options.onRowPinningChange==null?void 0:e.options.onRowPinningChange(n),e.resetRowPinning=n=>{var t,s;return e.setRowPinning(n?Yr():(t=(s=e.initialState)==null?void 0:s.rowPinning)!=null?t:Yr())},e.getIsSomeRowsPinned=n=>{var t;const s=e.getState().rowPinning;if(!n){var o,a;return!!((o=s.top)!=null&&o.length||(a=s.bottom)!=null&&a.length)}return!!((t=s[n])!=null&&t.length)},e._getPinnedRows=(n,t,s)=>{var o;return((o=e.options.keepPinnedRows)==null||o?(t??[]).map(u=>{const i=e.getRow(u,!0);return i.getIsAllParentsExpanded()?i:null}):(t??[]).map(u=>n.find(i=>i.id===u))).filter(Boolean).map(u=>({...u,position:s}))},e.getTopRows=Q(()=>[e.getRowModel().rows,e.getState().rowPinning.top],(n,t)=>e._getPinnedRows(n,t,"top"),J(e.options,"debugRows")),e.getBottomRows=Q(()=>[e.getRowModel().rows,e.getState().rowPinning.bottom],(n,t)=>e._getPinnedRows(n,t,"bottom"),J(e.options,"debugRows")),e.getCenterRows=Q(()=>[e.getRowModel().rows,e.getState().rowPinning.top,e.getState().rowPinning.bottom],(n,t,s)=>{const o=new Set([...t??[],...s??[]]);return n.filter(a=>!o.has(a.id))},J(e.options,"debugRows"))}},Si={getInitialState:e=>({rowSelection:{},...e}),getDefaultOptions:e=>({onRowSelectionChange:tt("rowSelection",e),enableRowSelection:!0,enableMultiRowSelection:!0,enableSubRowSelection:!0}),createTable:e=>{e.setRowSelection=n=>e.options.onRowSelectionChange==null?void 0:e.options.onRowSelectionChange(n),e.resetRowSelection=n=>{var t;return e.setRowSelection(n?{}:(t=e.initialState.rowSelection)!=null?t:{})},e.toggleAllRowsSelected=n=>{e.setRowSelection(t=>{n=typeof n<"u"?n:!e.getIsAllRowsSelected();const s={...t},o=e.getPreGroupedRowModel().flatRows;return n?o.forEach(a=>{a.getCanSelect()&&(s[a.id]=!0)}):o.forEach(a=>{delete s[a.id]}),s})},e.toggleAllPageRowsSelected=n=>e.setRowSelection(t=>{const s=typeof n<"u"?n:!e.getIsAllPageRowsSelected(),o={...t};return e.getRowModel().rows.forEach(a=>{ss(o,a.id,s,!0,e)}),o}),e.getPreSelectedRowModel=()=>e.getCoreRowModel(),e.getSelectedRowModel=Q(()=>[e.getState().rowSelection,e.getCoreRowModel()],(n,t)=>Object.keys(n).length?Kr(e,t):{rows:[],flatRows:[],rowsById:{}},J(e.options,"debugTable")),e.getFilteredSelectedRowModel=Q(()=>[e.getState().rowSelection,e.getFilteredRowModel()],(n,t)=>Object.keys(n).length?Kr(e,t):{rows:[],flatRows:[],rowsById:{}},J(e.options,"debugTable")),e.getGroupedSelectedRowModel=Q(()=>[e.getState().rowSelection,e.getSortedRowModel()],(n,t)=>Object.keys(n).length?Kr(e,t):{rows:[],flatRows:[],rowsById:{}},J(e.options,"debugTable")),e.getIsAllRowsSelected=()=>{const n=e.getFilteredRowModel().flatRows,{rowSelection:t}=e.getState();let s=!!(n.length&&Object.keys(t).length);return s&&n.some(o=>o.getCanSelect()&&!t[o.id])&&(s=!1),s},e.getIsAllPageRowsSelected=()=>{const n=e.getPaginationRowModel().flatRows.filter(o=>o.getCanSelect()),{rowSelection:t}=e.getState();let s=!!n.length;return s&&n.some(o=>!t[o.id])&&(s=!1),s},e.getIsSomeRowsSelected=()=>{var n;const t=Object.keys((n=e.getState().rowSelection)!=null?n:{}).length;return t>0&&t<e.getFilteredRowModel().flatRows.length},e.getIsSomePageRowsSelected=()=>{const n=e.getPaginationRowModel().flatRows;return e.getIsAllPageRowsSelected()?!1:n.filter(t=>t.getCanSelect()).some(t=>t.getIsSelected()||t.getIsSomeSelected())},e.getToggleAllRowsSelectedHandler=()=>n=>{e.toggleAllRowsSelected(n.target.checked)},e.getToggleAllPageRowsSelectedHandler=()=>n=>{e.toggleAllPageRowsSelected(n.target.checked)}},createRow:(e,n)=>{e.toggleSelected=(t,s)=>{const o=e.getIsSelected();n.setRowSelection(a=>{var u;if(t=typeof t<"u"?t:!o,e.getCanSelect()&&o===t)return a;const i={...a};return ss(i,e.id,t,(u=s==null?void 0:s.selectChildren)!=null?u:!0,n),i})},e.getIsSelected=()=>{const{rowSelection:t}=n.getState();return cs(e,t)},e.getIsSomeSelected=()=>{const{rowSelection:t}=n.getState();return os(e,t)==="some"},e.getIsAllSubRowsSelected=()=>{const{rowSelection:t}=n.getState();return os(e,t)==="all"},e.getCanSelect=()=>{var t;return typeof n.options.enableRowSelection=="function"?n.options.enableRowSelection(e):(t=n.options.enableRowSelection)!=null?t:!0},e.getCanSelectSubRows=()=>{var t;return typeof n.options.enableSubRowSelection=="function"?n.options.enableSubRowSelection(e):(t=n.options.enableSubRowSelection)!=null?t:!0},e.getCanMultiSelect=()=>{var t;return typeof n.options.enableMultiRowSelection=="function"?n.options.enableMultiRowSelection(e):(t=n.options.enableMultiRowSelection)!=null?t:!0},e.getToggleSelectedHandler=()=>{const t=e.getCanSelect();return s=>{var o;t&&e.toggleSelected((o=s.target)==null?void 0:o.checked)}}}},ss=(e,n,t,s,o)=>{var a;const u=o.getRow(n,!0);t?(u.getCanMultiSelect()||Object.keys(e).forEach(i=>delete e[i]),u.getCanSelect()&&(e[n]=!0)):delete e[n],s&&(a=u.subRows)!=null&&a.length&&u.getCanSelectSubRows()&&u.subRows.forEach(i=>ss(e,i.id,t,s,o))};function Kr(e,n){const t=e.getState().rowSelection,s=[],o={},a=function(u,i){return u.map(d=>{var m;const g=cs(d,t);if(g&&(s.push(d),o[d.id]=d),(m=d.subRows)!=null&&m.length&&(d={...d,subRows:a(d.subRows)}),g)return d}).filter(Boolean)};return{rows:a(n.rows),flatRows:s,rowsById:o}}function cs(e,n){var t;return(t=n[e.id])!=null?t:!1}function os(e,n,t){var s;if(!((s=e.subRows)!=null&&s.length))return!1;let o=!0,a=!1;return e.subRows.forEach(u=>{if(!(a&&!o)&&(u.getCanSelect()&&(cs(u,n)?a=!0:o=!1),u.subRows&&u.subRows.length)){const i=os(u,n);i==="all"?a=!0:(i==="some"&&(a=!0),o=!1)}}),o?"all":a?"some":!1}const as=/([0-9]+)/gm,wi=(e,n,t)=>fo(Tt(e.getValue(t)).toLowerCase(),Tt(n.getValue(t)).toLowerCase()),_i=(e,n,t)=>fo(Tt(e.getValue(t)),Tt(n.getValue(t))),Ci=(e,n,t)=>gs(Tt(e.getValue(t)).toLowerCase(),Tt(n.getValue(t)).toLowerCase()),Ni=(e,n,t)=>gs(Tt(e.getValue(t)),Tt(n.getValue(t))),ji=(e,n,t)=>{const s=e.getValue(t),o=n.getValue(t);return s>o?1:s<o?-1:0},Mi=(e,n,t)=>gs(e.getValue(t),n.getValue(t));function gs(e,n){return e===n?0:e>n?1:-1}function Tt(e){return typeof e=="number"?isNaN(e)||e===1/0||e===-1/0?"":String(e):typeof e=="string"?e:""}function fo(e,n){const t=e.split(as).filter(Boolean),s=n.split(as).filter(Boolean);for(;t.length&&s.length;){const o=t.shift(),a=s.shift(),u=parseInt(o,10),i=parseInt(a,10),d=[u,i].sort();if(isNaN(d[0])){if(o>a)return 1;if(a>o)return-1;continue}if(isNaN(d[1]))return isNaN(u)?-1:1;if(u>i)return 1;if(i>u)return-1}return t.length-s.length}const Dn={alphanumeric:wi,alphanumericCaseSensitive:_i,text:Ci,textCaseSensitive:Ni,datetime:ji,basic:Mi},Fi={getInitialState:e=>({sorting:[],...e}),getDefaultColumnDef:()=>({sortingFn:"auto",sortUndefined:1}),getDefaultOptions:e=>({onSortingChange:tt("sorting",e),isMultiSortEvent:n=>n.shiftKey}),createColumn:(e,n)=>{e.getAutoSortingFn=()=>{const t=n.getFilteredRowModel().flatRows.slice(10);let s=!1;for(const o of t){const a=o==null?void 0:o.getValue(e.id);if(Object.prototype.toString.call(a)==="[object Date]")return Dn.datetime;if(typeof a=="string"&&(s=!0,a.split(as).length>1))return Dn.alphanumeric}return s?Dn.text:Dn.basic},e.getAutoSortDir=()=>{const t=n.getFilteredRowModel().flatRows[0];return typeof(t==null?void 0:t.getValue(e.id))=="string"?"asc":"desc"},e.getSortingFn=()=>{var t,s;if(!e)throw new Error;return vr(e.columnDef.sortingFn)?e.columnDef.sortingFn:e.columnDef.sortingFn==="auto"?e.getAutoSortingFn():(t=(s=n.options.sortingFns)==null?void 0:s[e.columnDef.sortingFn])!=null?t:Dn[e.columnDef.sortingFn]},e.toggleSorting=(t,s)=>{const o=e.getNextSortingOrder(),a=typeof t<"u"&&t!==null;n.setSorting(u=>{const i=u==null?void 0:u.find(f=>f.id===e.id),d=u==null?void 0:u.findIndex(f=>f.id===e.id);let m=[],g,x=a?t:o==="desc";if(u!=null&&u.length&&e.getCanMultiSort()&&s?i?g="toggle":g="add":u!=null&&u.length&&d!==u.length-1?g="replace":i?g="toggle":g="replace",g==="toggle"&&(a||o||(g="remove")),g==="add"){var h;m=[...u,{id:e.id,desc:x}],m.splice(0,m.length-((h=n.options.maxMultiSortColCount)!=null?h:Number.MAX_SAFE_INTEGER))}else g==="toggle"?m=u.map(f=>f.id===e.id?{...f,desc:x}:f):g==="remove"?m=u.filter(f=>f.id!==e.id):m=[{id:e.id,desc:x}];return m})},e.getFirstSortDir=()=>{var t,s;return((t=(s=e.columnDef.sortDescFirst)!=null?s:n.options.sortDescFirst)!=null?t:e.getAutoSortDir()==="desc")?"desc":"asc"},e.getNextSortingOrder=t=>{var s,o;const a=e.getFirstSortDir(),u=e.getIsSorted();return u?u!==a&&((s=n.options.enableSortingRemoval)==null||s)&&(!(t&&(o=n.options.enableMultiRemove)!=null)||o)?!1:u==="desc"?"asc":"desc":a},e.getCanSort=()=>{var t,s;return((t=e.columnDef.enableSorting)!=null?t:!0)&&((s=n.options.enableSorting)!=null?s:!0)&&!!e.accessorFn},e.getCanMultiSort=()=>{var t,s;return(t=(s=e.columnDef.enableMultiSort)!=null?s:n.options.enableMultiSort)!=null?t:!!e.accessorFn},e.getIsSorted=()=>{var t;const s=(t=n.getState().sorting)==null?void 0:t.find(o=>o.id===e.id);return s?s.desc?"desc":"asc":!1},e.getSortIndex=()=>{var t,s;return(t=(s=n.getState().sorting)==null?void 0:s.findIndex(o=>o.id===e.id))!=null?t:-1},e.clearSorting=()=>{n.setSorting(t=>t!=null&&t.length?t.filter(s=>s.id!==e.id):[])},e.getToggleSortingHandler=()=>{const t=e.getCanSort();return s=>{t&&(s.persist==null||s.persist(),e.toggleSorting==null||e.toggleSorting(void 0,e.getCanMultiSort()?n.options.isMultiSortEvent==null?void 0:n.options.isMultiSortEvent(s):!1))}}},createTable:e=>{e.setSorting=n=>e.options.onSortingChange==null?void 0:e.options.onSortingChange(n),e.resetSorting=n=>{var t,s;e.setSorting(n?[]:(t=(s=e.initialState)==null?void 0:s.sorting)!=null?t:[])},e.getPreSortedRowModel=()=>e.getGroupedRowModel(),e.getSortedRowModel=()=>(!e._getSortedRowModel&&e.options.getSortedRowModel&&(e._getSortedRowModel=e.options.getSortedRowModel(e)),e.options.manualSorting||!e._getSortedRowModel?e.getPreSortedRowModel():e._getSortedRowModel())}},Ri=[Ka,pi,di,ci,Za,Qa,hi,xi,Fi,li,yi,vi,bi,Si,mi];function $i(e){var n,t;const s=[...Ri,...(n=e._features)!=null?n:[]];let o={_features:s};const a=o._features.reduce((h,f)=>Object.assign(h,f.getDefaultOptions==null?void 0:f.getDefaultOptions(o)),{}),u=h=>o.options.mergeOptions?o.options.mergeOptions(a,h):{...a,...h};let d={...{},...(t=e.initialState)!=null?t:{}};o._features.forEach(h=>{var f;d=(f=h.getInitialState==null?void 0:h.getInitialState(d))!=null?f:d});const m=[];let g=!1;const x={_features:s,options:{...a,...e},initialState:d,_queue:h=>{m.push(h),g||(g=!0,Promise.resolve().then(()=>{for(;m.length;)m.shift()();g=!1}).catch(f=>setTimeout(()=>{throw f})))},reset:()=>{o.setState(o.initialState)},setOptions:h=>{const f=Ot(h,o.options);o.options=u(f)},getState:()=>o.options.state,setState:h=>{o.options.onStateChange==null||o.options.onStateChange(h)},_getRowId:(h,f,_)=>{var C;return(C=o.options.getRowId==null?void 0:o.options.getRowId(h,f,_))!=null?C:`${_?[_.id,f].join("."):f}`},getCoreRowModel:()=>(o._getCoreRowModel||(o._getCoreRowModel=o.options.getCoreRowModel(o)),o._getCoreRowModel()),getRowModel:()=>o.getPaginationRowModel(),getRow:(h,f)=>{let _=(f?o.getPrePaginationRowModel():o.getRowModel()).rowsById[h];if(!_&&(_=o.getCoreRowModel().rowsById[h],!_))throw new Error;return _},_getDefaultColumnDef:Q(()=>[o.options.defaultColumn],h=>{var f;return h=(f=h)!=null?f:{},{header:_=>{const C=_.header.column.columnDef;return C.accessorKey?C.accessorKey:C.accessorFn?C.id:null},cell:_=>{var C,w;return(C=(w=_.renderValue())==null||w.toString==null?void 0:w.toString())!=null?C:null},...o._features.reduce((_,C)=>Object.assign(_,C.getDefaultColumnDef==null?void 0:C.getDefaultColumnDef()),{}),...h}},J(e,"debugColumns")),_getColumnDefs:()=>o.options.columns,getAllColumns:Q(()=>[o._getColumnDefs()],h=>{const f=function(_,C,w){return w===void 0&&(w=0),_.map(y=>{const S=Ya(o,y,w,C),v=y;return S.columns=v.columns?f(v.columns,S,w+1):[],S})};return f(h)},J(e,"debugColumns")),getAllFlatColumns:Q(()=>[o.getAllColumns()],h=>h.flatMap(f=>f.getFlatColumns()),J(e,"debugColumns")),_getAllFlatColumnsById:Q(()=>[o.getAllFlatColumns()],h=>h.reduce((f,_)=>(f[_.id]=_,f),{}),J(e,"debugColumns")),getAllLeafColumns:Q(()=>[o.getAllColumns(),o._getOrderColumnsFn()],(h,f)=>{let _=h.flatMap(C=>C.getLeafColumns());return f(_)},J(e,"debugColumns")),getColumn:h=>o._getAllFlatColumnsById()[h]};Object.assign(o,x);for(let h=0;h<o._features.length;h++){const f=o._features[h];f==null||f.createTable==null||f.createTable(o)}return o}function Bs(){return e=>Q(()=>[e.options.data],n=>{const t={rows:[],flatRows:[],rowsById:{}},s=function(o,a,u){a===void 0&&(a=0);const i=[];for(let m=0;m<o.length;m++){const g=Xa(e,e._getRowId(o[m],m,u),o[m],m,a,void 0,u==null?void 0:u.id);if(t.flatRows.push(g),t.rowsById[g.id]=g,i.push(g),e.options.getSubRows){var d;g.originalSubRows=e.options.getSubRows(o[m],m),(d=g.originalSubRows)!=null&&d.length&&(g.subRows=s(g.originalSubRows,a+1,g))}}return i};return t.rows=s(n),t},J(e.options,"debugTable","getRowModel",()=>e._autoResetPageIndex()))}function Ei(e){const n=[],t=s=>{var o;n.push(s),(o=s.subRows)!=null&&o.length&&s.getIsExpanded()&&s.subRows.forEach(t)};return e.rows.forEach(t),{rows:n,flatRows:e.flatRows,rowsById:e.rowsById}}function Us(e){return n=>Q(()=>[n.getState().pagination,n.getPrePaginationRowModel(),n.options.paginateExpandedRows?void 0:n.getState().expanded],(t,s)=>{if(!s.rows.length)return s;const{pageSize:o,pageIndex:a}=t;let{rows:u,flatRows:i,rowsById:d}=s;const m=o*a,g=m+o;u=u.slice(m,g);let x;n.options.paginateExpandedRows?x={rows:u,flatRows:i,rowsById:d}:x=Ei({rows:u,flatRows:i,rowsById:d}),x.flatRows=[];const h=f=>{x.flatRows.push(f),f.subRows.length&&f.subRows.forEach(h)};return x.rows.forEach(h),x},J(n.options,"debugTable"))}function Ws(){return e=>Q(()=>[e.getState().sorting,e.getPreSortedRowModel()],(n,t)=>{if(!t.rows.length||!(n!=null&&n.length))return t;const s=e.getState().sorting,o=[],a=s.filter(d=>{var m;return(m=e.getColumn(d.id))==null?void 0:m.getCanSort()}),u={};a.forEach(d=>{const m=e.getColumn(d.id);m&&(u[d.id]={sortUndefined:m.columnDef.sortUndefined,invertSorting:m.columnDef.invertSorting,sortingFn:m.getSortingFn()})});const i=d=>{const m=d.map(g=>({...g}));return m.sort((g,x)=>{for(let f=0;f<a.length;f+=1){var h;const _=a[f],C=u[_.id],w=C.sortUndefined,y=(h=_==null?void 0:_.desc)!=null?h:!1;let S=0;if(w){const v=g.getValue(_.id),j=x.getValue(_.id),A=v===void 0,F=j===void 0;if(A||F){if(w==="first")return A?-1:1;if(w==="last")return A?1:-1;S=A&&F?0:A?w:-w}}if(S===0&&(S=C.sortingFn(g,x,_.id)),S!==0)return y&&(S*=-1),C.invertSorting&&(S*=-1),S}return g.index-x.index}),m.forEach(g=>{var x;o.push(g),(x=g.subRows)!=null&&x.length&&(g.subRows=i(g.subRows))}),m};return{rows:i(t.rows),flatRows:o,rowsById:t.rowsById}},J(e.options,"debugTable","getSortedRowModel",()=>e._autoResetPageIndex()))}/**
   * react-table
   *
   * Copyright (c) TanStack
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE.md file in the root directory of this source tree.
   *
   * @license MIT
   */function qs(e,n){return e?Ii(e)?p.createElement(e,n):e:null}function Ii(e){return Ai(e)||typeof e=="function"||ki(e)}function Ai(e){return typeof e=="function"&&(()=>{const n=Object.getPrototypeOf(e);return n.prototype&&n.prototype.isReactComponent})()}function ki(e){return typeof e=="object"&&typeof e.$$typeof=="symbol"&&["react.memo","react.forward_ref"].includes(e.$$typeof.description)}function Ys(e){const n={state:{},onStateChange:()=>{},renderFallbackValue:null,...e},[t]=p.useState(()=>({current:$i(n)})),[s,o]=p.useState(()=>t.current.initialState);return t.current.setOptions(a=>({...a,...e,state:{...s,...e.state},onStateChange:u=>{o(u),e.onStateChange==null||e.onStateChange(u)}})),t.current}function po({nodes:e,edges:n,onNodesChange:t,onEdgesChange:s,onBlur:o,editable:a=!1}){const[u,i]=p.useState("nodes"),[d,m]=p.useState(e),[g,x]=p.useState(n),h=p.useRef(new Map),f=p.useRef(new Map);p.useEffect(()=>{m([...e]),x([...n]),h.current.clear(),f.current.clear()},[e,n]);const _=p.useMemo(()=>{if(e.length===0)return[];const v=new Set;e.forEach(F=>{Object.keys(F).forEach(B=>{B==="_totalIncoming"||B==="_totalOutgoing"||v.add(B)})});const j=Array.from(v);return[...j.includes("id")?["id"]:[],...j.includes("label")?["label"]:[],...j.filter(F=>F!=="id"&&F!=="label")].map(F=>({header:F.charAt(0).toUpperCase()+F.slice(1).replace(/_/g," "),accessorKey:F,cell:B=>{var H;const V=B.getValue();if(a&&F!=="id"){const q=B.row.original.id,ue=d.findIndex(le=>le.id===q);if(ue===-1)return r.jsx("span",{children:"-"});const E=((H=d[ue])==null?void 0:H[F])??V,ee=`${q}-${F}`;return r.jsx(Xr,{id:ee,type:typeof E=="number"?"number":"text",initialValue:E==null?"":String(E),isNumber:typeof E=="number",onBlur:le=>{const xe=[...d],de=typeof E=="number"?parseFloat(le)||0:le;xe[ue]={...xe[ue],[F]:de},m(xe),t==null||t(xe),o==null||o()}},ee)}return V==null?"-":typeof V=="number"?V.toLocaleString():String(V)}}))},[e,a]),C=p.useMemo(()=>{if(n.length===0)return[];const v=new Set;n.forEach(F=>{Object.keys(F).forEach(B=>v.add(B))});const j=Array.from(v);return[...j.includes("source")?["source"]:[],...j.includes("target")?["target"]:[],...j.includes("value")?["value"]:[],...j.filter(F=>F!=="source"&&F!=="target"&&F!=="value")].map(F=>({header:F.charAt(0).toUpperCase()+F.slice(1).replace(/_/g," "),accessorKey:F,cell:B=>{var H,ie;const V=B.getValue();if(a&&F!=="source"&&F!=="target"){const q=B.row.original,ue=g.findIndex(le=>le.source===q.source&&le.target===q.target&&le.value===q.value);if(ue===-1){const le=g.findIndex(we=>we.source===q.source&&we.target===q.target);if(le===-1)return r.jsx("span",{children:"-"});const xe=((H=g[le])==null?void 0:H[F])??V,de=`${q.source}-${q.target}-${F}-fallback`;return r.jsx(Xr,{id:de,type:typeof xe=="number"?"number":"text",initialValue:xe==null?"":String(xe),isNumber:typeof xe=="number",onBlur:we=>{const Fe=[...g],R=typeof xe=="number"?parseFloat(we)||0:we;Fe[le]={...Fe[le],[F]:R},x(Fe),s==null||s(Fe),o==null||o()}},de)}const E=((ie=g[ue])==null?void 0:ie[F])??V,ee=`${q.source}-${q.target}-${F}`;return r.jsx(Xr,{id:ee,type:typeof E=="number"?"number":"text",initialValue:E==null?"":String(E),isNumber:typeof E=="number",onBlur:le=>{const xe=[...g],de=typeof E=="number"?parseFloat(le)||0:le;xe[ue]={...xe[ue],[F]:de},x(xe),s==null||s(xe),o==null||o()}},ee)}return V==null?"-":typeof V=="number"?V.toLocaleString():String(V)}}))},[n,a]),w=Ys({data:a?d:e,columns:_,getCoreRowModel:Bs(),getSortedRowModel:Ws(),getPaginationRowModel:Us(),initialState:{pagination:{pageSize:25}}}),y=Ys({data:a?g:n,columns:C,getCoreRowModel:Bs(),getSortedRowModel:Ws(),getPaginationRowModel:Us(),initialState:{pagination:{pageSize:25}}}),S=u==="nodes"?w:y;return r.jsxs("div",{className:"h-full w-full flex flex-col",style:{height:"100%",maxHeight:"100%"},children:[r.jsxs("div",{className:"flex border-b mb-4 flex-shrink-0",children:[r.jsxs("button",{onClick:()=>i("nodes"),className:`px-4 py-2 font-medium text-sm transition-colors ${u==="nodes"?"border-b-2 border-blue-600 text-blue-600":"text-gray-600 hover:text-gray-900"}`,children:["Nodes (",e.length,")"]}),r.jsxs("button",{onClick:()=>i("edges"),className:`px-4 py-2 font-medium text-sm transition-colors ${u==="edges"?"border-b-2 border-blue-600 text-blue-600":"text-gray-600 hover:text-gray-900"}`,children:["Edges (",n.length,")"]})]}),r.jsx("div",{className:"flex-1 flex flex-col min-h-0 overflow-hidden",children:r.jsxs("div",{className:"overflow-auto flex-1 min-h-0",children:[r.jsxs("table",{className:"min-w-full text-sm",children:[r.jsx("thead",{className:"bg-gray-50 border-b sticky top-0 z-10",children:S.getHeaderGroups().map(v=>r.jsx("tr",{children:v.headers.map(j=>r.jsx("th",{className:"px-4 py-2 text-left font-semibold text-gray-700 bg-gray-50",children:j.isPlaceholder?null:r.jsxs("div",{className:j.column.getCanSort()?"cursor-pointer select-none hover:text-blue-600":"",onClick:j.column.getToggleSortingHandler(),children:[qs(j.column.columnDef.header,j.getContext()),{asc:" ↑",desc:" ↓"}[j.column.getIsSorted()]??null]})},j.id))},v.id))}),r.jsx("tbody",{className:"divide-y divide-gray-200 bg-white",children:S.getRowModel().rows.map(v=>r.jsx("tr",{className:"hover:bg-gray-50",children:v.getVisibleCells().map(j=>r.jsx("td",{className:"px-4 py-2",children:qs(j.column.columnDef.cell,j.getContext())},j.id))},v.id))})]}),S.getRowModel().rows.length===0&&r.jsxs("div",{className:"text-center text-gray-500 py-8",children:["No ",u," to display"]})]})}),r.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-t border-gray-200 bg-white flex-shrink-0",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("span",{className:"text-sm text-gray-700",children:"Show"}),r.jsx("select",{value:S.getState().pagination.pageSize,onChange:v=>{S.setPageSize(Number(v.target.value))},className:"border border-gray-300 rounded px-2 py-1 text-sm",children:[10,25,50,100].map(v=>r.jsx("option",{value:v,children:v},v))}),r.jsx("span",{className:"text-sm text-gray-700",children:"entries"})]}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsxs("span",{className:"text-sm text-gray-700",children:["Page ",S.getState().pagination.pageIndex+1," of"," ",S.getPageCount()]}),r.jsxs("div",{className:"flex gap-1",children:[r.jsx("button",{onClick:()=>S.setPageIndex(0),disabled:!S.getCanPreviousPage(),className:"px-2 py-1 text-sm border border-gray-300 rounded disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-50",children:"<<"}),r.jsx("button",{onClick:()=>S.previousPage(),disabled:!S.getCanPreviousPage(),className:"px-2 py-1 text-sm border border-gray-300 rounded disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-50",children:"<"}),r.jsx("button",{onClick:()=>S.nextPage(),disabled:!S.getCanNextPage(),className:"px-2 py-1 text-sm border border-gray-300 rounded disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-50",children:">"}),r.jsx("button",{onClick:()=>S.setPageIndex(S.getPageCount()-1),disabled:!S.getCanNextPage(),className:"px-2 py-1 text-sm border border-gray-300 rounded disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-50",children:">>"})]})]})]})]})}function Xr({id:e,type:n,initialValue:t,onBlur:s}){const o=p.useRef(null),[a,u]=p.useState(t);return p.useEffect(()=>{o.current&&document.activeElement!==o.current&&u(t)},[t]),r.jsx("input",{ref:o,id:e,type:n,value:a,onChange:i=>{u(i.target.value)},onBlur:i=>{s(i.target.value)},className:"w-full px-2 py-1 border border-gray-300 rounded text-sm focus:outline-none focus:ring-2 focus:ring-blue-500",autoComplete:"off"})}function Pi({dataset:e,onClose:n,onSave:t,onDelete:s,onDuplicate:o}){const[a,u]=p.useState(e.name),[i,d]=p.useState(e.notes||""),[m,g]=p.useState(!1),[x,h]=p.useState(!1),[f,_]=p.useState(!1),[C,w]=p.useState("info"),[y,S]=p.useState(null),v=e.snapshots[0]||{timestamp:e.timeRange.start,nodes:[],edges:[]};p.useEffect(()=>{u(e.name),d(e.notes||""),S(null)},[e]);async function j(){g(!0);try{const V={...e,name:a.trim(),notes:i.trim()||void 0};if(y){V.snapshots=y.snapshots;const H=V.snapshots[0]||v;V.metadata=tn(H)}await t(V),n()}catch(V){console.error("Save error:",V),alert("Failed to save dataset: "+(V instanceof Error?V.message:"Unknown error"))}finally{g(!1)}}async function A(){h(!0);try{await s(),n()}catch(V){console.error("Delete error:",V),alert("Failed to delete dataset: "+(V instanceof Error?V.message:"Unknown error"))}finally{h(!1),_(!1)}}function F(V,H){const ie={...v,nodes:V,edges:H};S({...e,snapshots:[ie]})}const B=a!==e.name||i!==(e.notes||"")||y!==null;return r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:r.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-6xl w-full mx-4 max-h-[90vh] flex flex-col",children:[r.jsxs("div",{className:"p-6 border-b flex items-center justify-between",children:[r.jsx("h2",{className:"text-2xl font-bold",children:"Edit Dataset"}),r.jsx("button",{onClick:n,type:"button",className:"text-gray-400 hover:text-gray-600 text-2xl cursor-pointer transition-colors",children:"×"})]}),r.jsxs("div",{className:"border-b flex",children:[r.jsx("button",{onClick:()=>w("info"),type:"button",className:`px-6 py-3 font-medium cursor-pointer transition-colors ${C==="info"?"border-b-2 border-blue-600 text-blue-600":"text-gray-600 hover:text-gray-900"}`,children:"Information"}),r.jsxs("button",{onClick:()=>w("data"),type:"button",className:`px-6 py-3 font-medium cursor-pointer transition-colors ${C==="data"?"border-b-2 border-blue-600 text-blue-600":"text-gray-600 hover:text-gray-900"}`,children:["Data (",v.nodes.length," nodes, ",v.edges.length," edges)"]})]}),r.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:C==="info"?r.jsxs("div",{className:"space-y-6 max-w-2xl",children:[r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Dataset Name ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsx("input",{type:"text",value:a,onChange:V=>u(V.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Enter a name for this dataset"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Notes"}),r.jsx("textarea",{value:i,onChange:V=>d(V.target.value),rows:5,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Add any notes about this dataset..."})]}),r.jsxs("div",{className:"bg-gray-50 p-4 rounded",children:[r.jsx("h3",{className:"font-medium text-gray-700 mb-2",children:"Dataset Information"}),r.jsxs("div",{className:"text-sm text-gray-600 space-y-1",children:[r.jsxs("div",{children:[r.jsx("span",{className:"font-medium",children:"Type:"})," ",e.type.toUpperCase()]}),r.jsxs("div",{children:[r.jsx("span",{className:"font-medium",children:"Time Range:"})," ",e.timeRange.start,e.timeRange.end!==e.timeRange.start?` – ${e.timeRange.end}`:""]}),r.jsxs("div",{children:[r.jsx("span",{className:"font-medium",children:"Snapshots:"})," ",e.snapshots.length]}),e.filename&&r.jsxs("div",{children:[r.jsx("span",{className:"font-medium",children:"Original File:"})," ",e.filename]}),r.jsxs("div",{children:[r.jsx("span",{className:"font-medium",children:"Created:"})," ",new Date(e.createdAt).toLocaleDateString()]})]})]}),r.jsxs("div",{className:"border-t pt-4 space-y-3",children:[r.jsx("button",{onClick:o,type:"button",className:"w-full px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50 cursor-pointer transition-colors",children:"Duplicate Dataset"}),r.jsx("button",{onClick:()=>_(!0),type:"button",className:"w-full px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 cursor-pointer transition-colors",children:"Delete Dataset"})]})]}):r.jsx("div",{className:"h-full",children:r.jsx(Vi,{nodes:v.nodes,edges:v.edges,onUpdate:F})})}),r.jsxs("div",{className:"p-6 border-t flex justify-end gap-3",children:[r.jsx("button",{onClick:n,type:"button",disabled:m||x,className:"px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50 disabled:opacity-50 cursor-pointer transition-colors",children:"Cancel"}),r.jsx("button",{onClick:j,type:"button",disabled:m||x||!B&&C==="info"||!a.trim(),className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed cursor-pointer transition-colors",children:m?"Saving...":y?"Save All Changes":"Save Changes"})]}),f&&r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-60",children:r.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md mx-4",children:[r.jsx("h3",{className:"text-lg font-bold mb-2",children:"Delete Dataset?"}),r.jsxs("p",{className:"text-gray-600 mb-4",children:['Are you sure you want to delete "',e.name,'"? This action cannot be undone.']}),r.jsxs("div",{className:"flex justify-end gap-3",children:[r.jsx("button",{onClick:()=>_(!1),type:"button",disabled:x,className:"px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50 cursor-pointer transition-colors",children:"Cancel"}),r.jsx("button",{onClick:A,type:"button",disabled:x,className:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 disabled:opacity-50 cursor-pointer transition-colors",children:x?"Deleting...":"Delete"})]})]})})]})})}function Vi({nodes:e,edges:n,onUpdate:t}){const[s,o]=p.useState(e),[a,u]=p.useState(n);p.useEffect(()=>{o([...e]),u([...n])},[e,n]);const i=p.useRef(s),d=p.useRef(a);p.useEffect(()=>{i.current=s,d.current=a},[s,a]);const m=p.useCallback(f=>{o(f),i.current=f},[]),g=p.useCallback(f=>{u(f),d.current=f},[]),x=p.useRef(!1),h=p.useCallback(()=>{x.current&&(t(i.current,d.current),x.current=!1)},[t]);return r.jsx("div",{className:"h-full",children:r.jsx(po,{nodes:s,edges:a,onNodesChange:f=>{m(f),x.current=!0},onEdgesChange:f=>{g(f),x.current=!0},onBlur:h,editable:!0})})}class Pt extends p.Component{constructor(n){super(n),this.state={hasError:!1,error:null}}static getDerivedStateFromError(n){return{hasError:!0,error:n}}componentDidCatch(n,t){var s,o;console.error("ErrorBoundary caught an error:",n,t),(o=(s=this.props).onError)==null||o.call(s,n,t)}render(){var n;return this.state.hasError?this.props.fallback?this.props.fallback:r.jsxs("div",{className:"p-4 bg-red-50 border border-red-200 rounded-md",children:[r.jsx("h3",{className:"text-lg font-semibold text-red-800 mb-2",children:"Something went wrong"}),r.jsx("p",{className:"text-sm text-red-700 mb-2",children:((n=this.state.error)==null?void 0:n.message)||"An error occurred"}),r.jsx("button",{onClick:()=>this.setState({hasError:!1,error:null}),className:"px-3 py-1 bg-red-600 text-white text-sm rounded hover:bg-red-700 cursor-pointer transition-colors",children:"Try again"})]}):this.props.children}}function Di({selectedId:e,onSelect:n,onRefresh:t}){const[s,o]=p.useState([]),[a,u]=p.useState(!1),[i,d]=p.useState(null),[m,g]=p.useState(!1),[x,h]=p.useState(null),f=p.useRef(null);p.useEffect(()=>{_()},[]);async function _(){const A=await La();o(A)}async function C(A,F){try{const V=`${A.type||"csv"}-${Date.now()}`,H={...A,id:V,snapshots:F.snapshots,metadata:F.metadata,createdAt:Date.now()};await Vt(H),await _(),u(!1),h(null),n(V)}catch(B){throw console.error("Import error:",B),B}finally{f.current&&(f.current.value="")}}async function w(A,F){F.stopPropagation();const B=await Dt(A);B&&d(B)}async function y(A){await Vt(A),await _(),e===A.id&&(t==null||t())}async function S(){i&&(await ts(i.id),await _(),e===i.id&&n(""),d(null))}async function v(){if(!i)return;const A=await za(i.id);await _(),d(null),n(A.id)}async function j(){await Ha(),await _(),g(!1),n(""),window.location.reload()}return r.jsxs("aside",{className:"h-full overflow-y-auto flex flex-col",children:[r.jsxs("div",{className:"p-4 border-b",children:[r.jsx("h2",{className:"text-lg font-bold",children:"Datasets"}),r.jsx("p",{className:"text-xs text-gray-500",children:"Stored in your browser"}),r.jsx("button",{onClick:()=>u(!0),className:"mt-3 w-full px-3 py-2 bg-blue-600 text-white text-sm rounded hover:bg-blue-700",children:"Import Dataset"}),r.jsx("input",{ref:f,type:"file",accept:".csv,.gexf",multiple:!0,className:"hidden"}),a&&r.jsx(Pt,{fallback:r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:r.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md mx-4",children:[r.jsx("h3",{className:"text-lg font-bold text-red-800 mb-2",children:"Import Panel Error"}),r.jsx("p",{className:"text-gray-600 mb-4",children:"The import panel encountered an error."}),r.jsx("button",{onClick:()=>u(!1),className:"px-4 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-700 cursor-pointer transition-colors",children:"Close"})]})}),children:r.jsx(Ba,{onClose:()=>{u(!1),h(null),f.current&&(f.current.value="")},onImport:C,fileInputRef:f,onFilesSelected:h,existingFile:x})})]}),r.jsxs("ul",{className:"divide-y flex-1 overflow-y-auto",children:[s.map(A=>r.jsx("li",{children:r.jsxs("div",{className:`flex items-center group ${e===A.id?"bg-blue-50":""}`,children:[r.jsxs("button",{className:"flex-1 text-left p-3 hover:bg-gray-50",onClick:()=>n(A.id),children:[r.jsx("div",{className:"flex items-center justify-between",children:r.jsxs("div",{children:[r.jsx("div",{className:"font-medium",children:A.name}),r.jsxs("div",{className:"text-xs text-gray-500",children:[A.type.toUpperCase()," · ",A.timeRange.start,A.timeRange.end!==A.timeRange.start?`–${A.timeRange.end}`:""]})]})}),A.notes&&r.jsx("div",{className:"text-xs text-gray-600 mt-1 line-clamp-2",children:A.notes})]}),r.jsx("button",{onClick:F=>w(A.id,F),className:"px-2 py-1 text-gray-400 hover:text-blue-600 hover:bg-gray-100 rounded transition-all mr-2 cursor-pointer",title:"Edit dataset",type:"button",children:r.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})})})]})},A.id)),s.length===0&&r.jsx("li",{className:"p-3 text-sm text-gray-500",children:"No datasets yet"})]}),r.jsxs("div",{className:"p-4 border-t",children:[r.jsx("button",{onClick:()=>g(!0),type:"button",className:"w-full px-3 py-2 bg-red-600 text-white text-sm rounded hover:bg-red-700 cursor-pointer transition-colors",children:"Reset All Data"}),r.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"Delete all datasets and reload defaults"})]}),i&&r.jsx(Pt,{fallback:r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:r.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md mx-4",children:[r.jsx("h3",{className:"text-lg font-bold text-red-800 mb-2",children:"Edit Panel Error"}),r.jsx("p",{className:"text-gray-600 mb-4",children:"The edit panel encountered an error."}),r.jsx("button",{onClick:()=>d(null),className:"px-4 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-700 cursor-pointer transition-colors",children:"Close"})]})}),children:r.jsx(Pi,{dataset:i,onClose:()=>d(null),onSave:y,onDelete:S,onDuplicate:v})}),m&&r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-60",children:r.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md mx-4",children:[r.jsx("h3",{className:"text-lg font-bold mb-2",children:"Reset All Data?"}),r.jsx("p",{className:"text-gray-600 mb-4",children:"This will delete all datasets and reload the default test data. This action cannot be undone."}),r.jsxs("div",{className:"flex justify-end gap-3",children:[r.jsx("button",{onClick:()=>g(!1),type:"button",className:"px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50 cursor-pointer transition-colors",children:"Cancel"}),r.jsx("button",{onClick:j,type:"button",className:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 cursor-pointer transition-colors",children:"Reset All Data"})]})]})})]})}function Oi({nodes:e,edges:n,width:t=1200,height:s=800}){const o=p.useRef(null),[a,u]=p.useState(null),[i,d]=p.useState(null);return p.useEffect(()=>{var we,Fe;if(!o.current||n.length===0||e.length===0){o.current&&Ae(o.current).selectAll("*").remove();return}Ae(o.current).selectAll("*").remove();const m=new Map;e.forEach(R=>{m.set(R.id,{id:R.id,label:R.label||R.id,outgoing:0,incoming:0})}),n.forEach(R=>{const W=m.get(R.source),Re=m.get(R.target);W&&(W.outgoing+=R.value),Re&&(Re.incoming+=R.value)});const g=Array.from(m.values()).filter(R=>R.outgoing>0||R.incoming>0);if(g.length===0){Ae(o.current).append("text").attr("x",t/2).attr("y",s/2).attr("text-anchor","middle").attr("font-size","14px").attr("fill","#666").text("No active nodes with flows");return}g.sort((R,W)=>W.outgoing+W.incoming-(R.outgoing+R.incoming));const x=50,h=t-50,f=20,_=15,C=2,w=5,y=g.reduce((R,W)=>R+W.outgoing,0),S=g.reduce((R,W)=>R+W.incoming,0),v=Math.max(s-2*f,400);let j=f;g.forEach(R=>{const W=y>0?Math.max(w,R.outgoing/y*v):Math.max(w,v/g.length);j+=W+C});let A=f;g.forEach(R=>{const W=S>0?Math.max(w,R.incoming/S*v):Math.max(w,v/g.length);A+=W+C});const F=Math.max(s,Math.max(j,A)+100),B=F-2*f,V=Ae(o.current).attr("width",t).attr("height",F).style("font","12px sans-serif");let H=f;const ie=g.map((R,W)=>{const Re=y>0?Math.max(w,R.outgoing/y*B):Math.max(w,B/g.length),ge=H;return H+=Re+C,{node:R,x,y:ge,height:Math.max(w,Re-C),side:"left",index:W}});H=f;const q=g.map((R,W)=>{const Re=S>0?Math.max(w,R.incoming/S*B):Math.max(w,B/g.length),ge=H;return H+=Re+C,{node:R,x:h,y:ge,height:Math.max(w,Re-C),side:"right",index:W}});let ue=[];a&&i&&(i==="left"?ue=n.filter(R=>R.source===a&&R.source!==R.target):ue=n.filter(R=>R.target===a&&R.source!==R.target));const E=Js(ro);if(ue.length>0){const R=ue.map(T=>{const ke=ie.find(Ue=>Ue.node.id===T.source),Z=q.find(Ue=>Ue.node.id===T.target);if(!ke||!Z)return null;const Oe=ke.y+ke.height/2,je=Z.y+Z.height/2;return{edge:T,sourceX:ke.x+_,sourceY:Oe,targetX:Z.x,targetY:je,value:T.value,leftIndex:ke.index,rightIndex:Z.index}}).filter(T=>T!==null),W=Math.max(...R.map(T=>T.value),1),Re=2,ge=20,Be=V.append("g").attr("class","links");R.forEach(T=>{const ke=Re+T.value/W*(ge-Re),Z=`gradient-${T.leftIndex}-${T.rightIndex}`,Oe=V.append("defs").append("linearGradient").attr("id",Z).attr("gradientUnits","userSpaceOnUse").attr("x1",T.sourceX).attr("x2",T.targetX).attr("y1",T.sourceY).attr("y2",T.targetY);Oe.append("stop").attr("offset","0%").attr("stop-color",E(String(T.leftIndex))).attr("stop-opacity",.6),Oe.append("stop").attr("offset","100%").attr("stop-color",E(String(T.rightIndex))).attr("stop-opacity",.6);const je=us(),Ue=(T.sourceX+T.targetX)/2;je.moveTo(T.sourceX,T.sourceY),je.bezierCurveTo(Ue,T.sourceY,Ue,T.targetY,T.targetX,T.targetY),Be.append("path").attr("d",je.toString()).attr("stroke",`url(#${Z})`).attr("stroke-width",ke).attr("fill","none").attr("stroke-opacity",.6).style("cursor","pointer").on("mouseover",function($e){Ae(this).attr("stroke-opacity",1).attr("stroke-width",ke+2),Ae("body").append("div").attr("class","tooltip").style("position","absolute").style("background","rgba(0, 0, 0, 0.8)").style("color","white").style("padding","8px").style("border-radius","4px").style("pointer-events","none").style("opacity",0).html(`${T.edge.source} → ${T.edge.target}<br/>${T.value.toLocaleString()}`).style("opacity",1)}).on("mousemove",function($e){Ae(".tooltip").style("left",`${$e.pageX+10}px`).style("top",`${$e.pageY-10}px`)}).on("mouseout",function(){Ae(this).attr("stroke-opacity",.6).attr("stroke-width",ke),Ae(".tooltip").remove()})})}const le=V.append("g").attr("class","left-nodes").selectAll("g.node").data(ie).join("g").attr("class","node").attr("transform",R=>`translate(${R.x}, ${R.y})`).style("cursor","pointer").on("click",function(R,W){R.stopPropagation(),a===W.node.id&&i==="left"?(u(null),d(null)):(u(W.node.id),d("left"))});le.append("rect").attr("width",_).attr("height",R=>R.height).attr("fill",(R,W)=>E(String(W))).attr("stroke",(R,W)=>nn(E(String(W))).darker().formatHex()).attr("stroke-width",R=>a===R.node.id&&i==="left"?3:1).attr("opacity",R=>a&&i==="left"&&a!==R.node.id?.3:1).on("mouseover",function(R,W){Ae(this).attr("fill",nn(E(String(W.index))).brighter(.5).formatHex())}).on("mouseout",function(R,W){Ae(this).attr("fill",E(String(W.index)))}),le.append("text").attr("x",_+6).attr("y",R=>R.height/2).attr("dy","0.35em").attr("text-anchor","start").text(R=>`${R.node.label} (${R.node.outgoing.toLocaleString()})`).style("font-size","11px").style("font-weight","500").style("fill","#333").attr("opacity",R=>a&&i==="left"&&a!==R.node.id?.3:1);const de=V.append("g").attr("class","right-nodes").selectAll("g.node").data(q).join("g").attr("class","node").attr("transform",R=>`translate(${R.x}, ${R.y})`).style("cursor","pointer").on("click",function(R,W){R.stopPropagation(),a===W.node.id&&i==="right"?(u(null),d(null)):(u(W.node.id),d("right"))});de.append("rect").attr("x",-_).attr("width",_).attr("height",R=>R.height).attr("fill",(R,W)=>E(String(W))).attr("stroke",(R,W)=>nn(E(String(W))).darker().formatHex()).attr("stroke-width",R=>a===R.node.id&&i==="right"?3:1).attr("opacity",R=>a&&i==="right"&&a!==R.node.id?.3:1).on("mouseover",function(R,W){Ae(this).attr("fill",nn(E(String(W.index))).brighter(.5).formatHex())}).on("mouseout",function(R,W){Ae(this).attr("fill",E(String(W.index)))}),de.append("text").attr("x",-_-6).attr("y",R=>R.height/2).attr("dy","0.35em").attr("text-anchor","end").text(R=>`${R.node.label} (${R.node.incoming.toLocaleString()})`).style("font-size","11px").style("font-weight","500").style("fill","#333").attr("opacity",R=>a&&i==="right"&&a!==R.node.id?.3:1),a?V.append("text").attr("x",t/2).attr("y",20).attr("text-anchor","middle").attr("font-size","14px").attr("fill","#333").text(i==="left"?`Showing outgoing flows from ${(we=ie.find(R=>R.node.id===a))==null?void 0:we.node.label}`:`Showing incoming flows to ${(Fe=q.find(R=>R.node.id===a))==null?void 0:Fe.node.label}`):V.append("text").attr("x",t/2).attr("y",20).attr("text-anchor","middle").attr("font-size","14px").attr("fill","#666").text("Click a node to see its connections"),V.append("text").attr("x",x+_/2).attr("y",F-10).attr("text-anchor","middle").attr("font-size","12px").attr("font-weight","bold").attr("fill","#333").text("Outgoing"),V.append("text").attr("x",h-_/2).attr("y",F-10).attr("text-anchor","middle").attr("font-size","12px").attr("font-weight","bold").attr("fill","#333").text("Incoming"),V.on("click",function(R){(R.target===o.current||R.target.tagName==="svg")&&(u(null),d(null))})},[e,n,t,s,a,i]),r.jsxs("div",{className:"w-full h-full flex flex-col min-h-0",children:[r.jsxs("div",{className:"text-center text-xs text-gray-500 mb-2 flex-shrink-0",children:["Interaction design inspired by"," ",r.jsx("a",{href:"https://peoplemov.in/#f_AF",target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-800 underline",children:"peoplemov.in by Carlo Zapponi"})]}),r.jsx("div",{className:"flex-1 overflow-auto min-h-0",children:r.jsx("svg",{ref:o,className:"border border-gray-200 rounded bg-white"})})]})}function Ti(e,n){const t=e.length,s=new Map;e.forEach((u,i)=>{s.set(u.id,i)});const o=Array(t).fill(null).map(()=>Array(t).fill(0));n.forEach(u=>{const i=s.get(u.source),d=s.get(u.target);i!==void 0&&d!==void 0&&(o[i][d]+=u.value)});const a=e.map(u=>u.label||u.id);return{matrix:o,labels:a,nodes:e}}function Ks(e,n,t){return!t||t==="all"?e:e.filter(s=>{const o=s[n];return Array.isArray(o)?o.includes(t):o===t})}function Li(e,n){const t=new Set;return e.forEach(s=>{const o=s[n];o!=null&&(Array.isArray(o)?o.forEach(a=>t.add(a)):t.add(o))}),Array.from(t).sort((s,o)=>typeof s=="number"&&typeof o=="number"?s-o:String(s).localeCompare(String(o)))}function zi({nodes:e,edges:n,width:t=1e3,height:s=800}){const o=p.useRef(null);return p.useEffect(()=>{if(!o.current||n.length===0||e.length===0){o.current&&Ae(o.current).selectAll("*").remove();return}Ae(o.current).selectAll("*").remove();const a=Ti(e,n),u=Ae(o.current).attr("width","100%").attr("height","100%").attr("viewBox",`0 0 ${t} ${s}`).attr("preserveAspectRatio","xMidYMid meet"),i=Math.min(t,s)*.5-40,d=i-20,m=No().scaleExtent([.1,4]).on("zoom",function(S){C.attr("transform",S.transform.toString())});u.call(m);const g=u.append("g").attr("class","reset-button").style("cursor","pointer").attr("transform",`translate(${t-120}, 10)`).on("click",function(){u.transition().duration(750).call(m.transform,jo)});g.append("rect").attr("width",110).attr("height",30).attr("rx",4).attr("fill","white").attr("stroke","#ccc").attr("stroke-width",1),g.append("text").attr("x",55).attr("y",20).attr("text-anchor","middle").attr("font-size","12px").attr("fill","#333").text("Reset View");const h=Wo().padAngle(.05).sortSubgroups(Bo)(a.matrix),f=ra().radius(d),_=Js(ro),C=u.append("g").attr("class","zoom-group"),w=C.append("g").attr("transform",`translate(${t/2}, ${s/2})`),y=w.append("g").selectAll("g").data(h.groups).join("g");y.append("path").attr("fill",S=>_(String(S.index))).attr("stroke",S=>nn(_(String(S.index))).darker().formatHex()).attr("d",pa().innerRadius(d).outerRadius(i)).on("mouseover",function(S,v){Ae(this).attr("fill",nn(_(String(v.index))).brighter(1).formatHex()),w.selectAll("path.chord").style("opacity",j=>j.source.index===v.index||j.target.index===v.index?1:.2)}).on("mouseout",function(){Ae(this).attr("fill",S=>_(String(S.index))),w.selectAll("path.chord").style("opacity",1)}),y.append("text").attr("dy",".35em").attr("transform",S=>`
        rotate(${(S.startAngle+S.endAngle)/2*180/Math.PI-90})
        translate(${i+10})
        ${(S.startAngle+S.endAngle)/2>Math.PI?"rotate(180)":""}
      `).attr("text-anchor",S=>(S.startAngle+S.endAngle)/2>Math.PI?"end":"start").text(S=>a.labels[S.index]).style("font-size","12px").style("font-weight","500"),w.append("g").attr("fill-opacity",.67).selectAll("path").data(h).join("path").attr("class","chord").attr("d",S=>f(S)??"").attr("fill",S=>_(String(S.source.index))).attr("stroke",S=>nn(_(String(S.source.index))).darker().formatHex()).style("stroke-width","1px").on("mouseover",function(S,v){Ae(this).attr("fill-opacity",1).style("stroke-width","2px"),Ae("body").append("div").attr("class","tooltip").style("position","absolute").style("background","rgba(0, 0, 0, 0.8)").style("color","white").style("padding","8px").style("border-radius","4px").style("pointer-events","none").style("opacity",0).style("transition","opacity 0.2s").html(`${a.labels[v.source.index]} → ${a.labels[v.target.index]}: ${v.source.value.toLocaleString()}`).style("opacity",1)}).on("mousemove",function(S){Ae(".tooltip").style("left",`${S.pageX+10}px`).style("top",`${S.pageY-10}px`)}).on("mouseout",function(){Ae(this).attr("fill-opacity",.67).style("stroke-width","1px"),Ae(".tooltip").remove()})},[e,n,t,s]),r.jsx("div",{className:"w-full h-full",children:r.jsx("svg",{ref:o,className:"border border-gray-200 rounded bg-white"})})}const Hi=200,Gi=600,Bi=384,Xs=4;function Ui({isCollapsed:e,onToggle:n,onResize:t,children:s,title:o="Settings",bottomContent:a}){const[u,i]=p.useState(Bi),[d,m]=p.useState(!1),g=p.useRef(null),x=p.useRef(null);return p.useEffect(()=>{if(!d)return;const h=_=>{var C;if(!e&&((C=g.current)==null?void 0:C.getBoundingClientRect())){const y=Math.max(Hi,Math.min(Gi,window.innerWidth-_.clientX));i(y),t==null||t(y)}},f=()=>{m(!1)};return document.addEventListener("mousemove",h),document.addEventListener("mouseup",f),()=>{document.removeEventListener("mousemove",h),document.removeEventListener("mouseup",f)}},[d,e,t]),r.jsxs("div",{ref:g,className:"bg-white border-l border-gray-200 flex flex-col transition-all duration-300  overflow-hidden relative",style:{minHeight:"100vh",width:e?`${Xs}px`:`${u}px`},children:[e&&r.jsxs(r.Fragment,{children:[r.jsx("div",{onClick:n,className:"w-full h-full bg-gray-100 hover:bg-blue-400 cursor-pointer transition-colors",style:{width:`${Xs}px`},title:"Click to expand settings"}),r.jsx("button",{onClick:n,className:"fixed bottom-4 right-4 z-50 p-3 bg-blue-600 hover:bg-blue-700 text-white rounded-full shadow-lg cursor-pointer transition-all hover:scale-110 flex items-center justify-center",style:{width:"48px",height:"48px"},title:"Open visualization settings","aria-label":"Open visualization settings",children:r.jsx(Is,{className:"w-5 h-5"})})]}),!e&&r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:s}),a&&r.jsx("div",{className:"flex-shrink-0 border-t border-gray-200 bg-white",children:a}),r.jsxs("button",{onClick:n,className:"w-full flex items-center justify-between p-2 border-t border-gray-200 flex-shrink-0 bg-gray-50 hover:bg-gray-100 transition-colors cursor-pointer","aria-label":"Collapse settings",children:[r.jsxs("div",{className:"flex items-center gap-2 flex-1",children:[r.jsx(Is,{className:"w-4 h-4 text-gray-600"}),r.jsx("span",{className:"text-sm font-medium text-gray-700",children:o})]}),r.jsx(Mo,{className:"w-4 h-4 text-gray-600 flex-shrink-0"})]}),r.jsx("div",{ref:x,onMouseDown:h=>{h.preventDefault(),m(!0)},className:"absolute top-0 left-0 w-1 h-full cursor-col-resize hover:bg-blue-400 bg-gray-300 transition-colors z-10",style:{touchAction:"none"},children:r.jsx("div",{className:"absolute top-1/2 left-0 transform -translate-y-1/2 -translate-x-0.5",children:r.jsx(Fo,{className:"w-3 h-6 text-gray-500"})})})]})]})}const ho=["Alabama","Alaska","Arizona","Arkansas","California","Colorado","Connecticut","Delaware","District of Columbia","Florida","Georgia","Hawaii","Idaho","Illinois","Indiana","Iowa","Kansas","Kentucky","Louisiana","Maine","Maryland","Massachusetts","Michigan","Minnesota","Mississippi","Missouri","Montana","Nebraska","Nevada","New Hampshire","New Jersey","New Mexico","New York","North Carolina","North Dakota","Ohio","Oklahoma","Oregon","Pennsylvania","Rhode Island","South Carolina","South Dakota","Tennessee","Texas","Utah","Vermont","Virginia","Washington","West Virginia","Wisconsin","Wyoming"],Wi=new Set(ho),qi=ho.length,Zs=Oo.reduce((e,n)=>(e[n]=n===2020?"ACS 1-year state-to-state migration flows for 2020 were not released by the Census Bureau due to pandemic-related data quality concerns.":"State-to-state migration data is unavailable for this year in the ACS 1-year series.",e),{});function Zt({title:e,subtitle:n,children:t,defaultOpen:s=!1,onReset:o}){const[a,u]=p.useState(s);return r.jsxs("div",{className:"border border-gray-200 rounded-md",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("button",{onClick:()=>u(!a),className:"flex-1 flex items-center justify-between p-3 hover:bg-gray-50 transition-colors text-left",children:[r.jsxs("div",{className:"flex-1",children:[r.jsx("div",{className:"font-semibold text-sm",children:e}),n&&r.jsx("div",{className:"text-xs text-gray-600 mt-0.5",children:n})]}),a?r.jsx(Ho,{className:"w-4 h-4 text-gray-600 flex-shrink-0"}):r.jsx(Lo,{className:"w-4 h-4 text-gray-600 flex-shrink-0"})]}),o&&r.jsx("button",{type:"button",onClick:i=>{i.stopPropagation(),o()},className:"pr-3 text-[11px] font-medium text-blue-600 hover:text-blue-800 transition-colors",children:"Reset"})]}),a&&r.jsx("div",{className:"p-3 pt-0 border-t border-gray-200",children:t})]})}const Qs=en(["kriskogram","table","sankey","chord"]),At=e=>{const n=e!==void 0?ot().default(e):ot().optional();return Me(t=>{if(t==null||t==="")return e;const s=typeof t=="string"?parseFloat(t):Number(t);return Number.isNaN(s)?e:s},n)},kt=e=>Me(n=>{if(typeof n=="boolean")return n;if(typeof n=="string"){if(n.toLowerCase()==="true")return!0;if(n.toLowerCase()==="false")return!1}return e},Po().default(e));function Qt(e,n){return Me(t=>{if(typeof t=="string"){const s=t.toLowerCase(),o=e.find(a=>a.toLowerCase()===s);if(o)return o}return n},en(e).default(n))}function Yi(e){return Me(n=>typeof n=="string"&&n.trim()!==""?n:e,rn().default(e))}const On=()=>Me(e=>e==null||e===""?null:typeof e=="string"?e:null,rn().nullable().default(null)),Ki=()=>Me(e=>Array.isArray(e)?e.map(n=>n==null?null:String(n)).filter(n=>!!(n&&n.trim())):typeof e=="string"?e.trim()===""?[]:e.split(",").map(n=>n.trim()).filter(n=>n.length>0):[],ko(rn()).default([])),Zr=e=>Me(n=>{if(typeof n=="string"){const t=n.trim().toLowerCase();if(/^#([0-9a-f]{3}|[0-9a-f]{6})$/.test(t))return t.length===4?`#${t[1]}${t[1]}${t[2]}${t[2]}${t[3]}${t[3]}`:t}return e},rn().default(e));Ao({dataset:rn().optional(),view:Me(e=>typeof e=="string"&&Qs.safeParse(e).success?e:"kriskogram",Qs.default("kriskogram")),year:At(void 0),minThreshold:At(0),maxThreshold:At(2e5),maxEdges:At(500),edgeWeightScale:Me(e=>{if(typeof e!="string")return"linear";const n=e.toLowerCase();return["linear","sqrt","log"].includes(n)?n:"linear"},en(["linear","sqrt","log"]).default("linear")),edgeWidthMultiplier:Me(e=>{if(e==null||e==="")return 1;const n=typeof e=="string"?parseFloat(e):Number(e);return Number.isNaN(n)?1:Math.max(.1,Math.min(10,n))},ot().min(.1).max(10).default(1)),egoNodeId:Me(e=>e==null||e===""||e==="null"?null:typeof e=="string"?e:void 0,rn().nullable().optional()),egoNeighborSteps:Me(e=>{if(e==null||e==="")return 1;const n=typeof e=="string"?parseInt(e,10):Number(e);return Number.isNaN(n)||n<1?1:Math.max(1,Math.round(n))},ot().min(1).default(1)),egoStepColoring:kt(!1),edgeType:Me(e=>e==="null"||e===""?null:typeof e=="string"?e:void 0,rn().nullable().optional()),showAllNodes:kt(!1),temporalOverlay:kt(!1),temporalOverlayEdgeStyle:Me(e=>{if(typeof e=="string"){const n=e.toLowerCase();if(["segmented","filled","outline"].includes(n))return n}return"filled"},en(["segmented","filled","outline"]).default("filled")),temporalOverlayNodeStyle:Me(e=>{if(typeof e=="string"){const n=e.toLowerCase();if(["filled","outline"].includes(n))return n}return"filled"},en(["filled","outline"]).default("filled")),temporalOverlayYearsPast:Me(e=>{if(e==null||e==="")return 1;const n=typeof e=="string"?parseInt(e,10):Number(e);return Number.isNaN(n)||n<0?0:Math.max(0,Math.round(n))},ot().min(0).default(1)),temporalOverlayYearsFuture:Me(e=>{if(e==null||e==="")return 1;const n=typeof e=="string"?parseInt(e,10):Number(e);return Number.isNaN(n)||n<0?0:Math.max(0,Math.round(n))},ot().min(0).default(1)),temporalOverlayColorPast:Zr("#fc8d59"),temporalOverlayColorMid:Zr("#ffffbf"),temporalOverlayColorFuture:Zr("#91bfdb"),temporalOverlayCurrentBlack:kt(!0),nodeOrderMode:Yi("alphabetical"),arcOpacity:Me(e=>{if(e==null||e==="")return .85;const n=typeof e=="string"?parseFloat(e):Number(e);return Number.isNaN(n)?.85:Math.max(0,Math.min(1,n))},ot().min(0).max(1).default(.85)),edgeWidthMode:Qt(["fixed","weight"],"weight"),edgeColorAdvanced:kt(!1),edgeColorHue:Qt(["direction","region","division","attribute","single"],"direction"),edgeColorHueAttribute:On(),edgeColorIntensity:Qt(["constant","weight","attribute"],"weight"),edgeColorIntensityAttribute:On(),edgeColorIntensityConst:Me(e=>{if(e==null||e==="")return .6;const n=typeof e=="string"?parseFloat(e):Number(e);return Number.isNaN(n)?.6:Math.max(0,Math.min(1,n))},ot().min(0).max(1).default(.6)),edgeColorInterGrayscale:kt(!0),intraFilter:Qt(["none","region","division","interRegion","interDivision"],"none"),baseEdgeWidth:Me(e=>{if(e==null||e==="")return 2;const n=typeof e=="string"?parseFloat(e):Number(e);return Number.isNaN(n)?2:Math.max(.5,Math.min(12,n))},ot().min(.5).max(12).default(2)),nodeColorMode:Qt(["single","attribute","visible_outgoing","visible_incoming","year_outgoing","year_incoming","net_year","outgoing","incoming","self_year"],"single"),nodeColorAttribute:On(),nodeSizeMode:Qt(["fixed","attribute","visible_outgoing","visible_incoming","year_outgoing","year_incoming","net_visible","net_year","outgoing","incoming","self_year"],"fixed"),nodeSizeAttribute:On(),nodeSizeWeightScale:Me(e=>{if(typeof e!="string")return"linear";const n=e.toLowerCase();return["linear","sqrt","log"].includes(n)?n:"linear"},en(["linear","sqrt","log"]).default("linear")),nodeSizeMultiplier:Me(e=>{if(e==null||e==="")return 1;const n=typeof e=="string"?parseFloat(e):Number(e);return Number.isNaN(n)?1:Math.max(.1,Math.min(10,n))},ot().min(.1).max(10).default(1)),interactionMode:Qt(["pan","lens"],"pan"),lensRadius:Me(e=>{if(e==null||e==="")return 80;const n=typeof e=="string"?parseFloat(e):Number(e);return Number.isNaN(n)?80:Math.max(20,Math.min(300,n))},ot().min(20).max(300).default(80)),edgeSegmentLength:At(8),edgeSegmentGap:At(4),edgeSegmentAnimate:kt(!1),edgeSegmentOffset:At(15),edgeSegmentSpeed:At(1),edgeSegmentScaleByWeight:kt(!1),edgeSegmentCap:Me(e=>{if(typeof e=="string"){const n=e.toLowerCase();if(["round","butt"].includes(n))return n}return"round"},en(["round","butt"]).default("round")),edgeOutlineGap:Me(e=>{if(e==null||e==="")return 3;const n=typeof e=="string"?parseFloat(e):Number(e);return Number.isNaN(n)?3:Math.max(.5,n)},ot().min(.5).default(3)),nodeFilterAttribute:On(),nodeFilterValues:Ki()});function rl(){const e=Ro({from:"/explorer"}),n=$o(),{leftSidebarCollapsed:t,leftSidebarWidth:s,setSidebarContent:o}=Eo(),[a,u]=p.useState(e.dataset),[i,d]=p.useState(void 0),[m,g]=p.useState(e.year),[x,h]=p.useState(!1),[f,_]=p.useState(null),[C,w]=p.useState(0),[y,S]=p.useState(e.minThreshold??0),[v,j]=p.useState(e.maxThreshold??2e5),[A,F]=p.useState(e.maxEdges??500),[B,V]=p.useState(e.edgeType??null),[H,ie]=p.useState(e.view),[q,ue]=p.useState(e.showAllNodes??!1),[E,ee]=p.useState(e.egoNodeId??null),[le,xe]=p.useState(e.egoNeighborSteps??1),[de,we]=p.useState(e.egoStepColoring??!1),[Fe,R]=p.useState(e.edgeWeightScale??"linear"),[W,Re]=p.useState(Math.max(.1,e.edgeWidthMultiplier??1)),[ge,Be]=p.useState(e.temporalOverlay??!1),[T,ke]=p.useState(e.temporalOverlayEdgeStyle??"filled"),[Z,Oe]=p.useState(e.temporalOverlayNodeStyle??"filled"),[je,Ue]=p.useState(e.edgeSegmentLength??8),[$e,sn]=p.useState(e.edgeSegmentGap??4),[nt,Hn]=p.useState(e.edgeSegmentAnimate??!1),[We,Gn]=p.useState(e.edgeSegmentOffset??15),[I,O]=p.useState(Math.max(.1,e.edgeSegmentSpeed??1)),[K,ye]=p.useState(e.edgeSegmentScaleByWeight??!1),[ne,he]=p.useState(e.edgeSegmentCap??"round"),[me,it]=p.useState(Math.max(.5,e.edgeOutlineGap??3)),[qe,Ct]=p.useState(e.temporalOverlayYearsPast??1),[_e,Pe]=p.useState(e.temporalOverlayYearsFuture??1),[Ye,Bn]=p.useState(xr(e.temporalOverlayColorPast,"#fc8d59")),[Ke,Un]=p.useState(xr(e.temporalOverlayColorMid,"#ffffbf")),[Xe,Wn]=p.useState(xr(e.temporalOverlayColorFuture,"#91bfdb")),[Lt,ms]=p.useState(e.temporalOverlayCurrentBlack??!0),[fs,wn]=p.useState(Ye),[ps,_n]=p.useState(Ke),[hs,Cn]=p.useState(Xe),[Le,br]=p.useState(e.nodeFilterAttribute??null),[lt,zt]=p.useState(e.nodeFilterValues??[]),Sr=p.useRef(null),[on,xo]=p.useState(!1),[qn,yo]=p.useState(384),[an,xs]=p.useState({width:typeof window<"u"?window.innerWidth:1200,height:typeof window<"u"?window.innerHeight:800});p.useEffect(()=>(o(r.jsx(Pt,{fallback:r.jsxs("div",{className:"p-4",children:[r.jsx("h2",{className:"text-lg font-bold text-red-800 mb-2",children:"Dataset Sidebar Error"}),r.jsx("p",{className:"text-sm text-red-700",children:"The dataset sidebar encountered an error."})]}),children:r.jsx(Di,{selectedId:a,onSelect:l=>{u(l),k({dataset:l})},onRefresh:()=>w(l=>l+1)})})),()=>{o(null)}),[a,C]),p.useEffect(()=>{if(typeof window>"u")return;const l=()=>{xs({width:window.innerWidth,height:window.innerHeight})};return l(),window.addEventListener("resize",l),()=>window.removeEventListener("resize",l)},[]),p.useEffect(()=>{typeof window<"u"&&setTimeout(()=>{xs({width:window.innerWidth,height:window.innerHeight})},100)},[t,on,s,qn]);const[Yn,ys]=p.useState(e.nodeOrderMode??"alphabetical"),[wr,vs]=p.useState(e.arcOpacity??.85),[ln,_r]=p.useState(e.edgeWidthMode??"weight"),[un,bs]=p.useState(e.edgeColorAdvanced??!1),[Ie,Ht]=p.useState(e.edgeColorHue??"direction"),[Gt,Kn]=p.useState(e.edgeColorHueAttribute??null),[ht,Cr]=p.useState(e.edgeColorIntensity??"weight"),[dn,Xn]=p.useState(e.edgeColorIntensityAttribute??null),[Zn,Nr]=p.useState(e.edgeColorIntensityConst??.6),[Qn,Ss]=p.useState(e.edgeColorInterGrayscale??!0),[rt,ws]=p.useState(e.intraFilter??"none"),[Bt,_s]=p.useState(e.baseEdgeWidth??2),[Jn,Cs]=p.useState(e.nodeColorMode??"single"),[Ut,jr]=p.useState(e.nodeColorAttribute??null),[xt,Ns]=p.useState(e.nodeSizeMode??"fixed"),[Je,Mr]=p.useState(e.nodeSizeAttribute??null),[er,js]=p.useState(e.nodeSizeWeightScale??"linear"),[Nn,Ms]=p.useState(Math.max(.1,e.nodeSizeMultiplier??1)),[Fr,Rr]=p.useState(e.interactionMode??"pan"),[vo,bo]=p.useState(e.lensRadius??80),[Zi,So]=p.useState({x:0,y:0}),k=p.useMemo(()=>l=>{n({to:"/explorer",search:c=>({view:c.view??"kriskogram",...c,...l}),replace:!0})},[n]),tr=p.useMemo(()=>{var l,c;return((c=(l=i==null?void 0:i.metadata)==null?void 0:l.hasCategoricalProperties)==null?void 0:c.nodes)??[]},[i]);p.useEffect(()=>{i&&Le&&(tr.includes(Le)||(br(null),zt([]),k({nodeFilterAttribute:null,nodeFilterValues:[]})))},[i,tr,Le,k]);const wo=p.useMemo(()=>i&&i.timeRange.start!==i.timeRange.end,[i]);p.useMemo(()=>{var N,se;if(!i)return 0;const l=(N=i.timeRange)==null?void 0:N.start,c=(se=i.timeRange)==null?void 0:se.end;return typeof l!="number"||typeof c!="number"?0:Math.max(0,c-l)},[i]);const yt=p.useRef(!0);p.useEffect(()=>{Ga().catch(()=>{}),Xi().then(l=>{const c=e.dataset||l;c&&(u(c),!e.dataset&&yt.current&&k({dataset:c})),yt.current=!1}).catch(l=>_(l instanceof Error?l.message:"Failed to preload datasets"))},[]),p.useEffect(()=>{if(!a){d(void 0);return}h(!0),_(null),Dt(a).then(l=>{if(d(l),l){const{start:c,end:N}=l.timeRange??{};g(se=>{const U=te=>typeof te=="number"&&typeof c=="number"&&typeof N=="number"&&te>=c&&te<=N;return U(se)?se:U(e.year)?e.year:typeof c=="number"?c:se??c??void 0})}}).catch(l=>_(l instanceof Error?l.message:"Failed to load dataset")).finally(()=>h(!1))},[a,C,e.year]);const ve=p.useMemo(()=>{if(!(!i||m===void 0))return i.snapshots.find(l=>(typeof l.timestamp=="string"?parseInt(l.timestamp,10):l.timestamp)===m)},[i,m]),jn=p.useMemo(()=>{if(!ve||!Le)return[];const l=new Set;return ve.nodes.forEach(c=>{const N=c==null?void 0:c[Le];N!=null&&N!==""&&l.add(String(N))}),Array.from(l).sort((c,N)=>c.localeCompare(N))},[ve,Le]);p.useEffect(()=>{if(!Le||!ve||lt.length===0)return;const l=lt.filter(c=>jn.includes(c));l.length!==lt.length&&(zt(l),k({nodeFilterValues:l}))},[Le,lt,jn,ve,k]),p.useMemo(()=>{if(!i)return new Map;const l=new Map;return i.snapshots.forEach(c=>{const N=typeof c.timestamp=="string"?parseInt(c.timestamp,10):c.timestamp;Number.isFinite(N)&&l.set(N,c)}),l},[i]);const De=p.useMemo(()=>{if(!i)return null;let l=1/0,c=-1/0,N=0;return i.snapshots.forEach(se=>{const U=Array.isArray(se==null?void 0:se.edges)?se.edges:[];let te=0;U.forEach(pe=>{if(pe!=null&&pe.source&&pe.source===pe.target)return;const ce=Number(pe==null?void 0:pe.value);Number.isFinite(ce)&&(te+=1,ce<l&&(l=ce),ce>c&&(c=ce))}),te>N&&(N=te)}),l===1/0||c===-1/0?{min:0,max:0,maxEdgesCount:N}:{min:l,max:c,maxEdgesCount:N}},[i]),Wt=p.useMemo(()=>{if(!i)return null;let l=1/0,c=-1/0;return i.snapshots.forEach(N=>{const se=new Map,U=new Map;(Array.isArray(N==null?void 0:N.edges)?N.edges:[]).forEach(ce=>{const Ee=U.get(ce.source)||0;U.set(ce.source,Ee+ce.value);const Te=se.get(ce.target)||0;se.set(ce.target,Te+ce.value)}),(Array.isArray(N==null?void 0:N.nodes)?N.nodes:[]).forEach(ce=>{const Ee=(se.get(ce.id)||0)-(U.get(ce.id)||0);Ee<l&&(l=Ee),Ee>c&&(c=Ee)})}),l===1/0||c===-1/0?{min:0,max:0}:{min:l,max:c}},[i]),qt=p.useMemo(()=>{if(!i)return null;let l=0,c=0;return i.snapshots.forEach(N=>{const se=new Map,U=new Map;(Array.isArray(N==null?void 0:N.edges)?N.edges:[]).forEach(ce=>{const Ee=U.get(ce.source)||0;U.set(ce.source,Ee+ce.value);const Te=se.get(ce.target)||0;se.set(ce.target,Te+ce.value)}),(Array.isArray(N==null?void 0:N.nodes)?N.nodes:[]).forEach(ce=>{const Ee=se.get(ce.id)||0,Te=U.get(ce.id)||0;Ee>l&&(l=Ee),Te>c&&(c=Te)})}),{maxIncoming:l,maxOutgoing:c}},[i]),nr=p.useMemo(()=>{if(!i)return null;let l=0;return i.snapshots.forEach(c=>{const N=Array.isArray(c==null?void 0:c.edges)?c.edges:[],se=new Map;N.forEach(U=>{if(U!=null&&U.source&&U.source===U.target){const te=Number(U.value);if(!Number.isFinite(te)||te<=0)return;const pe=se.get(U.source)||0;se.set(U.source,pe+te)}}),se.forEach(U=>{U>l&&(l=U)})}),{max:l}},[i]);p.useEffect(()=>{if(!De)return;const{min:l,max:c,maxEdgesCount:N}=De;if(!Number.isFinite(l)||!Number.isFinite(c))return;const se=(Ee,Te,et)=>et<Te||!Number.isFinite(Ee)||Ee<Te?Te:Ee>et?et:Ee,U=se(y,l,c);let te=se(v,l,c);te<U&&(te=U);const pe=Math.max(1,N),ce=Math.max(1,Math.min(A,pe));U!==y&&S(U),te!==v&&j(te),ce!==A&&F(ce)},[De,y,v,A]);const mt=p.useMemo(()=>{if(!ve||!(i!=null&&i.metadata))return null;const c=["migration_type","type","category","edge_type"].find(se=>{var U,te;return((U=i.metadata)==null?void 0:U.edgeProperties.includes(se))||((te=i.metadata)==null?void 0:te.hasCategoricalProperties.edges.includes(se))});if(!c)return null;const N=Li(ve.edges,c);return{property:c,values:N.map(se=>String(se))}},[ve,i]);p.useEffect(()=>{V(null)},[a]),p.useEffect(()=>{ve&&E&&(ve.nodes.some(c=>c.id===E)||(ee(null),de&&we(!1),k({egoNodeId:null,egoStepColoring:!1})))},[ve,E,de,k]);const Y=p.useMemo(()=>{if(!i||!ve)return{nodes:[],edges:[],baseEdges:[],overlayEdges:[],egoStepMax:0,overlayMeta:{hasPast:!1,hasFuture:!1,maxDelta:0}};const l=typeof m=="number"?m:null,c=!!(Le&&lt.length>0),N=new Set(lt.map(M=>String(M))),se=ve.nodes,U=c?se.filter(M=>{const L=M==null?void 0:M[Le];if(L==null)return!1;const G=String(L);return N.has(G)}):se,te=new Set(U.map(M=>M.id));if(te.size===0)return{nodes:[],baseEdges:[],edges:[],currentEdgeCount:0,egoStepMax:0,temporalOverlay:null};const pe=Math.max(0,Math.round(qe)),ce=Math.max(0,Math.round(_e)),Ee=M=>{const L=typeof M=="string"?M.trim().toLowerCase():"";return/^#([0-9a-f]{3}|[0-9a-f]{6})$/.test(L)?L.length===4?`#${L[1]}${L[1]}${L[2]}${L[2]}${L[3]}${L[3]}`:L:"#000000"},Te=Ee(Ye),et=Ee(Ke),Fn=Ee(Xe),mn=Lt?"#000000":et,Rn=M=>{const L=Ee(M).slice(1),G=parseInt(L,16);return Number.isNaN(G)||L.length!==6?{r:0,g:0,b:0}:{r:G>>16&255,g:G>>8&255,b:G&255}},fn=M=>Math.max(0,Math.min(255,Math.round(M))).toString(16).padStart(2,"0"),$n=(M,L,G)=>`#${fn(M)}${fn(L)}${fn(G)}`,pn=(M,L,G)=>{const fe=Math.max(0,Math.min(1,G)),oe=Rn(M),be=Rn(L),Ne=oe.r+(be.r-oe.r)*fe,Ge=oe.g+(be.g-oe.g)*fe,b=oe.b+(be.b-oe.b)*fe;return $n(Ne,Ge,b)},En=M=>{if(M===0)return mn;if(M<0){if(pe===0)return et;const fe=1-Math.max(0,Math.min(1,Math.abs(M)/Math.max(pe,1)));return pn(Te,et,fe)}if(ce===0)return et;const L=Math.max(0,Math.min(1,M/Math.max(ce,1)));return pn(et,Fn,L)},In=new Map,hn=new Map,xn=new Map;ve.edges.forEach(M=>{if(!te.has(M.source)||!te.has(M.target))return;const L=hn.get(M.source)||0;hn.set(M.source,L+M.value);const G=In.get(M.target)||0;if(In.set(M.target,G+M.value),M.source===M.target){const fe=xn.get(M.source)||0;xn.set(M.source,fe+M.value)}});const An=(M,L)=>{if(rt==="none")return M;const G=new Map(L.map(fe=>[fe.id,fe]));return M.filter(fe=>{const oe=G.get(fe.source),be=G.get(fe.target);return!oe||!be?!1:rt==="region"?oe.region&&be.region&&oe.region===be.region:rt==="division"?oe.division&&be.division&&oe.division===be.division:rt==="interRegion"?oe.region&&be.region&&oe.region!==be.region:rt==="interDivision"?oe.division&&be.division&&oe.division!==be.division:!0})};let dt=Ks(ve.edges,(mt==null?void 0:mt.property)||"",B);dt=dt.filter(M=>te.has(M.source)&&te.has(M.target)),dt=An(dt,U),dt=dt.filter(M=>(M==null?void 0:M.source)!==(M==null?void 0:M.target));const kn=dt.filter(M=>M.value>=y&&M.value<=v).sort((M,L)=>L.value-M.value).slice(0,A).map((M,L)=>({edge:M,idx:L}));let Yt=kn;const vt=new Map;let ct=0;if(H==="kriskogram"&&E){const M=Math.max(1,Math.round(le)),L=new Set;let G=new Set;const fe=new Set;G.add(E),fe.add(E);for(let oe=1;oe<=M&&G.size>0;oe+=1){const be=new Set;kn.forEach(({edge:Ne,idx:Ge})=>{if(G.has(Ne.source)||G.has(Ne.target)){L.add(Ge);const b=vt.get(Ge);(b===void 0||oe<b)&&vt.set(Ge,oe),fe.has(Ne.source)||(fe.add(Ne.source),be.add(Ne.source)),fe.has(Ne.target)||(fe.add(Ne.target),be.add(Ne.target))}}),G=be}Yt=kn.filter(({idx:oe})=>L.has(oe)),vt.forEach(oe=>{oe>ct&&(ct=oe)})}const Ce=T,or=T==="segmented"?`${Math.max(1,je)} ${Math.max(.5,$e)}`:null,ar=T==="segmented"?Math.max(0,We):0,ir=T==="segmented"?ne:"round",bt=Yt.map(({edge:M,idx:L})=>{const G=vt.get(L),fe={...M,__isOverlay:!1,__displayYear:l,__temporalDelta:0,_overlayType:void 0,_overlayYear:l,__overlayStyle:Ce,__overlayDash:or,__overlayDashOffset:ar,__overlayLineCap:ir,__segmentInitialGap:T==="segmented"?Math.max(0,We):0,__segmentSpeed:Math.max(.1,I),__segmentScaleByWeight:T==="segmented"&&K,__segmentCycle:T==="segmented"?Math.max(1,je+$e):0,__segmentAnimate:T==="segmented"&&nt,__outlineGap:me};return G!==void 0&&(fe._egoStep=G),fe}),Mt=new Set;bt.forEach(M=>{Mt.add(M.source),Mt.add(M.target)}),E&&Mt.add(E);const St=new Map,Pn=new Map;bt.forEach(M=>{const L=Pn.get(M.source)||0;Pn.set(M.source,L+M.value);const G=St.get(M.target)||0;St.set(M.target,G+M.value)});const Kt=[],Ze=new Map,Ft=new Map;let Rt=0,yn=!1,lr=!1;const Vn=new Map;if(i&&i.snapshots.forEach(M=>{const L=typeof M.timestamp=="string"?parseInt(M.timestamp,10):M.timestamp;Number.isFinite(L)&&Vn.set(L,M)}),ge&&i&&typeof m=="number"&&i.timeRange.start!==i.timeRange.end){const M=L=>{if(L===0||L<0&&pe===0||L>0&&ce===0)return;const G=m+L,fe=Vn.get(G);if(!fe)return;const oe=Array.isArray(fe.edges)?fe.edges:[];let be=null;if(c&&(be=new Set(fe.nodes.filter($=>{const P=$==null?void 0:$[Le];return P==null?!1:N.has(String(P))}).map($=>$.id)),be.size===0))return;let Ne=Ks(oe,(mt==null?void 0:mt.property)||"",B);if(rt!=="none"){const $=new Map(fe.nodes.map(P=>[P.id,P]));rt==="region"?Ne=Ne.filter(P=>{const ae=$.get(P.source),re=$.get(P.target);return ae&&re&&ae.region&&re.region&&ae.region===re.region}):rt==="division"?Ne=Ne.filter(P=>{const ae=$.get(P.source),re=$.get(P.target);return ae&&re&&ae.division&&re.division&&ae.division===re.division}):rt==="interRegion"?Ne=Ne.filter(P=>{const ae=$.get(P.source),re=$.get(P.target);return ae&&re&&ae.region&&re.region&&ae.region!==re.region}):rt==="interDivision"&&(Ne=Ne.filter(P=>{const ae=$.get(P.source),re=$.get(P.target);return ae&&re&&ae.division&&re.division&&ae.division!==re.division}))}be&&(Ne=Ne.filter($=>be.has($.source)&&be.has($.target)));const Ge=T==="segmented"?`${Math.max(1,je)} ${Math.max(.5,$e)}`:null,b=T==="segmented"?Math.max(0,We):0,D=T==="segmented"?ne:"round";Ne.filter($=>$.value>=y&&$.value<=v).sort(($,P)=>P.value-$.value).slice(0,A).map($=>({...$,_overlayType:L<0?"past":"future",_overlayYear:G,__isOverlay:!0,__displayYear:G,__temporalDelta:L,__overlayStyle:T,__overlayDash:Ge,__overlayDashOffset:b,__overlayLineCap:D,__segmentInitialGap:T==="segmented"?Math.max(0,We):0,__segmentCycle:T==="segmented"?Math.max(1,je+$e):0,__segmentAnimate:T==="segmented"&&nt,__segmentSpeed:Math.max(.1,I),__segmentScaleByWeight:T==="segmented"&&K,__outlineGap:me})).forEach($=>{if(Kt.push($),$._overlayType==="past"){yn=!0;const P=Ze.get($.source)||0;Ze.set($.source,P+$.value);const ae=Ze.get($.target)||0;Ze.set($.target,ae+$.value)}else{lr=!0;const P=Ft.get($.source)||0;Ft.set($.source,P+$.value);const ae=Ft.get($.target)||0;Ft.set($.target,ae+$.value)}})};for(let L=-pe;L<0;L+=1)M(L);for(let L=1;L<=ce;L+=1)M(L)}Kt.length>0&&Kt.forEach(M=>{Mt.add(M.source),Mt.add(M.target)});const wt=(H==="kriskogram"&&q?U:U.filter(M=>Mt.has(M.id))).map(M=>{const L=St.get(M.id)||0,G=Pn.get(M.id)||0,fe=In.get(M.id)||0,oe=hn.get(M.id)||0,be=L-G,Ne=fe-oe,Ge=xn.get(M.id)||0,b=Ze.get(M.id)||0,D=Ft.get(M.id)||0,z=D-b;return Math.abs(z)>Rt&&(Rt=Math.abs(z)),{...M,_totalIncoming:L,_totalOutgoing:G,total_incoming_visible:L,total_outgoing_visible:G,total_incoming_year:fe,total_outgoing_year:oe,net_flow_visible:be,net_flow_year:Ne,self_flow_year:Ge,temporal_overlay_past_total:b,temporal_overlay_future_total:D,temporal_overlay_delta:z,_overlayPastTotal:b,_overlayFutureTotal:D,_overlayDelta:z}});ge?wt.forEach(M=>{const L=M._overlayDelta??M.temporal_overlay_delta??0,G=Rt>0?Math.max(0,Math.min(1,Math.abs(L)/Rt)):0;M._overlayStrokeWidth=L===0?2:1.5+G*3,M._overlayStrokeColor=En(L)}):wt.forEach(M=>{M._overlayStrokeWidth=2,M._overlayStrokeColor="#fff"});const ur=ge?{hasPast:yn,hasFuture:lr,nodeDeltaAbsMax:Rt,style:T,edgeSegmentLength:je,edgeSegmentGap:$e,edgeSegmentOffset:We,edgeSegmentSpeed:I,edgeSegmentScaleByWeight:K,edgeSegmentCap:ne,edgeSegmentAnimate:nt,edgeOutlineGap:me,yearsPast:pe,yearsFuture:ce,colorCurrent:mn,colorPast:Te,colorMid:et,colorFuture:Fn,useBlackForCurrent:Lt,legendEntries:(()=>{const M=[],L=G=>{if(typeof m=="number"){const oe=m+G;if(G===0)return`${oe} (current)`;const be=Math.abs(G)===1?"year":"years";return G<0?`${oe} (${Math.abs(G)} ${be} past)`:`${oe} (${G} ${be} future)`}if(G===0)return"Current year";const fe=Math.abs(G)===1?"year":"years";return G<0?`${Math.abs(G)} ${fe} past`:`${G} ${fe} future`};M.push({label:L(0),color:mn});for(let G=-pe;G<0;G+=1)M.push({label:L(G),color:En(G)});for(let G=1;G<=ce;G+=1)M.push({label:L(G),color:En(G)});return M})()}:null,vn=ge&&Kt.length>0?[...bt,...Kt]:bt;return{nodes:wt,baseEdges:bt,edges:vn,currentEdgeCount:bt.length,egoStepMax:ct,temporalOverlay:ur}},[ve,y,v,A,B,mt,rt,q,H,E,le,Fe,ge,T,Z,qe,_e,Ye,Ke,Xe,Lt,je,$e,We,I,K,ne,nt,me,Le,lt,i]),st=p.useMemo(()=>{if(!ve)return null;const l=ve.edges.length,c=ve.nodes.length,N=ve.edges.reduce((te,pe)=>te+pe.value,0),se=l>0?N/l:0,U=l>0?Math.max(...ve.edges.map(te=>te.value)):0;return{totalNodes:c,totalEdges:l,visibleNodes:Y.nodes.length,visibleEdges:Y.currentEdgeCount??Y.edges.filter(te=>!te._overlayType).length,avgValue:se,maxValue:U}},[ve,Y]),ut=(De==null?void 0:De.min)??0,Mn=(De==null?void 0:De.max)??(st==null?void 0:st.maxValue)??ut,cn=Math.max(ut,Mn),_o=Math.max(cn,1),Fs=Math.max(1,Math.floor(_o/1e3)),$r=(De==null?void 0:De.maxEdgesCount)??(st==null?void 0:st.totalEdges)??0,Er=Math.max(500,$r),Ir=p.useMemo(()=>{if(!Y||Y.currentEdgeCount===0)return;const l=Y.edges.filter(c=>!c._overlayType);if(l.length!==0)return Math.min(...l.map(c=>c.value))},[Y]),Nt=p.useMemo(()=>Y.nodes.some(l=>l&&l.region),[Y]),jt=p.useMemo(()=>Y.nodes.some(l=>l&&l.division),[Y]);p.useEffect(()=>{!Nt&&Ie==="region"&&Ht("direction"),!jt&&Ie==="division"&&Ht("direction")},[Nt,jt,Ie]);const Ar=p.useMemo(()=>{if(!Y||Y.currentEdgeCount===0)return;const l=Y.edges.filter(c=>!c._overlayType);if(l.length!==0)return Math.max(...l.map(c=>c.value))},[Y]);p.useEffect(()=>{H==="kriskogram"&&Y.nodes.length>0&&Sr.current&&Sr.current.updateData(Y.nodes,Y.edges)},[Y,H]);const Co=l=>{g(l),yt.current||k({year:l})};p.useEffect(()=>{yt.current||k({minThreshold:y,maxThreshold:v,maxEdges:A})},[y,v,A]),p.useEffect(()=>{yt.current||k({view:H})},[H]),p.useEffect(()=>{yt.current||k({edgeType:B})},[B]),p.useEffect(()=>{!yt.current&&a&&k({dataset:a})},[a]),p.useEffect(()=>{yt.current},[]),p.useEffect(()=>{ve&&E&&(ve.nodes.some(c=>c.id===E)||(ee(null),de&&we(!1),k({egoNodeId:null,egoStepColoring:!1})))},[ve,E,de,k]),p.useEffect(()=>{if(!i)return;const l=i.timeRange&&typeof i.timeRange.start=="number"&&typeof i.timeRange.end=="number"&&i.timeRange.start!==i.timeRange.end;(!l||!(typeof m=="number"&&l))&&ge&&(Be(!1),k({temporalOverlay:!1,temporalOverlayEdgeStyle:T,temporalOverlayNodeStyle:Z,temporalOverlayCurrentBlack:Lt,temporalOverlayYearsPast:qe,temporalOverlayYearsFuture:_e,temporalOverlayColorPast:Ye,temporalOverlayColorMid:Ke,temporalOverlayColorFuture:Xe,edgeSegmentLength:je,edgeSegmentGap:$e,edgeSegmentOffset:We,edgeSegmentCap:ne,edgeSegmentAnimate:nt,edgeOutlineGap:me}))},[i,m,ge,T,Z,qe,_e,Ye,Ke,Xe,je,$e,We,ne,nt,me,k]),p.useEffect(()=>{yt.current||k({temporalOverlay:ge,temporalOverlayYearsPast:qe,temporalOverlayYearsFuture:_e,temporalOverlayColorPast:Ye,temporalOverlayColorMid:Ke,temporalOverlayColorFuture:Xe,temporalOverlayEdgeStyle:T,temporalOverlayNodeStyle:Z,edgeSegmentLength:je,edgeSegmentGap:$e,edgeSegmentOffset:We,edgeSegmentCap:ne,edgeSegmentAnimate:nt,edgeOutlineGap:me})},[ge,qe,_e,Ye,Ke,Xe,T,Z,je,$e,We,ne,nt,me,k]),p.useEffect(()=>{wn(Ye)},[Ye]),p.useEffect(()=>{_n(Ke)},[Ke]),p.useEffect(()=>{Cn(Xe)},[Xe]);const rr=(l,c,N,se,U)=>{const te=xr(l,c);N(te),se(te),k({[U]:te})},gn=(l,c,N,se,U)=>{const te=l.trim();if(!/^#([0-9a-fA-F]{3}|[0-9a-fA-F]{6})$/.test(te)){se(c);return}rr(te,c,N,se,U)},[sr,Rs]=p.useState("picker"),kr=p.useMemo(()=>{const l={nodeOrder:b=>b.label||b.id,nodeColor:()=>"#2563eb",nodeRadius:()=>6,edgeWidth:()=>Bt,edgeColor:()=>"#1f77b4",nodeStroke:()=>({color:"#fff",width:2})};if(Y.nodes.length===0||Y.baseEdges.length===0)return{accessors:l,legendItems:[]};const c=Y.baseEdges.map(b=>b.value),N=c.length>0?Math.min(...c):0,se=c.length>0?Math.max(...c):1,U=(De==null?void 0:De.min)??N,te=(De==null?void 0:De.max)??se,pe=Math.max(te-U,0),ce=b=>{if(!Number.isFinite(b)||pe<=0)return 0;const z=Math.min(Math.max(b,U),te)-U;switch(Fe){case"sqrt":{const $=Math.sqrt(pe);return $<=0?0:Math.max(0,Math.min(1,Math.sqrt(z)/$))}case"log":{const $=Math.log10(pe+1);return!Number.isFinite($)||$<=0?0:Math.max(0,Math.min(1,Math.log10(z+1)/$))}case"linear":default:return pe<=0?0:Math.max(0,Math.min(1,z/pe))}},Ee=b=>{if(pe<=0)return U;const D=Math.max(0,Math.min(1,b));switch(Fe){case"sqrt":return U+Math.pow(D,2)*pe;case"log":{const z=Math.log10(pe+1);if(!Number.isFinite(z)||z<=0)return U;const $=Math.pow(10,D*z)-1;return U+$}case"linear":default:return U+D*pe}},Te=Y.nodes.map(b=>b.total_outgoing_visible||b._totalOutgoing||0),et=Y.nodes.map(b=>b.total_incoming_visible||b._totalIncoming||0),Fn=Y.nodes.map(b=>b.total_outgoing_year||0),mn=Y.nodes.map(b=>b.total_incoming_year||0),Rn=Y.nodes.map(b=>b.net_flow_visible||0),fn=Y.nodes.map(b=>b.net_flow_year||0),$n=Te.length>0?Math.max(...Te):1,pn=et.length>0?Math.max(...et):1,En=Fn.length>0?Math.max(...Fn):1,In=mn.length>0?Math.max(...mn):1,hn=Rn.length>0?Math.max(...Rn.map(b=>Math.abs(b))):1,xn=fn.length>0?Math.max(...fn.map(b=>Math.abs(b))):1,An=(qt==null?void 0:qt.maxOutgoing)??En,dt=(qt==null?void 0:qt.maxIncoming)??In,$s=(Wt==null?void 0:Wt.min)??-xn,kn=(Wt==null?void 0:Wt.max)??xn,Yt=Math.max(Math.abs($s),Math.abs(kn))||1,vt=(nr==null?void 0:nr.max)??0,ct=["#3b82f6","#f59e0b","#ef4444","#10b981","#8b5cf6","#ec4899","#14b8a6","#f97316"],Ce=Y.temporalOverlay,or=!!Ce,ar=(Ce==null?void 0:Ce.nodeDeltaAbsMax)??0,ir=Math.max(0,(Ce==null?void 0:Ce.yearsPast)??0),bt=Math.max(0,(Ce==null?void 0:Ce.yearsFuture)??0),Mt=(Ce==null?void 0:Ce.colorPast)??Ye,St=(Ce==null?void 0:Ce.colorMid)??Ke,Pn=(Ce==null?void 0:Ce.colorFuture)??Xe,Kt=(Ce==null?void 0:Ce.colorCurrent)??(Lt?"#000000":St),Ze=b=>{const D=typeof b=="string"?b.trim().toLowerCase():"";return/^#([0-9a-f]{3}|[0-9a-f]{6})$/.test(D)?D.length===4?`#${D[1]}${D[1]}${D[2]}${D[2]}${D[3]}${D[3]}`:D:"#000000"},Ft=Ze(Kt),Rt=b=>{const D=Ze(b).slice(1),z=parseInt(D,16);return Number.isNaN(z)||D.length!==6?{r:0,g:0,b:0}:{r:z>>16&255,g:z>>8&255,b:z&255}},yn=b=>Math.max(0,Math.min(255,Math.round(b))).toString(16).padStart(2,"0"),lr=(b,D,z)=>`#${yn(b)}${yn(D)}${yn(z)}`,Vn=(b,D,z)=>{const $=Math.max(0,Math.min(1,z)),P=Rt(b),ae=Rt(D),re=P.r+(ae.r-P.r)*$,Se=P.g+(ae.g-P.g)*$,X=P.b+(ae.b-P.b)*$;return lr(re,Se,X)},Pr=b=>{if(b===0)return Ft;if(b<0){if(ir===0)return Ze(St);const $=1-Math.max(0,Math.min(1,Math.abs(b)/Math.max(ir,1)));return Vn(Ze(Mt),Ze(St),$)}if(bt===0)return Ze(St);const D=Math.max(0,Math.min(1,b/Math.max(bt,1)));return Vn(Ze(St),Ze(Pn),D)},Vr=!!(E&&de&&(Y.egoStepMax??0)>0),wt=Y.egoStepMax??0,ur=b=>{if(wt<=1)return"hsl(210, 80%, 55%)";const D=Math.max(1,Math.min(b,wt)),z=wt<=1?0:(D-1)/(wt-1),$=210-z*150,P=60-z*20;return`hsl(${Math.round($)}, 80%, ${Math.round(P)}%)`},vn=(b,D)=>{const z=Array.from(new Set(Y.nodes.map(P=>P[b]).filter(P=>P!=null))),$=new Map;return z.forEach((P,ae)=>{$.set(P,ct[ae%ct.length])}),$.get(D)||ct[0]},M=b=>{const D=$=>{const P=Math.max(0,Math.min(1,$));switch(er){case"sqrt":return Math.sqrt(P);case"log":{if(P<=0)return 0;const ae=Math.log10(P*9+1),re=Math.log10(10);return re>0?Math.min(1,ae/re):P}case"linear":default:return P}},z=$=>{const ae=3+D($)*9;return Math.max(1,ae*Nn)};switch(xt){case"fixed":return Math.max(1,6*Nn);case"visible_outgoing":case"outgoing":return z($n>0?(b.total_outgoing_visible||b._totalOutgoing||0)/$n:0);case"visible_incoming":case"incoming":return z(pn>0?(b.total_incoming_visible||b._totalIncoming||0)/pn:0);case"year_outgoing":return z(An>0?(b.total_outgoing_year||0)/An:0);case"year_incoming":return z(dt>0?(b.total_incoming_year||0)/dt:0);case"net_visible":{const $=Math.abs(b.net_flow_visible||0),P=hn>0?hn:1;return z($/P)}case"net_year":{const $=Math.abs(b.net_flow_year||0),P=Yt>0?Yt:1;return z($/P)}case"self_year":{const $=vt>0?(b.self_flow_year||0)/vt:0;return z($)}case"attribute":{if(!Je||typeof b[Je]!="number")return 6;const $=Y.nodes.map(X=>X[Je]).filter(X=>typeof X=="number");if($.length===0)return 6;const P=Math.min(...$),re=Math.max(...$)-P||1,Se=(b[Je]-P)/re;return z(Se)}default:return 6}},L=T,G=(b,D)=>{if(D==="outline")return Math.max(2.5,Bt);if(ln==="weight"){const z=ce(b),$=D==="segmented"?.5+z*12:.5+z*15;return Math.max(.25,$*W)}return D==="segmented"?Math.max(Bt,2):Bt},fe={nodeOrder:b=>{if(Yn==="alphabetical")return b.label||b.id;const D=b[Yn];return D==null?`ZZZ_${b.label||b.id}`:typeof D=="number"?`${String(1e6-D).padStart(10,"0")}_${b.label||b.id}`:`${String(D)}_${b.label||b.id}`},nodeColor:b=>{var ae;const D=(re,Se)=>!Number.isFinite(re)||Se<=0?0:Math.max(0,Math.min(1,re/Se)),z=(re,Se,X)=>{const ft=85-Math.max(0,Math.min(1,X))*45;return`hsl(${re}, ${Se}%, ${ft}%)`},$=re=>{if(!Number.isFinite(re)||Yt<=0)return"#6b7280";if(Math.abs(re)<1e-6)return"#9ca3af";const X=85-Math.max(0,Math.min(1,Math.abs(re)/Yt))*45;return re>=0?`hsl(0, 75%, ${X}%)`:`hsl(210, 75%, ${X}%)`};let P="#2563eb";switch(Jn){case"single":P="#2563eb";break;case"outgoing":case"visible_outgoing":P=z(24,85,D(b.total_outgoing_visible||b._totalOutgoing||0,$n));break;case"incoming":case"visible_incoming":P=z(160,70,D(b.total_incoming_visible||b._totalIncoming||0,pn));break;case"year_outgoing":P=z(24,85,D(b.total_outgoing_year||0,An));break;case"year_incoming":P=z(160,70,D(b.total_incoming_year||0,dt));break;case"net_year":P=$(b.net_flow_year||0);break;case"self_year":{const re=vt>0?(b.self_flow_year||0)/vt:0;P=z(280,70,re);break}case"attribute":{if(!Ut){P="#2563eb";break}const re=b[Ut];if(re==null){P="#9ca3af";break}if((ae=i==null?void 0:i.metadata)!=null&&ae.hasNumericProperties.nodes.includes(Ut)){const Se=Y.nodes.map(Et=>Et[Ut]).filter(Et=>typeof Et=="number");if(Se.length===0){P="#2563eb";break}const X=Math.min(...Se),ft=Math.max(...Se)-X||1,$t=(Number(re)-X)/ft;P=`hsl(${120-Math.max(0,Math.min(1,$t))*120}, 70%, 50%)`;break}P=vn(Ut,re);break}default:P="#2563eb";break}return b.__baseFillColor=P,P},nodeRadius:M,edgeWidth:b=>{const D=b.__overlayStyle??L;return G(b.value,D)},edgeColor:(b,D)=>{var re,Se;const z=b==null?void 0:b.__temporalDelta;if(or)return typeof z=="number"?Pr(z):Ft;if(Vr){const X=(b==null?void 0:b._egoStep)??0;if(X>0)return ur(X)}if(!un){if(Ie==="direction")return D?"#1f77b4":"#d62728";if(Ie==="single"){if(ht==="weight"){const Ve=80-ce(b.value)*55;return`hsl(210, 70%, ${Math.round(Ve)}%)`}return"#2563eb"}}let $="#2563eb";if(Ie==="direction")$=D?"#1f77b4":"#d62728";else if(Ie==="region"){const X=Y.nodes.find(Ve=>Ve.id===b.source);$=X!=null&&X.region?vn("region",X.region):"#2563eb"}else if(Ie==="division"){const X=Y.nodes.find(Ve=>Ve.id===b.source);$=X!=null&&X.division?vn("division",X.division):"#2563eb"}else if(Ie==="attribute"&&Gt){const X=b[Gt];if(X!=null)if((re=i==null?void 0:i.metadata)!=null&&re.hasNumericProperties.edges.includes(Gt)){const Ve=Y.baseEdges.map(Dr=>Dr[Gt]).filter(Dr=>typeof Dr=="number"),ft=Math.min(...Ve),dr=Math.max(...Ve)-ft||1;$=`hsl(${120-(Number(X)-ft)/dr*120}, 70%, 50%)`}else $=vn(Gt,X)}let P=.6;if(ht==="weight")P=Math.max(0,Math.min(1,ce(b.value)));else if(ht==="attribute"&&dn){const X=b[dn];if(X!=null&&((Se=i==null?void 0:i.metadata)!=null&&Se.hasNumericProperties.edges.includes(dn))){const Ve=Y.baseEdges.map(Et=>Et[dn]).filter(Et=>typeof Et=="number"),ft=Math.min(...Ve),dr=Math.max(...Ve)-ft||1;P=Math.max(0,Math.min(1,(Number(X)-ft)/dr))}}else ht==="constant"&&(P=Math.max(0,Math.min(1,Zn)));if(Qn&&(Ie==="region"||Ie==="division")){const X=Y.nodes.find($t=>$t.id===b.source),Ve=Y.nodes.find($t=>$t.id===b.target);if(!(Ie==="region"?(X==null?void 0:X.region)&&X.region===(Ve==null?void 0:Ve.region):(X==null?void 0:X.division)&&X.division===(Ve==null?void 0:Ve.division)))return`hsl(0, 0%, ${80-P*50}%)`}const ae=80-P*55;return Ie==="direction"?`hsl(${D?0:200}, 70%, ${Math.round(ae)}%)`:Ie==="single"?`hsl(210, 70%, ${Math.round(ae)}%)`:$},nodeStroke:b=>{const D=b.temporal_overlay_delta??0,z=b.__baseFillColor??"#2563eb";if(!or||ar<=0)return{color:Z==="outline"?z:"#fff",width:Z==="outline"?2.5:2};const $=Math.min(1,Math.abs(D)/Math.max(ar,1));if(Z==="outline"){const ae=2.5+(D===0?0:$*1.5);return{color:z,width:ae}}const P=2+(D===0?0:$*2);return{color:Pr(D),width:P}}},oe=[];if(oe.push({type:"direction",labels:{above:"Above baseline (clockwise)",below:"Below baseline (counter)"},colors:{above:"#d62728",below:"#1f77b4"}}),Ce&&(Ce.hasPast||Ce.hasFuture)){const b=Ce.legendEntries??[];oe.push({type:"temporalOverlay",entries:b})}else if(Vr){const b=Array.from({length:wt},(D,z)=>{const $=z+1;return{step:$,color:ur($)}});oe.push({type:"egoSteps",entries:b})}else if(un){if(Ie==="region"&&Nt){const D=Array.from(new Set(Y.nodes.map(z=>z.region).filter(Boolean))).slice(0,10).map((z,$)=>({label:z,color:ct[$%ct.length]}));oe.push({type:"categorical",title:"Regions",entries:D,interNote:Qn?"Inter edges: grayscale by intensity":void 0})}else if(Ie==="division"&&jt){const D=Array.from(new Set(Y.nodes.map(z=>z.division).filter(Boolean))).slice(0,10).map((z,$)=>({label:z,color:ct[$%ct.length]}));oe.push({type:"categorical",title:"Divisions",entries:D,interNote:Qn?"Inter edges: grayscale by intensity":void 0})}}else if(Ie!=="direction"){if(Ie==="single"&&ht==="weight"){const D=[0,.5,1].map(z=>{const $=Ee(z),ae=80-ce($)*55;return{value:$,color:`hsl(210, 70%, ${Math.round(ae)}%)`,width:G($,L),fraction:z}});oe.push({type:"weight",color:"#1f77b4",scale:Fe,min:U,max:te,samples:D})}}if(Y.baseEdges.length>0)if(ln==="weight"){const b=[0,.5,1],D=["Minimum","Median","Maximum"],z=b.map(($,P)=>{const ae=Ee($),re=G(ae,L);return{label:D[P],value:ae,width:re,fraction:$}});oe.push({type:"edgeWidth",mode:"weight",scale:Fe,multiplier:W,min:U,max:te,samples:z})}else{const b=G(te,L);oe.push({type:"edgeWidth",mode:"fixed",baseWidth:b,samples:[{label:"Fixed",width:b}]})}const be=()=>{switch(xt){case"fixed":return"Fixed radius";case"visible_outgoing":case"outgoing":return"Visible outgoing flow";case"visible_incoming":case"incoming":return"Visible incoming flow";case"year_outgoing":return"Year outgoing flow";case"year_incoming":return"Year incoming flow";case"net_visible":return"Visible net flow";case"net_year":return"Year net flow";case"self_year":return"Self flow (year)";case"attribute":return Je?`Attribute: ${Je}`:"Attribute value";default:return String(xt).replace(/_/g," ")}},Ne=b=>{switch(xt){case"fixed":return null;case"visible_outgoing":case"outgoing":return b.total_outgoing_visible||b._totalOutgoing||0;case"visible_incoming":case"incoming":return b.total_incoming_visible||b._totalIncoming||0;case"year_outgoing":return b.total_outgoing_year||0;case"year_incoming":return b.total_incoming_year||0;case"net_visible":return Math.abs(b.net_flow_visible||0);case"net_year":return Math.abs(b.net_flow_year||0);case"self_year":return b.self_flow_year||0;case"attribute":return Je&&typeof b[Je]=="number"?b[Je]:null;default:return null}},Ge=Y.nodes.map(b=>({id:b.id,label:b.label||b.id,radius:M(b),value:Ne(b)})).filter(b=>Number.isFinite(b.radius)).sort((b,D)=>b.radius-D.radius);if(Ge.length>0){const b=Se=>Ge[Math.min(Ge.length-1,Math.max(0,Se))],D=b(0),z=b(Math.floor(Ge.length/2)),$=b(Ge.length-1),P=new Map;[{label:"Minimum",radius:D.radius,value:D.value},{label:"Median",radius:z.radius,value:z.value},{label:"Maximum",radius:$.radius,value:$.value}].forEach(Se=>{const X=Math.round(Se.radius*10)/10;P.has(X)||P.set(X,{label:Se.label,radius:Math.max(3,Se.radius),value:Se.value??void 0})});const re=Array.from(P.values()).map(Se=>{const X=[Se.label];return Se.value!==void 0&&Se.value!==null&&X.push(new Intl.NumberFormat("en-US",{maximumFractionDigits:0}).format(Se.value)),{label:X.join(" • "),radius:Se.radius,value:Se.value??void 0}});oe.push({type:"nodeSize",mode:be(),scale:xt==="fixed"?void 0:er,multiplier:Nn,note:xt==="attribute"&&Je?`Using numeric attribute "${Je}"`:void 0,entries:re})}return{accessors:fe,legendItems:oe}},[Y,Bt,i,De,qt,Wt,nr,un,Ie,Gt,Qn,ht,dn,Zn,ln,W,Fe,E,de,jt,Nt,Ut,Jn,Yn,Je,xt,Nn,er,Xe,Ke,Ye,Lt,T,ge,Z,qe,_e]);return r.jsx(Pt,{fallback:r.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center",children:r.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-8 max-w-lg mx-4",children:[r.jsx("h2",{className:"text-2xl font-bold text-red-800 mb-4",children:"Explorer Error"}),r.jsx("p",{className:"text-gray-700 mb-4",children:"The explorer page encountered an error. Please refresh the page."}),r.jsx("button",{onClick:()=>window.location.reload(),className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 cursor-pointer transition-colors",children:"Reload Page"})]})}),children:r.jsxs("div",{className:"flex flex-1 h-full overflow-hidden",children:[r.jsxs("main",{className:"flex-1 flex flex-col overflow-hidden h-full relative",children:[x&&r.jsx("div",{className:"p-4 bg-yellow-50 text-yellow-800",children:"Loading…"}),f&&r.jsx("div",{className:"p-4 bg-red-50 text-red-600",children:f}),i?r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"flex-1 flex flex-col overflow-hidden bg-white",children:r.jsx("div",{className:`flex-1 overflow-hidden ${H==="table"?"":"p-4"}`,children:Y.nodes.length>0&&Y.baseEdges.length>0?r.jsxs(r.Fragment,{children:[H==="kriskogram"&&r.jsx(Pt,{fallback:r.jsxs("div",{className:"p-4 bg-red-50 border border-red-200 rounded-md",children:[r.jsx("h3",{className:"text-lg font-semibold text-red-800 mb-2",children:"Kriskogram Error"}),r.jsx("p",{className:"text-sm text-red-700",children:"The Kriskogram visualization encountered an error."})]}),children:r.jsx("div",{className:"w-full h-full",children:r.jsx(Io,{ref:Sr,nodes:Y.nodes,edges:Y.edges,width:Math.max(800,an.width-(t?64:s)-(on?4:qn)-40),height:Math.max(600,an.height-80),margin:{top:60,right:40,bottom:60,left:40},arcOpacity:wr,title:i.name,accessors:kr.accessors,legend:kr.legendItems.length>0?kr.legendItems:void 0})})}),H==="table"&&r.jsx(Pt,{fallback:r.jsxs("div",{className:"p-4 bg-red-50 border border-red-200 rounded-md",children:[r.jsx("h3",{className:"text-lg font-semibold text-red-800 mb-2",children:"Table View Error"}),r.jsx("p",{className:"text-sm text-red-700",children:"The table view encountered an error."})]}),children:r.jsx("div",{className:"h-full w-full flex flex-col min-h-0",children:r.jsx(po,{nodes:Y.nodes,edges:Y.baseEdges})})}),H==="sankey"&&r.jsx(Pt,{fallback:r.jsxs("div",{className:"p-4 bg-red-50 border border-red-200 rounded-md",children:[r.jsx("h3",{className:"text-lg font-semibold text-red-800 mb-2",children:"Sankey Diagram Error"}),r.jsx("p",{className:"text-sm text-red-700",children:"The Sankey diagram encountered an error."})]}),children:r.jsx("div",{className:"h-full min-h-0",children:r.jsx(Oi,{nodes:Y.nodes,edges:Y.baseEdges,width:Math.max(800,an.width-(t?64:s)-(on?4:qn)-40),height:Math.max(600,an.height-80)})})}),H==="chord"&&r.jsx(Pt,{fallback:r.jsxs("div",{className:"p-4 bg-red-50 border border-red-200 rounded-md",children:[r.jsx("h3",{className:"text-lg font-semibold text-red-800 mb-2",children:"Chord Diagram Error"}),r.jsx("p",{className:"text-sm text-red-700",children:"The chord diagram encountered an error."})]}),children:r.jsx(zi,{nodes:Y.nodes,edges:Y.baseEdges,width:Math.max(800,an.width-(t?64:s)-(on?4:qn)-40),height:Math.max(600,an.height-80)})})]}):ve?r.jsxs("div",{className:"text-center text-gray-500 py-8",children:["No data meets the current threshold range (",y.toLocaleString()," - ",v.toLocaleString(),"). Try adjusting the filters."]}):r.jsx("div",{className:"px-6 py-8 text-center text-gray-600 space-y-3",children:typeof m=="number"&&Zs[m]?r.jsxs(r.Fragment,{children:[r.jsxs("p",{className:"text-lg font-semibold text-gray-700",children:["No state-to-state migration snapshot for ",m]}),r.jsx("p",{className:"text-sm leading-relaxed",children:Zs[m]})]}):r.jsx("p",{children:"No snapshot to display."})})})}),H==="kriskogram"&&r.jsxs("div",{className:"absolute bottom-4 right-4 flex items-center gap-2 bg-white/90 backdrop-blur px-3 py-2 rounded shadow border border-gray-200",children:[r.jsx("label",{className:"text-xs font-medium text-gray-700",children:"Mode:"}),r.jsx("button",{type:"button",onClick:()=>{Rr("pan"),k({interactionMode:"pan"})},className:["text-xs px-2 py-1 rounded border",Fr==="pan"?"bg-blue-600 text-white border-blue-600":"bg-white text-gray-700 border-gray-300"].join(" "),children:"Pan"}),r.jsx("button",{type:"button",onClick:()=>{Rr("lens"),k({interactionMode:"lens"})},className:["text-xs px-2 py-1 rounded border",Fr==="lens"?"bg-blue-600 text-white border-blue-600":"bg-white text-gray-700 border-gray-300"].join(" "),children:"Edge Lens"}),Fr==="lens"&&r.jsxs("span",{className:"text-[10px] text-gray-600",children:["Wheel: radius (",vo,"px)"]})]})]}):r.jsx("div",{className:"flex-1 flex items-center justify-center text-gray-500",children:r.jsxs("div",{className:"text-center",children:[r.jsx("p",{className:"text-lg mb-2",children:"No dataset selected"}),r.jsx("p",{className:"text-sm",children:"Select a dataset from the sidebar to begin exploring"})]})})]}),i&&r.jsx(Ui,{isCollapsed:on,onToggle:()=>xo(!on),onResize:yo,title:"Visualization Settings",bottomContent:r.jsxs("div",{className:"p-3",children:[r.jsx("label",{className:"text-xs font-medium text-gray-600 block mb-2",children:"Visualization Type"}),r.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[r.jsx("button",{onClick:()=>{ie("kriskogram"),k({view:"kriskogram"})},className:`px-3 py-2.5 rounded text-sm font-medium transition-colors ${H==="kriskogram"?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"Kriskogram"}),r.jsx("button",{onClick:()=>{ie("table"),k({view:"table"})},className:`px-3 py-2.5 rounded text-sm font-medium transition-colors ${H==="table"?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"Table"}),r.jsx("button",{onClick:()=>{ie("sankey"),k({view:"sankey"})},className:`px-3 py-2.5 rounded text-sm font-medium transition-colors ${H==="sankey"?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"Sankey"}),r.jsx("button",{onClick:()=>{ie("chord"),k({view:"chord"})},className:`px-3 py-2.5 rounded text-sm font-medium transition-colors ${H==="chord"?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"Chord"})]})]}),children:r.jsxs("div",{className:"space-y-4",children:[r.jsxs(Zt,{title:i.name,defaultOpen:!0,subtitle:`${i.type.toUpperCase()} · ${i.timeRange.start}${i.timeRange.end!==i.timeRange.start?`–${i.timeRange.end}`:""}`,children:[i.notes&&r.jsx("div",{className:"text-xs text-gray-600 mt-2 whitespace-pre-wrap",children:i.notes}),!i.notes&&r.jsx("div",{className:"text-xs text-gray-500 italic mt-2",children:"No description available"})]}),st&&r.jsxs("div",{className:"p-3 bg-gray-50 rounded grid grid-cols-2 gap-3 text-sm",children:[r.jsxs("div",{children:[r.jsx("div",{className:"text-xs text-gray-600",children:"Nodes"}),r.jsxs("div",{className:"text-lg font-bold",children:[st.visibleNodes,"/",st.totalNodes]})]}),r.jsxs("div",{children:[r.jsx("div",{className:"text-xs text-gray-600",children:"Edges"}),r.jsxs("div",{className:"text-lg font-bold",children:[st.visibleEdges.toLocaleString(),"/",st.totalEdges.toLocaleString()]})]})]}),r.jsx(Zt,{title:"General Settings",defaultOpen:!0,onReset:()=>{const l=Math.max(1,$r);V(null),ws("none"),br(null),zt([]),S(ut),j(Mn),F(l),k({edgeType:null,intraFilter:"none",nodeFilterAttribute:null,nodeFilterValues:[],minThreshold:ut,maxThreshold:Mn,maxEdges:l})},children:r.jsxs("div",{className:"space-y-4",children:[wo&&m!==void 0&&r.jsxs("div",{className:"space-y-2",children:[r.jsxs("label",{className:"text-sm font-medium",children:["Year: ",m]}),r.jsx("input",{type:"range",min:i.timeRange.start,max:i.timeRange.end,value:m,onChange:l=>Co(parseInt(l.target.value)),className:"w-full"})]}),mt&&r.jsxs("div",{className:"space-y-2",children:[r.jsxs("label",{className:"text-sm font-medium",children:["Edge Type (",mt.property,")"]}),r.jsxs("select",{value:B||"all",onChange:l=>{const c=l.target.value==="all"?null:l.target.value;V(c),k({edgeType:c})},className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[r.jsx("option",{value:"all",children:"All Types"}),mt.values.map(l=>r.jsx("option",{value:l,children:l},l))]})]}),(Nt||jt)&&r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-sm font-medium",children:"Edge Scope"}),r.jsxs("select",{value:rt,onChange:l=>{const c=l.target.value;ws(c),k({intraFilter:c})},className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[r.jsx("option",{value:"none",children:"All"}),Nt&&r.jsx("option",{value:"region",children:"Intra Region"}),jt&&r.jsx("option",{value:"division",children:"Intra Division"}),Nt&&r.jsx("option",{value:"interRegion",children:"Inter Region"}),jt&&r.jsx("option",{value:"interDivision",children:"Inter Division"})]})]}),tr.length>0&&r.jsxs("div",{className:"space-y-2",children:[r.jsx("label",{className:"text-sm font-medium",children:"Node Filter"}),r.jsxs("select",{value:Le??"",onChange:l=>{const c=l.target.value||null;br(c),zt([]),k({nodeFilterAttribute:c,nodeFilterValues:[]})},className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[r.jsx("option",{value:"",children:"All nodes"}),tr.map(l=>r.jsx("option",{value:l,children:l},l))]}),Le&&(jn.length>0?r.jsxs("div",{className:"space-y-2",children:[r.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-600",children:[r.jsx("button",{type:"button",className:"rounded px-2 py-1 hover:bg-gray-100",onClick:()=>{const l=[...jn];zt(l),k({nodeFilterValues:l})},children:"Select all"}),r.jsx("button",{type:"button",className:"rounded px-2 py-1 hover:bg-gray-100",onClick:()=>{zt([]),k({nodeFilterValues:[]})},children:"Clear"})]}),r.jsx("div",{className:"max-h-48 overflow-y-auto rounded-md border border-gray-200 divide-y divide-gray-100",children:jn.map(l=>{const c=lt.includes(l);return r.jsxs("label",{className:"flex items-center gap-2 px-3 py-2 text-sm cursor-pointer hover:bg-gray-50",children:[r.jsx("input",{type:"checkbox",className:"h-3.5 w-3.5",checked:c,onChange:N=>{const se=N.target.checked?Array.from(new Set([...lt,l])).sort((U,te)=>U.localeCompare(te)):lt.filter(U=>U!==l);zt(se),k({nodeFilterValues:se})}}),r.jsx("span",{children:l})]},l)})}),lt.length===0&&r.jsxs("p",{className:"text-xs text-gray-500",children:["No specific values selected. All nodes for ",Le," remain visible."]})]}):r.jsxs("p",{className:"text-xs text-gray-500 italic",children:["No values available for ",Le," in this snapshot."]}))]}),ve&&st&&r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("label",{className:"text-sm font-medium flex items-center gap-2",children:[r.jsxs("span",{children:["Min: ",y.toLocaleString()]}),Ir!==void 0&&Ir>y&&r.jsxs("span",{className:"text-xs text-gray-400",children:["(actual ",Ir.toLocaleString(),")"]})]}),(()=>{const l=Math.max(1,$r),c=y>ut||v<Mn||A<l;return r.jsx("button",{onClick:()=>{S(ut),j(Mn),F(l)},disabled:!c,type:"button",className:`text-xs transition-colors ${c?"text-blue-600 hover:text-blue-800":"text-gray-400 cursor-not-allowed"}`,children:"Show All"})})()]}),r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("input",{type:"range",min:ut,max:cn||1,step:Fs,value:y,onChange:l=>{const c=parseInt(l.target.value),N=Math.min(c,v);S(N),k({minThreshold:N})},className:"w-full"}),r.jsx("input",{type:"number",min:ut,max:cn||1,value:y,onChange:l=>{const c=Number.parseInt(l.target.value);if(Number.isNaN(c))return;const N=Math.max(ut,Math.min(c,v));S(N),k({minThreshold:N})},className:"w-24 px-2 py-1 text-sm border border-gray-300 rounded-md"})]})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsxs("label",{className:"text-sm font-medium flex items-center gap-2",children:[r.jsxs("span",{children:["Max: ",v.toLocaleString()]}),Ar!==void 0&&Ar<v&&r.jsxs("span",{className:"text-xs text-gray-400",children:["(actual ",Ar.toLocaleString(),")"]})]}),r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("input",{type:"range",min:ut,max:cn||1,step:Fs,value:v,onChange:l=>{const c=parseInt(l.target.value),N=Math.max(c,y);j(N),k({maxThreshold:N})},className:"w-full"}),r.jsx("input",{type:"number",min:ut,max:cn||1,value:v,onChange:l=>{const c=Number.parseInt(l.target.value);if(Number.isNaN(c))return;const N=Math.min(cn||1,Math.max(c,y));j(N),k({maxThreshold:N})},className:"w-24 px-2 py-1 text-sm border border-gray-300 rounded-md"})]})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsxs("label",{className:"text-sm font-medium",children:["Max Edges: ",A]}),r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("input",{type:"range",min:10,max:Er,step:10,value:A,onChange:l=>{const c=parseInt(l.target.value);F(c),k({maxEdges:c})},className:"w-full"}),r.jsx("input",{type:"number",min:1,max:Er,value:A,onChange:l=>{const c=Number.parseInt(l.target.value);if(Number.isNaN(c))return;const N=Math.max(1,Math.min(c,Er));F(N),k({maxEdges:N})},className:"w-24 px-2 py-1 text-sm border border-gray-300 rounded-md"})]}),r.jsxs("p",{className:"text-xs text-gray-600 italic",children:["After filtering by thresholds and edge type, edges are sorted by value (highest first) and the top ",A," edges are displayed."]})]})]})]})}),H==="kriskogram"&&r.jsx(Zt,{title:"Kriskogram Settings",defaultOpen:!0,onReset:()=>{ue(!1),ys("alphabetical"),vs(.85),_r("weight"),Re(1),_s(2),Cs("single"),jr(null),Ns("fixed"),Mr(null),js("linear"),Ms(1),bs(!1),Ht("direction"),Kn(null),Ss(!0),Cr("weight"),Xn(null),Nr(.6),Rr("pan"),bo(80),So({x:0,y:0}),ee(null),xe(1),we(!1),R("linear"),Be(!1),ke("filled"),Oe("filled"),Ct(1),Pe(1),Bn("#fc8d59"),Un("#ffffbf"),Wn("#91bfdb"),ms(!0),Ue(8),sn(4),Gn(15),O(1),ye(!1),he("round"),Hn(!1),it(3),k({showAllNodes:!1,nodeOrderMode:"alphabetical",arcOpacity:.85,edgeWidthMode:"weight",edgeWidthMultiplier:1,baseEdgeWidth:2,nodeColorMode:"single",nodeColorAttribute:null,nodeSizeMode:"fixed",nodeSizeAttribute:null,nodeSizeWeightScale:"linear",nodeSizeMultiplier:1,edgeColorAdvanced:!1,edgeColorHue:"direction",edgeColorHueAttribute:null,edgeColorInterGrayscale:!0,edgeColorIntensity:"weight",edgeColorIntensityAttribute:null,edgeColorIntensityConst:.6,interactionMode:"pan",lensRadius:80,egoNodeId:null,egoNeighborSteps:1,egoStepColoring:!1,temporalOverlay:!1,temporalOverlayYearsPast:1,temporalOverlayYearsFuture:1,temporalOverlayColorPast:"#fc8d59",temporalOverlayColorMid:"#ffffbf",temporalOverlayColorFuture:"#91bfdb",temporalOverlayCurrentBlack:!0,edgeSegmentLength:8,edgeSegmentGap:4,edgeSegmentOffset:15,edgeSegmentSpeed:1,edgeSegmentScaleByWeight:!1,edgeSegmentCap:"round",edgeSegmentAnimate:!1,edgeWeightScale:"linear",edgeOutlineGap:3})},children:i!=null&&i.metadata?r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{className:"flex items-center justify-between p-2 bg-gray-50 rounded border border-gray-200",children:[r.jsxs("div",{children:[r.jsx("label",{htmlFor:"kriskogram-show-all-nodes",className:"text-sm font-medium text-gray-700",children:"Always show all nodes"}),r.jsx("p",{className:"text-xs text-gray-500",children:"Keeps every location visible even if its edges fall outside the filters."})]}),r.jsx("input",{id:"kriskogram-show-all-nodes",type:"checkbox",className:"w-4 h-4",checked:q,onChange:l=>{const c=l.target.checked;ue(c),k({showAllNodes:c})}})]}),r.jsxs("div",{className:"space-y-3 border border-gray-200 rounded-md p-3",children:[r.jsx("div",{className:"text-xs font-semibold text-gray-600 uppercase tracking-wide",children:"Ego Focus"}),r.jsxs("div",{children:[r.jsx("label",{htmlFor:"kriskogram-ego-node",className:"text-xs font-medium text-gray-700",children:"Ego focus (optional)"}),r.jsxs("select",{id:"kriskogram-ego-node",value:E??"",onChange:l=>{const c=l.target.value,N=c===""?null:c;N===null?(ee(null),de&&we(!1),k({egoNodeId:null,egoStepColoring:!1})):(ee(N),k({egoNodeId:N}))},className:"mt-1 w-full px-2 py-1.5 text-xs border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[r.jsx("option",{value:"",children:"No ego focus (show all eligible edges)"}),((ve==null?void 0:ve.nodes)??[]).map(l=>r.jsx("option",{value:l.id,children:l.label||l.id},l.id))]}),r.jsx("p",{className:"mt-1 text-[11px] text-gray-500",children:"Limit the visualization to flows centered on a selected node."})]}),r.jsxs("div",{children:[r.jsx("label",{htmlFor:"kriskogram-ego-steps",className:"text-xs font-medium text-gray-700",children:"Neighbor steps"}),r.jsxs("div",{className:"mt-1 flex items-center gap-2",children:[r.jsx("input",{id:"kriskogram-ego-steps",type:"number",min:1,max:10,value:le,disabled:!E,onChange:l=>{const c=Number.parseInt(l.target.value,10);if(Number.isNaN(c))return;const N=Math.max(1,Math.min(c,10));xe(N),k({egoNeighborSteps:N})},className:"w-20 px-2 py-1 text-xs border border-gray-300 rounded-md disabled:bg-gray-100 disabled:text-gray-500"}),r.jsx("span",{className:"text-[11px] text-gray-500",children:"How many hops from the ego node to include (based on currently visible edges)."})]})]}),r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("label",{htmlFor:"kriskogram-ego-step-coloring",className:"text-xs font-medium text-gray-700",children:"Color edges by neighbor step"}),r.jsx("p",{className:"text-[11px] text-gray-500",children:"Apply a step-based gradient for ego flows and show it in the legend."})]}),r.jsx("input",{id:"kriskogram-ego-step-coloring",type:"checkbox",className:"w-4 h-4",disabled:!E,checked:de&&!!E,onChange:l=>{const c=l.target.checked&&!!E;we(c),k({egoStepColoring:c})}})]}),r.jsx("p",{className:"text-[11px] text-gray-500",children:"Edge and node styling options are available in the sections below."})]}),r.jsxs("div",{className:"space-y-3 border border-gray-200 rounded-md p-3",children:[r.jsx("div",{className:"text-xs font-semibold text-gray-600 uppercase tracking-wide",children:"Temporal Overlay"}),r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("label",{className:"text-xs font-medium text-gray-700",htmlFor:"kriskogram-temporal-overlay",children:"Show neighboring years"}),r.jsx("p",{className:"text-[11px] text-gray-500",children:"Overlay edges from nearby years to compare past and future flows."})]}),r.jsx("input",{id:"kriskogram-temporal-overlay",type:"checkbox",className:"w-4 h-4",disabled:!i||i.timeRange.start===i.timeRange.end||typeof m!="number",checked:ge&&(i==null?void 0:i.timeRange.start)!==(i==null?void 0:i.timeRange.end),onChange:l=>{const c=l.target.checked;Be(c),k({temporalOverlay:c})}})]}),r.jsxs("div",{children:[r.jsx("label",{className:"text-xs font-medium text-gray-700",htmlFor:"kriskogram-temporal-overlay-years",children:"Neighbor years"}),r.jsxs("div",{className:"mt-1 grid grid-cols-1 sm:grid-cols-2 gap-2",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("span",{className:"text-[11px] text-gray-600 whitespace-nowrap",children:"Years before"}),r.jsx("input",{type:"number",min:0,max:10,value:qe,disabled:!ge,onChange:l=>{const c=Number.parseInt(l.target.value,10);if(Number.isNaN(c))return;const N=Math.max(0,Math.min(c,10));Ct(N),k({temporalOverlayYearsPast:N})},className:"w-20 px-2 py-1 text-xs border border-gray-300 rounded-md disabled:bg-gray-100 disabled:text-gray-500"})]}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("span",{className:"text-[11px] text-gray-600 whitespace-nowrap",children:"Years after"}),r.jsx("input",{type:"number",min:0,max:10,value:_e,disabled:!ge,onChange:l=>{const c=Number.parseInt(l.target.value,10);if(Number.isNaN(c))return;const N=Math.max(0,Math.min(c,10));Pe(N),k({temporalOverlayYearsFuture:N})},className:"w-20 px-2 py-1 text-xs border border-gray-300 rounded-md disabled:bg-gray-100 disabled:text-gray-500"})]})]}),r.jsx("p",{className:"mt-1 text-[11px] text-gray-500",children:"Control how many past and future snapshots appear alongside the current year."}),(!i||i.timeRange.start===i.timeRange.end)&&r.jsx("p",{className:"mt-2 text-[11px] text-gray-400 italic",children:"Temporal overlay is unavailable because this dataset has a single year."})]})]}),r.jsxs("div",{className:"space-y-3 border border-gray-200 rounded-md p-3",children:[r.jsx("div",{className:"text-xs font-semibold text-gray-600 uppercase tracking-wide",children:"Node"}),r.jsxs("div",{className:"space-y-2",children:[r.jsx("label",{className:"text-xs font-medium text-gray-700",children:"Node Ordering"}),r.jsxs("select",{value:Yn,onChange:l=>{const c=l.target.value;ys(c),k({nodeOrderMode:c})},className:"w-full px-2 py-1.5 text-xs border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[r.jsx("option",{value:"alphabetical",children:"Alphabetical"}),i.metadata.hasCategoricalProperties.nodes.map(l=>r.jsxs("option",{value:l,children:["By ",l]},l)),i.metadata.hasNumericProperties.nodes.map(l=>r.jsxs("option",{value:l,children:["By ",l]},l))]})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx("label",{className:"text-xs font-medium text-gray-700",children:"Node Color"}),r.jsxs("select",{value:Jn,onChange:l=>{const c=l.target.value;Cs(c);const N={nodeColorMode:c};c!=="attribute"&&(jr(null),N.nodeColorAttribute=null),k(N)},className:"w-full px-2 py-1.5 text-xs border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[r.jsx("option",{value:"single",children:"Single Color"}),r.jsx("option",{value:"visible_outgoing",children:"Visible Outgoing Flow"}),r.jsx("option",{value:"visible_incoming",children:"Visible Incoming Flow"}),r.jsx("option",{value:"year_outgoing",children:"Year Outgoing Flow"}),r.jsx("option",{value:"year_incoming",children:"Year Incoming Flow"}),r.jsx("option",{value:"net_year",children:"Net Flow (year)"}),r.jsx("option",{value:"self_year",children:"Self Flow (year)"}),r.jsx("option",{value:"attribute",children:"By Attribute"})]}),Jn==="attribute"&&r.jsxs("select",{value:Ut||"",onChange:l=>{const c=l.target.value||null;jr(c),k({nodeColorAttribute:c})},className:"w-full px-2 py-1.5 text-xs border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[r.jsx("option",{value:"",children:"Select..."}),i.metadata.hasCategoricalProperties.nodes.map(l=>r.jsx("option",{value:l,children:l},l)),i.metadata.hasNumericProperties.nodes.map(l=>r.jsx("option",{value:l,children:l},l))]})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx("label",{className:"text-xs font-medium text-gray-700",children:"Node Size"}),r.jsxs("select",{value:xt,onChange:l=>{const c=l.target.value;Ns(c);const N={nodeSizeMode:c};c!=="attribute"&&(Mr(null),N.nodeSizeAttribute=null),k(N)},className:"w-full px-2 py-1.5 text-xs border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[r.jsx("option",{value:"fixed",children:"Fixed"}),r.jsx("option",{value:"visible_outgoing",children:"Visible Outgoing Flow"}),r.jsx("option",{value:"visible_incoming",children:"Visible Incoming Flow"}),r.jsx("option",{value:"year_outgoing",children:"Year Outgoing Flow"}),r.jsx("option",{value:"year_incoming",children:"Year Incoming Flow"}),r.jsx("option",{value:"net_visible",children:"Net Flow (visible)"}),r.jsx("option",{value:"net_year",children:"Net Flow (year)"}),r.jsx("option",{value:"self_year",children:"Self Flow (year)"}),r.jsx("option",{value:"attribute",children:"By Attribute"})]}),xt==="attribute"&&r.jsxs("select",{value:Je||"",onChange:l=>{const c=l.target.value||null;Mr(c),k({nodeSizeAttribute:c})},className:"w-full px-2 py-1.5 text-xs border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[r.jsx("option",{value:"",children:"Select..."}),i.metadata.hasNumericProperties.nodes.map(l=>r.jsx("option",{value:l,children:l},l))]}),r.jsxs("div",{className:"mt-2 border border-gray-200 rounded-md p-2 bg-gray-50",children:[r.jsx("div",{className:"text-[11px] font-semibold text-gray-600 uppercase tracking-wide",children:"Weight"}),r.jsxs("div",{className:"mt-2 grid grid-cols-1 sm:grid-cols-2 gap-2 text-xs",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-[11px] font-medium text-gray-600",children:"Scaling"}),r.jsxs("select",{value:er,onChange:l=>{const c=l.target.value;js(c),k({nodeSizeWeightScale:c})},className:"mt-1 w-full px-2 py-1.5 text-xs border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[r.jsx("option",{value:"linear",children:"Linear"}),r.jsx("option",{value:"sqrt",children:"Square root"}),r.jsx("option",{value:"log",children:"Logarithmic"})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-[11px] font-medium text-gray-600",children:"Multiplier"}),r.jsx("input",{type:"number",min:.1,max:10,step:.1,value:Nn,onChange:l=>{const c=Number.parseFloat(l.target.value);if(Number.isNaN(c))return;const N=Math.max(.1,Math.min(10,c));Ms(N),k({nodeSizeMultiplier:N})},className:"mt-1 w-full px-2 py-1 text-xs border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]}),r.jsx("p",{className:"mt-2 text-[10px] text-gray-500",children:"Apply curve scaling and an overall multiplier to flow-based node sizes."})]})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx("label",{className:"text-xs font-medium text-gray-700",htmlFor:"kriskogram-node-styling",children:"Node styling"}),r.jsx("p",{className:"text-[11px] text-gray-500",children:"Control how nodes are rendered. Outline mode hides the fill and emphasizes the stroke."}),r.jsxs("select",{id:"kriskogram-node-styling",value:Z,onChange:l=>{const c=l.target.value;Oe(c),k({temporalOverlayNodeStyle:c})},className:"w-full px-2 py-1.5 text-xs border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[r.jsx("option",{value:"filled",children:"Filled nodes"}),r.jsx("option",{value:"outline",children:"Outline only"})]})]})]}),r.jsxs("div",{className:"space-y-3 border border-gray-200 rounded-md p-3",children:[r.jsx("div",{className:"text-xs font-semibold text-gray-600 uppercase tracking-wide",children:"Edge"}),r.jsxs("div",{className:"space-y-2",children:[r.jsxs("label",{className:"text-xs font-medium text-gray-700",children:["Arc Opacity: ",Math.round(wr*100),"%"]}),r.jsx("input",{type:"range",min:0,max:1,step:.05,value:wr,onChange:l=>{const c=Number.parseFloat(l.target.value);Number.isNaN(c)||(vs(c),k({arcOpacity:c}))},className:"w-full"})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx("label",{className:"text-xs font-medium text-gray-700",children:"Edge Width"}),r.jsxs("div",{className:"flex items-center gap-3 text-xs",children:[r.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[r.jsx("input",{type:"radio",name:"edgeWidthMode",value:"weight",checked:ln==="weight",onChange:()=>{_r("weight"),k({edgeWidthMode:"weight"})},className:"w-3.5 h-3.5"}),r.jsx("span",{children:"By Weight"})]}),r.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[r.jsx("input",{type:"radio",name:"edgeWidthMode",value:"fixed",checked:ln==="fixed",onChange:()=>{_r("fixed"),k({edgeWidthMode:"fixed"})},className:"w-3.5 h-3.5"}),r.jsx("span",{children:"Fixed"})]})]}),ln==="fixed"&&r.jsxs("div",{className:"mt-2",children:[r.jsxs("label",{className:"text-xs font-medium text-gray-700",children:["Base Edge Width: ",Bt.toFixed(1),"px"]}),r.jsx("input",{type:"range",min:.5,max:8,step:.1,value:Bt,onChange:l=>{const c=Number.parseFloat(l.target.value);Number.isNaN(c)||(_s(c),k({baseEdgeWidth:c}))},className:"w-full"})]}),r.jsxs("div",{className:"mt-2 border border-gray-200 rounded-md p-2 bg-gray-50",children:[r.jsx("div",{className:"text-[11px] font-semibold text-gray-600 uppercase tracking-wide",children:"Weight"}),r.jsxs("div",{className:"mt-2 grid grid-cols-1 sm:grid-cols-2 gap-2 text-xs",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-[11px] font-medium text-gray-600",children:"Scaling"}),r.jsxs("select",{value:Fe,onChange:l=>{const c=l.target.value;R(c),k({edgeWeightScale:c})},className:"mt-1 w-full px-2 py-1.5 text-xs border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[r.jsx("option",{value:"linear",children:"Linear (use raw weight differences)"}),r.jsx("option",{value:"sqrt",children:"Square root (compress extremes)"}),r.jsx("option",{value:"log",children:"Logarithmic (highlight small flows)"})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-[11px] font-medium text-gray-600",children:"Multiplier"}),r.jsx("input",{type:"number",min:.1,max:10,step:.1,value:W,onChange:l=>{const c=Number.parseFloat(l.target.value);if(Number.isNaN(c))return;const N=Math.max(.1,Math.min(10,c));Re(N),k({edgeWidthMultiplier:N})},className:"mt-1 w-full px-2 py-1 text-xs border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]}),r.jsx("p",{className:"mt-2 text-[10px] text-gray-500",children:"Scaling also shapes weight-based color intensity; the multiplier only stretches rendered edge widths."})]})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx("label",{className:"text-xs font-medium text-gray-700",htmlFor:"kriskogram-edge-style",children:"Line styling"}),r.jsx("p",{className:"text-[11px] text-gray-500",children:"Choose how edges are drawn. Segmented uses dashed arcs; outline shows a thin perimeter."}),r.jsxs("select",{id:"kriskogram-edge-style",value:T,onChange:l=>{const c=l.target.value;ke(c),k({temporalOverlayEdgeStyle:c})},className:"w-full px-2 py-1.5 text-xs border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[r.jsx("option",{value:"filled",children:"Filled (solid weight)"}),r.jsx("option",{value:"segmented",children:"Segmented (dashed)"}),r.jsx("option",{value:"outline",children:"Outline only"})]}),T==="segmented"&&r.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-3 text-xs mt-2",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-[11px] font-medium text-gray-600",children:"Dash length (px)"}),r.jsx("input",{type:"number",min:1,step:.5,value:je,onChange:l=>{const c=Number.parseFloat(l.target.value);if(Number.isNaN(c))return;const N=Math.max(1,c);Ue(N),k({edgeSegmentLength:N})},className:"mt-1 w-full px-2 py-1 text-xs border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-[11px] font-medium text-gray-600",children:"Gap length (px)"}),r.jsx("input",{type:"number",min:.5,step:.5,value:$e,onChange:l=>{const c=Number.parseFloat(l.target.value);if(Number.isNaN(c))return;const N=Math.max(.5,c);sn(N),k({edgeSegmentGap:N})},className:"mt-1 w-full px-2 py-1 text-xs border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-[11px] font-medium text-gray-600",children:"Initial gap (px)"}),r.jsx("input",{type:"number",min:0,step:.5,value:We,onChange:l=>{const c=Number.parseFloat(l.target.value);if(Number.isNaN(c))return;const N=Math.max(0,c);Gn(N),k({edgeSegmentOffset:N})},className:"mt-1 w-full px-2 py-1 text-xs border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]}),T==="segmented"&&r.jsxs("div",{className:"mt-2 space-y-2",children:[r.jsxs("div",{children:[r.jsx("label",{className:"text-[11px] font-medium text-gray-600",htmlFor:"kriskogram-edge-cap",children:"Segment cap style"}),r.jsxs("select",{id:"kriskogram-edge-cap",value:ne,onChange:l=>{const c=l.target.value;he(c),k({edgeSegmentCap:c})},className:"mt-1 w-full px-2 py-1.5 text-xs border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[r.jsx("option",{value:"round",children:"Rounded segment ends"}),r.jsx("option",{value:"butt",children:"Sharp segment ends"})]})]}),r.jsxs("label",{className:"flex items-center justify-between text-[11px] font-medium text-gray-600",children:[r.jsx("span",{children:"Animate flow"}),r.jsx("input",{type:"checkbox",className:"w-3.5 h-3.5",checked:nt,onChange:l=>{const c=l.target.checked;Hn(c),k({edgeSegmentAnimate:c})}})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-[11px] font-medium text-gray-600",children:"Animation speed multiplier"}),r.jsx("input",{type:"number",min:.1,step:.1,value:I,onChange:l=>{const c=Number.parseFloat(l.target.value);if(Number.isNaN(c))return;const N=Math.max(.1,c);O(N),k({edgeSegmentSpeed:N})},className:"mt-1 w-full px-2 py-1 text-xs border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"}),r.jsx("p",{className:"mt-1 text-[10px] text-gray-500",children:"Higher values move dashes faster. 1.0 matches the legacy speed."})]}),r.jsxs("label",{className:"flex items-center justify-between text-[11px] font-medium text-gray-600",children:[r.jsx("span",{children:"Multiply speed by flow weight"}),r.jsx("input",{type:"checkbox",className:"w-3.5 h-3.5",checked:K,onChange:l=>{const c=l.target.checked;ye(c),k({edgeSegmentScaleByWeight:c})}})]})]}),r.jsxs("div",{className:"mt-3 space-y-3",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-[11px] font-medium text-gray-600",children:"Temporal overlay colors"}),r.jsx("p",{className:"mt-1 text-[10px] text-gray-500",children:"Choose the palette for past, midpoint, and future overlay arcs. Switch the input format in Interface Settings."})]}),r.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-3 text-xs",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsx("span",{className:"block text-[11px] font-medium text-gray-600",children:"Past"}),sr==="picker"?r.jsx("input",{type:"color",value:Ye,disabled:!ge,onChange:l=>rr(l.target.value,"#fc8d59",Bn,wn,"temporalOverlayColorPast"),className:`h-8 w-full cursor-pointer ${ge?"":"opacity-60 cursor-not-allowed"}`}):r.jsx("input",{type:"text",value:fs,disabled:!ge,onChange:l=>wn(l.target.value),onBlur:l=>gn(l.target.value,Ye,Bn,wn,"temporalOverlayColorPast"),onKeyDown:l=>{l.key==="Enter"&&gn(fs,Ye,Bn,wn,"temporalOverlayColorPast")},placeholder:"#fc8d59",className:"w-full rounded border border-gray-300 px-2 py-1 text-xs font-mono disabled:bg-gray-100 disabled:text-gray-500"})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("span",{className:"block text-[11px] font-medium text-gray-600",children:"Midpoint"}),sr==="picker"?r.jsx("input",{type:"color",value:Ke,disabled:!ge,onChange:l=>rr(l.target.value,"#ffffbf",Un,_n,"temporalOverlayColorMid"),className:`h-8 w-full cursor-pointer ${ge?"":"opacity-60 cursor-not-allowed"}`}):r.jsx("input",{type:"text",value:ps,disabled:!ge,onChange:l=>_n(l.target.value),onBlur:l=>gn(l.target.value,Ke,Un,_n,"temporalOverlayColorMid"),onKeyDown:l=>{l.key==="Enter"&&gn(ps,Ke,Un,_n,"temporalOverlayColorMid")},placeholder:"#ffffbf",className:"w-full rounded border border-gray-300 px-2 py-1 text-xs font-mono disabled:bg-gray-100 disabled:text-gray-500"})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("span",{className:"block text-[11px] font-medium text-gray-600",children:"Future"}),sr==="picker"?r.jsx("input",{type:"color",value:Xe,disabled:!ge,onChange:l=>rr(l.target.value,"#91bfdb",Wn,Cn,"temporalOverlayColorFuture"),className:`h-8 w-full cursor-pointer ${ge?"":"opacity-60 cursor-not-allowed"}`}):r.jsx("input",{type:"text",value:hs,disabled:!ge,onChange:l=>Cn(l.target.value),onBlur:l=>gn(l.target.value,Xe,Wn,Cn,"temporalOverlayColorFuture"),onKeyDown:l=>{l.key==="Enter"&&gn(hs,Xe,Wn,Cn,"temporalOverlayColorFuture")},placeholder:"#91bfdb",className:"w-full rounded border border-gray-300 px-2 py-1 text-xs font-mono disabled:bg-gray-100 disabled:text-gray-500"})]})]}),r.jsxs("div",{className:"flex items-center justify-between p-2 bg-gray-50 border border-gray-200 rounded",children:[r.jsxs("div",{children:[r.jsx("label",{className:"text-xs font-medium text-gray-700",children:"Current year color"}),r.jsx("p",{className:"text-[11px] text-gray-500",children:"Use the default black or reuse the midpoint color for the current year arcs."})]}),r.jsxs("select",{value:Lt?"default":"midpoint",onChange:l=>{const c=l.target.value!=="midpoint";ms(c),k({temporalOverlayCurrentBlack:c})},disabled:!ge,className:"px-2 py-1 text-xs border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 disabled:bg-gray-100 disabled:text-gray-500",children:[r.jsx("option",{value:"default",children:"Default (black)"}),r.jsx("option",{value:"midpoint",children:"Use midpoint color"})]})]})]}),T==="outline"&&r.jsxs("div",{className:"mt-2 grid grid-cols-1 sm:grid-cols-2 gap-3 text-xs",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-[11px] font-medium text-gray-600",children:"Outline thickness (px)"}),r.jsx("input",{type:"range",min:.5,max:12,step:.5,value:me,onChange:l=>{const c=Number.parseFloat(l.target.value);if(Number.isNaN(c))return;const N=Math.max(.5,c);it(N),k({edgeOutlineGap:N})},className:"mt-1 w-full"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-[11px] font-medium text-gray-600",children:"Precise value"}),r.jsx("input",{type:"number",min:.5,step:.5,value:me,onChange:l=>{const c=Number.parseFloat(l.target.value);if(Number.isNaN(c))return;const N=Math.max(.5,c);it(N),k({edgeOutlineGap:N})},className:"mt-1 w-full px-2 py-1 text-xs border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("label",{className:"text-xs font-medium text-gray-700",children:"Edge Color"}),E&&de&&r.jsx("span",{className:"text-[11px] text-gray-400",children:"(disabled by neighbor step coloring)"})]}),r.jsxs("label",{className:"flex items-center gap-1 text-[11px] text-gray-600 cursor-pointer",children:[r.jsx("input",{type:"checkbox",className:"w-3.5 h-3.5",disabled:!!(E&&de),checked:un,onChange:l=>{const c=l.target.checked;E&&de||(bs(c),k({edgeColorAdvanced:c}),c||(Ht("direction"),Kn(null),Ss(!0),Cr("weight"),Xn(null),Nr(.6),k({edgeColorHue:"direction",edgeColorHueAttribute:null,edgeColorInterGrayscale:!0,edgeColorIntensity:"weight",edgeColorIntensityAttribute:null,edgeColorIntensityConst:.6})))}}),"Advanced"]})]}),!un&&!(E&&de)&&r.jsxs("div",{className:"flex flex-col gap-1.5 text-xs",children:[r.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[r.jsx("input",{type:"radio",name:"edgeColorHueSimple",value:"direction",checked:Ie==="direction",onChange:()=>{Ht("direction"),k({edgeColorHue:"direction"})},className:"w-3.5 h-3.5"}),r.jsx("span",{children:"By Direction (Above/Below)"})]}),r.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[r.jsx("input",{type:"radio",name:"edgeColorHueSimple",value:"single",checked:Ie==="single",onChange:()=>{Ht("single"),k({edgeColorHue:"single"})},className:"w-3.5 h-3.5"}),r.jsx("span",{children:"Single Color"})]})]}),un&&!(E&&de)&&r.jsxs("div",{className:"mt-2 space-y-3 border border-gray-200 rounded-md p-3 bg-gray-50/60",children:[r.jsxs("div",{children:[r.jsx("label",{className:"text-xs font-medium text-gray-700",children:"Hue Source"}),r.jsxs("select",{value:Ie,onChange:l=>{const c=l.target.value;Ht(c),k({edgeColorHue:c}),c!=="attribute"&&(Kn(null),k({edgeColorHueAttribute:null}))},className:"mt-1 w-full px-2 py-1.5 text-xs border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[r.jsx("option",{value:"direction",children:"Direction (Above/Below)"}),r.jsx("option",{value:"single",children:"Single"}),r.jsx("option",{value:"region",disabled:!Nt,children:"Region"}),r.jsx("option",{value:"division",disabled:!jt,children:"Division"}),r.jsx("option",{value:"attribute",children:"Attribute"})]}),Ie==="attribute"&&(i==null?void 0:i.metadata)&&r.jsxs("div",{className:"mt-2",children:[r.jsx("label",{className:"text-xs text-gray-600",children:"Hue Attribute"}),r.jsxs("select",{className:"w-full px-2 py-1.5 text-xs border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",value:Gt||"",onChange:l=>{const c=l.target.value||null;Kn(c),k({edgeColorHueAttribute:c})},children:[r.jsx("option",{value:"",children:"Select attribute…"}),i.metadata.hasCategoricalProperties.edges.concat(i.metadata.hasNumericProperties.edges).map(l=>r.jsx("option",{value:l,children:l},l))]})]})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-gray-700",children:"Intensity Source"}),r.jsxs("select",{value:ht,onChange:l=>{const c=l.target.value;Cr(c),k({edgeColorIntensity:c}),c!=="attribute"&&(Xn(null),k({edgeColorIntensityAttribute:null}))},className:"w-full px-2 py-1.5 text-xs border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[r.jsx("option",{value:"weight",children:"Weight"}),r.jsx("option",{value:"constant",children:"Constant"}),r.jsx("option",{value:"attribute",children:"Attribute"})]}),ht==="constant"&&r.jsxs("div",{className:"mt-2",children:[r.jsxs("label",{className:"text-xs text-gray-600",children:["Constant Intensity: ",(Zn*100).toFixed(0),"%"]}),r.jsx("input",{type:"range",min:0,max:1,step:.01,value:Zn,onChange:l=>{const c=Number.parseFloat(l.target.value);Number.isNaN(c)||(Nr(c),k({edgeColorIntensityConst:c}))},className:"w-full"})]}),ht==="attribute"&&(i==null?void 0:i.metadata)&&r.jsxs("div",{className:"mt-2",children:[r.jsx("label",{className:"text-xs text-gray-600",children:"Intensity Attribute"}),r.jsxs("select",{className:"w-full px-2 py-1.5 text-xs border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",value:dn||"",onChange:l=>{const c=l.target.value||null;Xn(c),k({edgeColorIntensityAttribute:c})},children:[r.jsx("option",{value:"",children:"Select attribute…"}),i.metadata.hasNumericProperties.edges.map(l=>r.jsx("option",{value:l,children:l},l))]})]})]})]})]})]})]}):r.jsx("div",{className:"text-xs text-gray-500 italic",children:"No dataset metadata available"})}),H==="table"&&r.jsx(Zt,{title:"Table Settings",defaultOpen:!1,children:r.jsx("div",{className:"text-xs text-gray-500 italic",children:"Settings to be added"})}),H==="sankey"&&r.jsx(Zt,{title:"Sankey Settings",defaultOpen:!1,children:r.jsx("div",{className:"text-xs text-gray-500 italic",children:"Settings to be added"})}),H==="chord"&&r.jsx(Zt,{title:"Chord Settings",defaultOpen:!1,children:r.jsx("div",{className:"text-xs text-gray-500 italic",children:"Settings to be added"})}),r.jsx(Zt,{title:"Interface Settings",defaultOpen:!1,onReset:()=>{Rs("picker")},children:r.jsx("div",{className:"space-y-4",children:r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-medium text-gray-700",children:"Color input format"}),r.jsxs("select",{value:sr,onChange:l=>{const c=l.target.value==="hex"?"hex":"picker";Rs(c)},className:"mt-1 w-full px-2 py-1.5 text-xs border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[r.jsx("option",{value:"picker",children:"Color picker"}),r.jsx("option",{value:"hex",children:"Hex input"})]}),r.jsx("p",{className:"mt-1 text-[10px] text-gray-500",children:"Choose whether temporal overlay colors are edited with the native color picker or by typing hex codes."})]})})})]})})]})})}async function Xi(){const e="csv-usa-pre-2020",n="csv-usa-post-2020",t="csv-2021",s="gexf-sample",o="swiss-2016";let a=await Dt(e),u=await Dt(n);const i=w=>w?w.snapshots.every(y=>{const S=new Set(y.nodes.map(v=>v.label));if(S.size!==qi)return!1;for(const v of S)if(!Wi.has(v))return!1;return!0}):!1;(a?!i(a):!1)&&(await ts(e).catch(()=>{}),a=void 0),(u?!i(u):!1)&&(await ts(n).catch(()=>{}),u=void 0);let g=!!a,x=!!u;const h=await Dt(t),f=await Dt(s),_=await Dt(o),C=async w=>{const y=[];for(const S of w)try{const v=new URL(Object.assign({"../data/StateToStateMigrationUSCSV/state_to_state_migration_table_2022_t13_updated_2024_06_27_2022.csv":ha,"../data/StateToStateMigrationUSCSV/state_to_state_migration_table_2023_t13_2023.csv":xa,"../data/StateToStateMigrationUSCSV/state_to_state_migrations_table_2005_2005.csv":ya,"../data/StateToStateMigrationUSCSV/state_to_state_migrations_table_2005_2007_2005-2007.csv":va,"../data/StateToStateMigrationUSCSV/state_to_state_migrations_table_2005_2009_2005-2009.csv":ba,"../data/StateToStateMigrationUSCSV/state_to_state_migrations_table_2006_2006.csv":Sa,"../data/StateToStateMigrationUSCSV/state_to_state_migrations_table_2006_2008_2006-2008.csv":wa,"../data/StateToStateMigrationUSCSV/state_to_state_migrations_table_2007_2007.csv":_a,"../data/StateToStateMigrationUSCSV/state_to_state_migrations_table_2007_2009_2007-2009.csv":Ca,"../data/StateToStateMigrationUSCSV/state_to_state_migrations_table_2008_2008.csv":Na,"../data/StateToStateMigrationUSCSV/state_to_state_migrations_table_2009_2009.csv":ja,"../data/StateToStateMigrationUSCSV/state_to_state_migrations_table_2010_2010.csv":Ma,"../data/StateToStateMigrationUSCSV/state_to_state_migrations_table_2011_2011.csv":Fa,"../data/StateToStateMigrationUSCSV/state_to_state_migrations_table_2012_2012.csv":Ra,"../data/StateToStateMigrationUSCSV/state_to_state_migrations_table_2013_2013.csv":$a,"../data/StateToStateMigrationUSCSV/state_to_state_migrations_table_2014_2014.csv":Ea,"../data/StateToStateMigrationUSCSV/state_to_state_migrations_table_2015_2015.csv":Ia,"../data/StateToStateMigrationUSCSV/state_to_state_migrations_table_2016_2016.csv":Aa,"../data/StateToStateMigrationUSCSV/state_to_state_migrations_table_2017_2017.csv":ka,"../data/StateToStateMigrationUSCSV/state_to_state_migrations_table_2018_2018.csv":Pa,"../data/StateToStateMigrationUSCSV/state_to_state_migrations_table_2019_2019.csv":Va,"../data/StateToStateMigrationUSCSV/state_to_state_migrations_table_2021_2021.csv":Da})[`../data/StateToStateMigrationUSCSV/${S.filename}`],import.meta.url),j=await cr(v.toString()),A=Qr(j);y.push({timestamp:S.year,nodes:A.nodes,edges:A.edges})}catch(v){console.warn(`⚠️ Failed to load snapshot for ${S.filename}:`,v)}return y.sort((S,v)=>{const j=typeof S.timestamp=="string"?Number.parseInt(S.timestamp,10):S.timestamp,A=typeof v.timestamp=="string"?Number.parseInt(v.timestamp,10):v.timestamp;return j-A}),y};if(!a){const w=Es.filter(S=>S.year<=2019),y=await C(w);if(y.length>0){const S=y[0],v=y[y.length-1],j=tn(S),A={id:e,name:"US State-to-State Migration (2005-2019)",notes:"Tidy ACS 1-year state-to-state migration flows from 2005 through 2019. The Census Bureau did not release 2020 1-year migration flows, so the series stops before the pandemic.",type:"csv",timeRange:{start:typeof S.timestamp=="string"?Number.parseInt(S.timestamp,10):S.timestamp,end:typeof v.timestamp=="string"?Number.parseInt(v.timestamp,10):v.timestamp},snapshots:y,metadata:j,createdAt:Date.now()};await Vt(A),g=!0}}if(!u){const w=Es.filter(S=>S.year>=2021),y=await C(w);if(y.length>0){const S=y[0],v=y[y.length-1],j=tn(S),A={id:n,name:"US State-to-State Migration (2021-2023)",notes:"Post-2020 ACS 1-year state-to-state migration flows. The 2022 release includes revised Connecticut flows per Census errata guidance.",type:"csv",timeRange:{start:typeof S.timestamp=="string"?Number.parseInt(S.timestamp,10):S.timestamp,end:typeof v.timestamp=="string"?Number.parseInt(v.timestamp,10):v.timestamp},snapshots:y,metadata:j,createdAt:Date.now()};await Vt(A),x=!0}}if(!h){const w=new URL("/INF358_Project_Kriskogram/assets/State_to_State_Migrations_Table_2021-N7RTh5uH.csv",import.meta.url),y=await cr(w.toString()),S=Qr(y),v={timestamp:2021,nodes:S.nodes,edges:S.edges},j=tn(v),A={id:t,name:"US State-to-State Migration (2021)",notes:"Real U.S. Census Bureau data showing migration flows between all 50 states from the American Community Survey 1-Year Estimates.",type:"csv",timeRange:{start:2021,end:2021},snapshots:[v],metadata:j,createdAt:Date.now()};await Vt(A)}if(!f){const w=new URL("/INF358_Project_Kriskogram/assets/sample-migration-data-Dify6Mt1.gexf",import.meta.url),y=await Do(w.toString()),S=eo(y),v=S.length>0?tn(S[0]):void 0,j={id:s,name:"Sample Migration (GEXF)",notes:"AI-generated sample network dataset in GEXF format demonstrating temporal migration patterns with multiple time slices. This example dataset includes economic, geographic, and migration type attributes for demonstration purposes.",type:"gexf",timeRange:y.timeRange,snapshots:S,metadata:v,createdAt:Date.now()};await Vt(j)}if(!_){const w="/INF358_Project_Kriskogram/",y=`${w}data/Swiss_Relocations_2016_locations.csv`,S=`${w}data/Swiss_Relocations_2016_flows.csv`,v=await cr(y),j=await cr(S),A=so({nodesFile:{content:v,idField:"id",labelField:"name"},edgesFile:{content:j,sourceField:"origin",targetField:"dest",valueField:"count"}}),F={timestamp:2016,nodes:A.nodes,edges:A.edges},B=tn(F),V={id:o,name:"Swiss Relocations (2016)",notes:"Relocations between Swiss cantons in 2016. This dataset contains 521,510 trips and uses a two-file CSV format with separate files for locations (cantons) and flows (relocations). Created by Ilya Boyandin.",type:"csv-two-file",timeRange:{start:2016,end:2016},snapshots:[F],metadata:B,createdAt:Date.now()};await Vt(V)}if(g)return e;if(x)return n;if(h)return t}function xr(e,n){if(typeof e=="string"){const t=e.trim().toLowerCase();if(/^#([0-9a-f]{3}|[0-9a-f]{6})$/.test(t))return t.length===4?`#${t[1]}${t[1]}${t[2]}${t[2]}${t[3]}${t[3]}`:t}return n}export{rl as component};
