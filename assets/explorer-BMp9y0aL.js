import{c as Tn,r as y,j as o,s as $e,o as Ss,a as Mt,z as qs,i as Ws,C as Ks,G as Ys,u as Xs,b as Zs,d as Qs,K as Js,e as _s,f as eo,p as Nt,g as pn,n as Fn,h as to}from"./main-9pUCAMbJ.js";import{p as $n,l as Qt}from"./csv-parser-BH7H656y.js";import{p as no,g as Cs,l as so}from"./gexf-parser-ChiJebeW.js";import{S as oo,a as es}from"./stateMigrationFiles-CyfipyKt.js";/**
 * @license lucide-react v0.476.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ro=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],io=Tn("ChevronDown",ro);/**
 * @license lucide-react v0.476.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ao=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],lo=Tn("ChevronUp",ao);/**
 * @license lucide-react v0.476.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uo=[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],ts=Tn("Settings",uo);function co(e,s){return e==null||s==null?NaN:s<e?-1:s>e?1:s>=e?0:NaN}var ns=Math.abs,hn=Math.cos,xn=Math.sin,js=Math.PI,Jt=js/2,ss=js*2,os=Math.max,vn=1e-12;function rs(e,s){return Array.from({length:s-e},(t,n)=>e+n)}function go(e){return function(s,t){return e(s.source.value+s.target.value,t.source.value+t.target.value)}}function fo(){return mo(!1)}function mo(e,s){var t=0,n=null,r=null,i=null;function l(a){var u=a.length,d=new Array(u),c=rs(0,u),p=new Array(u*u),m=new Array(u),f=0,w;a=Float64Array.from({length:u*u},(S,b)=>a[b/u|0][b%u]);for(let S=0;S<u;++S){let b=0;for(let h=0;h<u;++h)b+=a[S*u+h]+e*a[h*u+S];f+=d[S]=b}f=os(0,ss-t*u)/f,w=f?t:ss/u;{let S=0;n&&c.sort((b,h)=>n(d[b],d[h]));for(const b of c){const h=S;{const v=rs(0,u).filter(x=>a[b*u+x]||a[x*u+b]);r&&v.sort((x,_)=>r(a[b*u+x],a[b*u+_]));for(const x of v){let _;if(b<x?(_=p[b*u+x]||(p[b*u+x]={source:null,target:null}),_.source={index:b,startAngle:S,endAngle:S+=a[b*u+x]*f,value:a[b*u+x]}):(_=p[x*u+b]||(p[x*u+b]={source:null,target:null}),_.target={index:b,startAngle:S,endAngle:S+=a[b*u+x]*f,value:a[b*u+x]},b===x&&(_.source=_.target)),_.source&&_.target&&_.source.value<_.target.value){const M=_.source;_.source=_.target,_.target=M}}m[b]={index:b,startAngle:h,endAngle:S,value:d[b]}}S+=w}}return p=Object.values(p),p.groups=m,i?p.sort(i):p}return l.padAngle=function(a){return arguments.length?(t=os(0,a),l):t},l.sortGroups=function(a){return arguments.length?(n=a,l):n},l.sortSubgroups=function(a){return arguments.length?(r=a,l):r},l.sortChords=function(a){return arguments.length?(a==null?i=null:(i=go(a))._=a,l):i&&i._},l}const In=Math.PI,En=2*In,jt=1e-6,po=En-jt;function Ns(e){this._+=e[0];for(let s=1,t=e.length;s<t;++s)this._+=arguments[s]+e[s]}function ho(e){let s=Math.floor(e);if(!(s>=0))throw new Error(`invalid digits: ${e}`);if(s>15)return Ns;const t=10**s;return function(n){this._+=n[0];for(let r=1,i=n.length;r<i;++r)this._+=Math.round(arguments[r]*t)/t+n[r]}}class zn{constructor(s){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=s==null?Ns:ho(s)}moveTo(s,t){this._append`M${this._x0=this._x1=+s},${this._y0=this._y1=+t}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(s,t){this._append`L${this._x1=+s},${this._y1=+t}`}quadraticCurveTo(s,t,n,r){this._append`Q${+s},${+t},${this._x1=+n},${this._y1=+r}`}bezierCurveTo(s,t,n,r,i,l){this._append`C${+s},${+t},${+n},${+r},${this._x1=+i},${this._y1=+l}`}arcTo(s,t,n,r,i){if(s=+s,t=+t,n=+n,r=+r,i=+i,i<0)throw new Error(`negative radius: ${i}`);let l=this._x1,a=this._y1,u=n-s,d=r-t,c=l-s,p=a-t,m=c*c+p*p;if(this._x1===null)this._append`M${this._x1=s},${this._y1=t}`;else if(m>jt)if(!(Math.abs(p*u-d*c)>jt)||!i)this._append`L${this._x1=s},${this._y1=t}`;else{let f=n-l,w=r-a,S=u*u+d*d,b=f*f+w*w,h=Math.sqrt(S),v=Math.sqrt(m),x=i*Math.tan((In-Math.acos((S+m-b)/(2*h*v)))/2),_=x/v,M=x/h;Math.abs(_-1)>jt&&this._append`L${s+_*c},${t+_*p}`,this._append`A${i},${i},0,0,${+(p*f>c*w)},${this._x1=s+M*u},${this._y1=t+M*d}`}}arc(s,t,n,r,i,l){if(s=+s,t=+t,n=+n,l=!!l,n<0)throw new Error(`negative radius: ${n}`);let a=n*Math.cos(r),u=n*Math.sin(r),d=s+a,c=t+u,p=1^l,m=l?r-i:i-r;this._x1===null?this._append`M${d},${c}`:(Math.abs(this._x1-d)>jt||Math.abs(this._y1-c)>jt)&&this._append`L${d},${c}`,n&&(m<0&&(m=m%En+En),m>po?this._append`A${n},${n},0,1,${p},${s-a},${t-u}A${n},${n},0,1,${p},${this._x1=d},${this._y1=c}`:m>jt&&this._append`A${n},${n},0,${+(m>=In)},${p},${this._x1=s+n*Math.cos(i)},${this._y1=t+n*Math.sin(i)}`)}rect(s,t,n,r){this._append`M${this._x0=this._x1=+s},${this._y0=this._y1=+t}h${n=+n}v${+r}h${-n}Z`}toString(){return this._}}function Hn(){return new zn}Hn.prototype=zn.prototype;var xo=Array.prototype.slice;function kt(e){return function(){return e}}function vo(e){return e.source}function yo(e){return e.target}function is(e){return e.radius}function bo(e){return e.startAngle}function wo(e){return e.endAngle}function So(){return 0}function _o(e){var s=vo,t=yo,n=is,r=is,i=bo,l=wo,a=So,u=null;function d(){var c,p=s.apply(this,arguments),m=t.apply(this,arguments),f=a.apply(this,arguments)/2,w=xo.call(arguments),S=+n.apply(this,(w[0]=p,w)),b=i.apply(this,w)-Jt,h=l.apply(this,w)-Jt,v=+r.apply(this,(w[0]=m,w)),x=i.apply(this,w)-Jt,_=l.apply(this,w)-Jt;if(u||(u=c=Hn()),f>vn&&(ns(h-b)>f*2+vn?h>b?(b+=f,h-=f):(b-=f,h+=f):b=h=(b+h)/2,ns(_-x)>f*2+vn?_>x?(x+=f,_-=f):(x-=f,_+=f):x=_=(x+_)/2),u.moveTo(S*hn(b),S*xn(b)),u.arc(0,0,S,b,h),(b!==x||h!==_)&&(u.quadraticCurveTo(0,0,v*hn(x),v*xn(x)),u.arc(0,0,v,x,_)),u.quadraticCurveTo(0,0,S*hn(b),S*xn(b)),u.closePath(),c)return u=null,c+""||null}return d.radius=function(c){return arguments.length?(n=r=typeof c=="function"?c:kt(+c),d):n},d.sourceRadius=function(c){return arguments.length?(n=typeof c=="function"?c:kt(+c),d):n},d.targetRadius=function(c){return arguments.length?(r=typeof c=="function"?c:kt(+c),d):r},d.startAngle=function(c){return arguments.length?(i=typeof c=="function"?c:kt(+c),d):i},d.endAngle=function(c){return arguments.length?(l=typeof c=="function"?c:kt(+c),d):l},d.padAngle=function(c){return arguments.length?(a=typeof c=="function"?c:kt(+c),d):a},d.source=function(c){return arguments.length?(s=c,d):s},d.target=function(c){return arguments.length?(t=c,d):t},d.context=function(c){return arguments.length?(u=c??null,d):u},d}function Co(){return _o()}function jo(e){for(var s=e.length/6|0,t=new Array(s),n=0;n<s;)t[n]="#"+e.slice(n*6,++n*6);return t}const Rs=jo("1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf");function gt(e){return function(){return e}}const as=Math.abs,Le=Math.atan2,Ct=Math.cos,No=Math.max,yn=Math.min,rt=Math.sin,Lt=Math.sqrt,qe=1e-12,Ut=Math.PI,rn=Ut/2,Ro=2*Ut;function Mo(e){return e>1?0:e<-1?Ut:Math.acos(e)}function ls(e){return e>=1?rn:e<=-1?-rn:Math.asin(e)}function Fo(e){let s=3;return e.digits=function(t){if(!arguments.length)return s;if(t==null)s=null;else{const n=Math.floor(t);if(!(n>=0))throw new RangeError(`invalid digits: ${t}`);s=n}return e},()=>new zn(s)}function $o(e){return e.innerRadius}function Io(e){return e.outerRadius}function Eo(e){return e.startAngle}function Po(e){return e.endAngle}function Ao(e){return e&&e.padAngle}function Vo(e,s,t,n,r,i,l,a){var u=t-e,d=n-s,c=l-r,p=a-i,m=p*u-c*d;if(!(m*m<qe))return m=(c*(s-i)-p*(e-r))/m,[e+m*u,s+m*d]}function en(e,s,t,n,r,i,l){var a=e-t,u=s-n,d=(l?i:-i)/Lt(a*a+u*u),c=d*u,p=-d*a,m=e+c,f=s+p,w=t+c,S=n+p,b=(m+w)/2,h=(f+S)/2,v=w-m,x=S-f,_=v*v+x*x,M=r-i,C=m*S-w*f,k=(x<0?-1:1)*Lt(No(0,M*M*_-C*C)),I=(C*x-v*k)/_,P=(-C*v-x*k)/_,Y=(C*x+v*k)/_,D=(-C*v+x*k)/_,Q=I-b,F=P-h,G=Y-b,X=D-h;return Q*Q+F*F>G*G+X*X&&(I=Y,P=D),{cx:I,cy:P,x01:-c,y01:-p,x11:I*(r/M-1),y11:P*(r/M-1)}}function ko(){var e=$o,s=Io,t=gt(0),n=null,r=Eo,i=Po,l=Ao,a=null,u=Fo(d);function d(){var c,p,m=+e.apply(this,arguments),f=+s.apply(this,arguments),w=r.apply(this,arguments)-rn,S=i.apply(this,arguments)-rn,b=as(S-w),h=S>w;if(a||(a=c=u()),f<m&&(p=f,f=m,m=p),!(f>qe))a.moveTo(0,0);else if(b>Ro-qe)a.moveTo(f*Ct(w),f*rt(w)),a.arc(0,0,f,w,S,!h),m>qe&&(a.moveTo(m*Ct(S),m*rt(S)),a.arc(0,0,m,S,w,h));else{var v=w,x=S,_=w,M=S,C=b,k=b,I=l.apply(this,arguments)/2,P=I>qe&&(n?+n.apply(this,arguments):Lt(m*m+f*f)),Y=yn(as(f-m)/2,+t.apply(this,arguments)),D=Y,Q=Y,F,G;if(P>qe){var X=ls(P/m*rt(I)),ce=ls(P/f*rt(I));(C-=X*2)>qe?(X*=h?1:-1,_+=X,M-=X):(C=0,_=M=(w+S)/2),(k-=ce*2)>qe?(ce*=h?1:-1,v+=ce,x-=ce):(k=0,v=x=(w+S)/2)}var ue=f*Ct(v),xe=f*rt(v),_e=m*Ct(M),j=m*rt(M);if(Y>qe){var L=f*Ct(x),me=f*rt(x),Ve=m*Ct(_),ze=m*rt(_),U;if(b<Ut)if(U=Vo(ue,xe,Ve,ze,L,me,_e,j)){var be=ue-U[0],Z=xe-U[1],Ee=L-U[0],ke=me-U[1],He=1/rt(Mo((be*Ee+Z*ke)/(Lt(be*be+Z*Z)*Lt(Ee*Ee+ke*ke)))/2),Oe=Lt(U[0]*U[0]+U[1]*U[1]);D=yn(Y,(m-Oe)/(He-1)),Q=yn(Y,(f-Oe)/(He+1))}else D=Q=0}k>qe?Q>qe?(F=en(Ve,ze,ue,xe,f,Q,h),G=en(L,me,_e,j,f,Q,h),a.moveTo(F.cx+F.x01,F.cy+F.y01),Q<Y?a.arc(F.cx,F.cy,Q,Le(F.y01,F.x01),Le(G.y01,G.x01),!h):(a.arc(F.cx,F.cy,Q,Le(F.y01,F.x01),Le(F.y11,F.x11),!h),a.arc(0,0,f,Le(F.cy+F.y11,F.cx+F.x11),Le(G.cy+G.y11,G.cx+G.x11),!h),a.arc(G.cx,G.cy,Q,Le(G.y11,G.x11),Le(G.y01,G.x01),!h))):(a.moveTo(ue,xe),a.arc(0,0,f,v,x,!h)):a.moveTo(ue,xe),!(m>qe)||!(C>qe)?a.lineTo(_e,j):D>qe?(F=en(_e,j,L,me,m,-D,h),G=en(ue,xe,Ve,ze,m,-D,h),a.lineTo(F.cx+F.x01,F.cy+F.y01),D<Y?a.arc(F.cx,F.cy,D,Le(F.y01,F.x01),Le(G.y01,G.x01),!h):(a.arc(F.cx,F.cy,D,Le(F.y01,F.x01),Le(F.y11,F.x11),!h),a.arc(0,0,m,Le(F.cy+F.y11,F.cx+F.x11),Le(G.cy+G.y11,G.cx+G.x11),h),a.arc(G.cx,G.cy,D,Le(G.y11,G.x11),Le(G.y01,G.x01),!h))):a.arc(0,0,m,M,_,h)}if(a.closePath(),c)return a=null,c+""||null}return d.centroid=function(){var c=(+e.apply(this,arguments)+ +s.apply(this,arguments))/2,p=(+r.apply(this,arguments)+ +i.apply(this,arguments))/2-Ut/2;return[Ct(p)*c,rt(p)*c]},d.innerRadius=function(c){return arguments.length?(e=typeof c=="function"?c:gt(+c),d):e},d.outerRadius=function(c){return arguments.length?(s=typeof c=="function"?c:gt(+c),d):s},d.cornerRadius=function(c){return arguments.length?(t=typeof c=="function"?c:gt(+c),d):t},d.padRadius=function(c){return arguments.length?(n=c==null?null:typeof c=="function"?c:gt(+c),d):n},d.startAngle=function(c){return arguments.length?(r=typeof c=="function"?c:gt(+c),d):r},d.endAngle=function(c){return arguments.length?(i=typeof c=="function"?c:gt(+c),d):i},d.padAngle=function(c){return arguments.length?(l=typeof c=="function"?c:gt(+c),d):l},d.context=function(c){return arguments.length?(a=c??null,d):a},d}const Do="/INF358_Project_Kriskogram/assets/state_to_state_migration_table_2022_t13_updated_2024_06_27_2022-D7hzY5-5.csv",Lo="/INF358_Project_Kriskogram/assets/state_to_state_migration_table_2023_t13_2023-Da-tSzHC.csv",To="/INF358_Project_Kriskogram/assets/state_to_state_migrations_table_2005_2005-5D0dAV6T.csv",zo="/INF358_Project_Kriskogram/assets/state_to_state_migrations_table_2005_2007_2005-2007-C2gBOjzD.csv",Ho="/INF358_Project_Kriskogram/assets/state_to_state_migrations_table_2005_2009_2005-2009-oSLcshdC.csv",Oo="/INF358_Project_Kriskogram/assets/state_to_state_migrations_table_2006_2006-C-EFanec.csv",Go="/INF358_Project_Kriskogram/assets/state_to_state_migrations_table_2006_2008_2006-2008-Cp1NRBpc.csv",Uo="/INF358_Project_Kriskogram/assets/state_to_state_migrations_table_2007_2007-BXoQRRMn.csv",Bo="/INF358_Project_Kriskogram/assets/state_to_state_migrations_table_2007_2009_2007-2009-Qdd3KwND.csv",qo="/INF358_Project_Kriskogram/assets/state_to_state_migrations_table_2008_2008--00JWAqc.csv",Wo="/INF358_Project_Kriskogram/assets/state_to_state_migrations_table_2009_2009-5yGj8NCd.csv",Ko="/INF358_Project_Kriskogram/assets/state_to_state_migrations_table_2010_2010-CSB90FrU.csv",Yo="/INF358_Project_Kriskogram/assets/state_to_state_migrations_table_2011_2011-BzRnLs5h.csv",Xo="/INF358_Project_Kriskogram/assets/state_to_state_migrations_table_2012_2012-DrbWwk1R.csv",Zo="/INF358_Project_Kriskogram/assets/state_to_state_migrations_table_2013_2013-CTsYcw-F.csv",Qo="/INF358_Project_Kriskogram/assets/state_to_state_migrations_table_2014_2014-D8ze7hKk.csv",Jo="/INF358_Project_Kriskogram/assets/state_to_state_migrations_table_2015_2015-Sg6Ir2qO.csv",er="/INF358_Project_Kriskogram/assets/state_to_state_migrations_table_2016_2016-C26kP0Bk.csv",tr="/INF358_Project_Kriskogram/assets/state_to_state_migrations_table_2017_2017-BNMbL_en.csv",nr="/INF358_Project_Kriskogram/assets/state_to_state_migrations_table_2018_2018-DTnLPVgj.csv",sr="/INF358_Project_Kriskogram/assets/state_to_state_migrations_table_2019_2019-Bd1nphS1.csv",or="/INF358_Project_Kriskogram/assets/State_to_State_Migrations_Table_2021-N7RTh5uH.csv";function Rt(e){const s=new Set,t=new Set,n=new Set,r=new Set,i=new Set,l=new Set;return e.nodes.forEach(a=>{Object.keys(a).forEach(u=>{if(u!=="id"&&u!=="label"){s.add(u);const d=a[u];typeof d=="number"?n.add(u):typeof d=="string"&&i.add(u)}})}),e.edges.forEach(a=>{Object.keys(a).forEach(u=>{if(u!=="source"&&u!=="target"&&u!=="value"){t.add(u);const d=a[u];typeof d=="number"?r.add(u):typeof d=="string"&&l.add(u)}})}),{nodeProperties:Array.from(s),edgeProperties:Array.from(t),hasNumericProperties:{nodes:Array.from(n),edges:Array.from(r)},hasCategoricalProperties:{nodes:Array.from(i),edges:Array.from(l)}}}const rr="kriskogram-db",ir=1,Qe="datasets";function Bt(){return new Promise((e,s)=>{const t=indexedDB.open(rr,ir);t.onupgradeneeded=()=>{const n=t.result;n.objectStoreNames.contains(Qe)||n.createObjectStore(Qe,{keyPath:"id"})},t.onsuccess=()=>e(t.result),t.onerror=()=>s(t.error)})}async function mt(e){const s=await Bt();return new Promise((t,n)=>{const r=s.transaction(Qe,"readwrite");r.objectStore(Qe).put(e),r.oncomplete=()=>t(),r.onerror=()=>n(r.error),r.onabort=()=>n(r.error)})}async function pt(e){const s=await Bt();return new Promise((t,n)=>{const l=s.transaction(Qe,"readonly").objectStore(Qe).get(e);l.onsuccess=()=>t(l.result),l.onerror=()=>n(l.error)})}async function ar(){const e=await Bt();return new Promise((s,t)=>{const i=e.transaction(Qe,"readonly").objectStore(Qe).getAll();i.onsuccess=()=>s(i.result||[]),i.onerror=()=>t(i.error)})}async function Pn(e){const s=await Bt();return new Promise((t,n)=>{const r=s.transaction(Qe,"readwrite");r.objectStore(Qe).delete(e),r.oncomplete=()=>t(),r.onerror=()=>n(r.error)})}async function lr(e){const s=await pt(e);if(!s)throw new Error(`Dataset ${e} not found`);const t={...s,id:`${s.type}-${Date.now()}`,name:`${s.name} (Copy)`,createdAt:Date.now()};return await mt(t),t}async function ur(){const e=await Bt();return new Promise((s,t)=>{const n=e.transaction(Qe,"readwrite");n.objectStore(Qe).clear(),n.oncomplete=()=>s(),n.onerror=()=>t(n.error)})}async function cr(){if("storage"in navigator&&"persist"in navigator.storage)try{return await navigator.storage.persist()}catch{return!1}return!1}function us(e){const s=[];let t="",n=!1;for(let r=0;r<e.length;r++){const i=e[r];i==='"'?n=!n:i===","&&!n?(s.push(t),t=""):t+=i}return s.push(t),s}function cs(e){const s=e.trim().split(`
`).filter(r=>r.trim());if(s.length===0)throw new Error("CSV file is empty");const t=us(s[0]).map(r=>r.trim()),n=s.slice(1).map(us);return{headers:t,rows:n}}function bn(e){const s=e.replace(/[",]/g,"").trim(),t=Number.parseFloat(s);return Number.isNaN(t)?s:t}function Ms(e){var M;const{headers:s,rows:t}=cs(e.nodesFile.content),n=s.map(C=>C.toLowerCase().trim()),r=e.nodesFile.idField.toLowerCase().trim(),i=((M=e.nodesFile.labelField)==null?void 0:M.toLowerCase().trim())||r,l=n.indexOf(r),a=e.nodesFile.labelField?n.indexOf(i):l;if(l===-1)throw new Error(`ID field "${e.nodesFile.idField}" not found in nodes file. Available fields: ${s.join(", ")}`);const u=t.map(C=>{const k={id:String(C[l]||"").trim(),label:a>=0?String(C[a]||"").trim():String(C[l]||"").trim()},I=s[l],P=e.nodesFile.labelField?s[a]:I;return s.forEach((Y,D)=>{var Q;if(Y!==I&&Y!==P){const F=((Q=C[D])==null?void 0:Q.trim())||"";k[Y]=bn(F)}}),k}).filter(C=>C.id),d=new Map(u.map(C=>[C.id,C])),{headers:c,rows:p}=cs(e.edgesFile.content),m=c.map(C=>C.toLowerCase().trim()),f=e.edgesFile.sourceField.toLowerCase().trim(),w=e.edgesFile.targetField.toLowerCase().trim(),S=e.edgesFile.valueField.toLowerCase().trim(),b=m.indexOf(f),h=m.indexOf(w),v=m.indexOf(S);if(b===-1)throw new Error(`Source field "${e.edgesFile.sourceField}" not found in edges file. Available fields: ${c.join(", ")}`);if(h===-1)throw new Error(`Target field "${e.edgesFile.targetField}" not found in edges file. Available fields: ${c.join(", ")}`);if(v===-1)throw new Error(`Value field "${e.edgesFile.valueField}" not found in edges file. Available fields: ${c.join(", ")}`);const x=p.map(C=>{const k=String(C[b]||"").trim(),I=String(C[h]||"").trim(),P=String(C[v]||"").trim(),Y=bn(P);if(!k||!I||typeof Y!="number"||Y<=0)return null;(!d.has(k)||!d.has(I))&&console.warn(`Edge references missing node: ${k} -> ${I}`);const D={source:k,target:I,value:Y},Q=c[b],F=c[h],G=c[v];return c.forEach((X,ce)=>{var ue;if(X!==Q&&X!==F&&X!==G){const xe=((ue=C[ce])==null?void 0:ue.trim())||"";D[X]=bn(xe)}}),D}).filter(C=>C!==null&&d.has(C.source)&&d.has(C.target)),_=new Set;return x.forEach(C=>{_.add(C.source),_.add(C.target)}),_.forEach(C=>{d.has(C)||u.push({id:C,label:C})}),{nodes:u,edges:x}}function dr({onClose:e,onImport:s,fileInputRef:t,onFilesSelected:n,existingFile:r}){const[i,l]=y.useState(""),[a,u]=y.useState(""),[d,c]=y.useState(!1),[p,m]=y.useState({}),[f,w]=y.useState(!1),[S,b]=y.useState(null),[h,v]=y.useState([]),[x,_]=y.useState([]),[M,C]=y.useState(null),k=y.useRef(null),I=y.useRef(null),[P,Y]=y.useState(null),[D,Q]=y.useState(null),[F,G]=y.useState([]),[X,ce]=y.useState([]),[ue,xe]=y.useState(""),[_e,j]=y.useState(""),[L,me]=y.useState(""),[Ve,ze]=y.useState(""),[U,be]=y.useState(""),[Z,Ee]=y.useState(null);function ke(N){let $=N.replace(/\.(csv|gexf)$/i,"");return $=$.replace(/([a-z])([A-Z])/g,"$1 $2").replace(/[_-]/g," ").replace(/[^a-zA-Z0-9\s]/g," ").replace(/\s+/g," ").trim(),$.split(" ").map(z=>z.charAt(0).toUpperCase()+z.slice(1).toLowerCase()).join(" ")}y.useEffect(()=>{var N;if(r!=null&&r.parsedData){Ee(r.parsedData);const $=((N=r.files[0])==null?void 0:N.name)||"";l(ke($)),u(r.files.map(z=>z.name).join(", "))}},[r]),y.useEffect(()=>{var N;if(!r&&h.length>0){if(!i||i===ke(((N=h[0])==null?void 0:N.name)||"")){const $=h[0].name;l(ke($))}a||u(h.map($=>$.name).join(", "))}},[h]);function He(N){const $=[];let z="",ee=!1;for(let K=0;K<N.length;K++){const se=N[K];se==='"'?ee=!ee:se===","&&!ee?($.push(z),z=""):z+=se}return $.push(z),$}function Oe(N){const $=N.trim().split(`
`);if($.length===0)return[];const z=$[0];return He(z).map(ee=>ee.trim().replace(/^"|"$/g,""))}async function st(N){const $=Array.from(N.target.files||[]);if($.length===0)return;v($);const z=await Promise.all($.map(K=>K.text()));_(z);const ee=$[0].name.toLowerCase();if(ee.endsWith(".gexf")){C("gexf"),b("single");try{const K=no(z[0]),se=Cs(K);Ee({nodes:se.length>0?se[0].nodes:[],edges:se.length>0?se[0].edges:[],timeRange:K.timeRange}),l($[0].name.replace(".gexf",""))}catch(K){m({general:K instanceof Error?K.message:"Failed to parse GEXF"})}}else if(ee.endsWith(".csv")){if(C("csv"),$.length===1){b("single");try{const K=$n(z[0]);Ee({nodes:K.nodes,edges:K.edges,timeRange:{start:2021,end:2021}}),l($[0].name.replace(".csv",""))}catch{b("two-file");const se=Oe(z[0]);G(se),ce(se),Y(0);const de=se.find(Re=>Re.toLowerCase()==="id"||Re.toLowerCase()==="node"||Re.toLowerCase()==="name"),Je=se.find(Re=>Re.toLowerCase()==="source"||Re.toLowerCase()==="origin"||Re.toLowerCase()==="from"),it=se.find(Re=>Re.toLowerCase()==="target"||Re.toLowerCase()==="dest"||Re.toLowerCase()==="destination"||Re.toLowerCase()==="to"),ot=se.find(Re=>Re.toLowerCase()==="value"||Re.toLowerCase()==="count"||Re.toLowerCase()==="weight");de&&xe(de),Je&&me(Je),it&&ze(it),ot&&be(ot),m({general:"Could not parse as state migration format. Please select which file contains nodes and which contains edges."})}}else if($.length===2){b("two-file");const K=Oe(z[0]),se=Oe(z[1]);G(K),ce(se),Y(0),Q(1);const de=K.find(we=>we.toLowerCase()==="id"),Je=K.find(we=>we.toLowerCase()==="name"||we.toLowerCase()==="label");de&&xe(de),Je&&j(Je);const it=se.find(we=>we.toLowerCase()==="source"||we.toLowerCase()==="origin"||we.toLowerCase()==="from"),ot=se.find(we=>we.toLowerCase()==="target"||we.toLowerCase()==="dest"||we.toLowerCase()==="destination"||we.toLowerCase()==="to"),Re=se.find(we=>we.toLowerCase()==="value"||we.toLowerCase()==="count"||we.toLowerCase()==="weight");it&&me(it),ot&&ze(ot),Re&&be(Re),Ft()}}t.current&&(t.current.value="")}function Ft(){if(P===null||D===null||!ue||!L||!Ve||!U){m({general:"Please select all required fields"}),Ee(null);return}try{const N=Ms({nodesFile:{content:x[P],idField:ue,labelField:_e||ue},edgesFile:{content:x[D],sourceField:L,targetField:Ve,valueField:U}});Ee({nodes:N.nodes,edges:N.edges,timeRange:{start:2016,end:2016}}),m({})}catch(N){m({general:N instanceof Error?N.message:"Failed to parse two-file CSV"}),Ee(null)}}y.useEffect(()=>{S==="two-file"&&P!==null&&D!==null&&Ft()},[ue,_e,L,Ve,U,P,D]);function vt(){const N={},$=[];if(i.trim()||(N.name="Dataset name is required"),S==="two-file"&&(P===null&&(N.nodesFile="Please select which file contains nodes"),D===null&&(N.edgesFile="Please select which file contains edges"),P!==null&&!ue&&(N.nodeIdField="Please select the ID field for nodes"),D!==null&&!L&&(N.edgeSourceField="Please select the source field for edges"),D!==null&&!Ve&&(N.edgeTargetField="Please select the target field for edges"),D!==null&&!U&&(N.edgeValueField="Please select the value field for edges")),!Z)return N.general="Data parsing failed - please check file format and field selections",N;Z.nodes.length===0&&$.push("No nodes found in dataset"),Z.edges.length===0&&$.push("No edges found in dataset");const z=new Set(Z.nodes.map(K=>K.id));z.size!==Z.nodes.length&&$.push(`${Z.nodes.length-z.size} duplicate node IDs found`);const ee=Z.edges.filter(K=>!z.has(K.source)||!z.has(K.target));return ee.length>0&&$.push(`${ee.length} edges reference non-existent nodes`),$.length>0&&(N.summary=$.join("; ")),N}function Tt(){p.name&&k.current?(k.current.scrollIntoView({behavior:"smooth",block:"center"}),k.current.focus()):p.summary&&I.current&&I.current.scrollIntoView({behavior:"smooth",block:"center"})}async function ge(){const N=vt();if(m(N),Object.keys(N).filter(z=>z!=="summary").length>0||!Z){setTimeout(()=>Tt(),100);return}c(!0);try{const z=Z.timeRange||{start:2021,end:2021},ee={timestamp:z.start,nodes:Z.nodes,edges:Z.edges},K=Rt(ee),se=[ee],de={name:i.trim(),filename:h.map(Je=>Je.name).join(", "),notes:a.trim()||void 0,type:S==="two-file"?"csv":M||"csv",timeRange:z,snapshots:se,metadata:K};await s(de,{nodes:Z.nodes,edges:Z.edges,snapshots:se,metadata:K})}catch(z){console.error("Import error:",z),m({general:z instanceof Error?z.message:"Failed to import dataset"}),c(!1),setTimeout(()=>Tt(),100)}}return o.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:o.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-4xl w-full mx-4 max-h-[90vh] flex flex-col",children:[o.jsxs("div",{className:"p-6 border-b flex items-center justify-between",children:[o.jsx("h2",{className:"text-2xl font-bold",children:"Import Dataset"}),o.jsx("button",{onClick:e,className:"text-gray-400 hover:text-gray-600 text-2xl",children:"×"})]}),o.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:o.jsxs("div",{className:"space-y-6",children:[!S&&o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Select Files ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsxs("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-6 text-center",children:[o.jsx("button",{onClick:()=>{var N;return(N=t.current)==null?void 0:N.click()},className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700",children:"Choose Files"}),o.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"Select 1 file (GEXF or CSV) or 2 files (CSV nodes + CSV edges)"}),o.jsx("input",{ref:t,type:"file",accept:".csv,.gexf",multiple:!0,onChange:st,className:"hidden"})]})]}),h.length>0&&o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Selected Files"}),o.jsxs("div",{className:"space-y-2",children:[h.map((N,$)=>o.jsxs("div",{className:"flex items-center justify-between bg-gray-50 p-3 rounded",children:[o.jsx("span",{className:"text-sm",children:N.name}),o.jsx("button",{onClick:()=>{const z=[...h];z.splice($,1),v(z);const ee=[...x];ee.splice($,1),_(ee),S==="two-file"&&(P===$&&Y(null),D===$&&Q(null),P&&P>$&&Y(P-1),D&&D>$&&Q(D-1))},className:"text-red-600 text-sm hover:text-red-800",children:"Remove"})]},$)),o.jsx("button",{type:"button",onClick:()=>{const N=document.createElement("input");N.type="file",N.accept=".csv,.gexf",N.multiple=!0,N.onchange=async $=>{const z=$.target,ee=Array.from(z.files||[]);if(ee.length>0){const K=await Promise.all(ee.map(de=>de.text()));v([...h,...ee]),_([...x,...K]);const se=[...h,...ee];se.length===2&&se.every(de=>de.name.toLowerCase().endsWith(".csv"))&&(b("two-file"),C("csv"))}},N.click()},className:"text-sm text-blue-600 hover:text-blue-800",children:"+ Add More Files"})]})]}),S==="two-file"&&h.length>0&&o.jsxs("div",{className:"border-t pt-4 space-y-4","data-file-select":!0,children:[o.jsx("h3",{className:"font-semibold",children:"Map Files and Fields"}),o.jsxs("div",{"data-field-select":!0,children:[o.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Nodes File (Locations) ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsxs("select",{value:P??"",onChange:N=>{const $=parseInt(N.target.value);Y($);const z=Oe(x[$]);G(z);const ee=z.find(K=>K.toLowerCase()==="id");if(ee&&xe(ee),p.nodesFile){const K={...p};delete K.nodesFile,m(K)}},className:`w-full px-3 py-2 border rounded-md ${p.nodesFile?"border-red-500":"border-gray-300"}`,children:[o.jsx("option",{value:"",children:"Select file..."}),h.map((N,$)=>o.jsx("option",{value:$,children:N.name},$))]}),p.nodesFile&&o.jsx("p",{className:"mt-1 text-sm text-red-600",children:p.nodesFile}),P!==null&&F.length>0&&o.jsxs("div",{className:"mt-2 space-y-2",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"ID Field *"}),o.jsxs("select",{value:ue,onChange:N=>{if(xe(N.target.value),p.nodeIdField){const $={...p};delete $.nodeIdField,m($)}},className:`w-full px-2 py-1 border rounded text-sm ${p.nodeIdField?"border-red-500":"border-gray-300"}`,children:[o.jsx("option",{value:"",children:"Select field..."}),F.map(N=>o.jsx("option",{value:N,children:N},N))]}),p.nodeIdField&&o.jsx("p",{className:"mt-1 text-xs text-red-600",children:p.nodeIdField})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"Label Field (optional)"}),o.jsxs("select",{value:_e,onChange:N=>j(N.target.value),className:"w-full px-2 py-1 border border-gray-300 rounded text-sm",children:[o.jsx("option",{value:"",children:"Use ID field"}),F.map(N=>o.jsx("option",{value:N,children:N},N))]})]})]})]}),o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Edges File (Flows) ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsxs("select",{value:D??"",onChange:N=>{const $=parseInt(N.target.value);Q($);const z=Oe(x[$]);ce(z);const ee=z.find(de=>de.toLowerCase()==="source"||de.toLowerCase()==="origin"||de.toLowerCase()==="from"),K=z.find(de=>de.toLowerCase()==="target"||de.toLowerCase()==="dest"||de.toLowerCase()==="to"),se=z.find(de=>de.toLowerCase()==="value"||de.toLowerCase()==="count"||de.toLowerCase()==="weight");if(ee&&me(ee),K&&ze(K),se&&be(se),p.edgesFile){const de={...p};delete de.edgesFile,m(de)}},className:`w-full px-3 py-2 border rounded-md ${p.edgesFile?"border-red-500":"border-gray-300"}`,children:[o.jsx("option",{value:"",children:"Select file..."}),h.map((N,$)=>o.jsx("option",{value:$,children:N.name},$))]}),p.edgesFile&&o.jsx("p",{className:"mt-1 text-sm text-red-600",children:p.edgesFile}),D!==null&&X.length>0&&o.jsxs("div",{className:"mt-2 space-y-2",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"Source Field *"}),o.jsxs("select",{value:L,onChange:N=>{if(me(N.target.value),p.edgeSourceField){const $={...p};delete $.edgeSourceField,m($)}},className:`w-full px-2 py-1 border rounded text-sm ${p.edgeSourceField?"border-red-500":"border-gray-300"}`,children:[o.jsx("option",{value:"",children:"Select field..."}),X.map(N=>o.jsx("option",{value:N,children:N},N))]}),p.edgeSourceField&&o.jsx("p",{className:"mt-1 text-xs text-red-600",children:p.edgeSourceField})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"Target Field *"}),o.jsxs("select",{value:Ve,onChange:N=>{if(ze(N.target.value),p.edgeTargetField){const $={...p};delete $.edgeTargetField,m($)}},className:`w-full px-2 py-1 border rounded text-sm ${p.edgeTargetField?"border-red-500":"border-gray-300"}`,children:[o.jsx("option",{value:"",children:"Select field..."}),X.map(N=>o.jsx("option",{value:N,children:N},N))]}),p.edgeTargetField&&o.jsx("p",{className:"mt-1 text-xs text-red-600",children:p.edgeTargetField})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"Value Field *"}),o.jsxs("select",{value:U,onChange:N=>{if(be(N.target.value),p.edgeValueField){const $={...p};delete $.edgeValueField,m($)}},className:`w-full px-2 py-1 border rounded text-sm ${p.edgeValueField?"border-red-500":"border-gray-300"}`,children:[o.jsx("option",{value:"",children:"Select field..."}),X.map(N=>o.jsx("option",{value:N,children:N},N))]}),p.edgeValueField&&o.jsx("p",{className:"mt-1 text-xs text-red-600",children:p.edgeValueField})]})]})]})]}),o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Dataset Name ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsx("input",{ref:k,type:"text",value:i,onChange:N=>{if(l(N.target.value),p.name){const $={...p};delete $.name,m($)}},className:`w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 ${p.name?"border-red-500 focus:ring-red-500":"border-gray-300 focus:ring-blue-500"}`,placeholder:"Enter a name for this dataset"}),p.name&&o.jsx("p",{className:"mt-1 text-sm text-red-600",children:p.name})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Notes (optional)"}),o.jsx("textarea",{value:a,onChange:N=>u(N.target.value),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Add any notes about this dataset..."})]}),p.general&&o.jsxs("div",{className:"bg-red-50 border border-red-200 rounded p-3",children:[o.jsx("h4",{className:"font-semibold text-red-800 mb-2",children:"Error:"}),o.jsx("p",{className:"text-sm text-red-700",children:p.general})]}),Z&&o.jsxs("div",{ref:I,className:"bg-blue-50 border border-blue-200 rounded p-3",children:[o.jsx("h4",{className:"font-semibold text-blue-800 mb-2",children:"Data Summary"}),o.jsxs("div",{className:"text-sm text-blue-700 space-y-1",children:[o.jsxs("div",{children:[o.jsx("span",{className:"font-medium",children:"Nodes:"})," ",Z.nodes.length]}),o.jsxs("div",{children:[o.jsx("span",{className:"font-medium",children:"Edges:"})," ",Z.edges.length]}),Z.timeRange&&o.jsxs("div",{children:[o.jsx("span",{className:"font-medium",children:"Time Range:"})," ",Z.timeRange.start,Z.timeRange.end!==Z.timeRange.start?` – ${Z.timeRange.end}`:""]}),Z.nodes.length>0&&o.jsxs("div",{className:"mt-2 text-xs",children:[o.jsx("span",{className:"font-medium",children:"Sample node properties:"})," ",Object.keys(Z.nodes[0]).slice(0,5).join(", "),Object.keys(Z.nodes[0]).length>5&&"..."]}),p.summary&&o.jsxs("div",{className:"mt-2 pt-2 border-t border-blue-300",children:[o.jsx("span",{className:"font-medium text-orange-700",children:"Warnings:"})," ",o.jsx("span",{className:"text-orange-600",children:p.summary})]})]})]})]})}),o.jsxs("div",{className:"p-6 border-t flex justify-end gap-3",children:[o.jsx("button",{onClick:e,type:"button",disabled:d,className:"px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50 disabled:opacity-50 cursor-pointer transition-colors",children:"Cancel"}),o.jsx("button",{onClick:ge,type:"button",disabled:d||(Object.keys(p).filter($=>$!=="summary").length>0||!Z),className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed cursor-pointer transition-colors",children:d?"Importing...":"Import Dataset"})]})]})})}/**
   * table-core
   *
   * Copyright (c) TanStack
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE.md file in the root directory of this source tree.
   *
   * @license MIT
   */function ht(e,s){return typeof e=="function"?e(s):e}function Ye(e,s){return t=>{s.setState(n=>({...n,[e]:ht(t,n[e])}))}}function an(e){return e instanceof Function}function gr(e){return Array.isArray(e)&&e.every(s=>typeof s=="number")}function fr(e,s){const t=[],n=r=>{r.forEach(i=>{t.push(i);const l=s(i);l!=null&&l.length&&n(l)})};return n(e),t}function H(e,s,t){let n=[],r;return i=>{let l;t.key&&t.debug&&(l=Date.now());const a=e(i);if(!(a.length!==n.length||a.some((c,p)=>n[p]!==c)))return r;n=a;let d;if(t.key&&t.debug&&(d=Date.now()),r=s(...a),t==null||t.onChange==null||t.onChange(r),t.key&&t.debug&&t!=null&&t.debug()){const c=Math.round((Date.now()-l)*100)/100,p=Math.round((Date.now()-d)*100)/100,m=p/16,f=(w,S)=>{for(w=String(w);w.length<S;)w=" "+w;return w};console.info(`%c⏱ ${f(p,5)} /${f(c,5)} ms`,`
            font-size: .6rem;
            font-weight: bold;
            color: hsl(${Math.max(0,Math.min(120-120*m,120))}deg 100% 31%);`,t==null?void 0:t.key)}return r}}function O(e,s,t,n){return{debug:()=>{var r;return(r=e==null?void 0:e.debugAll)!=null?r:e[s]},key:!1,onChange:n}}function mr(e,s,t,n){const r=()=>{var l;return(l=i.getValue())!=null?l:e.options.renderFallbackValue},i={id:`${s.id}_${t.id}`,row:s,column:t,getValue:()=>s.getValue(n),renderValue:r,getContext:H(()=>[e,t,s,i],(l,a,u,d)=>({table:l,column:a,row:u,cell:d,getValue:d.getValue,renderValue:d.renderValue}),O(e.options,"debugCells"))};return e._features.forEach(l=>{l.createCell==null||l.createCell(i,t,s,e)},{}),i}function pr(e,s,t,n){var r,i;const a={...e._getDefaultColumnDef(),...s},u=a.accessorKey;let d=(r=(i=a.id)!=null?i:u?typeof String.prototype.replaceAll=="function"?u.replaceAll(".","_"):u.replace(/\./g,"_"):void 0)!=null?r:typeof a.header=="string"?a.header:void 0,c;if(a.accessorFn?c=a.accessorFn:u&&(u.includes(".")?c=m=>{let f=m;for(const S of u.split(".")){var w;f=(w=f)==null?void 0:w[S]}return f}:c=m=>m[a.accessorKey]),!d)throw new Error;let p={id:`${String(d)}`,accessorFn:c,parent:n,depth:t,columnDef:a,columns:[],getFlatColumns:H(()=>[!0],()=>{var m;return[p,...(m=p.columns)==null?void 0:m.flatMap(f=>f.getFlatColumns())]},O(e.options,"debugColumns")),getLeafColumns:H(()=>[e._getOrderColumnsFn()],m=>{var f;if((f=p.columns)!=null&&f.length){let w=p.columns.flatMap(S=>S.getLeafColumns());return m(w)}return[p]},O(e.options,"debugColumns"))};for(const m of e._features)m.createColumn==null||m.createColumn(p,e);return p}const Te="debugHeaders";function ds(e,s,t){var n;let i={id:(n=t.id)!=null?n:s.id,column:s,index:t.index,isPlaceholder:!!t.isPlaceholder,placeholderId:t.placeholderId,depth:t.depth,subHeaders:[],colSpan:0,rowSpan:0,headerGroup:null,getLeafHeaders:()=>{const l=[],a=u=>{u.subHeaders&&u.subHeaders.length&&u.subHeaders.map(a),l.push(u)};return a(i),l},getContext:()=>({table:e,header:i,column:s})};return e._features.forEach(l=>{l.createHeader==null||l.createHeader(i,e)}),i}const hr={createTable:e=>{e.getHeaderGroups=H(()=>[e.getAllColumns(),e.getVisibleLeafColumns(),e.getState().columnPinning.left,e.getState().columnPinning.right],(s,t,n,r)=>{var i,l;const a=(i=n==null?void 0:n.map(p=>t.find(m=>m.id===p)).filter(Boolean))!=null?i:[],u=(l=r==null?void 0:r.map(p=>t.find(m=>m.id===p)).filter(Boolean))!=null?l:[],d=t.filter(p=>!(n!=null&&n.includes(p.id))&&!(r!=null&&r.includes(p.id)));return tn(s,[...a,...d,...u],e)},O(e.options,Te)),e.getCenterHeaderGroups=H(()=>[e.getAllColumns(),e.getVisibleLeafColumns(),e.getState().columnPinning.left,e.getState().columnPinning.right],(s,t,n,r)=>(t=t.filter(i=>!(n!=null&&n.includes(i.id))&&!(r!=null&&r.includes(i.id))),tn(s,t,e,"center")),O(e.options,Te)),e.getLeftHeaderGroups=H(()=>[e.getAllColumns(),e.getVisibleLeafColumns(),e.getState().columnPinning.left],(s,t,n)=>{var r;const i=(r=n==null?void 0:n.map(l=>t.find(a=>a.id===l)).filter(Boolean))!=null?r:[];return tn(s,i,e,"left")},O(e.options,Te)),e.getRightHeaderGroups=H(()=>[e.getAllColumns(),e.getVisibleLeafColumns(),e.getState().columnPinning.right],(s,t,n)=>{var r;const i=(r=n==null?void 0:n.map(l=>t.find(a=>a.id===l)).filter(Boolean))!=null?r:[];return tn(s,i,e,"right")},O(e.options,Te)),e.getFooterGroups=H(()=>[e.getHeaderGroups()],s=>[...s].reverse(),O(e.options,Te)),e.getLeftFooterGroups=H(()=>[e.getLeftHeaderGroups()],s=>[...s].reverse(),O(e.options,Te)),e.getCenterFooterGroups=H(()=>[e.getCenterHeaderGroups()],s=>[...s].reverse(),O(e.options,Te)),e.getRightFooterGroups=H(()=>[e.getRightHeaderGroups()],s=>[...s].reverse(),O(e.options,Te)),e.getFlatHeaders=H(()=>[e.getHeaderGroups()],s=>s.map(t=>t.headers).flat(),O(e.options,Te)),e.getLeftFlatHeaders=H(()=>[e.getLeftHeaderGroups()],s=>s.map(t=>t.headers).flat(),O(e.options,Te)),e.getCenterFlatHeaders=H(()=>[e.getCenterHeaderGroups()],s=>s.map(t=>t.headers).flat(),O(e.options,Te)),e.getRightFlatHeaders=H(()=>[e.getRightHeaderGroups()],s=>s.map(t=>t.headers).flat(),O(e.options,Te)),e.getCenterLeafHeaders=H(()=>[e.getCenterFlatHeaders()],s=>s.filter(t=>{var n;return!((n=t.subHeaders)!=null&&n.length)}),O(e.options,Te)),e.getLeftLeafHeaders=H(()=>[e.getLeftFlatHeaders()],s=>s.filter(t=>{var n;return!((n=t.subHeaders)!=null&&n.length)}),O(e.options,Te)),e.getRightLeafHeaders=H(()=>[e.getRightFlatHeaders()],s=>s.filter(t=>{var n;return!((n=t.subHeaders)!=null&&n.length)}),O(e.options,Te)),e.getLeafHeaders=H(()=>[e.getLeftHeaderGroups(),e.getCenterHeaderGroups(),e.getRightHeaderGroups()],(s,t,n)=>{var r,i,l,a,u,d;return[...(r=(i=s[0])==null?void 0:i.headers)!=null?r:[],...(l=(a=t[0])==null?void 0:a.headers)!=null?l:[],...(u=(d=n[0])==null?void 0:d.headers)!=null?u:[]].map(c=>c.getLeafHeaders()).flat()},O(e.options,Te))}};function tn(e,s,t,n){var r,i;let l=0;const a=function(m,f){f===void 0&&(f=1),l=Math.max(l,f),m.filter(w=>w.getIsVisible()).forEach(w=>{var S;(S=w.columns)!=null&&S.length&&a(w.columns,f+1)},0)};a(e);let u=[];const d=(m,f)=>{const w={depth:f,id:[n,`${f}`].filter(Boolean).join("_"),headers:[]},S=[];m.forEach(b=>{const h=[...S].reverse()[0],v=b.column.depth===w.depth;let x,_=!1;if(v&&b.column.parent?x=b.column.parent:(x=b.column,_=!0),h&&(h==null?void 0:h.column)===x)h.subHeaders.push(b);else{const M=ds(t,x,{id:[n,f,x.id,b==null?void 0:b.id].filter(Boolean).join("_"),isPlaceholder:_,placeholderId:_?`${S.filter(C=>C.column===x).length}`:void 0,depth:f,index:S.length});M.subHeaders.push(b),S.push(M)}w.headers.push(b),b.headerGroup=w}),u.push(w),f>0&&d(S,f-1)},c=s.map((m,f)=>ds(t,m,{depth:l,index:f}));d(c,l-1),u.reverse();const p=m=>m.filter(w=>w.column.getIsVisible()).map(w=>{let S=0,b=0,h=[0];w.subHeaders&&w.subHeaders.length?(h=[],p(w.subHeaders).forEach(x=>{let{colSpan:_,rowSpan:M}=x;S+=_,h.push(M)})):S=1;const v=Math.min(...h);return b=b+v,w.colSpan=S,w.rowSpan=b,{colSpan:S,rowSpan:b}});return p((r=(i=u[0])==null?void 0:i.headers)!=null?r:[]),u}const xr=(e,s,t,n,r,i,l)=>{let a={id:s,index:n,original:t,depth:r,parentId:l,_valuesCache:{},_uniqueValuesCache:{},getValue:u=>{if(a._valuesCache.hasOwnProperty(u))return a._valuesCache[u];const d=e.getColumn(u);if(d!=null&&d.accessorFn)return a._valuesCache[u]=d.accessorFn(a.original,n),a._valuesCache[u]},getUniqueValues:u=>{if(a._uniqueValuesCache.hasOwnProperty(u))return a._uniqueValuesCache[u];const d=e.getColumn(u);if(d!=null&&d.accessorFn)return d.columnDef.getUniqueValues?(a._uniqueValuesCache[u]=d.columnDef.getUniqueValues(a.original,n),a._uniqueValuesCache[u]):(a._uniqueValuesCache[u]=[a.getValue(u)],a._uniqueValuesCache[u])},renderValue:u=>{var d;return(d=a.getValue(u))!=null?d:e.options.renderFallbackValue},subRows:[],getLeafRows:()=>fr(a.subRows,u=>u.subRows),getParentRow:()=>a.parentId?e.getRow(a.parentId,!0):void 0,getParentRows:()=>{let u=[],d=a;for(;;){const c=d.getParentRow();if(!c)break;u.push(c),d=c}return u.reverse()},getAllCells:H(()=>[e.getAllLeafColumns()],u=>u.map(d=>mr(e,a,d,d.id)),O(e.options,"debugRows")),_getAllCellsByColumnId:H(()=>[a.getAllCells()],u=>u.reduce((d,c)=>(d[c.column.id]=c,d),{}),O(e.options,"debugRows"))};for(let u=0;u<e._features.length;u++){const d=e._features[u];d==null||d.createRow==null||d.createRow(a,e)}return a},vr={createColumn:(e,s)=>{e._getFacetedRowModel=s.options.getFacetedRowModel&&s.options.getFacetedRowModel(s,e.id),e.getFacetedRowModel=()=>e._getFacetedRowModel?e._getFacetedRowModel():s.getPreFilteredRowModel(),e._getFacetedUniqueValues=s.options.getFacetedUniqueValues&&s.options.getFacetedUniqueValues(s,e.id),e.getFacetedUniqueValues=()=>e._getFacetedUniqueValues?e._getFacetedUniqueValues():new Map,e._getFacetedMinMaxValues=s.options.getFacetedMinMaxValues&&s.options.getFacetedMinMaxValues(s,e.id),e.getFacetedMinMaxValues=()=>{if(e._getFacetedMinMaxValues)return e._getFacetedMinMaxValues()}}},Fs=(e,s,t)=>{var n,r;const i=t==null||(n=t.toString())==null?void 0:n.toLowerCase();return!!(!((r=e.getValue(s))==null||(r=r.toString())==null||(r=r.toLowerCase())==null)&&r.includes(i))};Fs.autoRemove=e=>nt(e);const $s=(e,s,t)=>{var n;return!!(!((n=e.getValue(s))==null||(n=n.toString())==null)&&n.includes(t))};$s.autoRemove=e=>nt(e);const Is=(e,s,t)=>{var n;return((n=e.getValue(s))==null||(n=n.toString())==null?void 0:n.toLowerCase())===(t==null?void 0:t.toLowerCase())};Is.autoRemove=e=>nt(e);const Es=(e,s,t)=>{var n;return(n=e.getValue(s))==null?void 0:n.includes(t)};Es.autoRemove=e=>nt(e);const Ps=(e,s,t)=>!t.some(n=>{var r;return!((r=e.getValue(s))!=null&&r.includes(n))});Ps.autoRemove=e=>nt(e)||!(e!=null&&e.length);const As=(e,s,t)=>t.some(n=>{var r;return(r=e.getValue(s))==null?void 0:r.includes(n)});As.autoRemove=e=>nt(e)||!(e!=null&&e.length);const Vs=(e,s,t)=>e.getValue(s)===t;Vs.autoRemove=e=>nt(e);const ks=(e,s,t)=>e.getValue(s)==t;ks.autoRemove=e=>nt(e);const On=(e,s,t)=>{let[n,r]=t;const i=e.getValue(s);return i>=n&&i<=r};On.resolveFilterValue=e=>{let[s,t]=e,n=typeof s!="number"?parseFloat(s):s,r=typeof t!="number"?parseFloat(t):t,i=s===null||Number.isNaN(n)?-1/0:n,l=t===null||Number.isNaN(r)?1/0:r;if(i>l){const a=i;i=l,l=a}return[i,l]};On.autoRemove=e=>nt(e)||nt(e[0])&&nt(e[1]);const ut={includesString:Fs,includesStringSensitive:$s,equalsString:Is,arrIncludes:Es,arrIncludesAll:Ps,arrIncludesSome:As,equals:Vs,weakEquals:ks,inNumberRange:On};function nt(e){return e==null||e===""}const yr={getDefaultColumnDef:()=>({filterFn:"auto"}),getInitialState:e=>({columnFilters:[],...e}),getDefaultOptions:e=>({onColumnFiltersChange:Ye("columnFilters",e),filterFromLeafRows:!1,maxLeafRowFilterDepth:100}),createColumn:(e,s)=>{e.getAutoFilterFn=()=>{const t=s.getCoreRowModel().flatRows[0],n=t==null?void 0:t.getValue(e.id);return typeof n=="string"?ut.includesString:typeof n=="number"?ut.inNumberRange:typeof n=="boolean"||n!==null&&typeof n=="object"?ut.equals:Array.isArray(n)?ut.arrIncludes:ut.weakEquals},e.getFilterFn=()=>{var t,n;return an(e.columnDef.filterFn)?e.columnDef.filterFn:e.columnDef.filterFn==="auto"?e.getAutoFilterFn():(t=(n=s.options.filterFns)==null?void 0:n[e.columnDef.filterFn])!=null?t:ut[e.columnDef.filterFn]},e.getCanFilter=()=>{var t,n,r;return((t=e.columnDef.enableColumnFilter)!=null?t:!0)&&((n=s.options.enableColumnFilters)!=null?n:!0)&&((r=s.options.enableFilters)!=null?r:!0)&&!!e.accessorFn},e.getIsFiltered=()=>e.getFilterIndex()>-1,e.getFilterValue=()=>{var t;return(t=s.getState().columnFilters)==null||(t=t.find(n=>n.id===e.id))==null?void 0:t.value},e.getFilterIndex=()=>{var t,n;return(t=(n=s.getState().columnFilters)==null?void 0:n.findIndex(r=>r.id===e.id))!=null?t:-1},e.setFilterValue=t=>{s.setColumnFilters(n=>{const r=e.getFilterFn(),i=n==null?void 0:n.find(c=>c.id===e.id),l=ht(t,i?i.value:void 0);if(gs(r,l,e)){var a;return(a=n==null?void 0:n.filter(c=>c.id!==e.id))!=null?a:[]}const u={id:e.id,value:l};if(i){var d;return(d=n==null?void 0:n.map(c=>c.id===e.id?u:c))!=null?d:[]}return n!=null&&n.length?[...n,u]:[u]})}},createRow:(e,s)=>{e.columnFilters={},e.columnFiltersMeta={}},createTable:e=>{e.setColumnFilters=s=>{const t=e.getAllLeafColumns(),n=r=>{var i;return(i=ht(s,r))==null?void 0:i.filter(l=>{const a=t.find(u=>u.id===l.id);if(a){const u=a.getFilterFn();if(gs(u,l.value,a))return!1}return!0})};e.options.onColumnFiltersChange==null||e.options.onColumnFiltersChange(n)},e.resetColumnFilters=s=>{var t,n;e.setColumnFilters(s?[]:(t=(n=e.initialState)==null?void 0:n.columnFilters)!=null?t:[])},e.getPreFilteredRowModel=()=>e.getCoreRowModel(),e.getFilteredRowModel=()=>(!e._getFilteredRowModel&&e.options.getFilteredRowModel&&(e._getFilteredRowModel=e.options.getFilteredRowModel(e)),e.options.manualFiltering||!e._getFilteredRowModel?e.getPreFilteredRowModel():e._getFilteredRowModel())}};function gs(e,s,t){return(e&&e.autoRemove?e.autoRemove(s,t):!1)||typeof s>"u"||typeof s=="string"&&!s}const br=(e,s,t)=>t.reduce((n,r)=>{const i=r.getValue(e);return n+(typeof i=="number"?i:0)},0),wr=(e,s,t)=>{let n;return t.forEach(r=>{const i=r.getValue(e);i!=null&&(n>i||n===void 0&&i>=i)&&(n=i)}),n},Sr=(e,s,t)=>{let n;return t.forEach(r=>{const i=r.getValue(e);i!=null&&(n<i||n===void 0&&i>=i)&&(n=i)}),n},_r=(e,s,t)=>{let n,r;return t.forEach(i=>{const l=i.getValue(e);l!=null&&(n===void 0?l>=l&&(n=r=l):(n>l&&(n=l),r<l&&(r=l)))}),[n,r]},Cr=(e,s)=>{let t=0,n=0;if(s.forEach(r=>{let i=r.getValue(e);i!=null&&(i=+i)>=i&&(++t,n+=i)}),t)return n/t},jr=(e,s)=>{if(!s.length)return;const t=s.map(i=>i.getValue(e));if(!gr(t))return;if(t.length===1)return t[0];const n=Math.floor(t.length/2),r=t.sort((i,l)=>i-l);return t.length%2!==0?r[n]:(r[n-1]+r[n])/2},Nr=(e,s)=>Array.from(new Set(s.map(t=>t.getValue(e))).values()),Rr=(e,s)=>new Set(s.map(t=>t.getValue(e))).size,Mr=(e,s)=>s.length,wn={sum:br,min:wr,max:Sr,extent:_r,mean:Cr,median:jr,unique:Nr,uniqueCount:Rr,count:Mr},Fr={getDefaultColumnDef:()=>({aggregatedCell:e=>{var s,t;return(s=(t=e.getValue())==null||t.toString==null?void 0:t.toString())!=null?s:null},aggregationFn:"auto"}),getInitialState:e=>({grouping:[],...e}),getDefaultOptions:e=>({onGroupingChange:Ye("grouping",e),groupedColumnMode:"reorder"}),createColumn:(e,s)=>{e.toggleGrouping=()=>{s.setGrouping(t=>t!=null&&t.includes(e.id)?t.filter(n=>n!==e.id):[...t??[],e.id])},e.getCanGroup=()=>{var t,n;return((t=e.columnDef.enableGrouping)!=null?t:!0)&&((n=s.options.enableGrouping)!=null?n:!0)&&(!!e.accessorFn||!!e.columnDef.getGroupingValue)},e.getIsGrouped=()=>{var t;return(t=s.getState().grouping)==null?void 0:t.includes(e.id)},e.getGroupedIndex=()=>{var t;return(t=s.getState().grouping)==null?void 0:t.indexOf(e.id)},e.getToggleGroupingHandler=()=>{const t=e.getCanGroup();return()=>{t&&e.toggleGrouping()}},e.getAutoAggregationFn=()=>{const t=s.getCoreRowModel().flatRows[0],n=t==null?void 0:t.getValue(e.id);if(typeof n=="number")return wn.sum;if(Object.prototype.toString.call(n)==="[object Date]")return wn.extent},e.getAggregationFn=()=>{var t,n;if(!e)throw new Error;return an(e.columnDef.aggregationFn)?e.columnDef.aggregationFn:e.columnDef.aggregationFn==="auto"?e.getAutoAggregationFn():(t=(n=s.options.aggregationFns)==null?void 0:n[e.columnDef.aggregationFn])!=null?t:wn[e.columnDef.aggregationFn]}},createTable:e=>{e.setGrouping=s=>e.options.onGroupingChange==null?void 0:e.options.onGroupingChange(s),e.resetGrouping=s=>{var t,n;e.setGrouping(s?[]:(t=(n=e.initialState)==null?void 0:n.grouping)!=null?t:[])},e.getPreGroupedRowModel=()=>e.getFilteredRowModel(),e.getGroupedRowModel=()=>(!e._getGroupedRowModel&&e.options.getGroupedRowModel&&(e._getGroupedRowModel=e.options.getGroupedRowModel(e)),e.options.manualGrouping||!e._getGroupedRowModel?e.getPreGroupedRowModel():e._getGroupedRowModel())},createRow:(e,s)=>{e.getIsGrouped=()=>!!e.groupingColumnId,e.getGroupingValue=t=>{if(e._groupingValuesCache.hasOwnProperty(t))return e._groupingValuesCache[t];const n=s.getColumn(t);return n!=null&&n.columnDef.getGroupingValue?(e._groupingValuesCache[t]=n.columnDef.getGroupingValue(e.original),e._groupingValuesCache[t]):e.getValue(t)},e._groupingValuesCache={}},createCell:(e,s,t,n)=>{e.getIsGrouped=()=>s.getIsGrouped()&&s.id===t.groupingColumnId,e.getIsPlaceholder=()=>!e.getIsGrouped()&&s.getIsGrouped(),e.getIsAggregated=()=>{var r;return!e.getIsGrouped()&&!e.getIsPlaceholder()&&!!((r=t.subRows)!=null&&r.length)}}};function $r(e,s,t){if(!(s!=null&&s.length)||!t)return e;const n=e.filter(i=>!s.includes(i.id));return t==="remove"?n:[...s.map(i=>e.find(l=>l.id===i)).filter(Boolean),...n]}const Ir={getInitialState:e=>({columnOrder:[],...e}),getDefaultOptions:e=>({onColumnOrderChange:Ye("columnOrder",e)}),createColumn:(e,s)=>{e.getIndex=H(t=>[Gt(s,t)],t=>t.findIndex(n=>n.id===e.id),O(s.options,"debugColumns")),e.getIsFirstColumn=t=>{var n;return((n=Gt(s,t)[0])==null?void 0:n.id)===e.id},e.getIsLastColumn=t=>{var n;const r=Gt(s,t);return((n=r[r.length-1])==null?void 0:n.id)===e.id}},createTable:e=>{e.setColumnOrder=s=>e.options.onColumnOrderChange==null?void 0:e.options.onColumnOrderChange(s),e.resetColumnOrder=s=>{var t;e.setColumnOrder(s?[]:(t=e.initialState.columnOrder)!=null?t:[])},e._getOrderColumnsFn=H(()=>[e.getState().columnOrder,e.getState().grouping,e.options.groupedColumnMode],(s,t,n)=>r=>{let i=[];if(!(s!=null&&s.length))i=r;else{const l=[...s],a=[...r];for(;a.length&&l.length;){const u=l.shift(),d=a.findIndex(c=>c.id===u);d>-1&&i.push(a.splice(d,1)[0])}i=[...i,...a]}return $r(i,t,n)},O(e.options,"debugTable"))}},Sn=()=>({left:[],right:[]}),Er={getInitialState:e=>({columnPinning:Sn(),...e}),getDefaultOptions:e=>({onColumnPinningChange:Ye("columnPinning",e)}),createColumn:(e,s)=>{e.pin=t=>{const n=e.getLeafColumns().map(r=>r.id).filter(Boolean);s.setColumnPinning(r=>{var i,l;if(t==="right"){var a,u;return{left:((a=r==null?void 0:r.left)!=null?a:[]).filter(p=>!(n!=null&&n.includes(p))),right:[...((u=r==null?void 0:r.right)!=null?u:[]).filter(p=>!(n!=null&&n.includes(p))),...n]}}if(t==="left"){var d,c;return{left:[...((d=r==null?void 0:r.left)!=null?d:[]).filter(p=>!(n!=null&&n.includes(p))),...n],right:((c=r==null?void 0:r.right)!=null?c:[]).filter(p=>!(n!=null&&n.includes(p)))}}return{left:((i=r==null?void 0:r.left)!=null?i:[]).filter(p=>!(n!=null&&n.includes(p))),right:((l=r==null?void 0:r.right)!=null?l:[]).filter(p=>!(n!=null&&n.includes(p)))}})},e.getCanPin=()=>e.getLeafColumns().some(n=>{var r,i,l;return((r=n.columnDef.enablePinning)!=null?r:!0)&&((i=(l=s.options.enableColumnPinning)!=null?l:s.options.enablePinning)!=null?i:!0)}),e.getIsPinned=()=>{const t=e.getLeafColumns().map(a=>a.id),{left:n,right:r}=s.getState().columnPinning,i=t.some(a=>n==null?void 0:n.includes(a)),l=t.some(a=>r==null?void 0:r.includes(a));return i?"left":l?"right":!1},e.getPinnedIndex=()=>{var t,n;const r=e.getIsPinned();return r?(t=(n=s.getState().columnPinning)==null||(n=n[r])==null?void 0:n.indexOf(e.id))!=null?t:-1:0}},createRow:(e,s)=>{e.getCenterVisibleCells=H(()=>[e._getAllVisibleCells(),s.getState().columnPinning.left,s.getState().columnPinning.right],(t,n,r)=>{const i=[...n??[],...r??[]];return t.filter(l=>!i.includes(l.column.id))},O(s.options,"debugRows")),e.getLeftVisibleCells=H(()=>[e._getAllVisibleCells(),s.getState().columnPinning.left],(t,n)=>(n??[]).map(i=>t.find(l=>l.column.id===i)).filter(Boolean).map(i=>({...i,position:"left"})),O(s.options,"debugRows")),e.getRightVisibleCells=H(()=>[e._getAllVisibleCells(),s.getState().columnPinning.right],(t,n)=>(n??[]).map(i=>t.find(l=>l.column.id===i)).filter(Boolean).map(i=>({...i,position:"right"})),O(s.options,"debugRows"))},createTable:e=>{e.setColumnPinning=s=>e.options.onColumnPinningChange==null?void 0:e.options.onColumnPinningChange(s),e.resetColumnPinning=s=>{var t,n;return e.setColumnPinning(s?Sn():(t=(n=e.initialState)==null?void 0:n.columnPinning)!=null?t:Sn())},e.getIsSomeColumnsPinned=s=>{var t;const n=e.getState().columnPinning;if(!s){var r,i;return!!((r=n.left)!=null&&r.length||(i=n.right)!=null&&i.length)}return!!((t=n[s])!=null&&t.length)},e.getLeftLeafColumns=H(()=>[e.getAllLeafColumns(),e.getState().columnPinning.left],(s,t)=>(t??[]).map(n=>s.find(r=>r.id===n)).filter(Boolean),O(e.options,"debugColumns")),e.getRightLeafColumns=H(()=>[e.getAllLeafColumns(),e.getState().columnPinning.right],(s,t)=>(t??[]).map(n=>s.find(r=>r.id===n)).filter(Boolean),O(e.options,"debugColumns")),e.getCenterLeafColumns=H(()=>[e.getAllLeafColumns(),e.getState().columnPinning.left,e.getState().columnPinning.right],(s,t,n)=>{const r=[...t??[],...n??[]];return s.filter(i=>!r.includes(i.id))},O(e.options,"debugColumns"))}};function Pr(e){return e||(typeof document<"u"?document:null)}const nn={size:150,minSize:20,maxSize:Number.MAX_SAFE_INTEGER},_n=()=>({startOffset:null,startSize:null,deltaOffset:null,deltaPercentage:null,isResizingColumn:!1,columnSizingStart:[]}),Ar={getDefaultColumnDef:()=>nn,getInitialState:e=>({columnSizing:{},columnSizingInfo:_n(),...e}),getDefaultOptions:e=>({columnResizeMode:"onEnd",columnResizeDirection:"ltr",onColumnSizingChange:Ye("columnSizing",e),onColumnSizingInfoChange:Ye("columnSizingInfo",e)}),createColumn:(e,s)=>{e.getSize=()=>{var t,n,r;const i=s.getState().columnSizing[e.id];return Math.min(Math.max((t=e.columnDef.minSize)!=null?t:nn.minSize,(n=i??e.columnDef.size)!=null?n:nn.size),(r=e.columnDef.maxSize)!=null?r:nn.maxSize)},e.getStart=H(t=>[t,Gt(s,t),s.getState().columnSizing],(t,n)=>n.slice(0,e.getIndex(t)).reduce((r,i)=>r+i.getSize(),0),O(s.options,"debugColumns")),e.getAfter=H(t=>[t,Gt(s,t),s.getState().columnSizing],(t,n)=>n.slice(e.getIndex(t)+1).reduce((r,i)=>r+i.getSize(),0),O(s.options,"debugColumns")),e.resetSize=()=>{s.setColumnSizing(t=>{let{[e.id]:n,...r}=t;return r})},e.getCanResize=()=>{var t,n;return((t=e.columnDef.enableResizing)!=null?t:!0)&&((n=s.options.enableColumnResizing)!=null?n:!0)},e.getIsResizing=()=>s.getState().columnSizingInfo.isResizingColumn===e.id},createHeader:(e,s)=>{e.getSize=()=>{let t=0;const n=r=>{if(r.subHeaders.length)r.subHeaders.forEach(n);else{var i;t+=(i=r.column.getSize())!=null?i:0}};return n(e),t},e.getStart=()=>{if(e.index>0){const t=e.headerGroup.headers[e.index-1];return t.getStart()+t.getSize()}return 0},e.getResizeHandler=t=>{const n=s.getColumn(e.column.id),r=n==null?void 0:n.getCanResize();return i=>{if(!n||!r||(i.persist==null||i.persist(),Cn(i)&&i.touches&&i.touches.length>1))return;const l=e.getSize(),a=e?e.getLeafHeaders().map(h=>[h.column.id,h.column.getSize()]):[[n.id,n.getSize()]],u=Cn(i)?Math.round(i.touches[0].clientX):i.clientX,d={},c=(h,v)=>{typeof v=="number"&&(s.setColumnSizingInfo(x=>{var _,M;const C=s.options.columnResizeDirection==="rtl"?-1:1,k=(v-((_=x==null?void 0:x.startOffset)!=null?_:0))*C,I=Math.max(k/((M=x==null?void 0:x.startSize)!=null?M:0),-.999999);return x.columnSizingStart.forEach(P=>{let[Y,D]=P;d[Y]=Math.round(Math.max(D+D*I,0)*100)/100}),{...x,deltaOffset:k,deltaPercentage:I}}),(s.options.columnResizeMode==="onChange"||h==="end")&&s.setColumnSizing(x=>({...x,...d})))},p=h=>c("move",h),m=h=>{c("end",h),s.setColumnSizingInfo(v=>({...v,isResizingColumn:!1,startOffset:null,startSize:null,deltaOffset:null,deltaPercentage:null,columnSizingStart:[]}))},f=Pr(t),w={moveHandler:h=>p(h.clientX),upHandler:h=>{f==null||f.removeEventListener("mousemove",w.moveHandler),f==null||f.removeEventListener("mouseup",w.upHandler),m(h.clientX)}},S={moveHandler:h=>(h.cancelable&&(h.preventDefault(),h.stopPropagation()),p(h.touches[0].clientX),!1),upHandler:h=>{var v;f==null||f.removeEventListener("touchmove",S.moveHandler),f==null||f.removeEventListener("touchend",S.upHandler),h.cancelable&&(h.preventDefault(),h.stopPropagation()),m((v=h.touches[0])==null?void 0:v.clientX)}},b=Vr()?{passive:!1}:!1;Cn(i)?(f==null||f.addEventListener("touchmove",S.moveHandler,b),f==null||f.addEventListener("touchend",S.upHandler,b)):(f==null||f.addEventListener("mousemove",w.moveHandler,b),f==null||f.addEventListener("mouseup",w.upHandler,b)),s.setColumnSizingInfo(h=>({...h,startOffset:u,startSize:l,deltaOffset:0,deltaPercentage:0,columnSizingStart:a,isResizingColumn:n.id}))}}},createTable:e=>{e.setColumnSizing=s=>e.options.onColumnSizingChange==null?void 0:e.options.onColumnSizingChange(s),e.setColumnSizingInfo=s=>e.options.onColumnSizingInfoChange==null?void 0:e.options.onColumnSizingInfoChange(s),e.resetColumnSizing=s=>{var t;e.setColumnSizing(s?{}:(t=e.initialState.columnSizing)!=null?t:{})},e.resetHeaderSizeInfo=s=>{var t;e.setColumnSizingInfo(s?_n():(t=e.initialState.columnSizingInfo)!=null?t:_n())},e.getTotalSize=()=>{var s,t;return(s=(t=e.getHeaderGroups()[0])==null?void 0:t.headers.reduce((n,r)=>n+r.getSize(),0))!=null?s:0},e.getLeftTotalSize=()=>{var s,t;return(s=(t=e.getLeftHeaderGroups()[0])==null?void 0:t.headers.reduce((n,r)=>n+r.getSize(),0))!=null?s:0},e.getCenterTotalSize=()=>{var s,t;return(s=(t=e.getCenterHeaderGroups()[0])==null?void 0:t.headers.reduce((n,r)=>n+r.getSize(),0))!=null?s:0},e.getRightTotalSize=()=>{var s,t;return(s=(t=e.getRightHeaderGroups()[0])==null?void 0:t.headers.reduce((n,r)=>n+r.getSize(),0))!=null?s:0}}};let sn=null;function Vr(){if(typeof sn=="boolean")return sn;let e=!1;try{const s={get passive(){return e=!0,!1}},t=()=>{};window.addEventListener("test",t,s),window.removeEventListener("test",t)}catch{e=!1}return sn=e,sn}function Cn(e){return e.type==="touchstart"}const kr={getInitialState:e=>({columnVisibility:{},...e}),getDefaultOptions:e=>({onColumnVisibilityChange:Ye("columnVisibility",e)}),createColumn:(e,s)=>{e.toggleVisibility=t=>{e.getCanHide()&&s.setColumnVisibility(n=>({...n,[e.id]:t??!e.getIsVisible()}))},e.getIsVisible=()=>{var t,n;const r=e.columns;return(t=r.length?r.some(i=>i.getIsVisible()):(n=s.getState().columnVisibility)==null?void 0:n[e.id])!=null?t:!0},e.getCanHide=()=>{var t,n;return((t=e.columnDef.enableHiding)!=null?t:!0)&&((n=s.options.enableHiding)!=null?n:!0)},e.getToggleVisibilityHandler=()=>t=>{e.toggleVisibility==null||e.toggleVisibility(t.target.checked)}},createRow:(e,s)=>{e._getAllVisibleCells=H(()=>[e.getAllCells(),s.getState().columnVisibility],t=>t.filter(n=>n.column.getIsVisible()),O(s.options,"debugRows")),e.getVisibleCells=H(()=>[e.getLeftVisibleCells(),e.getCenterVisibleCells(),e.getRightVisibleCells()],(t,n,r)=>[...t,...n,...r],O(s.options,"debugRows"))},createTable:e=>{const s=(t,n)=>H(()=>[n(),n().filter(r=>r.getIsVisible()).map(r=>r.id).join("_")],r=>r.filter(i=>i.getIsVisible==null?void 0:i.getIsVisible()),O(e.options,"debugColumns"));e.getVisibleFlatColumns=s("getVisibleFlatColumns",()=>e.getAllFlatColumns()),e.getVisibleLeafColumns=s("getVisibleLeafColumns",()=>e.getAllLeafColumns()),e.getLeftVisibleLeafColumns=s("getLeftVisibleLeafColumns",()=>e.getLeftLeafColumns()),e.getRightVisibleLeafColumns=s("getRightVisibleLeafColumns",()=>e.getRightLeafColumns()),e.getCenterVisibleLeafColumns=s("getCenterVisibleLeafColumns",()=>e.getCenterLeafColumns()),e.setColumnVisibility=t=>e.options.onColumnVisibilityChange==null?void 0:e.options.onColumnVisibilityChange(t),e.resetColumnVisibility=t=>{var n;e.setColumnVisibility(t?{}:(n=e.initialState.columnVisibility)!=null?n:{})},e.toggleAllColumnsVisible=t=>{var n;t=(n=t)!=null?n:!e.getIsAllColumnsVisible(),e.setColumnVisibility(e.getAllLeafColumns().reduce((r,i)=>({...r,[i.id]:t||!(i.getCanHide!=null&&i.getCanHide())}),{}))},e.getIsAllColumnsVisible=()=>!e.getAllLeafColumns().some(t=>!(t.getIsVisible!=null&&t.getIsVisible())),e.getIsSomeColumnsVisible=()=>e.getAllLeafColumns().some(t=>t.getIsVisible==null?void 0:t.getIsVisible()),e.getToggleAllColumnsVisibilityHandler=()=>t=>{var n;e.toggleAllColumnsVisible((n=t.target)==null?void 0:n.checked)}}};function Gt(e,s){return s?s==="center"?e.getCenterVisibleLeafColumns():s==="left"?e.getLeftVisibleLeafColumns():e.getRightVisibleLeafColumns():e.getVisibleLeafColumns()}const Dr={createTable:e=>{e._getGlobalFacetedRowModel=e.options.getFacetedRowModel&&e.options.getFacetedRowModel(e,"__global__"),e.getGlobalFacetedRowModel=()=>e.options.manualFiltering||!e._getGlobalFacetedRowModel?e.getPreFilteredRowModel():e._getGlobalFacetedRowModel(),e._getGlobalFacetedUniqueValues=e.options.getFacetedUniqueValues&&e.options.getFacetedUniqueValues(e,"__global__"),e.getGlobalFacetedUniqueValues=()=>e._getGlobalFacetedUniqueValues?e._getGlobalFacetedUniqueValues():new Map,e._getGlobalFacetedMinMaxValues=e.options.getFacetedMinMaxValues&&e.options.getFacetedMinMaxValues(e,"__global__"),e.getGlobalFacetedMinMaxValues=()=>{if(e._getGlobalFacetedMinMaxValues)return e._getGlobalFacetedMinMaxValues()}}},Lr={getInitialState:e=>({globalFilter:void 0,...e}),getDefaultOptions:e=>({onGlobalFilterChange:Ye("globalFilter",e),globalFilterFn:"auto",getColumnCanGlobalFilter:s=>{var t;const n=(t=e.getCoreRowModel().flatRows[0])==null||(t=t._getAllCellsByColumnId()[s.id])==null?void 0:t.getValue();return typeof n=="string"||typeof n=="number"}}),createColumn:(e,s)=>{e.getCanGlobalFilter=()=>{var t,n,r,i;return((t=e.columnDef.enableGlobalFilter)!=null?t:!0)&&((n=s.options.enableGlobalFilter)!=null?n:!0)&&((r=s.options.enableFilters)!=null?r:!0)&&((i=s.options.getColumnCanGlobalFilter==null?void 0:s.options.getColumnCanGlobalFilter(e))!=null?i:!0)&&!!e.accessorFn}},createTable:e=>{e.getGlobalAutoFilterFn=()=>ut.includesString,e.getGlobalFilterFn=()=>{var s,t;const{globalFilterFn:n}=e.options;return an(n)?n:n==="auto"?e.getGlobalAutoFilterFn():(s=(t=e.options.filterFns)==null?void 0:t[n])!=null?s:ut[n]},e.setGlobalFilter=s=>{e.options.onGlobalFilterChange==null||e.options.onGlobalFilterChange(s)},e.resetGlobalFilter=s=>{e.setGlobalFilter(s?void 0:e.initialState.globalFilter)}}},Tr={getInitialState:e=>({expanded:{},...e}),getDefaultOptions:e=>({onExpandedChange:Ye("expanded",e),paginateExpandedRows:!0}),createTable:e=>{let s=!1,t=!1;e._autoResetExpanded=()=>{var n,r;if(!s){e._queue(()=>{s=!0});return}if((n=(r=e.options.autoResetAll)!=null?r:e.options.autoResetExpanded)!=null?n:!e.options.manualExpanding){if(t)return;t=!0,e._queue(()=>{e.resetExpanded(),t=!1})}},e.setExpanded=n=>e.options.onExpandedChange==null?void 0:e.options.onExpandedChange(n),e.toggleAllRowsExpanded=n=>{n??!e.getIsAllRowsExpanded()?e.setExpanded(!0):e.setExpanded({})},e.resetExpanded=n=>{var r,i;e.setExpanded(n?{}:(r=(i=e.initialState)==null?void 0:i.expanded)!=null?r:{})},e.getCanSomeRowsExpand=()=>e.getPrePaginationRowModel().flatRows.some(n=>n.getCanExpand()),e.getToggleAllRowsExpandedHandler=()=>n=>{n.persist==null||n.persist(),e.toggleAllRowsExpanded()},e.getIsSomeRowsExpanded=()=>{const n=e.getState().expanded;return n===!0||Object.values(n).some(Boolean)},e.getIsAllRowsExpanded=()=>{const n=e.getState().expanded;return typeof n=="boolean"?n===!0:!(!Object.keys(n).length||e.getRowModel().flatRows.some(r=>!r.getIsExpanded()))},e.getExpandedDepth=()=>{let n=0;return(e.getState().expanded===!0?Object.keys(e.getRowModel().rowsById):Object.keys(e.getState().expanded)).forEach(i=>{const l=i.split(".");n=Math.max(n,l.length)}),n},e.getPreExpandedRowModel=()=>e.getSortedRowModel(),e.getExpandedRowModel=()=>(!e._getExpandedRowModel&&e.options.getExpandedRowModel&&(e._getExpandedRowModel=e.options.getExpandedRowModel(e)),e.options.manualExpanding||!e._getExpandedRowModel?e.getPreExpandedRowModel():e._getExpandedRowModel())},createRow:(e,s)=>{e.toggleExpanded=t=>{s.setExpanded(n=>{var r;const i=n===!0?!0:!!(n!=null&&n[e.id]);let l={};if(n===!0?Object.keys(s.getRowModel().rowsById).forEach(a=>{l[a]=!0}):l=n,t=(r=t)!=null?r:!i,!i&&t)return{...l,[e.id]:!0};if(i&&!t){const{[e.id]:a,...u}=l;return u}return n})},e.getIsExpanded=()=>{var t;const n=s.getState().expanded;return!!((t=s.options.getIsRowExpanded==null?void 0:s.options.getIsRowExpanded(e))!=null?t:n===!0||n!=null&&n[e.id])},e.getCanExpand=()=>{var t,n,r;return(t=s.options.getRowCanExpand==null?void 0:s.options.getRowCanExpand(e))!=null?t:((n=s.options.enableExpanding)!=null?n:!0)&&!!((r=e.subRows)!=null&&r.length)},e.getIsAllParentsExpanded=()=>{let t=!0,n=e;for(;t&&n.parentId;)n=s.getRow(n.parentId,!0),t=n.getIsExpanded();return t},e.getToggleExpandedHandler=()=>{const t=e.getCanExpand();return()=>{t&&e.toggleExpanded()}}}},An=0,Vn=10,jn=()=>({pageIndex:An,pageSize:Vn}),zr={getInitialState:e=>({...e,pagination:{...jn(),...e==null?void 0:e.pagination}}),getDefaultOptions:e=>({onPaginationChange:Ye("pagination",e)}),createTable:e=>{let s=!1,t=!1;e._autoResetPageIndex=()=>{var n,r;if(!s){e._queue(()=>{s=!0});return}if((n=(r=e.options.autoResetAll)!=null?r:e.options.autoResetPageIndex)!=null?n:!e.options.manualPagination){if(t)return;t=!0,e._queue(()=>{e.resetPageIndex(),t=!1})}},e.setPagination=n=>{const r=i=>ht(n,i);return e.options.onPaginationChange==null?void 0:e.options.onPaginationChange(r)},e.resetPagination=n=>{var r;e.setPagination(n?jn():(r=e.initialState.pagination)!=null?r:jn())},e.setPageIndex=n=>{e.setPagination(r=>{let i=ht(n,r.pageIndex);const l=typeof e.options.pageCount>"u"||e.options.pageCount===-1?Number.MAX_SAFE_INTEGER:e.options.pageCount-1;return i=Math.max(0,Math.min(i,l)),{...r,pageIndex:i}})},e.resetPageIndex=n=>{var r,i;e.setPageIndex(n?An:(r=(i=e.initialState)==null||(i=i.pagination)==null?void 0:i.pageIndex)!=null?r:An)},e.resetPageSize=n=>{var r,i;e.setPageSize(n?Vn:(r=(i=e.initialState)==null||(i=i.pagination)==null?void 0:i.pageSize)!=null?r:Vn)},e.setPageSize=n=>{e.setPagination(r=>{const i=Math.max(1,ht(n,r.pageSize)),l=r.pageSize*r.pageIndex,a=Math.floor(l/i);return{...r,pageIndex:a,pageSize:i}})},e.setPageCount=n=>e.setPagination(r=>{var i;let l=ht(n,(i=e.options.pageCount)!=null?i:-1);return typeof l=="number"&&(l=Math.max(-1,l)),{...r,pageCount:l}}),e.getPageOptions=H(()=>[e.getPageCount()],n=>{let r=[];return n&&n>0&&(r=[...new Array(n)].fill(null).map((i,l)=>l)),r},O(e.options,"debugTable")),e.getCanPreviousPage=()=>e.getState().pagination.pageIndex>0,e.getCanNextPage=()=>{const{pageIndex:n}=e.getState().pagination,r=e.getPageCount();return r===-1?!0:r===0?!1:n<r-1},e.previousPage=()=>e.setPageIndex(n=>n-1),e.nextPage=()=>e.setPageIndex(n=>n+1),e.firstPage=()=>e.setPageIndex(0),e.lastPage=()=>e.setPageIndex(e.getPageCount()-1),e.getPrePaginationRowModel=()=>e.getExpandedRowModel(),e.getPaginationRowModel=()=>(!e._getPaginationRowModel&&e.options.getPaginationRowModel&&(e._getPaginationRowModel=e.options.getPaginationRowModel(e)),e.options.manualPagination||!e._getPaginationRowModel?e.getPrePaginationRowModel():e._getPaginationRowModel()),e.getPageCount=()=>{var n;return(n=e.options.pageCount)!=null?n:Math.ceil(e.getRowCount()/e.getState().pagination.pageSize)},e.getRowCount=()=>{var n;return(n=e.options.rowCount)!=null?n:e.getPrePaginationRowModel().rows.length}}},Nn=()=>({top:[],bottom:[]}),Hr={getInitialState:e=>({rowPinning:Nn(),...e}),getDefaultOptions:e=>({onRowPinningChange:Ye("rowPinning",e)}),createRow:(e,s)=>{e.pin=(t,n,r)=>{const i=n?e.getLeafRows().map(u=>{let{id:d}=u;return d}):[],l=r?e.getParentRows().map(u=>{let{id:d}=u;return d}):[],a=new Set([...l,e.id,...i]);s.setRowPinning(u=>{var d,c;if(t==="bottom"){var p,m;return{top:((p=u==null?void 0:u.top)!=null?p:[]).filter(S=>!(a!=null&&a.has(S))),bottom:[...((m=u==null?void 0:u.bottom)!=null?m:[]).filter(S=>!(a!=null&&a.has(S))),...Array.from(a)]}}if(t==="top"){var f,w;return{top:[...((f=u==null?void 0:u.top)!=null?f:[]).filter(S=>!(a!=null&&a.has(S))),...Array.from(a)],bottom:((w=u==null?void 0:u.bottom)!=null?w:[]).filter(S=>!(a!=null&&a.has(S)))}}return{top:((d=u==null?void 0:u.top)!=null?d:[]).filter(S=>!(a!=null&&a.has(S))),bottom:((c=u==null?void 0:u.bottom)!=null?c:[]).filter(S=>!(a!=null&&a.has(S)))}})},e.getCanPin=()=>{var t;const{enableRowPinning:n,enablePinning:r}=s.options;return typeof n=="function"?n(e):(t=n??r)!=null?t:!0},e.getIsPinned=()=>{const t=[e.id],{top:n,bottom:r}=s.getState().rowPinning,i=t.some(a=>n==null?void 0:n.includes(a)),l=t.some(a=>r==null?void 0:r.includes(a));return i?"top":l?"bottom":!1},e.getPinnedIndex=()=>{var t,n;const r=e.getIsPinned();if(!r)return-1;const i=(t=r==="top"?s.getTopRows():s.getBottomRows())==null?void 0:t.map(l=>{let{id:a}=l;return a});return(n=i==null?void 0:i.indexOf(e.id))!=null?n:-1}},createTable:e=>{e.setRowPinning=s=>e.options.onRowPinningChange==null?void 0:e.options.onRowPinningChange(s),e.resetRowPinning=s=>{var t,n;return e.setRowPinning(s?Nn():(t=(n=e.initialState)==null?void 0:n.rowPinning)!=null?t:Nn())},e.getIsSomeRowsPinned=s=>{var t;const n=e.getState().rowPinning;if(!s){var r,i;return!!((r=n.top)!=null&&r.length||(i=n.bottom)!=null&&i.length)}return!!((t=n[s])!=null&&t.length)},e._getPinnedRows=(s,t,n)=>{var r;return((r=e.options.keepPinnedRows)==null||r?(t??[]).map(l=>{const a=e.getRow(l,!0);return a.getIsAllParentsExpanded()?a:null}):(t??[]).map(l=>s.find(a=>a.id===l))).filter(Boolean).map(l=>({...l,position:n}))},e.getTopRows=H(()=>[e.getRowModel().rows,e.getState().rowPinning.top],(s,t)=>e._getPinnedRows(s,t,"top"),O(e.options,"debugRows")),e.getBottomRows=H(()=>[e.getRowModel().rows,e.getState().rowPinning.bottom],(s,t)=>e._getPinnedRows(s,t,"bottom"),O(e.options,"debugRows")),e.getCenterRows=H(()=>[e.getRowModel().rows,e.getState().rowPinning.top,e.getState().rowPinning.bottom],(s,t,n)=>{const r=new Set([...t??[],...n??[]]);return s.filter(i=>!r.has(i.id))},O(e.options,"debugRows"))}},Or={getInitialState:e=>({rowSelection:{},...e}),getDefaultOptions:e=>({onRowSelectionChange:Ye("rowSelection",e),enableRowSelection:!0,enableMultiRowSelection:!0,enableSubRowSelection:!0}),createTable:e=>{e.setRowSelection=s=>e.options.onRowSelectionChange==null?void 0:e.options.onRowSelectionChange(s),e.resetRowSelection=s=>{var t;return e.setRowSelection(s?{}:(t=e.initialState.rowSelection)!=null?t:{})},e.toggleAllRowsSelected=s=>{e.setRowSelection(t=>{s=typeof s<"u"?s:!e.getIsAllRowsSelected();const n={...t},r=e.getPreGroupedRowModel().flatRows;return s?r.forEach(i=>{i.getCanSelect()&&(n[i.id]=!0)}):r.forEach(i=>{delete n[i.id]}),n})},e.toggleAllPageRowsSelected=s=>e.setRowSelection(t=>{const n=typeof s<"u"?s:!e.getIsAllPageRowsSelected(),r={...t};return e.getRowModel().rows.forEach(i=>{kn(r,i.id,n,!0,e)}),r}),e.getPreSelectedRowModel=()=>e.getCoreRowModel(),e.getSelectedRowModel=H(()=>[e.getState().rowSelection,e.getCoreRowModel()],(s,t)=>Object.keys(s).length?Rn(e,t):{rows:[],flatRows:[],rowsById:{}},O(e.options,"debugTable")),e.getFilteredSelectedRowModel=H(()=>[e.getState().rowSelection,e.getFilteredRowModel()],(s,t)=>Object.keys(s).length?Rn(e,t):{rows:[],flatRows:[],rowsById:{}},O(e.options,"debugTable")),e.getGroupedSelectedRowModel=H(()=>[e.getState().rowSelection,e.getSortedRowModel()],(s,t)=>Object.keys(s).length?Rn(e,t):{rows:[],flatRows:[],rowsById:{}},O(e.options,"debugTable")),e.getIsAllRowsSelected=()=>{const s=e.getFilteredRowModel().flatRows,{rowSelection:t}=e.getState();let n=!!(s.length&&Object.keys(t).length);return n&&s.some(r=>r.getCanSelect()&&!t[r.id])&&(n=!1),n},e.getIsAllPageRowsSelected=()=>{const s=e.getPaginationRowModel().flatRows.filter(r=>r.getCanSelect()),{rowSelection:t}=e.getState();let n=!!s.length;return n&&s.some(r=>!t[r.id])&&(n=!1),n},e.getIsSomeRowsSelected=()=>{var s;const t=Object.keys((s=e.getState().rowSelection)!=null?s:{}).length;return t>0&&t<e.getFilteredRowModel().flatRows.length},e.getIsSomePageRowsSelected=()=>{const s=e.getPaginationRowModel().flatRows;return e.getIsAllPageRowsSelected()?!1:s.filter(t=>t.getCanSelect()).some(t=>t.getIsSelected()||t.getIsSomeSelected())},e.getToggleAllRowsSelectedHandler=()=>s=>{e.toggleAllRowsSelected(s.target.checked)},e.getToggleAllPageRowsSelectedHandler=()=>s=>{e.toggleAllPageRowsSelected(s.target.checked)}},createRow:(e,s)=>{e.toggleSelected=(t,n)=>{const r=e.getIsSelected();s.setRowSelection(i=>{var l;if(t=typeof t<"u"?t:!r,e.getCanSelect()&&r===t)return i;const a={...i};return kn(a,e.id,t,(l=n==null?void 0:n.selectChildren)!=null?l:!0,s),a})},e.getIsSelected=()=>{const{rowSelection:t}=s.getState();return Gn(e,t)},e.getIsSomeSelected=()=>{const{rowSelection:t}=s.getState();return Dn(e,t)==="some"},e.getIsAllSubRowsSelected=()=>{const{rowSelection:t}=s.getState();return Dn(e,t)==="all"},e.getCanSelect=()=>{var t;return typeof s.options.enableRowSelection=="function"?s.options.enableRowSelection(e):(t=s.options.enableRowSelection)!=null?t:!0},e.getCanSelectSubRows=()=>{var t;return typeof s.options.enableSubRowSelection=="function"?s.options.enableSubRowSelection(e):(t=s.options.enableSubRowSelection)!=null?t:!0},e.getCanMultiSelect=()=>{var t;return typeof s.options.enableMultiRowSelection=="function"?s.options.enableMultiRowSelection(e):(t=s.options.enableMultiRowSelection)!=null?t:!0},e.getToggleSelectedHandler=()=>{const t=e.getCanSelect();return n=>{var r;t&&e.toggleSelected((r=n.target)==null?void 0:r.checked)}}}},kn=(e,s,t,n,r)=>{var i;const l=r.getRow(s,!0);t?(l.getCanMultiSelect()||Object.keys(e).forEach(a=>delete e[a]),l.getCanSelect()&&(e[s]=!0)):delete e[s],n&&(i=l.subRows)!=null&&i.length&&l.getCanSelectSubRows()&&l.subRows.forEach(a=>kn(e,a.id,t,n,r))};function Rn(e,s){const t=e.getState().rowSelection,n=[],r={},i=function(l,a){return l.map(u=>{var d;const c=Gn(u,t);if(c&&(n.push(u),r[u.id]=u),(d=u.subRows)!=null&&d.length&&(u={...u,subRows:i(u.subRows)}),c)return u}).filter(Boolean)};return{rows:i(s.rows),flatRows:n,rowsById:r}}function Gn(e,s){var t;return(t=s[e.id])!=null?t:!1}function Dn(e,s,t){var n;if(!((n=e.subRows)!=null&&n.length))return!1;let r=!0,i=!1;return e.subRows.forEach(l=>{if(!(i&&!r)&&(l.getCanSelect()&&(Gn(l,s)?i=!0:r=!1),l.subRows&&l.subRows.length)){const a=Dn(l,s);a==="all"?i=!0:(a==="some"&&(i=!0),r=!1)}}),r?"all":i?"some":!1}const Ln=/([0-9]+)/gm,Gr=(e,s,t)=>Ds(xt(e.getValue(t)).toLowerCase(),xt(s.getValue(t)).toLowerCase()),Ur=(e,s,t)=>Ds(xt(e.getValue(t)),xt(s.getValue(t))),Br=(e,s,t)=>Un(xt(e.getValue(t)).toLowerCase(),xt(s.getValue(t)).toLowerCase()),qr=(e,s,t)=>Un(xt(e.getValue(t)),xt(s.getValue(t))),Wr=(e,s,t)=>{const n=e.getValue(t),r=s.getValue(t);return n>r?1:n<r?-1:0},Kr=(e,s,t)=>Un(e.getValue(t),s.getValue(t));function Un(e,s){return e===s?0:e>s?1:-1}function xt(e){return typeof e=="number"?isNaN(e)||e===1/0||e===-1/0?"":String(e):typeof e=="string"?e:""}function Ds(e,s){const t=e.split(Ln).filter(Boolean),n=s.split(Ln).filter(Boolean);for(;t.length&&n.length;){const r=t.shift(),i=n.shift(),l=parseInt(r,10),a=parseInt(i,10),u=[l,a].sort();if(isNaN(u[0])){if(r>i)return 1;if(i>r)return-1;continue}if(isNaN(u[1]))return isNaN(l)?-1:1;if(l>a)return 1;if(a>l)return-1}return t.length-n.length}const Ot={alphanumeric:Gr,alphanumericCaseSensitive:Ur,text:Br,textCaseSensitive:qr,datetime:Wr,basic:Kr},Yr={getInitialState:e=>({sorting:[],...e}),getDefaultColumnDef:()=>({sortingFn:"auto",sortUndefined:1}),getDefaultOptions:e=>({onSortingChange:Ye("sorting",e),isMultiSortEvent:s=>s.shiftKey}),createColumn:(e,s)=>{e.getAutoSortingFn=()=>{const t=s.getFilteredRowModel().flatRows.slice(10);let n=!1;for(const r of t){const i=r==null?void 0:r.getValue(e.id);if(Object.prototype.toString.call(i)==="[object Date]")return Ot.datetime;if(typeof i=="string"&&(n=!0,i.split(Ln).length>1))return Ot.alphanumeric}return n?Ot.text:Ot.basic},e.getAutoSortDir=()=>{const t=s.getFilteredRowModel().flatRows[0];return typeof(t==null?void 0:t.getValue(e.id))=="string"?"asc":"desc"},e.getSortingFn=()=>{var t,n;if(!e)throw new Error;return an(e.columnDef.sortingFn)?e.columnDef.sortingFn:e.columnDef.sortingFn==="auto"?e.getAutoSortingFn():(t=(n=s.options.sortingFns)==null?void 0:n[e.columnDef.sortingFn])!=null?t:Ot[e.columnDef.sortingFn]},e.toggleSorting=(t,n)=>{const r=e.getNextSortingOrder(),i=typeof t<"u"&&t!==null;s.setSorting(l=>{const a=l==null?void 0:l.find(f=>f.id===e.id),u=l==null?void 0:l.findIndex(f=>f.id===e.id);let d=[],c,p=i?t:r==="desc";if(l!=null&&l.length&&e.getCanMultiSort()&&n?a?c="toggle":c="add":l!=null&&l.length&&u!==l.length-1?c="replace":a?c="toggle":c="replace",c==="toggle"&&(i||r||(c="remove")),c==="add"){var m;d=[...l,{id:e.id,desc:p}],d.splice(0,d.length-((m=s.options.maxMultiSortColCount)!=null?m:Number.MAX_SAFE_INTEGER))}else c==="toggle"?d=l.map(f=>f.id===e.id?{...f,desc:p}:f):c==="remove"?d=l.filter(f=>f.id!==e.id):d=[{id:e.id,desc:p}];return d})},e.getFirstSortDir=()=>{var t,n;return((t=(n=e.columnDef.sortDescFirst)!=null?n:s.options.sortDescFirst)!=null?t:e.getAutoSortDir()==="desc")?"desc":"asc"},e.getNextSortingOrder=t=>{var n,r;const i=e.getFirstSortDir(),l=e.getIsSorted();return l?l!==i&&((n=s.options.enableSortingRemoval)==null||n)&&(!(t&&(r=s.options.enableMultiRemove)!=null)||r)?!1:l==="desc"?"asc":"desc":i},e.getCanSort=()=>{var t,n;return((t=e.columnDef.enableSorting)!=null?t:!0)&&((n=s.options.enableSorting)!=null?n:!0)&&!!e.accessorFn},e.getCanMultiSort=()=>{var t,n;return(t=(n=e.columnDef.enableMultiSort)!=null?n:s.options.enableMultiSort)!=null?t:!!e.accessorFn},e.getIsSorted=()=>{var t;const n=(t=s.getState().sorting)==null?void 0:t.find(r=>r.id===e.id);return n?n.desc?"desc":"asc":!1},e.getSortIndex=()=>{var t,n;return(t=(n=s.getState().sorting)==null?void 0:n.findIndex(r=>r.id===e.id))!=null?t:-1},e.clearSorting=()=>{s.setSorting(t=>t!=null&&t.length?t.filter(n=>n.id!==e.id):[])},e.getToggleSortingHandler=()=>{const t=e.getCanSort();return n=>{t&&(n.persist==null||n.persist(),e.toggleSorting==null||e.toggleSorting(void 0,e.getCanMultiSort()?s.options.isMultiSortEvent==null?void 0:s.options.isMultiSortEvent(n):!1))}}},createTable:e=>{e.setSorting=s=>e.options.onSortingChange==null?void 0:e.options.onSortingChange(s),e.resetSorting=s=>{var t,n;e.setSorting(s?[]:(t=(n=e.initialState)==null?void 0:n.sorting)!=null?t:[])},e.getPreSortedRowModel=()=>e.getGroupedRowModel(),e.getSortedRowModel=()=>(!e._getSortedRowModel&&e.options.getSortedRowModel&&(e._getSortedRowModel=e.options.getSortedRowModel(e)),e.options.manualSorting||!e._getSortedRowModel?e.getPreSortedRowModel():e._getSortedRowModel())}},Xr=[hr,kr,Ir,Er,vr,yr,Dr,Lr,Yr,Fr,Tr,zr,Hr,Or,Ar];function Zr(e){var s,t;const n=[...Xr,...(s=e._features)!=null?s:[]];let r={_features:n};const i=r._features.reduce((m,f)=>Object.assign(m,f.getDefaultOptions==null?void 0:f.getDefaultOptions(r)),{}),l=m=>r.options.mergeOptions?r.options.mergeOptions(i,m):{...i,...m};let u={...{},...(t=e.initialState)!=null?t:{}};r._features.forEach(m=>{var f;u=(f=m.getInitialState==null?void 0:m.getInitialState(u))!=null?f:u});const d=[];let c=!1;const p={_features:n,options:{...i,...e},initialState:u,_queue:m=>{d.push(m),c||(c=!0,Promise.resolve().then(()=>{for(;d.length;)d.shift()();c=!1}).catch(f=>setTimeout(()=>{throw f})))},reset:()=>{r.setState(r.initialState)},setOptions:m=>{const f=ht(m,r.options);r.options=l(f)},getState:()=>r.options.state,setState:m=>{r.options.onStateChange==null||r.options.onStateChange(m)},_getRowId:(m,f,w)=>{var S;return(S=r.options.getRowId==null?void 0:r.options.getRowId(m,f,w))!=null?S:`${w?[w.id,f].join("."):f}`},getCoreRowModel:()=>(r._getCoreRowModel||(r._getCoreRowModel=r.options.getCoreRowModel(r)),r._getCoreRowModel()),getRowModel:()=>r.getPaginationRowModel(),getRow:(m,f)=>{let w=(f?r.getPrePaginationRowModel():r.getRowModel()).rowsById[m];if(!w&&(w=r.getCoreRowModel().rowsById[m],!w))throw new Error;return w},_getDefaultColumnDef:H(()=>[r.options.defaultColumn],m=>{var f;return m=(f=m)!=null?f:{},{header:w=>{const S=w.header.column.columnDef;return S.accessorKey?S.accessorKey:S.accessorFn?S.id:null},cell:w=>{var S,b;return(S=(b=w.renderValue())==null||b.toString==null?void 0:b.toString())!=null?S:null},...r._features.reduce((w,S)=>Object.assign(w,S.getDefaultColumnDef==null?void 0:S.getDefaultColumnDef()),{}),...m}},O(e,"debugColumns")),_getColumnDefs:()=>r.options.columns,getAllColumns:H(()=>[r._getColumnDefs()],m=>{const f=function(w,S,b){return b===void 0&&(b=0),w.map(h=>{const v=pr(r,h,b,S),x=h;return v.columns=x.columns?f(x.columns,v,b+1):[],v})};return f(m)},O(e,"debugColumns")),getAllFlatColumns:H(()=>[r.getAllColumns()],m=>m.flatMap(f=>f.getFlatColumns()),O(e,"debugColumns")),_getAllFlatColumnsById:H(()=>[r.getAllFlatColumns()],m=>m.reduce((f,w)=>(f[w.id]=w,f),{}),O(e,"debugColumns")),getAllLeafColumns:H(()=>[r.getAllColumns(),r._getOrderColumnsFn()],(m,f)=>{let w=m.flatMap(S=>S.getLeafColumns());return f(w)},O(e,"debugColumns")),getColumn:m=>r._getAllFlatColumnsById()[m]};Object.assign(r,p);for(let m=0;m<r._features.length;m++){const f=r._features[m];f==null||f.createTable==null||f.createTable(r)}return r}function fs(){return e=>H(()=>[e.options.data],s=>{const t={rows:[],flatRows:[],rowsById:{}},n=function(r,i,l){i===void 0&&(i=0);const a=[];for(let d=0;d<r.length;d++){const c=xr(e,e._getRowId(r[d],d,l),r[d],d,i,void 0,l==null?void 0:l.id);if(t.flatRows.push(c),t.rowsById[c.id]=c,a.push(c),e.options.getSubRows){var u;c.originalSubRows=e.options.getSubRows(r[d],d),(u=c.originalSubRows)!=null&&u.length&&(c.subRows=n(c.originalSubRows,i+1,c))}}return a};return t.rows=n(s),t},O(e.options,"debugTable","getRowModel",()=>e._autoResetPageIndex()))}function Qr(e){const s=[],t=n=>{var r;s.push(n),(r=n.subRows)!=null&&r.length&&n.getIsExpanded()&&n.subRows.forEach(t)};return e.rows.forEach(t),{rows:s,flatRows:e.flatRows,rowsById:e.rowsById}}function ms(e){return s=>H(()=>[s.getState().pagination,s.getPrePaginationRowModel(),s.options.paginateExpandedRows?void 0:s.getState().expanded],(t,n)=>{if(!n.rows.length)return n;const{pageSize:r,pageIndex:i}=t;let{rows:l,flatRows:a,rowsById:u}=n;const d=r*i,c=d+r;l=l.slice(d,c);let p;s.options.paginateExpandedRows?p={rows:l,flatRows:a,rowsById:u}:p=Qr({rows:l,flatRows:a,rowsById:u}),p.flatRows=[];const m=f=>{p.flatRows.push(f),f.subRows.length&&f.subRows.forEach(m)};return p.rows.forEach(m),p},O(s.options,"debugTable"))}function ps(){return e=>H(()=>[e.getState().sorting,e.getPreSortedRowModel()],(s,t)=>{if(!t.rows.length||!(s!=null&&s.length))return t;const n=e.getState().sorting,r=[],i=n.filter(u=>{var d;return(d=e.getColumn(u.id))==null?void 0:d.getCanSort()}),l={};i.forEach(u=>{const d=e.getColumn(u.id);d&&(l[u.id]={sortUndefined:d.columnDef.sortUndefined,invertSorting:d.columnDef.invertSorting,sortingFn:d.getSortingFn()})});const a=u=>{const d=u.map(c=>({...c}));return d.sort((c,p)=>{for(let f=0;f<i.length;f+=1){var m;const w=i[f],S=l[w.id],b=S.sortUndefined,h=(m=w==null?void 0:w.desc)!=null?m:!1;let v=0;if(b){const x=c.getValue(w.id),_=p.getValue(w.id),M=x===void 0,C=_===void 0;if(M||C){if(b==="first")return M?-1:1;if(b==="last")return M?1:-1;v=M&&C?0:M?b:-b}}if(v===0&&(v=S.sortingFn(c,p,w.id)),v!==0)return h&&(v*=-1),S.invertSorting&&(v*=-1),v}return c.index-p.index}),d.forEach(c=>{var p;r.push(c),(p=c.subRows)!=null&&p.length&&(c.subRows=a(c.subRows))}),d};return{rows:a(t.rows),flatRows:r,rowsById:t.rowsById}},O(e.options,"debugTable","getSortedRowModel",()=>e._autoResetPageIndex()))}/**
   * react-table
   *
   * Copyright (c) TanStack
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE.md file in the root directory of this source tree.
   *
   * @license MIT
   */function hs(e,s){return e?Jr(e)?y.createElement(e,s):e:null}function Jr(e){return ei(e)||typeof e=="function"||ti(e)}function ei(e){return typeof e=="function"&&(()=>{const s=Object.getPrototypeOf(e);return s.prototype&&s.prototype.isReactComponent})()}function ti(e){return typeof e=="object"&&typeof e.$$typeof=="symbol"&&["react.memo","react.forward_ref"].includes(e.$$typeof.description)}function xs(e){const s={state:{},onStateChange:()=>{},renderFallbackValue:null,...e},[t]=y.useState(()=>({current:Zr(s)})),[n,r]=y.useState(()=>t.current.initialState);return t.current.setOptions(i=>({...i,...e,state:{...n,...e.state},onStateChange:l=>{r(l),e.onStateChange==null||e.onStateChange(l)}})),t.current}function Ls({nodes:e,edges:s,onNodesChange:t,onEdgesChange:n,onBlur:r,editable:i=!1}){const[l,a]=y.useState("nodes"),[u,d]=y.useState(e),[c,p]=y.useState(s),m=y.useRef(new Map),f=y.useRef(new Map);y.useEffect(()=>{d([...e]),p([...s]),m.current.clear(),f.current.clear()},[e,s]);const w=y.useMemo(()=>{if(e.length===0)return[];const x=new Set;e.forEach(C=>{Object.keys(C).forEach(k=>{k==="_totalIncoming"||k==="_totalOutgoing"||x.add(k)})});const _=Array.from(x);return[..._.includes("id")?["id"]:[],..._.includes("label")?["label"]:[],..._.filter(C=>C!=="id"&&C!=="label")].map(C=>({header:C.charAt(0).toUpperCase()+C.slice(1).replace(/_/g," "),accessorKey:C,cell:k=>{var P;const I=k.getValue();if(i&&C!=="id"){const D=k.row.original.id,Q=u.findIndex(X=>X.id===D);if(Q===-1)return o.jsx("span",{children:"-"});const F=((P=u[Q])==null?void 0:P[C])??I,G=`${D}-${C}`;return o.jsx(Mn,{id:G,type:typeof F=="number"?"number":"text",initialValue:F==null?"":String(F),isNumber:typeof F=="number",onBlur:X=>{const ce=[...u],ue=typeof F=="number"?parseFloat(X)||0:X;ce[Q]={...ce[Q],[C]:ue},d(ce),t==null||t(ce),r==null||r()}},G)}return I==null?"-":typeof I=="number"?I.toLocaleString():String(I)}}))},[e,i]),S=y.useMemo(()=>{if(s.length===0)return[];const x=new Set;s.forEach(C=>{Object.keys(C).forEach(k=>x.add(k))});const _=Array.from(x);return[..._.includes("source")?["source"]:[],..._.includes("target")?["target"]:[],..._.includes("value")?["value"]:[],..._.filter(C=>C!=="source"&&C!=="target"&&C!=="value")].map(C=>({header:C.charAt(0).toUpperCase()+C.slice(1).replace(/_/g," "),accessorKey:C,cell:k=>{var P,Y;const I=k.getValue();if(i&&C!=="source"&&C!=="target"){const D=k.row.original,Q=c.findIndex(X=>X.source===D.source&&X.target===D.target&&X.value===D.value);if(Q===-1){const X=c.findIndex(xe=>xe.source===D.source&&xe.target===D.target);if(X===-1)return o.jsx("span",{children:"-"});const ce=((P=c[X])==null?void 0:P[C])??I,ue=`${D.source}-${D.target}-${C}-fallback`;return o.jsx(Mn,{id:ue,type:typeof ce=="number"?"number":"text",initialValue:ce==null?"":String(ce),isNumber:typeof ce=="number",onBlur:xe=>{const _e=[...c],j=typeof ce=="number"?parseFloat(xe)||0:xe;_e[X]={..._e[X],[C]:j},p(_e),n==null||n(_e),r==null||r()}},ue)}const F=((Y=c[Q])==null?void 0:Y[C])??I,G=`${D.source}-${D.target}-${C}`;return o.jsx(Mn,{id:G,type:typeof F=="number"?"number":"text",initialValue:F==null?"":String(F),isNumber:typeof F=="number",onBlur:X=>{const ce=[...c],ue=typeof F=="number"?parseFloat(X)||0:X;ce[Q]={...ce[Q],[C]:ue},p(ce),n==null||n(ce),r==null||r()}},G)}return I==null?"-":typeof I=="number"?I.toLocaleString():String(I)}}))},[s,i]),b=xs({data:i?u:e,columns:w,getCoreRowModel:fs(),getSortedRowModel:ps(),getPaginationRowModel:ms(),initialState:{pagination:{pageSize:25}}}),h=xs({data:i?c:s,columns:S,getCoreRowModel:fs(),getSortedRowModel:ps(),getPaginationRowModel:ms(),initialState:{pagination:{pageSize:25}}}),v=l==="nodes"?b:h;return o.jsxs("div",{className:"h-full w-full flex flex-col",style:{height:"100%",maxHeight:"100%"},children:[o.jsxs("div",{className:"flex border-b mb-4 flex-shrink-0",children:[o.jsxs("button",{onClick:()=>a("nodes"),className:`px-4 py-2 font-medium text-sm transition-colors ${l==="nodes"?"border-b-2 border-blue-600 text-blue-600":"text-gray-600 hover:text-gray-900"}`,children:["Nodes (",e.length,")"]}),o.jsxs("button",{onClick:()=>a("edges"),className:`px-4 py-2 font-medium text-sm transition-colors ${l==="edges"?"border-b-2 border-blue-600 text-blue-600":"text-gray-600 hover:text-gray-900"}`,children:["Edges (",s.length,")"]})]}),o.jsx("div",{className:"flex-1 flex flex-col min-h-0 overflow-hidden",children:o.jsxs("div",{className:"overflow-auto flex-1 min-h-0",children:[o.jsxs("table",{className:"min-w-full text-sm",children:[o.jsx("thead",{className:"bg-gray-50 border-b sticky top-0 z-10",children:v.getHeaderGroups().map(x=>o.jsx("tr",{children:x.headers.map(_=>o.jsx("th",{className:"px-4 py-2 text-left font-semibold text-gray-700 bg-gray-50",children:_.isPlaceholder?null:o.jsxs("div",{className:_.column.getCanSort()?"cursor-pointer select-none hover:text-blue-600":"",onClick:_.column.getToggleSortingHandler(),children:[hs(_.column.columnDef.header,_.getContext()),{asc:" ↑",desc:" ↓"}[_.column.getIsSorted()]??null]})},_.id))},x.id))}),o.jsx("tbody",{className:"divide-y divide-gray-200 bg-white",children:v.getRowModel().rows.map(x=>o.jsx("tr",{className:"hover:bg-gray-50",children:x.getVisibleCells().map(_=>o.jsx("td",{className:"px-4 py-2",children:hs(_.column.columnDef.cell,_.getContext())},_.id))},x.id))})]}),v.getRowModel().rows.length===0&&o.jsxs("div",{className:"text-center text-gray-500 py-8",children:["No ",l," to display"]})]})}),o.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-t border-gray-200 bg-white flex-shrink-0",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("span",{className:"text-sm text-gray-700",children:"Show"}),o.jsx("select",{value:v.getState().pagination.pageSize,onChange:x=>{v.setPageSize(Number(x.target.value))},className:"border border-gray-300 rounded px-2 py-1 text-sm",children:[10,25,50,100].map(x=>o.jsx("option",{value:x,children:x},x))}),o.jsx("span",{className:"text-sm text-gray-700",children:"entries"})]}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsxs("span",{className:"text-sm text-gray-700",children:["Page ",v.getState().pagination.pageIndex+1," of"," ",v.getPageCount()]}),o.jsxs("div",{className:"flex gap-1",children:[o.jsx("button",{onClick:()=>v.setPageIndex(0),disabled:!v.getCanPreviousPage(),className:"px-2 py-1 text-sm border border-gray-300 rounded disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-50",children:"<<"}),o.jsx("button",{onClick:()=>v.previousPage(),disabled:!v.getCanPreviousPage(),className:"px-2 py-1 text-sm border border-gray-300 rounded disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-50",children:"<"}),o.jsx("button",{onClick:()=>v.nextPage(),disabled:!v.getCanNextPage(),className:"px-2 py-1 text-sm border border-gray-300 rounded disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-50",children:">"}),o.jsx("button",{onClick:()=>v.setPageIndex(v.getPageCount()-1),disabled:!v.getCanNextPage(),className:"px-2 py-1 text-sm border border-gray-300 rounded disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-50",children:">>"})]})]})]})]})}function Mn({id:e,type:s,initialValue:t,onBlur:n}){const r=y.useRef(null),[i,l]=y.useState(t);return y.useEffect(()=>{r.current&&document.activeElement!==r.current&&l(t)},[t]),o.jsx("input",{ref:r,id:e,type:s,value:i,onChange:a=>{l(a.target.value)},onBlur:a=>{n(a.target.value)},className:"w-full px-2 py-1 border border-gray-300 rounded text-sm focus:outline-none focus:ring-2 focus:ring-blue-500",autoComplete:"off"})}function ni({dataset:e,onClose:s,onSave:t,onDelete:n,onDuplicate:r}){const[i,l]=y.useState(e.name),[a,u]=y.useState(e.notes||""),[d,c]=y.useState(!1),[p,m]=y.useState(!1),[f,w]=y.useState(!1),[S,b]=y.useState("info"),[h,v]=y.useState(null),x=e.snapshots[0]||{timestamp:e.timeRange.start,nodes:[],edges:[]};y.useEffect(()=>{l(e.name),u(e.notes||""),v(null)},[e]);async function _(){c(!0);try{const I={...e,name:i.trim(),notes:a.trim()||void 0};if(h){I.snapshots=h.snapshots;const P=I.snapshots[0]||x;I.metadata=Rt(P)}await t(I),s()}catch(I){console.error("Save error:",I),alert("Failed to save dataset: "+(I instanceof Error?I.message:"Unknown error"))}finally{c(!1)}}async function M(){m(!0);try{await n(),s()}catch(I){console.error("Delete error:",I),alert("Failed to delete dataset: "+(I instanceof Error?I.message:"Unknown error"))}finally{m(!1),w(!1)}}function C(I,P){const Y={...x,nodes:I,edges:P};v({...e,snapshots:[Y]})}const k=i!==e.name||a!==(e.notes||"")||h!==null;return o.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:o.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-6xl w-full mx-4 max-h-[90vh] flex flex-col",children:[o.jsxs("div",{className:"p-6 border-b flex items-center justify-between",children:[o.jsx("h2",{className:"text-2xl font-bold",children:"Edit Dataset"}),o.jsx("button",{onClick:s,type:"button",className:"text-gray-400 hover:text-gray-600 text-2xl cursor-pointer transition-colors",children:"×"})]}),o.jsxs("div",{className:"border-b flex",children:[o.jsx("button",{onClick:()=>b("info"),type:"button",className:`px-6 py-3 font-medium cursor-pointer transition-colors ${S==="info"?"border-b-2 border-blue-600 text-blue-600":"text-gray-600 hover:text-gray-900"}`,children:"Information"}),o.jsxs("button",{onClick:()=>b("data"),type:"button",className:`px-6 py-3 font-medium cursor-pointer transition-colors ${S==="data"?"border-b-2 border-blue-600 text-blue-600":"text-gray-600 hover:text-gray-900"}`,children:["Data (",x.nodes.length," nodes, ",x.edges.length," edges)"]})]}),o.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:S==="info"?o.jsxs("div",{className:"space-y-6 max-w-2xl",children:[o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Dataset Name ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsx("input",{type:"text",value:i,onChange:I=>l(I.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Enter a name for this dataset"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Notes"}),o.jsx("textarea",{value:a,onChange:I=>u(I.target.value),rows:5,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Add any notes about this dataset..."})]}),o.jsxs("div",{className:"bg-gray-50 p-4 rounded",children:[o.jsx("h3",{className:"font-medium text-gray-700 mb-2",children:"Dataset Information"}),o.jsxs("div",{className:"text-sm text-gray-600 space-y-1",children:[o.jsxs("div",{children:[o.jsx("span",{className:"font-medium",children:"Type:"})," ",e.type.toUpperCase()]}),o.jsxs("div",{children:[o.jsx("span",{className:"font-medium",children:"Time Range:"})," ",e.timeRange.start,e.timeRange.end!==e.timeRange.start?` – ${e.timeRange.end}`:""]}),o.jsxs("div",{children:[o.jsx("span",{className:"font-medium",children:"Snapshots:"})," ",e.snapshots.length]}),e.filename&&o.jsxs("div",{children:[o.jsx("span",{className:"font-medium",children:"Original File:"})," ",e.filename]}),o.jsxs("div",{children:[o.jsx("span",{className:"font-medium",children:"Created:"})," ",new Date(e.createdAt).toLocaleDateString()]})]})]}),o.jsxs("div",{className:"border-t pt-4 space-y-3",children:[o.jsx("button",{onClick:r,type:"button",className:"w-full px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50 cursor-pointer transition-colors",children:"Duplicate Dataset"}),o.jsx("button",{onClick:()=>w(!0),type:"button",className:"w-full px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 cursor-pointer transition-colors",children:"Delete Dataset"})]})]}):o.jsx("div",{className:"h-full",children:o.jsx(si,{nodes:x.nodes,edges:x.edges,onUpdate:C})})}),o.jsxs("div",{className:"p-6 border-t flex justify-end gap-3",children:[o.jsx("button",{onClick:s,type:"button",disabled:d||p,className:"px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50 disabled:opacity-50 cursor-pointer transition-colors",children:"Cancel"}),o.jsx("button",{onClick:_,type:"button",disabled:d||p||!k&&S==="info"||!i.trim(),className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed cursor-pointer transition-colors",children:d?"Saving...":h?"Save All Changes":"Save Changes"})]}),f&&o.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-60",children:o.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md mx-4",children:[o.jsx("h3",{className:"text-lg font-bold mb-2",children:"Delete Dataset?"}),o.jsxs("p",{className:"text-gray-600 mb-4",children:['Are you sure you want to delete "',e.name,'"? This action cannot be undone.']}),o.jsxs("div",{className:"flex justify-end gap-3",children:[o.jsx("button",{onClick:()=>w(!1),type:"button",disabled:p,className:"px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50 cursor-pointer transition-colors",children:"Cancel"}),o.jsx("button",{onClick:M,type:"button",disabled:p,className:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 disabled:opacity-50 cursor-pointer transition-colors",children:p?"Deleting...":"Delete"})]})]})})]})})}function si({nodes:e,edges:s,onUpdate:t}){const[n,r]=y.useState(e),[i,l]=y.useState(s);y.useEffect(()=>{r([...e]),l([...s])},[e,s]);const a=y.useRef(n),u=y.useRef(i);y.useEffect(()=>{a.current=n,u.current=i},[n,i]);const d=y.useCallback(f=>{r(f),a.current=f},[]),c=y.useCallback(f=>{l(f),u.current=f},[]),p=y.useRef(!1),m=y.useCallback(()=>{p.current&&(t(a.current,u.current),p.current=!1)},[t]);return o.jsx("div",{className:"h-full",children:o.jsx(Ls,{nodes:n,edges:i,onNodesChange:f=>{d(f),p.current=!0},onEdgesChange:f=>{c(f),p.current=!0},onBlur:m,editable:!0})})}class ft extends y.Component{constructor(s){super(s),this.state={hasError:!1,error:null}}static getDerivedStateFromError(s){return{hasError:!0,error:s}}componentDidCatch(s,t){var n,r;console.error("ErrorBoundary caught an error:",s,t),(r=(n=this.props).onError)==null||r.call(n,s,t)}render(){var s;return this.state.hasError?this.props.fallback?this.props.fallback:o.jsxs("div",{className:"p-4 bg-red-50 border border-red-200 rounded-md",children:[o.jsx("h3",{className:"text-lg font-semibold text-red-800 mb-2",children:"Something went wrong"}),o.jsx("p",{className:"text-sm text-red-700 mb-2",children:((s=this.state.error)==null?void 0:s.message)||"An error occurred"}),o.jsx("button",{onClick:()=>this.setState({hasError:!1,error:null}),className:"px-3 py-1 bg-red-600 text-white text-sm rounded hover:bg-red-700 cursor-pointer transition-colors",children:"Try again"})]}):this.props.children}}function oi({selectedId:e,onSelect:s,onRefresh:t}){const[n,r]=y.useState([]),[i,l]=y.useState(!1),[a,u]=y.useState(null),[d,c]=y.useState(!1),[p,m]=y.useState(null),f=y.useRef(null);y.useEffect(()=>{w()},[]);async function w(){const M=await ar();r(M)}async function S(M,C){try{const I=`${M.type||"csv"}-${Date.now()}`,P={...M,id:I,snapshots:C.snapshots,metadata:C.metadata,createdAt:Date.now()};await mt(P),await w(),l(!1),m(null),s(I)}catch(k){throw console.error("Import error:",k),k}finally{f.current&&(f.current.value="")}}async function b(M,C){C.stopPropagation();const k=await pt(M);k&&u(k)}async function h(M){await mt(M),await w(),e===M.id&&(t==null||t())}async function v(){a&&(await Pn(a.id),await w(),e===a.id&&s(""),u(null))}async function x(){if(!a)return;const M=await lr(a.id);await w(),u(null),s(M.id)}async function _(){await ur(),await w(),c(!1),s(""),window.location.reload()}return o.jsxs("aside",{className:"h-full overflow-y-auto flex flex-col",children:[o.jsxs("div",{className:"p-4 border-b",children:[o.jsx("h2",{className:"text-lg font-bold",children:"Datasets"}),o.jsx("p",{className:"text-xs text-gray-500",children:"Stored in your browser"}),o.jsx("button",{onClick:()=>l(!0),className:"mt-3 w-full px-3 py-2 bg-blue-600 text-white text-sm rounded hover:bg-blue-700",children:"Import Dataset"}),o.jsx("input",{ref:f,type:"file",accept:".csv,.gexf",multiple:!0,className:"hidden"}),i&&o.jsx(ft,{fallback:o.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:o.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md mx-4",children:[o.jsx("h3",{className:"text-lg font-bold text-red-800 mb-2",children:"Import Panel Error"}),o.jsx("p",{className:"text-gray-600 mb-4",children:"The import panel encountered an error."}),o.jsx("button",{onClick:()=>l(!1),className:"px-4 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-700 cursor-pointer transition-colors",children:"Close"})]})}),children:o.jsx(dr,{onClose:()=>{l(!1),m(null),f.current&&(f.current.value="")},onImport:S,fileInputRef:f,onFilesSelected:m,existingFile:p})})]}),o.jsxs("ul",{className:"divide-y flex-1 overflow-y-auto",children:[n.map(M=>o.jsx("li",{children:o.jsxs("div",{className:`flex items-center group ${e===M.id?"bg-blue-50":""}`,children:[o.jsxs("button",{className:"flex-1 text-left p-3 hover:bg-gray-50",onClick:()=>s(M.id),children:[o.jsx("div",{className:"flex items-center justify-between",children:o.jsxs("div",{children:[o.jsx("div",{className:"font-medium",children:M.name}),o.jsxs("div",{className:"text-xs text-gray-500",children:[M.type.toUpperCase()," · ",M.timeRange.start,M.timeRange.end!==M.timeRange.start?`–${M.timeRange.end}`:""]})]})}),M.notes&&o.jsx("div",{className:"text-xs text-gray-600 mt-1 line-clamp-2",children:M.notes})]}),o.jsx("button",{onClick:C=>b(M.id,C),className:"px-2 py-1 text-gray-400 hover:text-blue-600 hover:bg-gray-100 rounded transition-all mr-2 cursor-pointer",title:"Edit dataset",type:"button",children:o.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})})})]})},M.id)),n.length===0&&o.jsx("li",{className:"p-3 text-sm text-gray-500",children:"No datasets yet"})]}),o.jsxs("div",{className:"p-4 border-t",children:[o.jsx("button",{onClick:()=>c(!0),type:"button",className:"w-full px-3 py-2 bg-red-600 text-white text-sm rounded hover:bg-red-700 cursor-pointer transition-colors",children:"Reset All Data"}),o.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"Delete all datasets and reload defaults"})]}),a&&o.jsx(ft,{fallback:o.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:o.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md mx-4",children:[o.jsx("h3",{className:"text-lg font-bold text-red-800 mb-2",children:"Edit Panel Error"}),o.jsx("p",{className:"text-gray-600 mb-4",children:"The edit panel encountered an error."}),o.jsx("button",{onClick:()=>u(null),className:"px-4 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-700 cursor-pointer transition-colors",children:"Close"})]})}),children:o.jsx(ni,{dataset:a,onClose:()=>u(null),onSave:h,onDelete:v,onDuplicate:x})}),d&&o.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-60",children:o.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md mx-4",children:[o.jsx("h3",{className:"text-lg font-bold mb-2",children:"Reset All Data?"}),o.jsx("p",{className:"text-gray-600 mb-4",children:"This will delete all datasets and reload the default test data. This action cannot be undone."}),o.jsxs("div",{className:"flex justify-end gap-3",children:[o.jsx("button",{onClick:()=>c(!1),type:"button",className:"px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50 cursor-pointer transition-colors",children:"Cancel"}),o.jsx("button",{onClick:_,type:"button",className:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 cursor-pointer transition-colors",children:"Reset All Data"})]})]})})]})}function ri({nodes:e,edges:s,width:t=1200,height:n=800}){const r=y.useRef(null),[i,l]=y.useState(null),[a,u]=y.useState(null);return y.useEffect(()=>{var xe,_e;if(!r.current||s.length===0||e.length===0){r.current&&$e(r.current).selectAll("*").remove();return}$e(r.current).selectAll("*").remove();const d=new Map;e.forEach(j=>{d.set(j.id,{id:j.id,label:j.label||j.id,outgoing:0,incoming:0})}),s.forEach(j=>{const L=d.get(j.source),me=d.get(j.target);L&&(L.outgoing+=j.value),me&&(me.incoming+=j.value)});const c=Array.from(d.values()).filter(j=>j.outgoing>0||j.incoming>0);if(c.length===0){$e(r.current).append("text").attr("x",t/2).attr("y",n/2).attr("text-anchor","middle").attr("font-size","14px").attr("fill","#666").text("No active nodes with flows");return}c.sort((j,L)=>L.outgoing+L.incoming-(j.outgoing+j.incoming));const p=50,m=t-50,f=20,w=15,S=2,b=5,h=c.reduce((j,L)=>j+L.outgoing,0),v=c.reduce((j,L)=>j+L.incoming,0),x=Math.max(n-2*f,400);let _=f;c.forEach(j=>{const L=h>0?Math.max(b,j.outgoing/h*x):Math.max(b,x/c.length);_+=L+S});let M=f;c.forEach(j=>{const L=v>0?Math.max(b,j.incoming/v*x):Math.max(b,x/c.length);M+=L+S});const C=Math.max(n,Math.max(_,M)+100),k=C-2*f,I=$e(r.current).attr("width",t).attr("height",C).style("font","12px sans-serif");let P=f;const Y=c.map((j,L)=>{const me=h>0?Math.max(b,j.outgoing/h*k):Math.max(b,k/c.length),Ve=P;return P+=me+S,{node:j,x:p,y:Ve,height:Math.max(b,me-S),side:"left",index:L}});P=f;const D=c.map((j,L)=>{const me=v>0?Math.max(b,j.incoming/v*k):Math.max(b,k/c.length),Ve=P;return P+=me+S,{node:j,x:m,y:Ve,height:Math.max(b,me-S),side:"right",index:L}});let Q=[];i&&a&&(a==="left"?Q=s.filter(j=>j.source===i&&j.source!==j.target):Q=s.filter(j=>j.target===i&&j.source!==j.target));const F=Ss(Rs);if(Q.length>0){const j=Q.map(U=>{const be=Y.find(He=>He.node.id===U.source),Z=D.find(He=>He.node.id===U.target);if(!be||!Z)return null;const Ee=be.y+be.height/2,ke=Z.y+Z.height/2;return{edge:U,sourceX:be.x+w,sourceY:Ee,targetX:Z.x,targetY:ke,value:U.value,leftIndex:be.index,rightIndex:Z.index}}).filter(U=>U!==null),L=Math.max(...j.map(U=>U.value),1),me=2,Ve=20,ze=I.append("g").attr("class","links");j.forEach(U=>{const be=me+U.value/L*(Ve-me),Z=`gradient-${U.leftIndex}-${U.rightIndex}`,Ee=I.append("defs").append("linearGradient").attr("id",Z).attr("gradientUnits","userSpaceOnUse").attr("x1",U.sourceX).attr("x2",U.targetX).attr("y1",U.sourceY).attr("y2",U.targetY);Ee.append("stop").attr("offset","0%").attr("stop-color",F(String(U.leftIndex))).attr("stop-opacity",.6),Ee.append("stop").attr("offset","100%").attr("stop-color",F(String(U.rightIndex))).attr("stop-opacity",.6);const ke=Hn(),He=(U.sourceX+U.targetX)/2;ke.moveTo(U.sourceX,U.sourceY),ke.bezierCurveTo(He,U.sourceY,He,U.targetY,U.targetX,U.targetY),ze.append("path").attr("d",ke.toString()).attr("stroke",`url(#${Z})`).attr("stroke-width",be).attr("fill","none").attr("stroke-opacity",.6).style("cursor","pointer").on("mouseover",function(Oe){$e(this).attr("stroke-opacity",1).attr("stroke-width",be+2),$e("body").append("div").attr("class","tooltip").style("position","absolute").style("background","rgba(0, 0, 0, 0.8)").style("color","white").style("padding","8px").style("border-radius","4px").style("pointer-events","none").style("opacity",0).html(`${U.edge.source} → ${U.edge.target}<br/>${U.value.toLocaleString()}`).style("opacity",1)}).on("mousemove",function(Oe){$e(".tooltip").style("left",`${Oe.pageX+10}px`).style("top",`${Oe.pageY-10}px`)}).on("mouseout",function(){$e(this).attr("stroke-opacity",.6).attr("stroke-width",be),$e(".tooltip").remove()})})}const X=I.append("g").attr("class","left-nodes").selectAll("g.node").data(Y).join("g").attr("class","node").attr("transform",j=>`translate(${j.x}, ${j.y})`).style("cursor","pointer").on("click",function(j,L){j.stopPropagation(),i===L.node.id&&a==="left"?(l(null),u(null)):(l(L.node.id),u("left"))});X.append("rect").attr("width",w).attr("height",j=>j.height).attr("fill",(j,L)=>F(String(L))).attr("stroke",(j,L)=>Mt(F(String(L))).darker().formatHex()).attr("stroke-width",j=>i===j.node.id&&a==="left"?3:1).attr("opacity",j=>i&&a==="left"&&i!==j.node.id?.3:1).on("mouseover",function(j,L){$e(this).attr("fill",Mt(F(String(L.index))).brighter(.5).formatHex())}).on("mouseout",function(j,L){$e(this).attr("fill",F(String(L.index)))}),X.append("text").attr("x",w+6).attr("y",j=>j.height/2).attr("dy","0.35em").attr("text-anchor","start").text(j=>`${j.node.label} (${j.node.outgoing.toLocaleString()})`).style("font-size","11px").style("font-weight","500").style("fill","#333").attr("opacity",j=>i&&a==="left"&&i!==j.node.id?.3:1);const ue=I.append("g").attr("class","right-nodes").selectAll("g.node").data(D).join("g").attr("class","node").attr("transform",j=>`translate(${j.x}, ${j.y})`).style("cursor","pointer").on("click",function(j,L){j.stopPropagation(),i===L.node.id&&a==="right"?(l(null),u(null)):(l(L.node.id),u("right"))});ue.append("rect").attr("x",-w).attr("width",w).attr("height",j=>j.height).attr("fill",(j,L)=>F(String(L))).attr("stroke",(j,L)=>Mt(F(String(L))).darker().formatHex()).attr("stroke-width",j=>i===j.node.id&&a==="right"?3:1).attr("opacity",j=>i&&a==="right"&&i!==j.node.id?.3:1).on("mouseover",function(j,L){$e(this).attr("fill",Mt(F(String(L.index))).brighter(.5).formatHex())}).on("mouseout",function(j,L){$e(this).attr("fill",F(String(L.index)))}),ue.append("text").attr("x",-w-6).attr("y",j=>j.height/2).attr("dy","0.35em").attr("text-anchor","end").text(j=>`${j.node.label} (${j.node.incoming.toLocaleString()})`).style("font-size","11px").style("font-weight","500").style("fill","#333").attr("opacity",j=>i&&a==="right"&&i!==j.node.id?.3:1),i?I.append("text").attr("x",t/2).attr("y",20).attr("text-anchor","middle").attr("font-size","14px").attr("fill","#333").text(a==="left"?`Showing outgoing flows from ${(xe=Y.find(j=>j.node.id===i))==null?void 0:xe.node.label}`:`Showing incoming flows to ${(_e=D.find(j=>j.node.id===i))==null?void 0:_e.node.label}`):I.append("text").attr("x",t/2).attr("y",20).attr("text-anchor","middle").attr("font-size","14px").attr("fill","#666").text("Click a node to see its connections"),I.append("text").attr("x",p+w/2).attr("y",C-10).attr("text-anchor","middle").attr("font-size","12px").attr("font-weight","bold").attr("fill","#333").text("Outgoing"),I.append("text").attr("x",m-w/2).attr("y",C-10).attr("text-anchor","middle").attr("font-size","12px").attr("font-weight","bold").attr("fill","#333").text("Incoming"),I.on("click",function(j){(j.target===r.current||j.target.tagName==="svg")&&(l(null),u(null))})},[e,s,t,n,i,a]),o.jsxs("div",{className:"w-full h-full flex flex-col min-h-0",children:[o.jsxs("div",{className:"text-center text-xs text-gray-500 mb-2 flex-shrink-0",children:["Interaction design inspired by"," ",o.jsx("a",{href:"https://peoplemov.in/#f_AF",target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-800 underline",children:"peoplemov.in by Carlo Zapponi"})]}),o.jsx("div",{className:"flex-1 overflow-auto min-h-0",children:o.jsx("svg",{ref:r,className:"border border-gray-200 rounded bg-white"})})]})}function ii(e,s){const t=e.length,n=new Map;e.forEach((l,a)=>{n.set(l.id,a)});const r=Array(t).fill(null).map(()=>Array(t).fill(0));s.forEach(l=>{const a=n.get(l.source),u=n.get(l.target);a!==void 0&&u!==void 0&&(r[a][u]+=l.value)});const i=e.map(l=>l.label||l.id);return{matrix:r,labels:i,nodes:e}}function ai(e,s,t){return!t||t==="all"?e:e.filter(n=>{const r=n[s];return Array.isArray(r)?r.includes(t):r===t})}function li(e,s){const t=new Set;return e.forEach(n=>{const r=n[s];r!=null&&(Array.isArray(r)?r.forEach(i=>t.add(i)):t.add(r))}),Array.from(t).sort((n,r)=>typeof n=="number"&&typeof r=="number"?n-r:String(n).localeCompare(String(r)))}function ui({nodes:e,edges:s,width:t=1e3,height:n=800}){const r=y.useRef(null);return y.useEffect(()=>{if(!r.current||s.length===0||e.length===0){r.current&&$e(r.current).selectAll("*").remove();return}$e(r.current).selectAll("*").remove();const i=ii(e,s),l=$e(r.current).attr("width","100%").attr("height","100%").attr("viewBox",`0 0 ${t} ${n}`).attr("preserveAspectRatio","xMidYMid meet"),a=Math.min(t,n)*.5-40,u=a-20,d=qs().scaleExtent([.1,4]).on("zoom",function(v){S.attr("transform",v.transform.toString())});l.call(d);const c=l.append("g").attr("class","reset-button").style("cursor","pointer").attr("transform",`translate(${t-120}, 10)`).on("click",function(){l.transition().duration(750).call(d.transform,Ws)});c.append("rect").attr("width",110).attr("height",30).attr("rx",4).attr("fill","white").attr("stroke","#ccc").attr("stroke-width",1),c.append("text").attr("x",55).attr("y",20).attr("text-anchor","middle").attr("font-size","12px").attr("fill","#333").text("Reset View");const m=fo().padAngle(.05).sortSubgroups(co)(i.matrix),f=Co().radius(u),w=Ss(Rs),S=l.append("g").attr("class","zoom-group"),b=S.append("g").attr("transform",`translate(${t/2}, ${n/2})`),h=b.append("g").selectAll("g").data(m.groups).join("g");h.append("path").attr("fill",v=>w(String(v.index))).attr("stroke",v=>Mt(w(String(v.index))).darker().formatHex()).attr("d",ko().innerRadius(u).outerRadius(a)).on("mouseover",function(v,x){$e(this).attr("fill",Mt(w(String(x.index))).brighter(1).formatHex()),b.selectAll("path.chord").style("opacity",_=>_.source.index===x.index||_.target.index===x.index?1:.2)}).on("mouseout",function(){$e(this).attr("fill",v=>w(String(v.index))),b.selectAll("path.chord").style("opacity",1)}),h.append("text").attr("dy",".35em").attr("transform",v=>`
        rotate(${(v.startAngle+v.endAngle)/2*180/Math.PI-90})
        translate(${a+10})
        ${(v.startAngle+v.endAngle)/2>Math.PI?"rotate(180)":""}
      `).attr("text-anchor",v=>(v.startAngle+v.endAngle)/2>Math.PI?"end":"start").text(v=>i.labels[v.index]).style("font-size","12px").style("font-weight","500"),b.append("g").attr("fill-opacity",.67).selectAll("path").data(m).join("path").attr("class","chord").attr("d",v=>f(v)??"").attr("fill",v=>w(String(v.source.index))).attr("stroke",v=>Mt(w(String(v.source.index))).darker().formatHex()).style("stroke-width","1px").on("mouseover",function(v,x){$e(this).attr("fill-opacity",1).style("stroke-width","2px"),$e("body").append("div").attr("class","tooltip").style("position","absolute").style("background","rgba(0, 0, 0, 0.8)").style("color","white").style("padding","8px").style("border-radius","4px").style("pointer-events","none").style("opacity",0).style("transition","opacity 0.2s").html(`${i.labels[x.source.index]} → ${i.labels[x.target.index]}: ${x.source.value.toLocaleString()}`).style("opacity",1)}).on("mousemove",function(v){$e(".tooltip").style("left",`${v.pageX+10}px`).style("top",`${v.pageY-10}px`)}).on("mouseout",function(){$e(this).attr("fill-opacity",.67).style("stroke-width","1px"),$e(".tooltip").remove()})},[e,s,t,n]),o.jsx("div",{className:"w-full h-full",children:o.jsx("svg",{ref:r,className:"border border-gray-200 rounded bg-white"})})}const ci=200,di=600,gi=384,vs=4;function fi({isCollapsed:e,onToggle:s,onResize:t,children:n,title:r="Settings",bottomContent:i}){const[l,a]=y.useState(gi),[u,d]=y.useState(!1),c=y.useRef(null),p=y.useRef(null);return y.useEffect(()=>{if(!u)return;const m=w=>{var S;if(!e&&((S=c.current)==null?void 0:S.getBoundingClientRect())){const h=Math.max(ci,Math.min(di,window.innerWidth-w.clientX));a(h),t==null||t(h)}},f=()=>{d(!1)};return document.addEventListener("mousemove",m),document.addEventListener("mouseup",f),()=>{document.removeEventListener("mousemove",m),document.removeEventListener("mouseup",f)}},[u,e,t]),o.jsxs("div",{ref:c,className:"bg-white border-l border-gray-200 flex flex-col transition-all duration-300  overflow-hidden relative",style:{minHeight:"100vh",width:e?`${vs}px`:`${l}px`},children:[e&&o.jsxs(o.Fragment,{children:[o.jsx("div",{onClick:s,className:"w-full h-full bg-gray-100 hover:bg-blue-400 cursor-pointer transition-colors",style:{width:`${vs}px`},title:"Click to expand settings"}),o.jsx("button",{onClick:s,className:"fixed bottom-4 right-4 z-50 p-3 bg-blue-600 hover:bg-blue-700 text-white rounded-full shadow-lg cursor-pointer transition-all hover:scale-110 flex items-center justify-center",style:{width:"48px",height:"48px"},title:"Open visualization settings","aria-label":"Open visualization settings",children:o.jsx(ts,{className:"w-5 h-5"})})]}),!e&&o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:n}),i&&o.jsx("div",{className:"flex-shrink-0 border-t border-gray-200 bg-white",children:i}),o.jsxs("button",{onClick:s,className:"w-full flex items-center justify-between p-2 border-t border-gray-200 flex-shrink-0 bg-gray-50 hover:bg-gray-100 transition-colors cursor-pointer","aria-label":"Collapse settings",children:[o.jsxs("div",{className:"flex items-center gap-2 flex-1",children:[o.jsx(ts,{className:"w-4 h-4 text-gray-600"}),o.jsx("span",{className:"text-sm font-medium text-gray-700",children:r})]}),o.jsx(Ks,{className:"w-4 h-4 text-gray-600 flex-shrink-0"})]}),o.jsx("div",{ref:p,onMouseDown:m=>{m.preventDefault(),d(!0)},className:"absolute top-0 left-0 w-1 h-full cursor-col-resize hover:bg-blue-400 bg-gray-300 transition-colors z-10",style:{touchAction:"none"},children:o.jsx("div",{className:"absolute top-1/2 left-0 transform -translate-y-1/2 -translate-x-0.5",children:o.jsx(Ys,{className:"w-3 h-6 text-gray-500"})})})]})]})}const Ts=["Alabama","Alaska","Arizona","Arkansas","California","Colorado","Connecticut","Delaware","District of Columbia","Florida","Georgia","Hawaii","Idaho","Illinois","Indiana","Iowa","Kansas","Kentucky","Louisiana","Maine","Maryland","Massachusetts","Michigan","Minnesota","Mississippi","Missouri","Montana","Nebraska","Nevada","New Hampshire","New Jersey","New Mexico","New York","North Carolina","North Dakota","Ohio","Oklahoma","Oregon","Pennsylvania","Rhode Island","South Carolina","South Dakota","Tennessee","Texas","Utah","Vermont","Virginia","Washington","West Virginia","Wisconsin","Wyoming"],mi=new Set(Ts),pi=Ts.length,ys=oo.reduce((e,s)=>(e[s]=s===2020?"ACS 1-year state-to-state migration flows for 2020 were not released by the Census Bureau due to pandemic-related data quality concerns.":"State-to-state migration data is unavailable for this year in the ACS 1-year series.",e),{});function Dt({title:e,subtitle:s,children:t,defaultOpen:n=!1,onReset:r}){const[i,l]=y.useState(n);return o.jsxs("div",{className:"border border-gray-200 rounded-md",children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("button",{onClick:()=>l(!i),className:"flex-1 flex items-center justify-between p-3 hover:bg-gray-50 transition-colors text-left",children:[o.jsxs("div",{className:"flex-1",children:[o.jsx("div",{className:"font-semibold text-sm",children:e}),s&&o.jsx("div",{className:"text-xs text-gray-600 mt-0.5",children:s})]}),i?o.jsx(lo,{className:"w-4 h-4 text-gray-600 flex-shrink-0"}):o.jsx(io,{className:"w-4 h-4 text-gray-600 flex-shrink-0"})]}),r&&o.jsx("button",{type:"button",onClick:a=>{a.stopPropagation(),r()},className:"pr-3 text-[11px] font-medium text-blue-600 hover:text-blue-800 transition-colors",children:"Reset"})]}),i&&o.jsx("div",{className:"p-3 pt-0 border-t border-gray-200",children:t})]})}const bs=_s(["kriskogram","table","sankey","chord"]),on=e=>{const s=e!==void 0?Fn().default(e):Fn().optional();return Nt(t=>{if(t==null||t==="")return e;const n=typeof t=="string"?parseFloat(t):Number(t);return Number.isNaN(n)?e:n},s)},ws=e=>Nt(s=>{if(typeof s=="boolean")return s;if(typeof s=="string"){if(s.toLowerCase()==="true")return!0;if(s.toLowerCase()==="false")return!1}return e},to().default(e));eo({dataset:pn().optional(),view:Nt(e=>typeof e=="string"&&bs.safeParse(e).success?e:"kriskogram",bs.default("kriskogram")),year:on(void 0),minThreshold:on(0),maxThreshold:on(2e5),maxEdges:on(500),edgeWeightScale:Nt(e=>{if(typeof e!="string")return"linear";const s=e.toLowerCase();return["linear","sqrt","log"].includes(s)?s:"linear"},_s(["linear","sqrt","log"]).default("linear")),egoNodeId:Nt(e=>e==null||e===""||e==="null"?null:typeof e=="string"?e:void 0,pn().nullable().optional()),egoNeighborSteps:Nt(e=>{if(e==null||e==="")return 1;const s=typeof e=="string"?parseInt(e,10):Number(e);return Number.isNaN(s)||s<1?1:Math.max(1,Math.round(s))},Fn().min(1).default(1)),egoStepColoring:ws(!1),edgeType:Nt(e=>e==="null"||e===""?null:typeof e=="string"?e:void 0,pn().nullable().optional()),showAllNodes:ws(!1)});function wi(){const e=Xs({from:"/explorer"}),s=Zs(),{leftSidebarCollapsed:t,leftSidebarWidth:n,setSidebarContent:r}=Qs(),[i,l]=y.useState(e.dataset),[a,u]=y.useState(void 0),[d,c]=y.useState(e.year),[p,m]=y.useState(!1),[f,w]=y.useState(null),[S,b]=y.useState(0),[h,v]=y.useState(e.minThreshold??0),[x,_]=y.useState(e.maxThreshold??2e5),[M,C]=y.useState(e.maxEdges??500),[k,I]=y.useState(e.edgeType??null),[P,Y]=y.useState(e.view),[D,Q]=y.useState(e.showAllNodes??!1),[F,G]=y.useState(e.egoNodeId??null),[X,ce]=y.useState(e.egoNeighborSteps??1),[ue,xe]=y.useState(e.egoStepColoring??!1),[_e,j]=y.useState(e.edgeWeightScale??"linear"),L=y.useRef(null),[me,Ve]=y.useState(!1),[ze,U]=y.useState(384),[be,Z]=y.useState({width:typeof window<"u"?window.innerWidth:1200,height:typeof window<"u"?window.innerHeight:800});y.useEffect(()=>(r(o.jsx(ft,{fallback:o.jsxs("div",{className:"p-4",children:[o.jsx("h2",{className:"text-lg font-bold text-red-800 mb-2",children:"Dataset Sidebar Error"}),o.jsx("p",{className:"text-sm text-red-700",children:"The dataset sidebar encountered an error."})]}),children:o.jsx(oi,{selectedId:i,onSelect:g=>{l(g),pe({dataset:g})},onRefresh:()=>b(g=>g+1)})})),()=>{r(null)}),[i,S]),y.useEffect(()=>{if(typeof window>"u")return;const g=()=>{Z({width:window.innerWidth,height:window.innerHeight})};return g(),window.addEventListener("resize",g),()=>window.removeEventListener("resize",g)},[]),y.useEffect(()=>{typeof window<"u"&&setTimeout(()=>{Z({width:window.innerWidth,height:window.innerHeight})},100)},[t,me,n,ze]);const[Ee,ke]=y.useState("alphabetical"),[He,Oe]=y.useState(.85),[st,Ft]=y.useState("weight"),[vt,Tt]=y.useState(!1),[ge,N]=y.useState("direction"),[$,z]=y.useState(null),[ee,K]=y.useState("weight"),[se,de]=y.useState(null),[Je,it]=y.useState(.6),[ot,Re]=y.useState(!0),[we,Bn]=y.useState("none"),[zt,qn]=y.useState(2),[ln,Wn]=y.useState("single"),[$t,Kn]=y.useState(null),[We,Yn]=y.useState("fixed"),[qt,Xn]=y.useState(null),[ct,Wt]=y.useState("pan"),[Kt,un]=y.useState(80),[Zn,Qn]=y.useState({x:0,y:0}),pe=y.useMemo(()=>g=>{s({to:"/explorer",search:R=>({view:R.view??"kriskogram",...R,...g}),replace:!0})},[s]),zs=y.useMemo(()=>a&&a.timeRange.start!==a.timeRange.end,[a]),yt=y.useRef(!0);y.useEffect(()=>{cr().catch(()=>{}),hi().then(g=>{const R=e.dataset||g;R&&(l(R),!e.dataset&&yt.current&&pe({dataset:R})),yt.current=!1}).catch(g=>w(g instanceof Error?g.message:"Failed to preload datasets"))},[]),y.useEffect(()=>{if(!i){u(void 0);return}m(!0),w(null),pt(i).then(g=>{u(g),g&&(c(g.timeRange.start),v(0),C(500))}).catch(g=>w(g instanceof Error?g.message:"Failed to load dataset")).finally(()=>m(!1))},[i,S]);const Ce=y.useMemo(()=>{if(!(!a||d===void 0))return a.snapshots.find(g=>(typeof g.timestamp=="string"?parseInt(g.timestamp,10):g.timestamp)===d)},[a,d]),je=y.useMemo(()=>{if(!a)return null;let g=1/0,R=-1/0,V=0;return a.snapshots.forEach(q=>{const B=Array.isArray(q==null?void 0:q.edges)?q.edges:[];let oe=0;B.forEach(re=>{if(re!=null&&re.source&&re.source===re.target)return;const te=Number(re==null?void 0:re.value);Number.isFinite(te)&&(oe+=1,te<g&&(g=te),te>R&&(R=te))}),oe>V&&(V=oe)}),g===1/0||R===-1/0?{min:0,max:0,maxEdgesCount:V}:{min:g,max:R,maxEdgesCount:V}},[a]),It=y.useMemo(()=>{if(!a)return null;let g=1/0,R=-1/0;return a.snapshots.forEach(V=>{const q=new Map,B=new Map;(Array.isArray(V==null?void 0:V.edges)?V.edges:[]).forEach(te=>{const Se=B.get(te.source)||0;B.set(te.source,Se+te.value);const ie=q.get(te.target)||0;q.set(te.target,ie+te.value)}),(Array.isArray(V==null?void 0:V.nodes)?V.nodes:[]).forEach(te=>{const Se=(q.get(te.id)||0)-(B.get(te.id)||0);Se<g&&(g=Se),Se>R&&(R=Se)})}),g===1/0||R===-1/0?{min:0,max:0}:{min:g,max:R}},[a]),Et=y.useMemo(()=>{if(!a)return null;let g=0,R=0;return a.snapshots.forEach(V=>{const q=new Map,B=new Map;(Array.isArray(V==null?void 0:V.edges)?V.edges:[]).forEach(te=>{const Se=B.get(te.source)||0;B.set(te.source,Se+te.value);const ie=q.get(te.target)||0;q.set(te.target,ie+te.value)}),(Array.isArray(V==null?void 0:V.nodes)?V.nodes:[]).forEach(te=>{const Se=q.get(te.id)||0,ie=B.get(te.id)||0;Se>g&&(g=Se),ie>R&&(R=ie)})}),{maxIncoming:g,maxOutgoing:R}},[a]),Pt=y.useMemo(()=>{if(!a)return null;let g=0;return a.snapshots.forEach(R=>{const V=Array.isArray(R==null?void 0:R.edges)?R.edges:[],q=new Map;V.forEach(B=>{if(B!=null&&B.source&&B.source===B.target){const oe=Number(B.value);if(!Number.isFinite(oe)||oe<=0)return;const re=q.get(B.source)||0;q.set(B.source,re+oe)}}),q.forEach(B=>{B>g&&(g=B)})}),{max:g}},[a]);y.useEffect(()=>{if(!je)return;const{min:g,max:R,maxEdgesCount:V}=je;if(!Number.isFinite(g)||!Number.isFinite(R))return;const q=(Se,ie,ve)=>ve<ie||!Number.isFinite(Se)||Se<ie?ie:Se>ve?ve:Se,B=q(h,g,R);let oe=q(x,g,R);oe<B&&(oe=B);const re=Math.max(1,V),te=Math.max(1,Math.min(M,re));B!==h&&v(B),oe!==x&&_(oe),te!==M&&C(te)},[je,h,x,M]);const bt=y.useMemo(()=>{if(!Ce||!(a!=null&&a.metadata))return null;const R=["migration_type","type","category","edge_type"].find(q=>{var B,oe;return((B=a.metadata)==null?void 0:B.edgeProperties.includes(q))||((oe=a.metadata)==null?void 0:oe.hasCategoricalProperties.edges.includes(q))});if(!R)return null;const V=li(Ce.edges,R);return{property:R,values:V.map(q=>String(q))}},[Ce,a]);y.useEffect(()=>{I(null)},[i]),y.useEffect(()=>{Ce&&F&&(Ce.nodes.some(R=>R.id===F)||(G(null),ue&&xe(!1),pe({egoNodeId:null,egoStepColoring:!1})))},[Ce,F,ue,pe]);const T=y.useMemo(()=>{if(!Ce)return{nodes:[],edges:[]};const g=new Map,R=new Map,V=new Map;Ce.edges.forEach(A=>{const J=R.get(A.source)||0;R.set(A.source,J+A.value);const le=g.get(A.target)||0;if(g.set(A.target,le+A.value),A.source===A.target){const he=V.get(A.source)||0;V.set(A.source,he+A.value)}});let q=ai(Ce.edges,(bt==null?void 0:bt.property)||"",k);if(q=q.filter(A=>(A==null?void 0:A.source)!==(A==null?void 0:A.target)),we!=="none"){const A=new Map(Ce.nodes.map(J=>[J.id,J]));we==="region"?q=q.filter(J=>{const le=A.get(J.source),he=A.get(J.target);return le&&he&&le.region&&he.region&&le.region===he.region}):we==="division"?q=q.filter(J=>{const le=A.get(J.source),he=A.get(J.target);return le&&he&&le.division&&he.division&&le.division===he.division}):we==="interRegion"?q=q.filter(J=>{const le=A.get(J.source),he=A.get(J.target);return le&&he&&le.region&&he.region&&le.region!==he.region}):we==="interDivision"&&(q=q.filter(J=>{const le=A.get(J.source),he=A.get(J.target);return le&&he&&le.division&&he.division&&le.division!==he.division}))}const oe=q.filter(A=>A.value>=h&&A.value<=x).sort((A,J)=>J.value-A.value).slice(0,M).map((A,J)=>({edge:A,idx:J}));let re=oe;const te=new Map;let Se=0;if(P==="kriskogram"&&F){const A=Math.max(1,Math.round(X)),J=new Set;let le=new Set;const he=new Set;le.add(F),he.add(F);for(let Ge=1;Ge<=A&&le.size>0;Ge+=1){const dt=new Set;oe.forEach(({edge:Be,idx:lt})=>{if(le.has(Be.source)||le.has(Be.target)){J.add(lt);const Yt=te.get(lt);(Yt===void 0||Ge<Yt)&&te.set(lt,Ge),he.has(Be.source)||(he.add(Be.source),dt.add(Be.source)),he.has(Be.target)||(he.add(Be.target),dt.add(Be.target))}}),le=dt}re=oe.filter(({idx:Ge})=>J.has(Ge)),te.forEach(Ge=>{Ge>Se&&(Se=Ge)})}const ie=re.map(({edge:A,idx:J})=>{const le=te.get(J);return le!==void 0?{...A,_egoStep:le}:A}),ve=new Set;ie.forEach(A=>{ve.add(A.source),ve.add(A.target)}),F&&ve.add(F);const Me=new Map,ae=new Map;return ie.forEach(A=>{const J=ae.get(A.source)||0;ae.set(A.source,J+A.value);const le=Me.get(A.target)||0;Me.set(A.target,le+A.value)}),{nodes:(P==="kriskogram"&&D?Ce.nodes:Ce.nodes.filter(A=>ve.has(A.id))).map(A=>{const J=Me.get(A.id)||0,le=ae.get(A.id)||0,he=g.get(A.id)||0,Ge=R.get(A.id)||0,dt=J-le,Be=he-Ge,lt=V.get(A.id)||0;return{...A,_totalIncoming:J,_totalOutgoing:le,total_incoming_visible:J,total_outgoing_visible:le,total_incoming_year:he,total_outgoing_year:Ge,net_flow_visible:dt,net_flow_year:Be,self_flow_year:lt}}),edges:ie,egoStepMax:Se}},[Ce,h,x,M,k,bt,we,D,P,F,X,_e]),Xe=y.useMemo(()=>{if(!Ce)return null;const g=Ce.edges.length,R=Ce.nodes.length,V=Ce.edges.reduce((oe,re)=>oe+re.value,0),q=g>0?V/g:0,B=g>0?Math.max(...Ce.edges.map(oe=>oe.value)):0;return{totalNodes:R,totalEdges:g,visibleNodes:T.nodes.length,visibleEdges:T.edges.length,avgValue:q,maxValue:B}},[Ce,T]),et=(je==null?void 0:je.min)??0,Ht=(je==null?void 0:je.max)??(Xe==null?void 0:Xe.maxValue)??et,At=Math.max(et,Ht),Hs=Math.max(At,1),Jn=Math.max(1,Math.floor(Hs/1e3)),cn=(je==null?void 0:je.maxEdgesCount)??(Xe==null?void 0:Xe.totalEdges)??0,dn=Math.max(500,cn),gn=y.useMemo(()=>{if(!(!T||T.edges.length===0))return Math.min(...T.edges.map(g=>g.value))},[T]),wt=y.useMemo(()=>T.nodes.some(g=>g&&g.region),[T]),St=y.useMemo(()=>T.nodes.some(g=>g&&g.division),[T]);y.useEffect(()=>{!wt&&ge==="region"&&N("direction"),!St&&ge==="division"&&N("direction")},[wt,St,ge]);const fn=y.useMemo(()=>{if(!(!T||T.edges.length===0))return Math.max(...T.edges.map(g=>g.value))},[T]);y.useEffect(()=>{P==="kriskogram"&&T.nodes.length>0&&L.current&&L.current.updateData(T.nodes,T.edges)},[T,P]);const Os=g=>{c(g),yt.current||pe({year:g})};return y.useEffect(()=>{yt.current||pe({minThreshold:h,maxThreshold:x,maxEdges:M})},[h,x,M]),y.useEffect(()=>{yt.current||pe({view:P})},[P]),y.useEffect(()=>{yt.current||pe({edgeType:k})},[k]),y.useEffect(()=>{!yt.current&&i&&pe({dataset:i})},[i]),o.jsx(ft,{fallback:o.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center",children:o.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-8 max-w-lg mx-4",children:[o.jsx("h2",{className:"text-2xl font-bold text-red-800 mb-4",children:"Explorer Error"}),o.jsx("p",{className:"text-gray-700 mb-4",children:"The explorer page encountered an error. Please refresh the page."}),o.jsx("button",{onClick:()=>window.location.reload(),className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 cursor-pointer transition-colors",children:"Reload Page"})]})}),children:o.jsxs("div",{className:"flex flex-1 h-full overflow-hidden",children:[o.jsxs("main",{className:"flex-1 flex flex-col overflow-hidden h-full relative",children:[p&&o.jsx("div",{className:"p-4 bg-yellow-50 text-yellow-800",children:"Loading…"}),f&&o.jsx("div",{className:"p-4 bg-red-50 text-red-600",children:f}),a?o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"flex-1 flex flex-col overflow-hidden bg-white",children:o.jsx("div",{className:`flex-1 overflow-hidden ${P==="table"?"":"p-4"}`,children:T.nodes.length>0&&T.edges.length>0?o.jsxs(o.Fragment,{children:[P==="kriskogram"&&o.jsx(ft,{fallback:o.jsxs("div",{className:"p-4 bg-red-50 border border-red-200 rounded-md",children:[o.jsx("h3",{className:"text-lg font-semibold text-red-800 mb-2",children:"Kriskogram Error"}),o.jsx("p",{className:"text-sm text-red-700",children:"The Kriskogram visualization encountered an error."})]}),children:o.jsx("div",{className:"w-full h-full",children:o.jsx(Js,{ref:L,nodes:T.nodes,edges:T.edges,width:Math.max(800,be.width-(t?64:n)-(me?4:ze)-40),height:Math.max(600,be.height-80),margin:{top:60,right:40,bottom:60,left:40},arcOpacity:He,title:a.name,accessors:(()=>{const g=T.edges.map(E=>E.value),R=g.length>0?Math.min(...g):0,V=g.length>0?Math.max(...g):1,q=(je==null?void 0:je.min)??R,B=(je==null?void 0:je.max)??V,oe=Math.max(B-q,0),re=T.egoStepMax??0,te=!!(F&&ue&&re>0),Se=E=>{if(re<=1)return"hsl(210, 80%, 55%)";const Fe=Math.max(1,Math.min(E,re)),Ie=re<=1?0:(Fe-1)/(re-1),Ne=210-Ie*150,Ae=60-Ie*20;return`hsl(${Math.round(Ne)}, 80%, ${Math.round(Ae)}%)`},ie=E=>{if(!Number.isFinite(E)||oe<=0)return 0;const Ie=Math.min(Math.max(E,q),B)-q;switch(_e){case"sqrt":{const Ne=Math.sqrt(oe);return Ne<=0?0:Math.max(0,Math.min(1,Math.sqrt(Ie)/Ne))}case"log":{const Ne=Math.log10(oe+1);return!Number.isFinite(Ne)||Ne<=0?0:Math.max(0,Math.min(1,Math.log10(Ie+1)/Ne))}case"linear":default:{const Ne=oe;return Ne<=0?0:Math.max(0,Math.min(1,Ie/Ne))}}},ve=T.nodes.map(E=>E.total_outgoing_visible||E._totalOutgoing||0),Me=T.nodes.map(E=>E.total_incoming_visible||E._totalIncoming||0),ae=T.nodes.map(E=>E.total_outgoing_year||0),Pe=T.nodes.map(E=>E.total_incoming_year||0),_t=T.nodes.map(E=>E.net_flow_visible||0),at=T.nodes.map(E=>E.net_flow_year||0),A=ve.length>0?Math.max(...ve):1,J=Me.length>0?Math.max(...Me):1,le=ae.length>0?Math.max(...ae):1,he=Pe.length>0?Math.max(...Pe):1,Ge=_t.length>0?Math.max(..._t.map(E=>Math.abs(E))):1,dt=at.length>0?Math.max(...at.map(E=>Math.abs(E))):1,Be=(Et==null?void 0:Et.maxOutgoing)??le,lt=(Et==null?void 0:Et.maxIncoming)??he,Yt=(It==null?void 0:It.min)??-dt,Gs=(It==null?void 0:It.max)??dt,Xt=Math.max(Math.abs(Yt),Math.abs(Gs))||1,Us=(E,Fe,Ie)=>{const Ne=Array.from(new Set(T.nodes.map(ne=>ne[E]).filter(ne=>ne!=null))),Ae=new Map;return Ne.forEach((ne,De)=>{Ae.set(ne,Ie[De%Ie.length])}),Ae.get(Fe)||Ie[0]},Bs=["#3b82f6","#f59e0b","#ef4444","#10b981","#8b5cf6","#ec4899","#14b8a6","#f97316"];return{nodeOrder:E=>{if(Ee==="alphabetical")return E.label||E.id;const Fe=E[Ee];return Fe==null?`ZZZ_${E.label||E.id}`:typeof Fe=="number"?`${String(1e6-Fe).padStart(10,"0")}_${E.label||E.id}`:`${String(Fe)}_${E.label||E.id}`},nodeColor:E=>{var Ae;const Fe=(ne,De)=>!Number.isFinite(ne)||De<=0?0:Math.max(0,Math.min(1,ne/De)),Ie=(ne,De,Ze)=>{const W=85-Math.max(0,Math.min(1,Ze))*45;return`hsl(${ne}, ${De}%, ${W}%)`},Ne=ne=>{if(!Number.isFinite(ne)||Xt<=0)return"#6b7280";if(Math.abs(ne)<1e-6)return"#9ca3af";const Ze=85-Math.max(0,Math.min(1,Math.abs(ne)/Xt))*45;return ne>=0?`hsl(0, 75%, ${Ze}%)`:`hsl(210, 75%, ${Ze}%)`};switch(ln){case"single":return"#2563eb";case"outgoing":case"visible_outgoing":{const ne=Fe(E.total_outgoing_visible||E._totalOutgoing||0,A);return Ie(24,85,ne)}case"incoming":case"visible_incoming":{const ne=Fe(E.total_incoming_visible||E._totalIncoming||0,J);return Ie(160,70,ne)}case"year_outgoing":{const ne=Fe(E.total_outgoing_year||0,Be);return Ie(24,85,ne)}case"year_incoming":{const ne=Fe(E.total_incoming_year||0,lt);return Ie(160,70,ne)}case"net_year":return Ne(E.net_flow_year||0);case"self_year":{const ne=Fe(E.self_flow_year||0,(Pt==null?void 0:Pt.max)??0);return Ie(280,70,ne)}case"attribute":{if(!$t)return"#2563eb";const ne=E[$t];if(ne==null)return"#9ca3af";if((Ae=a==null?void 0:a.metadata)!=null&&Ae.hasNumericProperties.nodes.includes($t)){const De=T.nodes.map(fe=>fe[$t]).filter(fe=>typeof fe=="number");if(De.length===0)return"#2563eb";const Ze=Math.min(...De),W=Math.max(...De)-Ze||1,ye=(Number(ne)-Ze)/W;return`hsl(${120-Math.max(0,Math.min(1,ye))*120}, 70%, 50%)`}return Us($t,ne,Bs)}default:return"#2563eb"}},nodeRadius:E=>{const Fe=E.total_outgoing_visible||E._totalOutgoing||0,Ie=E.total_incoming_visible||E._totalIncoming||0,Ne=E.total_outgoing_year||0,Ae=E.total_incoming_year||0,ne=Math.abs(E.net_flow_visible||0),De=Math.abs(E.net_flow_year||0),Ze=E.self_flow_year||0,Ke=W=>3+Math.max(0,Math.min(1,W))*9;if(We==="fixed")return 6;if(We==="visible_outgoing"||We==="outgoing")return Ke(A>0?Fe/A:0);if(We==="visible_incoming"||We==="incoming")return Ke(J>0?Ie/J:0);if(We==="year_outgoing")return Ke(Be>0?Ne/Be:0);if(We==="year_incoming")return Ke(lt>0?Ae/lt:0);if(We==="net_visible"){const W=Ge>0?Ge:1;return Ke(ne/W)}if(We==="net_year"){const W=Xt>0?Xt:1;return Ke(De/W)}if(We==="attribute"&&qt){const W=E[qt];if(typeof W!="number")return 6;const ye=T.nodes.map(Zt=>Zt[qt]).filter(Zt=>typeof Zt=="number");if(ye.length===0)return 6;const Ue=Math.min(...ye),tt=Math.max(...ye)-Ue||1,Vt=(W-Ue)/tt;return Ke(Vt)}if(We==="self_year"){const W=(Pt==null?void 0:Pt.max)??0,ye=W>0?Ze/W:0;return Ke(ye)}return 6},edgeWidth:E=>st==="weight"?.5+ie(E.value)*15:zt,edgeColor:(E,Fe)=>{var Ze,Ke;if(te){const W=E==null?void 0:E._egoStep;if(typeof W=="number"&&W>0)return Se(W)}const Ie=ie(E.value),Ne=["#3b82f6","#f59e0b","#ef4444","#10b981","#8b5cf6","#ec4899","#14b8a6","#f97316"];if(!vt&&ge==="direction")return Fe?"#1f77b4":"#d62728";let Ae="#2563eb";if(ge==="direction")Ae=Fe?"#1f77b4":"#d62728";else if(ge==="region"){const W=T.nodes.find(fe=>fe.id===E.source),ye=Array.from(new Set(T.nodes.map(fe=>fe.region).filter(Boolean))),Ue=new Map(ye.map((fe,tt)=>[fe,Ne[tt%Ne.length]]));Ae=W&&W.region&&Ue.get(W.region)||"#2563eb"}else if(ge==="division"){const W=T.nodes.find(fe=>fe.id===E.source),ye=Array.from(new Set(T.nodes.map(fe=>fe.division).filter(Boolean))),Ue=new Map(ye.map((fe,tt)=>[fe,Ne[tt%Ne.length]]));Ae=W&&W.division&&Ue.get(W.division)||"#2563eb"}else if(ge==="attribute"&&$){const W=E[$];if(W!=null)if((Ze=a==null?void 0:a.metadata)!=null&&Ze.hasNumericProperties.edges.includes($)){const ye=T.edges.map(mn=>mn[$]).filter(mn=>typeof mn=="number"),Ue=Math.min(...ye),tt=Math.max(...ye)-Ue||1;Ae=`hsl(${120-(Number(W)-Ue)/tt*120}, 70%, 50%)`}else{const ye=Array.from(new Set(T.edges.map(fe=>fe[$]).filter(fe=>fe!=null)));Ae=new Map(ye.map((fe,tt)=>[fe,Ne[tt%Ne.length]])).get(W)||"#2563eb"}}else ge==="single"&&(Ae="#2563eb");let ne=.6;if(ee==="weight")ne=Math.max(0,Math.min(1,Ie));else if(ee==="attribute"&&se){const W=E[se];if(W!=null&&((Ke=a==null?void 0:a.metadata)!=null&&Ke.hasNumericProperties.edges.includes(se))){const ye=T.edges.map(Vt=>Vt[se]).filter(Vt=>typeof Vt=="number"),Ue=Math.min(...ye),tt=Math.max(...ye)-Ue||1;ne=Math.max(0,Math.min(1,(Number(W)-Ue)/tt))}}else ee==="constant"&&(ne=Math.max(0,Math.min(1,Je)));if(ot&&(ge==="region"||ge==="division")){const W=T.nodes.find(fe=>fe.id===E.source),ye=T.nodes.find(fe=>fe.id===E.target);if(!(ge==="region"?(W==null?void 0:W.region)&&W.region===(ye==null?void 0:ye.region):(W==null?void 0:W.division)&&W.division===(ye==null?void 0:ye.division)))return`hsl(0, 0%, ${80-ne*50}%)`}const De=80-ne*55;return ge==="direction"?`hsl(${Fe?0:200}, 70%, ${Math.round(De)}%)`:ge==="single"?`hsl(210, 70%, ${Math.round(De)}%)`:Ae}}})(),legend:(()=>{const g=T.egoStepMax??0;if(F&&ue&&g>0){const ie=Me=>{if(g<=1)return"hsl(210, 80%, 55%)";const ae=Math.max(1,Math.min(Me,g)),Pe=g<=1?0:(ae-1)/(g-1),_t=210-Pe*150,at=60-Pe*20;return`hsl(${Math.round(_t)}, 80%, ${Math.round(at)}%)`};return{type:"egoSteps",entries:Array.from({length:g},(Me,ae)=>({step:ae+1,color:ie(ae+1)}))}}const R=T.edges.map(ie=>ie.value),V=R.length>0?Math.min(...R):0,q=R.length>0?Math.max(...R):1,B=(je==null?void 0:je.min)??V,oe=(je==null?void 0:je.max)??q,re=Math.max(oe-B,0),te=ie=>{if(!Number.isFinite(ie)||re<=0)return 0;const Me=Math.min(Math.max(ie,B),oe)-B;switch(_e){case"sqrt":{const ae=Math.sqrt(re);return ae<=0?0:Math.max(0,Math.min(1,Math.sqrt(Me)/ae))}case"log":{const ae=Math.log10(re+1);return!Number.isFinite(ae)||ae<=0?0:Math.max(0,Math.min(1,Math.log10(Me+1)/ae))}case"linear":default:return re<=0?0:Math.max(0,Math.min(1,Me/re))}},Se=ie=>{if(re<=0)return B;const ve=Math.max(0,Math.min(1,ie));switch(_e){case"sqrt":return B+Math.pow(ve,2)*re;case"log":{const Me=Math.log10(re+1);if(!Number.isFinite(Me)||Me<=0)return B;const ae=Math.pow(10,ve*Me)-1;return B+ae}case"linear":default:return B+ve*re}};if(vt){if(ge==="region"&&wt){const ie=Array.from(new Set(T.nodes.map(ae=>ae.region).filter(Boolean))),ve=["#3b82f6","#f59e0b","#ef4444","#10b981","#8b5cf6","#ec4899","#14b8a6","#f97316"];return{type:"categorical",title:"Regions",entries:ie.slice(0,10).map((ae,Pe)=>({label:ae,color:ve[Pe%ve.length]})),interNote:ot?"Inter edges: grayscale by intensity":void 0}}if(ge==="division"&&St){const ie=Array.from(new Set(T.nodes.map(ae=>ae.division).filter(Boolean))),ve=["#3b82f6","#f59e0b","#ef4444","#10b981","#8b5cf6","#ec4899","#14b8a6","#f97316"];return{type:"categorical",title:"Divisions",entries:ie.slice(0,10).map((ae,Pe)=>({label:ae,color:ve[Pe%ve.length]})),interNote:ot?"Inter edges: grayscale by intensity":void 0}}if(ge==="single"&&ee==="weight"){const ve=[0,.5,1].map(Me=>{const ae=Se(Me),Pe=te(ae),at=80-Pe*55,A=`hsl(210, 70%, ${Math.round(at)}%)`,J=st==="weight"?.5+Pe*15:zt;return{fraction:Pe,value:ae,color:A,width:J}});return{type:"weight",color:"#1f77b4",scale:_e,min:B,max:oe,samples:ve}}}else{if(ge==="direction")return{type:"direction"};if(ge==="single"&&ee==="weight"){const ve=[0,.5,1].map(Me=>{const ae=Se(Me),Pe=te(ae),at=80-Pe*55,A=`hsl(210, 70%, ${Math.round(at)}%)`,J=st==="weight"?.5+Pe*15:zt;return{fraction:Pe,value:ae,color:A,width:J}});return{type:"weight",color:"#1f77b4",scale:_e,min:B,max:oe,samples:ve}}}})(),lens:{enabled:ct==="lens",x:Zn.x,y:Zn.y,radius:Kt},onMouseMoveInCanvas:g=>{ct==="lens"&&Qn(g)},onWheelInCanvas:g=>{ct==="lens"&&un(R=>Math.max(20,Math.min(300,R+(g>0?-10:10))))}})})}),P==="table"&&o.jsx(ft,{fallback:o.jsxs("div",{className:"p-4 bg-red-50 border border-red-200 rounded-md",children:[o.jsx("h3",{className:"text-lg font-semibold text-red-800 mb-2",children:"Table View Error"}),o.jsx("p",{className:"text-sm text-red-700",children:"The table view encountered an error."})]}),children:o.jsx("div",{className:"h-full w-full flex flex-col min-h-0",children:o.jsx(Ls,{nodes:T.nodes,edges:T.edges})})}),P==="sankey"&&o.jsx(ft,{fallback:o.jsxs("div",{className:"p-4 bg-red-50 border border-red-200 rounded-md",children:[o.jsx("h3",{className:"text-lg font-semibold text-red-800 mb-2",children:"Sankey Diagram Error"}),o.jsx("p",{className:"text-sm text-red-700",children:"The Sankey diagram encountered an error."})]}),children:o.jsx("div",{className:"h-full min-h-0",children:o.jsx(ri,{nodes:T.nodes,edges:T.edges,width:Math.max(800,be.width-(t?64:n)-(me?4:ze)-40),height:Math.max(600,be.height-80)})})}),P==="chord"&&o.jsx(ft,{fallback:o.jsxs("div",{className:"p-4 bg-red-50 border border-red-200 rounded-md",children:[o.jsx("h3",{className:"text-lg font-semibold text-red-800 mb-2",children:"Chord Diagram Error"}),o.jsx("p",{className:"text-sm text-red-700",children:"The chord diagram encountered an error."})]}),children:o.jsx(ui,{nodes:T.nodes,edges:T.edges,width:Math.max(800,be.width-(t?64:n)-(me?4:ze)-40),height:Math.max(600,be.height-80)})})]}):Ce?o.jsxs("div",{className:"text-center text-gray-500 py-8",children:["No data meets the current threshold range (",h.toLocaleString()," - ",x.toLocaleString(),"). Try adjusting the filters."]}):o.jsx("div",{className:"px-6 py-8 text-center text-gray-600 space-y-3",children:typeof d=="number"&&ys[d]?o.jsxs(o.Fragment,{children:[o.jsxs("p",{className:"text-lg font-semibold text-gray-700",children:["No state-to-state migration snapshot for ",d]}),o.jsx("p",{className:"text-sm leading-relaxed",children:ys[d]})]}):o.jsx("p",{children:"No snapshot to display."})})})}),P==="kriskogram"&&o.jsxs("div",{className:"absolute bottom-4 right-4 flex items-center gap-2 bg-white/90 backdrop-blur px-3 py-2 rounded shadow border border-gray-200",children:[o.jsx("label",{className:"text-xs font-medium text-gray-700",children:"Mode:"}),o.jsx("button",{type:"button",onClick:()=>Wt("pan"),className:["text-xs px-2 py-1 rounded border",ct==="pan"?"bg-blue-600 text-white border-blue-600":"bg-white text-gray-700 border-gray-300"].join(" "),children:"Pan"}),o.jsx("button",{type:"button",onClick:()=>Wt("lens"),className:["text-xs px-2 py-1 rounded border",ct==="lens"?"bg-blue-600 text-white border-blue-600":"bg-white text-gray-700 border-gray-300"].join(" "),children:"Edge Lens"}),ct==="lens"&&o.jsxs("span",{className:"text-[10px] text-gray-600",children:["Wheel: radius (",Kt,"px)"]})]})]}):o.jsx("div",{className:"flex-1 flex items-center justify-center text-gray-500",children:o.jsxs("div",{className:"text-center",children:[o.jsx("p",{className:"text-lg mb-2",children:"No dataset selected"}),o.jsx("p",{className:"text-sm",children:"Select a dataset from the sidebar to begin exploring"})]})})]}),a&&o.jsx(fi,{isCollapsed:me,onToggle:()=>Ve(!me),onResize:U,title:"Visualization Settings",bottomContent:o.jsxs("div",{className:"p-3",children:[o.jsx("label",{className:"text-xs font-medium text-gray-600 block mb-2",children:"Visualization Type"}),o.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[o.jsx("button",{onClick:()=>{Y("kriskogram"),pe({view:"kriskogram"})},className:`px-3 py-2.5 rounded text-sm font-medium transition-colors ${P==="kriskogram"?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"Kriskogram"}),o.jsx("button",{onClick:()=>{Y("table"),pe({view:"table"})},className:`px-3 py-2.5 rounded text-sm font-medium transition-colors ${P==="table"?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"Table"}),o.jsx("button",{onClick:()=>{Y("sankey"),pe({view:"sankey"})},className:`px-3 py-2.5 rounded text-sm font-medium transition-colors ${P==="sankey"?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"Sankey"}),o.jsx("button",{onClick:()=>{Y("chord"),pe({view:"chord"})},className:`px-3 py-2.5 rounded text-sm font-medium transition-colors ${P==="chord"?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"Chord"})]})]}),children:o.jsxs("div",{className:"space-y-4",children:[o.jsxs(Dt,{title:a.name,defaultOpen:!0,subtitle:`${a.type.toUpperCase()} · ${a.timeRange.start}${a.timeRange.end!==a.timeRange.start?`–${a.timeRange.end}`:""}`,children:[a.notes&&o.jsx("div",{className:"text-xs text-gray-600 mt-2 whitespace-pre-wrap",children:a.notes}),!a.notes&&o.jsx("div",{className:"text-xs text-gray-500 italic mt-2",children:"No description available"})]}),Xe&&o.jsxs("div",{className:"p-3 bg-gray-50 rounded grid grid-cols-2 gap-3 text-sm",children:[o.jsxs("div",{children:[o.jsx("div",{className:"text-xs text-gray-600",children:"Nodes"}),o.jsxs("div",{className:"text-lg font-bold",children:[Xe.visibleNodes,"/",Xe.totalNodes]})]}),o.jsxs("div",{children:[o.jsx("div",{className:"text-xs text-gray-600",children:"Edges"}),o.jsxs("div",{className:"text-lg font-bold",children:[Xe.visibleEdges.toLocaleString(),"/",Xe.totalEdges.toLocaleString()]})]})]}),o.jsx(Dt,{title:"General Settings",defaultOpen:!0,onReset:()=>{const g=Math.max(1,cn);I(null),Bn("none"),v(et),_(Ht),C(g),pe({edgeType:null,minThreshold:et,maxThreshold:Ht,maxEdges:g})},children:o.jsxs("div",{className:"space-y-4",children:[zs&&d!==void 0&&o.jsxs("div",{className:"space-y-2",children:[o.jsxs("label",{className:"text-sm font-medium",children:["Year: ",d]}),o.jsx("input",{type:"range",min:a.timeRange.start,max:a.timeRange.end,value:d,onChange:g=>Os(parseInt(g.target.value)),className:"w-full"})]}),bt&&o.jsxs("div",{className:"space-y-2",children:[o.jsxs("label",{className:"text-sm font-medium",children:["Edge Type (",bt.property,")"]}),o.jsxs("select",{value:k||"all",onChange:g=>{const R=g.target.value==="all"?null:g.target.value;I(R),pe({edgeType:R})},className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[o.jsx("option",{value:"all",children:"All Types"}),bt.values.map(g=>o.jsx("option",{value:g,children:g},g))]})]}),(wt||St)&&o.jsxs("div",{className:"space-y-1",children:[o.jsx("label",{className:"text-sm font-medium",children:"Edge Scope"}),o.jsxs("select",{value:we,onChange:g=>Bn(g.target.value),className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[o.jsx("option",{value:"none",children:"All"}),wt&&o.jsx("option",{value:"region",children:"Intra Region"}),St&&o.jsx("option",{value:"division",children:"Intra Division"}),wt&&o.jsx("option",{value:"interRegion",children:"Inter Region"}),St&&o.jsx("option",{value:"interDivision",children:"Inter Division"})]})]}),Ce&&Xe&&o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{className:"space-y-2",children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("label",{className:"text-sm font-medium flex items-center gap-2",children:[o.jsxs("span",{children:["Min: ",h.toLocaleString()]}),gn!==void 0&&gn>h&&o.jsxs("span",{className:"text-xs text-gray-400",children:["(actual ",gn.toLocaleString(),")"]})]}),(()=>{const g=Math.max(1,cn),R=h>et||x<Ht||M<g;return o.jsx("button",{onClick:()=>{v(et),_(Ht),C(g)},disabled:!R,type:"button",className:`text-xs transition-colors ${R?"text-blue-600 hover:text-blue-800":"text-gray-400 cursor-not-allowed"}`,children:"Show All"})})()]}),o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("input",{type:"range",min:et,max:At||1,step:Jn,value:h,onChange:g=>{const R=parseInt(g.target.value),V=Math.min(R,x);v(V),pe({minThreshold:V})},className:"w-full"}),o.jsx("input",{type:"number",min:et,max:At||1,value:h,onChange:g=>{const R=Number.parseInt(g.target.value);if(Number.isNaN(R))return;const V=Math.max(et,Math.min(R,x));v(V),pe({minThreshold:V})},className:"w-24 px-2 py-1 text-sm border border-gray-300 rounded-md"})]})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsxs("label",{className:"text-sm font-medium flex items-center gap-2",children:[o.jsxs("span",{children:["Max: ",x.toLocaleString()]}),fn!==void 0&&fn<x&&o.jsxs("span",{className:"text-xs text-gray-400",children:["(actual ",fn.toLocaleString(),")"]})]}),o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("input",{type:"range",min:et,max:At||1,step:Jn,value:x,onChange:g=>{const R=parseInt(g.target.value),V=Math.max(R,h);_(V),pe({maxThreshold:V})},className:"w-full"}),o.jsx("input",{type:"number",min:et,max:At||1,value:x,onChange:g=>{const R=Number.parseInt(g.target.value);if(Number.isNaN(R))return;const V=Math.min(At||1,Math.max(R,h));_(V),pe({maxThreshold:V})},className:"w-24 px-2 py-1 text-sm border border-gray-300 rounded-md"})]})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsxs("label",{className:"text-sm font-medium",children:["Max Edges: ",M]}),o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("input",{type:"range",min:10,max:dn,step:10,value:M,onChange:g=>{const R=parseInt(g.target.value);C(R),pe({maxEdges:R})},className:"w-full"}),o.jsx("input",{type:"number",min:1,max:dn,value:M,onChange:g=>{const R=Number.parseInt(g.target.value);if(Number.isNaN(R))return;const V=Math.max(1,Math.min(R,dn));C(V),pe({maxEdges:V})},className:"w-24 px-2 py-1 text-sm border border-gray-300 rounded-md"})]}),o.jsxs("p",{className:"text-xs text-gray-600 italic",children:["After filtering by thresholds and edge type, edges are sorted by value (highest first) and the top ",M," edges are displayed."]})]})]})]})}),P==="kriskogram"&&o.jsx(Dt,{title:"Kriskogram Settings",defaultOpen:!0,onReset:()=>{Q(!1),ke("alphabetical"),Oe(.85),Ft("weight"),qn(2),Wn("single"),Kn(null),Yn("fixed"),Xn(null),Tt(!1),N("direction"),z(null),Re(!0),K("weight"),de(null),it(.6),Wt("pan"),un(80),Qn({x:0,y:0}),G(null),ce(1),xe(!1),j("linear"),pe({showAllNodes:!1,egoNodeId:null,egoNeighborSteps:1,egoStepColoring:!1,edgeWeightScale:"linear"})},children:a!=null&&a.metadata?o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{className:"flex items-center justify-between p-2 bg-gray-50 rounded border border-gray-200",children:[o.jsxs("div",{children:[o.jsx("label",{htmlFor:"kriskogram-show-all-nodes",className:"text-sm font-medium text-gray-700",children:"Always show all nodes"}),o.jsx("p",{className:"text-xs text-gray-500",children:"Keeps every location visible even if its edges fall outside the filters."})]}),o.jsx("input",{id:"kriskogram-show-all-nodes",type:"checkbox",className:"w-4 h-4",checked:D,onChange:g=>{const R=g.target.checked;Q(R),pe({showAllNodes:R})}})]}),o.jsxs("div",{className:"space-y-3",children:[o.jsxs("div",{children:[o.jsx("label",{htmlFor:"kriskogram-ego-node",className:"text-xs font-medium text-gray-700",children:"Ego focus (optional)"}),o.jsxs("select",{id:"kriskogram-ego-node",value:F??"",onChange:g=>{const R=g.target.value,V=R===""?null:R;V===null?(G(null),ue&&xe(!1),pe({egoNodeId:null,egoStepColoring:!1})):(G(V),pe({egoNodeId:V}))},className:"mt-1 w-full px-2 py-1.5 text-xs border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[o.jsx("option",{value:"",children:"No ego focus (show all eligible edges)"}),((Ce==null?void 0:Ce.nodes)??[]).map(g=>o.jsx("option",{value:g.id,children:g.label||g.id},g.id))]}),o.jsx("p",{className:"mt-1 text-[11px] text-gray-500",children:"Limit the visualization to flows centered on a selected node."})]}),o.jsxs("div",{children:[o.jsx("label",{htmlFor:"kriskogram-ego-steps",className:"text-xs font-medium text-gray-700",children:"Neighbor steps"}),o.jsxs("div",{className:"mt-1 flex items-center gap-2",children:[o.jsx("input",{id:"kriskogram-ego-steps",type:"number",min:1,max:10,value:X,disabled:!F,onChange:g=>{const R=Number.parseInt(g.target.value,10);if(Number.isNaN(R))return;const V=Math.max(1,Math.min(R,10));ce(V),pe({egoNeighborSteps:V})},className:"w-20 px-2 py-1 text-xs border border-gray-300 rounded-md disabled:bg-gray-100 disabled:text-gray-500"}),o.jsx("span",{className:"text-[11px] text-gray-500",children:"How many hops from the ego node to include (based on currently visible edges)."})]})]}),o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("label",{htmlFor:"kriskogram-ego-step-coloring",className:"text-xs font-medium text-gray-700",children:"Color edges by neighbor step"}),o.jsx("p",{className:"text-[11px] text-gray-500",children:"Apply a step-based gradient for ego flows and show it in the legend."})]}),o.jsx("input",{id:"kriskogram-ego-step-coloring",type:"checkbox",className:"w-4 h-4",disabled:!F,checked:ue&&!!F,onChange:g=>{const R=g.target.checked&&!!F;xe(R),pe({egoStepColoring:R})}})]})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsx("label",{className:"text-xs font-medium text-gray-700",children:"Node Ordering"}),o.jsxs("select",{value:Ee,onChange:g=>ke(g.target.value),className:"w-full px-2 py-1.5 text-xs border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[o.jsx("option",{value:"alphabetical",children:"Alphabetical"}),a.metadata.hasCategoricalProperties.nodes.map(g=>o.jsxs("option",{value:g,children:["By ",g]},g)),a.metadata.hasNumericProperties.nodes.map(g=>o.jsxs("option",{value:g,children:["By ",g]},g))]})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsxs("label",{className:"text-xs font-medium text-gray-700",children:["Arc Opacity: ",Math.round(He*100),"%"]}),o.jsx("input",{type:"range",min:0,max:1,step:.05,value:He,onChange:g=>Oe(parseFloat(g.target.value)),className:"w-full"})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsx("label",{className:"text-xs font-medium text-gray-700",children:"Edge Width"}),o.jsxs("div",{className:"flex items-center gap-3 text-xs",children:[o.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[o.jsx("input",{type:"radio",name:"edgeWidthMode",value:"weight",checked:st==="weight",onChange:()=>Ft("weight"),className:"w-3.5 h-3.5"}),o.jsx("span",{children:"By Weight"})]}),o.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[o.jsx("input",{type:"radio",name:"edgeWidthMode",value:"fixed",checked:st==="fixed",onChange:()=>Ft("fixed"),className:"w-3.5 h-3.5"}),o.jsx("span",{children:"Fixed"})]})]}),st==="fixed"&&o.jsxs("div",{className:"mt-2",children:[o.jsxs("label",{className:"text-xs font-medium text-gray-700",children:["Base Edge Width: ",zt.toFixed(1),"px"]}),o.jsx("input",{type:"range",min:.5,max:8,step:.1,value:zt,onChange:g=>qn(parseFloat(g.target.value)),className:"w-full"})]}),o.jsxs("div",{className:"mt-2 space-y-1",children:[o.jsx("label",{className:"text-xs font-medium text-gray-700",children:"Weight scaling"}),o.jsxs("select",{value:_e,onChange:g=>{const R=g.target.value;j(R),pe({edgeWeightScale:R})},className:"w-full px-2 py-1.5 text-xs border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[o.jsx("option",{value:"linear",children:"Linear (use raw weight differences)"}),o.jsx("option",{value:"sqrt",children:"Square root (compress extremes)"}),o.jsx("option",{value:"log",children:"Logarithmic (highlight small flows)"})]}),o.jsx("p",{className:"text-[11px] text-gray-500",children:"Applies to both edge widths and weight-based color intensity."})]})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("label",{className:"text-xs font-medium text-gray-700",children:"Edge Color"}),o.jsxs("label",{className:"flex items-center gap-1 text-[11px] text-gray-600 cursor-pointer",children:[o.jsx("input",{type:"checkbox",className:"w-3.5 h-3.5",checked:vt,onChange:g=>{const R=g.target.checked;Tt(R),R||(N("direction"),z(null),Re(!0),K("weight"),de(null),it(.6))}}),"Advanced"]})]}),!vt&&o.jsxs("div",{className:"flex flex-col gap-1.5 text-xs",children:[o.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[o.jsx("input",{type:"radio",name:"edgeColorHueSimple",value:"direction",checked:ge==="direction",onChange:()=>N("direction"),className:"w-3.5 h-3.5"}),o.jsx("span",{children:"By Direction (Above/Below)"})]}),o.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[o.jsx("input",{type:"radio",name:"edgeColorHueSimple",value:"weight",checked:ee==="weight"&&ge==="single",onChange:()=>{N("single"),K("weight")},className:"w-3.5 h-3.5"}),o.jsx("span",{children:"By Weight Intensity"})]})]}),vt&&o.jsxs("div",{className:"space-y-3 border border-gray-200 rounded-md p-3 bg-gray-50/60",children:[o.jsxs("div",{className:"space-y-1",children:[o.jsx("label",{className:"text-xs font-medium text-gray-700",children:"Hue Source"}),o.jsxs("select",{value:ge,onChange:g=>{const R=g.target.value;N(R)},className:"w-full px-2 py-1.5 text-xs border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[o.jsx("option",{value:"direction",children:"Direction (above/below)"}),o.jsx("option",{value:"region",disabled:!wt,children:"Region"}),o.jsx("option",{value:"division",disabled:!St,children:"Division"}),o.jsx("option",{value:"attribute",children:"Attribute"}),o.jsx("option",{value:"single",children:"Single Color"})]}),ge==="attribute"&&(a==null?void 0:a.metadata)&&o.jsxs("div",{className:"mt-2",children:[o.jsx("label",{className:"text-xs text-gray-600",children:"Hue Attribute"}),o.jsxs("select",{className:"w-full px-2 py-1.5 text-xs border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",value:$||"",onChange:g=>z(g.target.value||null),children:[o.jsx("option",{value:"",children:"Select attribute…"}),[...a.metadata.hasNumericProperties.edges,...a.metadata.hasCategoricalProperties.edges].filter((g,R,V)=>V.indexOf(g)===R).map(g=>o.jsx("option",{value:g,children:g},g))]})]}),(ge==="region"||ge==="division")&&o.jsxs("label",{className:"flex items-center gap-2 mt-2 text-[11px] text-gray-600 cursor-pointer",children:[o.jsx("input",{type:"checkbox",className:"w-3.5 h-3.5",checked:ot,onChange:g=>Re(g.target.checked)}),"Inter edges grayscale by intensity"]})]}),o.jsxs("div",{className:"space-y-1",children:[o.jsx("label",{className:"text-xs font-medium text-gray-700",children:"Intensity Source"}),o.jsxs("select",{value:ee,onChange:g=>K(g.target.value),className:"w-full px-2 py-1.5 text-xs border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[o.jsx("option",{value:"weight",children:"Weight"}),o.jsx("option",{value:"constant",children:"Constant"}),o.jsx("option",{value:"attribute",children:"Attribute"})]}),ee==="constant"&&o.jsxs("div",{className:"mt-2",children:[o.jsxs("label",{className:"text-xs text-gray-600",children:["Constant Intensity: ",(Je*100).toFixed(0),"%"]}),o.jsx("input",{type:"range",min:0,max:1,step:.01,value:Je,onChange:g=>it(parseFloat(g.target.value)),className:"w-full"})]}),ee==="attribute"&&(a==null?void 0:a.metadata)&&o.jsxs("div",{className:"mt-2",children:[o.jsx("label",{className:"text-xs text-gray-600",children:"Intensity Attribute"}),o.jsxs("select",{className:"w-full px-2 py-1.5 text-xs border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",value:se||"",onChange:g=>de(g.target.value||null),children:[o.jsx("option",{value:"",children:"Select attribute…"}),a.metadata.hasNumericProperties.edges.map(g=>o.jsx("option",{value:g,children:g},g))]})]})]})]})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsx("label",{className:"text-xs font-medium text-gray-700",children:"Node Color"}),o.jsxs("select",{value:ln,onChange:g=>Wn(g.target.value),className:"w-full px-2 py-1.5 text-xs border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[o.jsx("option",{value:"single",children:"Single Color"}),o.jsx("option",{value:"visible_outgoing",children:"Visible Outgoing Flow"}),o.jsx("option",{value:"visible_incoming",children:"Visible Incoming Flow"}),o.jsx("option",{value:"year_outgoing",children:"Year Outgoing Flow"}),o.jsx("option",{value:"year_incoming",children:"Year Incoming Flow"}),o.jsx("option",{value:"net_year",children:"Net Flow (year)"}),o.jsx("option",{value:"self_year",children:"Self Flow (year)"}),o.jsx("option",{value:"attribute",children:"By Attribute"})]}),ln==="attribute"&&o.jsxs("select",{value:$t||"",onChange:g=>Kn(g.target.value||null),className:"w-full px-2 py-1.5 text-xs border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[o.jsx("option",{value:"",children:"Select..."}),a.metadata.hasCategoricalProperties.nodes.map(g=>o.jsx("option",{value:g,children:g},g)),a.metadata.hasNumericProperties.nodes.map(g=>o.jsx("option",{value:g,children:g},g))]})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsx("label",{className:"text-xs font-medium text-gray-700",children:"Node Size"}),o.jsxs("select",{value:We,onChange:g=>Yn(g.target.value),className:"w-full px-2 py-1.5 text-xs border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[o.jsx("option",{value:"fixed",children:"Fixed"}),o.jsx("option",{value:"visible_outgoing",children:"Visible Outgoing Flow"}),o.jsx("option",{value:"visible_incoming",children:"Visible Incoming Flow"}),o.jsx("option",{value:"year_outgoing",children:"Year Outgoing Flow"}),o.jsx("option",{value:"year_incoming",children:"Year Incoming Flow"}),o.jsx("option",{value:"net_visible",children:"Net Flow (visible)"}),o.jsx("option",{value:"net_year",children:"Net Flow (year)"}),o.jsx("option",{value:"self_year",children:"Self Flow (year)"}),o.jsx("option",{value:"attribute",children:"By Attribute"})]}),We==="attribute"&&o.jsxs("select",{value:qt||"",onChange:g=>Xn(g.target.value||null),className:"w-full px-2 py-1.5 text-xs border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[o.jsx("option",{value:"",children:"Select..."}),a.metadata.hasNumericProperties.nodes.map(g=>o.jsx("option",{value:g,children:g},g))]})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsx("label",{className:"text-xs font-medium text-gray-700",children:"Interaction Mode"}),o.jsxs("select",{value:ct,onChange:g=>Wt(g.target.value),className:"w-full px-2 py-1.5 text-xs border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[o.jsx("option",{value:"pan",children:"Pan"}),o.jsx("option",{value:"lens",children:"Edge Lens"})]}),ct==="lens"&&o.jsxs("div",{className:"space-y-1",children:[o.jsxs("label",{className:"text-[11px] text-gray-600",children:["Lens Radius: ",Kt,"px"]}),o.jsx("input",{type:"range",min:20,max:300,step:5,value:Kt,onChange:g=>un(parseInt(g.target.value)),className:"w-full"}),o.jsx("p",{className:"text-[10px] text-gray-500",children:"Scroll over the visualization to adjust while lens mode is active."})]})]})]}):o.jsx("div",{className:"text-xs text-gray-500 italic",children:"No dataset metadata available"})}),P==="table"&&o.jsx(Dt,{title:"Table Settings",defaultOpen:!1,children:o.jsx("div",{className:"text-xs text-gray-500 italic",children:"Settings to be added"})}),P==="sankey"&&o.jsx(Dt,{title:"Sankey Settings",defaultOpen:!1,children:o.jsx("div",{className:"text-xs text-gray-500 italic",children:"Settings to be added"})}),P==="chord"&&o.jsx(Dt,{title:"Chord Settings",defaultOpen:!1,children:o.jsx("div",{className:"text-xs text-gray-500 italic",children:"Settings to be added"})})]})})]})})}async function hi(){const e="csv-usa-pre-2020",s="csv-usa-post-2020",t="csv-2021",n="gexf-sample",r="swiss-2016";let i=await pt(e),l=await pt(s);const a=b=>b?b.snapshots.every(h=>{const v=new Set(h.nodes.map(x=>x.label));if(v.size!==pi)return!1;for(const x of v)if(!mi.has(x))return!1;return!0}):!1;(i?!a(i):!1)&&(await Pn(e).catch(()=>{}),i=void 0),(l?!a(l):!1)&&(await Pn(s).catch(()=>{}),l=void 0);let c=!!i,p=!!l;const m=await pt(t),f=await pt(n),w=await pt(r),S=async b=>{const h=[];for(const v of b)try{const x=new URL(Object.assign({"../data/StateToStateMigrationUSCSV/state_to_state_migration_table_2022_t13_updated_2024_06_27_2022.csv":Do,"../data/StateToStateMigrationUSCSV/state_to_state_migration_table_2023_t13_2023.csv":Lo,"../data/StateToStateMigrationUSCSV/state_to_state_migrations_table_2005_2005.csv":To,"../data/StateToStateMigrationUSCSV/state_to_state_migrations_table_2005_2007_2005-2007.csv":zo,"../data/StateToStateMigrationUSCSV/state_to_state_migrations_table_2005_2009_2005-2009.csv":Ho,"../data/StateToStateMigrationUSCSV/state_to_state_migrations_table_2006_2006.csv":Oo,"../data/StateToStateMigrationUSCSV/state_to_state_migrations_table_2006_2008_2006-2008.csv":Go,"../data/StateToStateMigrationUSCSV/state_to_state_migrations_table_2007_2007.csv":Uo,"../data/StateToStateMigrationUSCSV/state_to_state_migrations_table_2007_2009_2007-2009.csv":Bo,"../data/StateToStateMigrationUSCSV/state_to_state_migrations_table_2008_2008.csv":qo,"../data/StateToStateMigrationUSCSV/state_to_state_migrations_table_2009_2009.csv":Wo,"../data/StateToStateMigrationUSCSV/state_to_state_migrations_table_2010_2010.csv":Ko,"../data/StateToStateMigrationUSCSV/state_to_state_migrations_table_2011_2011.csv":Yo,"../data/StateToStateMigrationUSCSV/state_to_state_migrations_table_2012_2012.csv":Xo,"../data/StateToStateMigrationUSCSV/state_to_state_migrations_table_2013_2013.csv":Zo,"../data/StateToStateMigrationUSCSV/state_to_state_migrations_table_2014_2014.csv":Qo,"../data/StateToStateMigrationUSCSV/state_to_state_migrations_table_2015_2015.csv":Jo,"../data/StateToStateMigrationUSCSV/state_to_state_migrations_table_2016_2016.csv":er,"../data/StateToStateMigrationUSCSV/state_to_state_migrations_table_2017_2017.csv":tr,"../data/StateToStateMigrationUSCSV/state_to_state_migrations_table_2018_2018.csv":nr,"../data/StateToStateMigrationUSCSV/state_to_state_migrations_table_2019_2019.csv":sr,"../data/StateToStateMigrationUSCSV/state_to_state_migrations_table_2021_2021.csv":or})[`../data/StateToStateMigrationUSCSV/${v.filename}`],import.meta.url),_=await Qt(x.toString()),M=$n(_);h.push({timestamp:v.year,nodes:M.nodes,edges:M.edges})}catch(x){console.warn(`⚠️ Failed to load snapshot for ${v.filename}:`,x)}return h.sort((v,x)=>{const _=typeof v.timestamp=="string"?Number.parseInt(v.timestamp,10):v.timestamp,M=typeof x.timestamp=="string"?Number.parseInt(x.timestamp,10):x.timestamp;return _-M}),h};if(!i){const b=es.filter(v=>v.year<=2019),h=await S(b);if(h.length>0){const v=h[0],x=h[h.length-1],_=Rt(v),M={id:e,name:"US State-to-State Migration (2005-2019)",notes:"Tidy ACS 1-year state-to-state migration flows from 2005 through 2019. The Census Bureau did not release 2020 1-year migration flows, so the series stops before the pandemic.",type:"csv",timeRange:{start:typeof v.timestamp=="string"?Number.parseInt(v.timestamp,10):v.timestamp,end:typeof x.timestamp=="string"?Number.parseInt(x.timestamp,10):x.timestamp},snapshots:h,metadata:_,createdAt:Date.now()};await mt(M),c=!0}}if(!l){const b=es.filter(v=>v.year>=2021),h=await S(b);if(h.length>0){const v=h[0],x=h[h.length-1],_=Rt(v),M={id:s,name:"US State-to-State Migration (2021-2023)",notes:"Post-2020 ACS 1-year state-to-state migration flows. The 2022 release includes revised Connecticut flows per Census errata guidance.",type:"csv",timeRange:{start:typeof v.timestamp=="string"?Number.parseInt(v.timestamp,10):v.timestamp,end:typeof x.timestamp=="string"?Number.parseInt(x.timestamp,10):x.timestamp},snapshots:h,metadata:_,createdAt:Date.now()};await mt(M),p=!0}}if(!m){const b=new URL("/INF358_Project_Kriskogram/assets/State_to_State_Migrations_Table_2021-N7RTh5uH.csv",import.meta.url),h=await Qt(b.toString()),v=$n(h),x={timestamp:2021,nodes:v.nodes,edges:v.edges},_=Rt(x),M={id:t,name:"US State-to-State Migration (2021)",notes:"Real U.S. Census Bureau data showing migration flows between all 50 states from the American Community Survey 1-Year Estimates.",type:"csv",timeRange:{start:2021,end:2021},snapshots:[x],metadata:_,createdAt:Date.now()};await mt(M)}if(!f){const b=new URL("/INF358_Project_Kriskogram/assets/sample-migration-data-Dify6Mt1.gexf",import.meta.url),h=await so(b.toString()),v=Cs(h),x=v.length>0?Rt(v[0]):void 0,_={id:n,name:"Sample Migration (GEXF)",notes:"AI-generated sample network dataset in GEXF format demonstrating temporal migration patterns with multiple time slices. This example dataset includes economic, geographic, and migration type attributes for demonstration purposes.",type:"gexf",timeRange:h.timeRange,snapshots:v,metadata:x,createdAt:Date.now()};await mt(_)}if(!w){const b="/INF358_Project_Kriskogram/",h=`${b}data/Swiss_Relocations_2016_locations.csv`,v=`${b}data/Swiss_Relocations_2016_flows.csv`,x=await Qt(h),_=await Qt(v),M=Ms({nodesFile:{content:x,idField:"id",labelField:"name"},edgesFile:{content:_,sourceField:"origin",targetField:"dest",valueField:"count"}}),C={timestamp:2016,nodes:M.nodes,edges:M.edges},k=Rt(C),I={id:r,name:"Swiss Relocations (2016)",notes:"Relocations between Swiss cantons in 2016. This dataset contains 521,510 trips and uses a two-file CSV format with separate files for locations (cantons) and flows (relocations). Created by Ilya Boyandin.",type:"csv-two-file",timeRange:{start:2016,end:2016},snapshots:[C],metadata:k,createdAt:Date.now()};await mt(I)}if(c)return e;if(p)return s;if(m)return t}export{wi as component};
