import{c as Ft,r as S,j as o,C as vn,G as wn,u as yn,a as Sn,b as Cn,_ as bn,o as jn,p as wt,s as Pt,n as Vt}from"./main-DRfPWqBI.js";import{s as se,o as en,r as Ae,z as Rn,i as Nn,K as Fn}from"./Kriskogram-CuOzh8-a.js";import{p as tn,l as ot}from"./csv-parser-C3wi6dZF.js";import{p as $n,g as nn,l as _n}from"./gexf-parser-ChiJebeW.js";/**
 * @license lucide-react v0.476.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mn=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],En=Ft("ChevronDown",Mn);/**
 * @license lucide-react v0.476.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const In=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],Pn=Ft("ChevronUp",In);/**
 * @license lucide-react v0.476.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vn=[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],At=Ft("Settings",Vn);function An(e,s){return e==null||s==null?NaN:s<e?-1:s>e?1:s>=e?0:NaN}var Dt=Math.abs,it=Math.cos,at=Math.sin,sn=Math.PI,Ke=sn/2,kt=sn*2,Lt=Math.max,lt=1e-12;function zt(e,s){return Array.from({length:s-e},(t,n)=>e+n)}function Dn(e){return function(s,t){return e(s.source.value+s.target.value,t.source.value+t.target.value)}}function kn(){return Ln(!1)}function Ln(e,s){var t=0,n=null,r=null,i=null;function l(a){var u=a.length,c=new Array(u),d=zt(0,u),m=new Array(u*u),f=new Array(u),g=0,h;a=Float64Array.from({length:u*u},(x,y)=>a[y/u|0][y%u]);for(let x=0;x<u;++x){let y=0;for(let v=0;v<u;++v)y+=a[x*u+v]+e*a[v*u+x];g+=c[x]=y}g=Lt(0,kt-t*u)/g,h=g?t:kt/u;{let x=0;n&&d.sort((y,v)=>n(c[y],c[v]));for(const y of d){const v=x;{const C=zt(0,u).filter(w=>a[y*u+w]||a[w*u+y]);r&&C.sort((w,N)=>r(a[y*u+w],a[y*u+N]));for(const w of C){let N;if(y<w?(N=m[y*u+w]||(m[y*u+w]={source:null,target:null}),N.source={index:y,startAngle:x,endAngle:x+=a[y*u+w]*g,value:a[y*u+w]}):(N=m[w*u+y]||(m[w*u+y]={source:null,target:null}),N.target={index:y,startAngle:x,endAngle:x+=a[y*u+w]*g,value:a[y*u+w]},y===w&&(N.source=N.target)),N.source&&N.target&&N.source.value<N.target.value){const M=N.source;N.source=N.target,N.target=M}}f[y]={index:y,startAngle:v,endAngle:x,value:c[y]}}x+=h}}return m=Object.values(m),m.groups=f,i?m.sort(i):m}return l.padAngle=function(a){return arguments.length?(t=Lt(0,a),l):t},l.sortGroups=function(a){return arguments.length?(n=a,l):n},l.sortSubgroups=function(a){return arguments.length?(r=a,l):r},l.sortChords=function(a){return arguments.length?(a==null?i=null:(i=Dn(a))._=a,l):i&&i._},l}const yt=Math.PI,St=2*yt,Ve=1e-6,zn=St-Ve;function rn(e){this._+=e[0];for(let s=1,t=e.length;s<t;++s)this._+=arguments[s]+e[s]}function Tn(e){let s=Math.floor(e);if(!(s>=0))throw new Error(`invalid digits: ${e}`);if(s>15)return rn;const t=10**s;return function(n){this._+=n[0];for(let r=1,i=n.length;r<i;++r)this._+=Math.round(arguments[r]*t)/t+n[r]}}class $t{constructor(s){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=s==null?rn:Tn(s)}moveTo(s,t){this._append`M${this._x0=this._x1=+s},${this._y0=this._y1=+t}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(s,t){this._append`L${this._x1=+s},${this._y1=+t}`}quadraticCurveTo(s,t,n,r){this._append`Q${+s},${+t},${this._x1=+n},${this._y1=+r}`}bezierCurveTo(s,t,n,r,i,l){this._append`C${+s},${+t},${+n},${+r},${this._x1=+i},${this._y1=+l}`}arcTo(s,t,n,r,i){if(s=+s,t=+t,n=+n,r=+r,i=+i,i<0)throw new Error(`negative radius: ${i}`);let l=this._x1,a=this._y1,u=n-s,c=r-t,d=l-s,m=a-t,f=d*d+m*m;if(this._x1===null)this._append`M${this._x1=s},${this._y1=t}`;else if(f>Ve)if(!(Math.abs(m*u-c*d)>Ve)||!i)this._append`L${this._x1=s},${this._y1=t}`;else{let g=n-l,h=r-a,x=u*u+c*c,y=g*g+h*h,v=Math.sqrt(x),C=Math.sqrt(f),w=i*Math.tan((yt-Math.acos((x+f-y)/(2*v*C)))/2),N=w/C,M=w/v;Math.abs(N-1)>Ve&&this._append`L${s+N*d},${t+N*m}`,this._append`A${i},${i},0,0,${+(m*g>d*h)},${this._x1=s+M*u},${this._y1=t+M*c}`}}arc(s,t,n,r,i,l){if(s=+s,t=+t,n=+n,l=!!l,n<0)throw new Error(`negative radius: ${n}`);let a=n*Math.cos(r),u=n*Math.sin(r),c=s+a,d=t+u,m=1^l,f=l?r-i:i-r;this._x1===null?this._append`M${c},${d}`:(Math.abs(this._x1-c)>Ve||Math.abs(this._y1-d)>Ve)&&this._append`L${c},${d}`,n&&(f<0&&(f=f%St+St),f>zn?this._append`A${n},${n},0,1,${m},${s-a},${t-u}A${n},${n},0,1,${m},${this._x1=c},${this._y1=d}`:f>Ve&&this._append`A${n},${n},0,${+(f>=yt)},${m},${this._x1=s+n*Math.cos(i)},${this._y1=t+n*Math.sin(i)}`)}rect(s,t,n,r){this._append`M${this._x0=this._x1=+s},${this._y0=this._y1=+t}h${n=+n}v${+r}h${-n}Z`}toString(){return this._}}function _t(){return new $t}_t.prototype=$t.prototype;var Hn=Array.prototype.slice;function De(e){return function(){return e}}function On(e){return e.source}function Gn(e){return e.target}function Tt(e){return e.radius}function Bn(e){return e.startAngle}function Un(e){return e.endAngle}function qn(){return 0}function Wn(e){var s=On,t=Gn,n=Tt,r=Tt,i=Bn,l=Un,a=qn,u=null;function c(){var d,m=s.apply(this,arguments),f=t.apply(this,arguments),g=a.apply(this,arguments)/2,h=Hn.call(arguments),x=+n.apply(this,(h[0]=m,h)),y=i.apply(this,h)-Ke,v=l.apply(this,h)-Ke,C=+r.apply(this,(h[0]=f,h)),w=i.apply(this,h)-Ke,N=l.apply(this,h)-Ke;if(u||(u=d=_t()),g>lt&&(Dt(v-y)>g*2+lt?v>y?(y+=g,v-=g):(y-=g,v+=g):y=v=(y+v)/2,Dt(N-w)>g*2+lt?N>w?(w+=g,N-=g):(w-=g,N+=g):w=N=(w+N)/2),u.moveTo(x*it(y),x*at(y)),u.arc(0,0,x,y,v),(y!==w||v!==N)&&(u.quadraticCurveTo(0,0,C*it(w),C*at(w)),u.arc(0,0,C,w,N)),u.quadraticCurveTo(0,0,x*it(y),x*at(y)),u.closePath(),d)return u=null,d+""||null}return c.radius=function(d){return arguments.length?(n=r=typeof d=="function"?d:De(+d),c):n},c.sourceRadius=function(d){return arguments.length?(n=typeof d=="function"?d:De(+d),c):n},c.targetRadius=function(d){return arguments.length?(r=typeof d=="function"?d:De(+d),c):r},c.startAngle=function(d){return arguments.length?(i=typeof d=="function"?d:De(+d),c):i},c.endAngle=function(d){return arguments.length?(l=typeof d=="function"?d:De(+d),c):l},c.padAngle=function(d){return arguments.length?(a=typeof d=="function"?d:De(+d),c):a},c.source=function(d){return arguments.length?(s=d,c):s},c.target=function(d){return arguments.length?(t=d,c):t},c.context=function(d){return arguments.length?(u=d??null,c):u},c}function Xn(){return Wn()}function Kn(e){for(var s=e.length/6|0,t=new Array(s),n=0;n<s;)t[n]="#"+e.slice(n*6,++n*6);return t}const on=Kn("1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf");function _e(e){return function(){return e}}const Ht=Math.abs,me=Math.atan2,Pe=Math.cos,Yn=Math.max,ut=Math.min,je=Math.sin,Le=Math.sqrt,xe=1e-12,Be=Math.PI,tt=Be/2,Zn=2*Be;function Qn(e){return e>1?0:e<-1?Be:Math.acos(e)}function Ot(e){return e>=1?tt:e<=-1?-tt:Math.asin(e)}function Jn(e){let s=3;return e.digits=function(t){if(!arguments.length)return s;if(t==null)s=null;else{const n=Math.floor(t);if(!(n>=0))throw new RangeError(`invalid digits: ${t}`);s=n}return e},()=>new $t(s)}function es(e){return e.innerRadius}function ts(e){return e.outerRadius}function ns(e){return e.startAngle}function ss(e){return e.endAngle}function rs(e){return e&&e.padAngle}function os(e,s,t,n,r,i,l,a){var u=t-e,c=n-s,d=l-r,m=a-i,f=m*u-d*c;if(!(f*f<xe))return f=(d*(s-i)-m*(e-r))/f,[e+f*u,s+f*c]}function Ye(e,s,t,n,r,i,l){var a=e-t,u=s-n,c=(l?i:-i)/Le(a*a+u*u),d=c*u,m=-c*a,f=e+d,g=s+m,h=t+d,x=n+m,y=(f+h)/2,v=(g+x)/2,C=h-f,w=x-g,N=C*C+w*w,M=r-i,R=f*x-h*g,V=(w<0?-1:1)*Le(Yn(0,M*M*N-R*R)),E=(R*w-C*V)/N,I=(-R*C-w*V)/N,B=(R*w+C*V)/N,P=(-R*C+w*V)/N,G=E-y,_=I-v,T=B-y,q=P-v;return G*G+_*_>T*T+q*q&&(E=B,I=P),{cx:E,cy:I,x01:-d,y01:-m,x11:E*(r/M-1),y11:I*(r/M-1)}}function is(){var e=es,s=ts,t=_e(0),n=null,r=ns,i=ss,l=rs,a=null,u=Jn(c);function c(){var d,m,f=+e.apply(this,arguments),g=+s.apply(this,arguments),h=r.apply(this,arguments)-tt,x=i.apply(this,arguments)-tt,y=Ht(x-h),v=x>h;if(a||(a=d=u()),g<f&&(m=g,g=f,f=m),!(g>xe))a.moveTo(0,0);else if(y>Zn-xe)a.moveTo(g*Pe(h),g*je(h)),a.arc(0,0,g,h,x,!v),f>xe&&(a.moveTo(f*Pe(x),f*je(x)),a.arc(0,0,f,x,h,v));else{var C=h,w=x,N=h,M=x,R=y,V=y,E=l.apply(this,arguments)/2,I=E>xe&&(n?+n.apply(this,arguments):Le(f*f+g*g)),B=ut(Ht(g-f)/2,+t.apply(this,arguments)),P=B,G=B,_,T;if(I>xe){var q=Ot(I/f*je(E)),X=Ot(I/g*je(E));(R-=q*2)>xe?(q*=v?1:-1,N+=q,M-=q):(R=0,N=M=(h+x)/2),(V-=X*2)>xe?(X*=v?1:-1,C+=X,w-=X):(V=0,C=w=(h+x)/2)}var Y=g*Pe(C),Z=g*je(C),re=f*Pe(M),j=f*je(M);if(B>xe){var A=g*Pe(w),Q=g*je(w),ie=f*Pe(N),oe=f*je(N),D;if(y<Be)if(D=os(Y,Z,ie,oe,A,Q,re,j)){var J=Y-D[0],U=Z-D[1],ee=A-D[0],ce=Q-D[1],fe=1/je(Qn((J*ee+U*ce)/(Le(J*J+U*U)*Le(ee*ee+ce*ce)))/2),he=Le(D[0]*D[0]+D[1]*D[1]);P=ut(B,(f-he)/(fe-1)),G=ut(B,(g-he)/(fe+1))}else P=G=0}V>xe?G>xe?(_=Ye(ie,oe,Y,Z,g,G,v),T=Ye(A,Q,re,j,g,G,v),a.moveTo(_.cx+_.x01,_.cy+_.y01),G<B?a.arc(_.cx,_.cy,G,me(_.y01,_.x01),me(T.y01,T.x01),!v):(a.arc(_.cx,_.cy,G,me(_.y01,_.x01),me(_.y11,_.x11),!v),a.arc(0,0,g,me(_.cy+_.y11,_.cx+_.x11),me(T.cy+T.y11,T.cx+T.x11),!v),a.arc(T.cx,T.cy,G,me(T.y11,T.x11),me(T.y01,T.x01),!v))):(a.moveTo(Y,Z),a.arc(0,0,g,C,w,!v)):a.moveTo(Y,Z),!(f>xe)||!(R>xe)?a.lineTo(re,j):P>xe?(_=Ye(re,j,A,Q,f,-P,v),T=Ye(Y,Z,ie,oe,f,-P,v),a.lineTo(_.cx+_.x01,_.cy+_.y01),P<B?a.arc(_.cx,_.cy,P,me(_.y01,_.x01),me(T.y01,T.x01),!v):(a.arc(_.cx,_.cy,P,me(_.y01,_.x01),me(_.y11,_.x11),!v),a.arc(0,0,f,me(_.cy+_.y11,_.cx+_.x11),me(T.cy+T.y11,T.cx+T.x11),v),a.arc(T.cx,T.cy,P,me(T.y11,T.x11),me(T.y01,T.x01),!v))):a.arc(0,0,f,M,N,v)}if(a.closePath(),d)return a=null,d+""||null}return c.centroid=function(){var d=(+e.apply(this,arguments)+ +s.apply(this,arguments))/2,m=(+r.apply(this,arguments)+ +i.apply(this,arguments))/2-Be/2;return[Pe(m)*d,je(m)*d]},c.innerRadius=function(d){return arguments.length?(e=typeof d=="function"?d:_e(+d),c):e},c.outerRadius=function(d){return arguments.length?(s=typeof d=="function"?d:_e(+d),c):s},c.cornerRadius=function(d){return arguments.length?(t=typeof d=="function"?d:_e(+d),c):t},c.padRadius=function(d){return arguments.length?(n=d==null?null:typeof d=="function"?d:_e(+d),c):n},c.startAngle=function(d){return arguments.length?(r=typeof d=="function"?d:_e(+d),c):r},c.endAngle=function(d){return arguments.length?(i=typeof d=="function"?d:_e(+d),c):i},c.padAngle=function(d){return arguments.length?(l=typeof d=="function"?d:_e(+d),c):l},c.context=function(d){return arguments.length?(a=d??null,c):a},c}function Oe(e){const s=new Set,t=new Set,n=new Set,r=new Set,i=new Set,l=new Set;return e.nodes.forEach(a=>{Object.keys(a).forEach(u=>{if(u!=="id"&&u!=="label"){s.add(u);const c=a[u];typeof c=="number"?n.add(u):typeof c=="string"&&i.add(u)}})}),e.edges.forEach(a=>{Object.keys(a).forEach(u=>{if(u!=="source"&&u!=="target"&&u!=="value"){t.add(u);const c=a[u];typeof c=="number"?r.add(u):typeof c=="string"&&l.add(u)}})}),{nodeProperties:Array.from(s),edgeProperties:Array.from(t),hasNumericProperties:{nodes:Array.from(n),edges:Array.from(r)},hasCategoricalProperties:{nodes:Array.from(i),edges:Array.from(l)}}}const as="kriskogram-db",ls=1,Se="datasets";function Ue(){return new Promise((e,s)=>{const t=indexedDB.open(as,ls);t.onupgradeneeded=()=>{const n=t.result;n.objectStoreNames.contains(Se)||n.createObjectStore(Se,{keyPath:"id"})},t.onsuccess=()=>e(t.result),t.onerror=()=>s(t.error)})}async function ze(e){const s=await Ue();return new Promise((t,n)=>{const r=s.transaction(Se,"readwrite");r.objectStore(Se).put(e),r.oncomplete=()=>t(),r.onerror=()=>n(r.error),r.onabort=()=>n(r.error)})}async function Te(e){const s=await Ue();return new Promise((t,n)=>{const l=s.transaction(Se,"readonly").objectStore(Se).get(e);l.onsuccess=()=>t(l.result),l.onerror=()=>n(l.error)})}async function us(){const e=await Ue();return new Promise((s,t)=>{const i=e.transaction(Se,"readonly").objectStore(Se).getAll();i.onsuccess=()=>s(i.result||[]),i.onerror=()=>t(i.error)})}async function ds(e){const s=await Ue();return new Promise((t,n)=>{const r=s.transaction(Se,"readwrite");r.objectStore(Se).delete(e),r.oncomplete=()=>t(),r.onerror=()=>n(r.error)})}async function cs(e){const s=await Te(e);if(!s)throw new Error(`Dataset ${e} not found`);const t={...s,id:`${s.type}-${Date.now()}`,name:`${s.name} (Copy)`,createdAt:Date.now()};return await ze(t),t}async function gs(){const e=await Ue();return new Promise((s,t)=>{const n=e.transaction(Se,"readwrite");n.objectStore(Se).clear(),n.oncomplete=()=>s(),n.onerror=()=>t(n.error)})}async function fs(){if("storage"in navigator&&"persist"in navigator.storage)try{return await navigator.storage.persist()}catch{return!1}return!1}function Gt(e){const s=[];let t="",n=!1;for(let r=0;r<e.length;r++){const i=e[r];i==='"'?n=!n:i===","&&!n?(s.push(t),t=""):t+=i}return s.push(t),s}function Bt(e){const s=e.trim().split(`
`).filter(r=>r.trim());if(s.length===0)throw new Error("CSV file is empty");const t=Gt(s[0]).map(r=>r.trim()),n=s.slice(1).map(Gt);return{headers:t,rows:n}}function dt(e){const s=e.replace(/[",]/g,"").trim(),t=Number.parseFloat(s);return Number.isNaN(t)?s:t}function an(e){var M;const{headers:s,rows:t}=Bt(e.nodesFile.content),n=s.map(R=>R.toLowerCase().trim()),r=e.nodesFile.idField.toLowerCase().trim(),i=((M=e.nodesFile.labelField)==null?void 0:M.toLowerCase().trim())||r,l=n.indexOf(r),a=e.nodesFile.labelField?n.indexOf(i):l;if(l===-1)throw new Error(`ID field "${e.nodesFile.idField}" not found in nodes file. Available fields: ${s.join(", ")}`);const u=t.map(R=>{const V={id:String(R[l]||"").trim(),label:a>=0?String(R[a]||"").trim():String(R[l]||"").trim()},E=s[l],I=e.nodesFile.labelField?s[a]:E;return s.forEach((B,P)=>{var G;if(B!==E&&B!==I){const _=((G=R[P])==null?void 0:G.trim())||"";V[B]=dt(_)}}),V}).filter(R=>R.id),c=new Map(u.map(R=>[R.id,R])),{headers:d,rows:m}=Bt(e.edgesFile.content),f=d.map(R=>R.toLowerCase().trim()),g=e.edgesFile.sourceField.toLowerCase().trim(),h=e.edgesFile.targetField.toLowerCase().trim(),x=e.edgesFile.valueField.toLowerCase().trim(),y=f.indexOf(g),v=f.indexOf(h),C=f.indexOf(x);if(y===-1)throw new Error(`Source field "${e.edgesFile.sourceField}" not found in edges file. Available fields: ${d.join(", ")}`);if(v===-1)throw new Error(`Target field "${e.edgesFile.targetField}" not found in edges file. Available fields: ${d.join(", ")}`);if(C===-1)throw new Error(`Value field "${e.edgesFile.valueField}" not found in edges file. Available fields: ${d.join(", ")}`);const w=m.map(R=>{const V=String(R[y]||"").trim(),E=String(R[v]||"").trim(),I=String(R[C]||"").trim(),B=dt(I);if(!V||!E||typeof B!="number"||B<=0)return null;(!c.has(V)||!c.has(E))&&console.warn(`Edge references missing node: ${V} -> ${E}`);const P={source:V,target:E,value:B},G=d[y],_=d[v],T=d[C];return d.forEach((q,X)=>{var Y;if(q!==G&&q!==_&&q!==T){const Z=((Y=R[X])==null?void 0:Y.trim())||"";P[q]=dt(Z)}}),P}).filter(R=>R!==null&&c.has(R.source)&&c.has(R.target)),N=new Set;return w.forEach(R=>{N.add(R.source),N.add(R.target)}),N.forEach(R=>{c.has(R)||u.push({id:R,label:R})}),{nodes:u,edges:w}}function ms({onClose:e,onImport:s,fileInputRef:t,onFilesSelected:n,existingFile:r}){const[i,l]=S.useState(""),[a,u]=S.useState(""),[c,d]=S.useState(!1),[m,f]=S.useState({}),[g,h]=S.useState(!1),[x,y]=S.useState(null),[v,C]=S.useState([]),[w,N]=S.useState([]),[M,R]=S.useState(null),V=S.useRef(null),E=S.useRef(null),[I,B]=S.useState(null),[P,G]=S.useState(null),[_,T]=S.useState([]),[q,X]=S.useState([]),[Y,Z]=S.useState(""),[re,j]=S.useState(""),[A,Q]=S.useState(""),[ie,oe]=S.useState(""),[D,J]=S.useState(""),[U,ee]=S.useState(null);function ce(b){let F=b.replace(/\.(csv|gexf)$/i,"");return F=F.replace(/([a-z])([A-Z])/g,"$1 $2").replace(/[_-]/g," ").replace(/[^a-zA-Z0-9\s]/g," ").replace(/\s+/g," ").trim(),F.split(" ").map(H=>H.charAt(0).toUpperCase()+H.slice(1).toLowerCase()).join(" ")}S.useEffect(()=>{var b;if(r!=null&&r.parsedData){ee(r.parsedData);const F=((b=r.files[0])==null?void 0:b.name)||"";l(ce(F)),u(r.files.map(H=>H.name).join(", "))}},[r]),S.useEffect(()=>{var b;if(!r&&v.length>0){if(!i||i===ce(((b=v[0])==null?void 0:b.name)||"")){const F=v[0].name;l(ce(F))}a||u(v.map(F=>F.name).join(", "))}},[v]);function fe(b){const F=[];let H="",p=!1;for(let $=0;$<b.length;$++){const k=b[$];k==='"'?p=!p:k===","&&!p?(F.push(H),H=""):H+=k}return F.push(H),F}function he(b){const F=b.trim().split(`
`);if(F.length===0)return[];const H=F[0];return fe(H).map(p=>p.trim().replace(/^"|"$/g,""))}async function ae(b){const F=Array.from(b.target.files||[]);if(F.length===0)return;C(F);const H=await Promise.all(F.map($=>$.text()));N(H);const p=F[0].name.toLowerCase();if(p.endsWith(".gexf")){R("gexf"),y("single");try{const $=$n(H[0]),k=nn($);ee({nodes:k.length>0?k[0].nodes:[],edges:k.length>0?k[0].edges:[],timeRange:$.timeRange}),l(F[0].name.replace(".gexf",""))}catch($){f([$ instanceof Error?$.message:"Failed to parse GEXF"])}}else if(p.endsWith(".csv")){if(R("csv"),F.length===1){y("single");try{const $=tn(H[0]);ee({nodes:$.nodes,edges:$.edges,timeRange:{start:2021,end:2021}}),l(F[0].name.replace(".csv",""))}catch{y("two-file");const k=he(H[0]);T(k),X(k),B(0);const W=k.find(O=>O.toLowerCase()==="id"||O.toLowerCase()==="node"||O.toLowerCase()==="name"),le=k.find(O=>O.toLowerCase()==="source"||O.toLowerCase()==="origin"||O.toLowerCase()==="from"),ue=k.find(O=>O.toLowerCase()==="target"||O.toLowerCase()==="dest"||O.toLowerCase()==="destination"||O.toLowerCase()==="to"),ve=k.find(O=>O.toLowerCase()==="value"||O.toLowerCase()==="count"||O.toLowerCase()==="weight");W&&Z(W),le&&Q(le),ue&&oe(ue),ve&&J(ve),f(["Could not parse as state migration format. Please select which file contains nodes and which contains edges."])}}else if(F.length===2){y("two-file");const $=he(H[0]),k=he(H[1]);T($),X(k),B(0),G(1);const W=$.find(ne=>ne.toLowerCase()==="id"),le=$.find(ne=>ne.toLowerCase()==="name"||ne.toLowerCase()==="label");W&&Z(W),le&&j(le);const ue=k.find(ne=>ne.toLowerCase()==="source"||ne.toLowerCase()==="origin"||ne.toLowerCase()==="from"),ve=k.find(ne=>ne.toLowerCase()==="target"||ne.toLowerCase()==="dest"||ne.toLowerCase()==="destination"||ne.toLowerCase()==="to"),O=k.find(ne=>ne.toLowerCase()==="value"||ne.toLowerCase()==="count"||ne.toLowerCase()==="weight");ue&&Q(ue),ve&&oe(ve),O&&J(O),qe()}}t.current&&(t.current.value="")}function qe(){if(I===null||P===null||!Y||!A||!ie||!D){f(["Please select all required fields"]),ee(null);return}try{const b=an({nodesFile:{content:w[I],idField:Y,labelField:re||Y},edgesFile:{content:w[P],sourceField:A,targetField:ie,valueField:D}});ee({nodes:b.nodes,edges:b.edges,timeRange:{start:2016,end:2016}}),f([])}catch(b){f([b instanceof Error?b.message:"Failed to parse two-file CSV"]),ee(null)}}S.useEffect(()=>{x==="two-file"&&I!==null&&P!==null&&qe()},[Y,re,A,ie,D,I,P]);function Re(){const b={},F=[];if(i.trim()||(b.name="Dataset name is required"),x==="two-file"&&(I===null&&(b.nodesFile="Please select which file contains nodes"),P===null&&(b.edgesFile="Please select which file contains edges"),I!==null&&!Y&&(b.nodeIdField="Please select the ID field for nodes"),P!==null&&!A&&(b.edgeSourceField="Please select the source field for edges"),P!==null&&!ie&&(b.edgeTargetField="Please select the target field for edges"),P!==null&&!D&&(b.edgeValueField="Please select the value field for edges")),!U)return b.general="Data parsing failed - please check file format and field selections",b;U.nodes.length===0&&F.push("No nodes found in dataset"),U.edges.length===0&&F.push("No edges found in dataset");const H=new Set(U.nodes.map($=>$.id));H.size!==U.nodes.length&&F.push(`${U.nodes.length-H.size} duplicate node IDs found`);const p=U.edges.filter($=>!H.has($.source)||!H.has($.target));return p.length>0&&F.push(`${p.length} edges reference non-existent nodes`),F.length>0&&(b.summary=F.join("; ")),b}function te(){m.name&&V.current?(V.current.scrollIntoView({behavior:"smooth",block:"center"}),V.current.focus()):m.summary&&E.current&&E.current.scrollIntoView({behavior:"smooth",block:"center"})}async function Ne(){const b=Re();if(f(b),Object.keys(b).filter(H=>H!=="summary").length>0||!U){setTimeout(()=>te(),100);return}d(!0);try{const H=U.timeRange||{start:2021,end:2021},p={timestamp:H.start,nodes:U.nodes,edges:U.edges},$=Oe(p),k=[p],W={name:i.trim(),filename:v.map(le=>le.name).join(", "),notes:a.trim()||void 0,type:x==="two-file"?"csv":M||"csv",timeRange:H,snapshots:k,metadata:$};await s(W,{nodes:U.nodes,edges:U.edges,snapshots:k,metadata:$})}catch(H){console.error("Import error:",H),f({general:H instanceof Error?H.message:"Failed to import dataset"}),d(!1),setTimeout(()=>te(),100)}}return o.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:o.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-4xl w-full mx-4 max-h-[90vh] flex flex-col",children:[o.jsxs("div",{className:"p-6 border-b flex items-center justify-between",children:[o.jsx("h2",{className:"text-2xl font-bold",children:"Import Dataset"}),o.jsx("button",{onClick:e,className:"text-gray-400 hover:text-gray-600 text-2xl",children:"×"})]}),o.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:o.jsxs("div",{className:"space-y-6",children:[!x&&o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Select Files ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsxs("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-6 text-center",children:[o.jsx("button",{onClick:()=>{var b;return(b=t.current)==null?void 0:b.click()},className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700",children:"Choose Files"}),o.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"Select 1 file (GEXF or CSV) or 2 files (CSV nodes + CSV edges)"}),o.jsx("input",{ref:t,type:"file",accept:".csv,.gexf",multiple:!0,onChange:ae,className:"hidden"})]})]}),v.length>0&&o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Selected Files"}),o.jsxs("div",{className:"space-y-2",children:[v.map((b,F)=>o.jsxs("div",{className:"flex items-center justify-between bg-gray-50 p-3 rounded",children:[o.jsx("span",{className:"text-sm",children:b.name}),o.jsx("button",{onClick:()=>{const H=[...v];H.splice(F,1),C(H);const p=[...w];p.splice(F,1),N(p),x==="two-file"&&(I===F&&B(null),P===F&&G(null),I&&I>F&&B(I-1),P&&P>F&&G(P-1))},className:"text-red-600 text-sm hover:text-red-800",children:"Remove"})]},F)),o.jsx("button",{type:"button",onClick:()=>{const b=document.createElement("input");b.type="file",b.accept=".csv,.gexf",b.multiple=!0,b.onchange=async F=>{const H=F.target,p=Array.from(H.files||[]);if(p.length>0){const $=await Promise.all(p.map(W=>W.text()));C([...v,...p]),N([...w,...$]);const k=[...v,...p];k.length===2&&k.every(W=>W.name.toLowerCase().endsWith(".csv"))&&(y("two-file"),R("csv"))}},b.click()},className:"text-sm text-blue-600 hover:text-blue-800",children:"+ Add More Files"})]})]}),x==="two-file"&&v.length>0&&o.jsxs("div",{className:"border-t pt-4 space-y-4","data-file-select":!0,children:[o.jsx("h3",{className:"font-semibold",children:"Map Files and Fields"}),o.jsxs("div",{"data-field-select":!0,children:[o.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Nodes File (Locations) ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsxs("select",{value:I??"",onChange:b=>{const F=parseInt(b.target.value);B(F);const H=he(w[F]);T(H);const p=H.find($=>$.toLowerCase()==="id");if(p&&Z(p),m.nodesFile){const $={...m};delete $.nodesFile,f($)}},className:`w-full px-3 py-2 border rounded-md ${m.nodesFile?"border-red-500":"border-gray-300"}`,children:[o.jsx("option",{value:"",children:"Select file..."}),v.map((b,F)=>o.jsx("option",{value:F,children:b.name},F))]}),m.nodesFile&&o.jsx("p",{className:"mt-1 text-sm text-red-600",children:m.nodesFile}),I!==null&&_.length>0&&o.jsxs("div",{className:"mt-2 space-y-2",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"ID Field *"}),o.jsxs("select",{value:Y,onChange:b=>{if(Z(b.target.value),m.nodeIdField){const F={...m};delete F.nodeIdField,f(F)}},className:`w-full px-2 py-1 border rounded text-sm ${m.nodeIdField?"border-red-500":"border-gray-300"}`,children:[o.jsx("option",{value:"",children:"Select field..."}),_.map(b=>o.jsx("option",{value:b,children:b},b))]}),m.nodeIdField&&o.jsx("p",{className:"mt-1 text-xs text-red-600",children:m.nodeIdField})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"Label Field (optional)"}),o.jsxs("select",{value:re,onChange:b=>j(b.target.value),className:"w-full px-2 py-1 border border-gray-300 rounded text-sm",children:[o.jsx("option",{value:"",children:"Use ID field"}),_.map(b=>o.jsx("option",{value:b,children:b},b))]})]})]})]}),o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Edges File (Flows) ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsxs("select",{value:P??"",onChange:b=>{const F=parseInt(b.target.value);G(F);const H=he(w[F]);X(H);const p=H.find(W=>W.toLowerCase()==="source"||W.toLowerCase()==="origin"||W.toLowerCase()==="from"),$=H.find(W=>W.toLowerCase()==="target"||W.toLowerCase()==="dest"||W.toLowerCase()==="to"),k=H.find(W=>W.toLowerCase()==="value"||W.toLowerCase()==="count"||W.toLowerCase()==="weight");if(p&&Q(p),$&&oe($),k&&J(k),m.edgesFile){const W={...m};delete W.edgesFile,f(W)}},className:`w-full px-3 py-2 border rounded-md ${m.edgesFile?"border-red-500":"border-gray-300"}`,children:[o.jsx("option",{value:"",children:"Select file..."}),v.map((b,F)=>o.jsx("option",{value:F,children:b.name},F))]}),m.edgesFile&&o.jsx("p",{className:"mt-1 text-sm text-red-600",children:m.edgesFile}),P!==null&&q.length>0&&o.jsxs("div",{className:"mt-2 space-y-2",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"Source Field *"}),o.jsxs("select",{value:A,onChange:b=>{if(Q(b.target.value),m.edgeSourceField){const F={...m};delete F.edgeSourceField,f(F)}},className:`w-full px-2 py-1 border rounded text-sm ${m.edgeSourceField?"border-red-500":"border-gray-300"}`,children:[o.jsx("option",{value:"",children:"Select field..."}),q.map(b=>o.jsx("option",{value:b,children:b},b))]}),m.edgeSourceField&&o.jsx("p",{className:"mt-1 text-xs text-red-600",children:m.edgeSourceField})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"Target Field *"}),o.jsxs("select",{value:ie,onChange:b=>{if(oe(b.target.value),m.edgeTargetField){const F={...m};delete F.edgeTargetField,f(F)}},className:`w-full px-2 py-1 border rounded text-sm ${m.edgeTargetField?"border-red-500":"border-gray-300"}`,children:[o.jsx("option",{value:"",children:"Select field..."}),q.map(b=>o.jsx("option",{value:b,children:b},b))]}),m.edgeTargetField&&o.jsx("p",{className:"mt-1 text-xs text-red-600",children:m.edgeTargetField})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"Value Field *"}),o.jsxs("select",{value:D,onChange:b=>{if(J(b.target.value),m.edgeValueField){const F={...m};delete F.edgeValueField,f(F)}},className:`w-full px-2 py-1 border rounded text-sm ${m.edgeValueField?"border-red-500":"border-gray-300"}`,children:[o.jsx("option",{value:"",children:"Select field..."}),q.map(b=>o.jsx("option",{value:b,children:b},b))]}),m.edgeValueField&&o.jsx("p",{className:"mt-1 text-xs text-red-600",children:m.edgeValueField})]})]})]})]}),o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Dataset Name ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsx("input",{ref:V,type:"text",value:i,onChange:b=>{if(l(b.target.value),m.name){const F={...m};delete F.name,f(F)}},className:`w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 ${m.name?"border-red-500 focus:ring-red-500":"border-gray-300 focus:ring-blue-500"}`,placeholder:"Enter a name for this dataset"}),m.name&&o.jsx("p",{className:"mt-1 text-sm text-red-600",children:m.name})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Notes (optional)"}),o.jsx("textarea",{value:a,onChange:b=>u(b.target.value),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Add any notes about this dataset..."})]}),m.general&&o.jsxs("div",{className:"bg-red-50 border border-red-200 rounded p-3",children:[o.jsx("h4",{className:"font-semibold text-red-800 mb-2",children:"Error:"}),o.jsx("p",{className:"text-sm text-red-700",children:m.general})]}),U&&o.jsxs("div",{ref:E,className:"bg-blue-50 border border-blue-200 rounded p-3",children:[o.jsx("h4",{className:"font-semibold text-blue-800 mb-2",children:"Data Summary"}),o.jsxs("div",{className:"text-sm text-blue-700 space-y-1",children:[o.jsxs("div",{children:[o.jsx("span",{className:"font-medium",children:"Nodes:"})," ",U.nodes.length]}),o.jsxs("div",{children:[o.jsx("span",{className:"font-medium",children:"Edges:"})," ",U.edges.length]}),U.timeRange&&o.jsxs("div",{children:[o.jsx("span",{className:"font-medium",children:"Time Range:"})," ",U.timeRange.start,U.timeRange.end!==U.timeRange.start?` – ${U.timeRange.end}`:""]}),U.nodes.length>0&&o.jsxs("div",{className:"mt-2 text-xs",children:[o.jsx("span",{className:"font-medium",children:"Sample node properties:"})," ",Object.keys(U.nodes[0]).slice(0,5).join(", "),Object.keys(U.nodes[0]).length>5&&"..."]}),m.summary&&o.jsxs("div",{className:"mt-2 pt-2 border-t border-blue-300",children:[o.jsx("span",{className:"font-medium text-orange-700",children:"Warnings:"})," ",o.jsx("span",{className:"text-orange-600",children:m.summary})]})]})]})]})}),o.jsxs("div",{className:"p-6 border-t flex justify-end gap-3",children:[o.jsx("button",{onClick:e,type:"button",disabled:c,className:"px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50 disabled:opacity-50 cursor-pointer transition-colors",children:"Cancel"}),o.jsx("button",{onClick:Ne,type:"button",disabled:c||(Object.keys(m).filter(F=>F!=="summary").length>0||!U),className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed cursor-pointer transition-colors",children:c?"Importing...":"Import Dataset"})]})]})})}/**
   * table-core
   *
   * Copyright (c) TanStack
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE.md file in the root directory of this source tree.
   *
   * @license MIT
   */function Ee(e,s){return typeof e=="function"?e(s):e}function ye(e,s){return t=>{s.setState(n=>({...n,[e]:Ee(t,n[e])}))}}function nt(e){return e instanceof Function}function ps(e){return Array.isArray(e)&&e.every(s=>typeof s=="number")}function hs(e,s){const t=[],n=r=>{r.forEach(i=>{t.push(i);const l=s(i);l!=null&&l.length&&n(l)})};return n(e),t}function L(e,s,t){let n=[],r;return i=>{let l;t.key&&t.debug&&(l=Date.now());const a=e(i);if(!(a.length!==n.length||a.some((d,m)=>n[m]!==d)))return r;n=a;let c;if(t.key&&t.debug&&(c=Date.now()),r=s(...a),t==null||t.onChange==null||t.onChange(r),t.key&&t.debug&&t!=null&&t.debug()){const d=Math.round((Date.now()-l)*100)/100,m=Math.round((Date.now()-c)*100)/100,f=m/16,g=(h,x)=>{for(h=String(h);h.length<x;)h=" "+h;return h};console.info(`%c⏱ ${g(m,5)} /${g(d,5)} ms`,`
            font-size: .6rem;
            font-weight: bold;
            color: hsl(${Math.max(0,Math.min(120-120*f,120))}deg 100% 31%);`,t==null?void 0:t.key)}return r}}function z(e,s,t,n){return{debug:()=>{var r;return(r=e==null?void 0:e.debugAll)!=null?r:e[s]},key:!1,onChange:n}}function xs(e,s,t,n){const r=()=>{var l;return(l=i.getValue())!=null?l:e.options.renderFallbackValue},i={id:`${s.id}_${t.id}`,row:s,column:t,getValue:()=>s.getValue(n),renderValue:r,getContext:L(()=>[e,t,s,i],(l,a,u,c)=>({table:l,column:a,row:u,cell:c,getValue:c.getValue,renderValue:c.renderValue}),z(e.options,"debugCells"))};return e._features.forEach(l=>{l.createCell==null||l.createCell(i,t,s,e)},{}),i}function vs(e,s,t,n){var r,i;const a={...e._getDefaultColumnDef(),...s},u=a.accessorKey;let c=(r=(i=a.id)!=null?i:u?typeof String.prototype.replaceAll=="function"?u.replaceAll(".","_"):u.replace(/\./g,"_"):void 0)!=null?r:typeof a.header=="string"?a.header:void 0,d;if(a.accessorFn?d=a.accessorFn:u&&(u.includes(".")?d=f=>{let g=f;for(const x of u.split(".")){var h;g=(h=g)==null?void 0:h[x]}return g}:d=f=>f[a.accessorKey]),!c)throw new Error;let m={id:`${String(c)}`,accessorFn:d,parent:n,depth:t,columnDef:a,columns:[],getFlatColumns:L(()=>[!0],()=>{var f;return[m,...(f=m.columns)==null?void 0:f.flatMap(g=>g.getFlatColumns())]},z(e.options,"debugColumns")),getLeafColumns:L(()=>[e._getOrderColumnsFn()],f=>{var g;if((g=m.columns)!=null&&g.length){let h=m.columns.flatMap(x=>x.getLeafColumns());return f(h)}return[m]},z(e.options,"debugColumns"))};for(const f of e._features)f.createColumn==null||f.createColumn(m,e);return m}const pe="debugHeaders";function Ut(e,s,t){var n;let i={id:(n=t.id)!=null?n:s.id,column:s,index:t.index,isPlaceholder:!!t.isPlaceholder,placeholderId:t.placeholderId,depth:t.depth,subHeaders:[],colSpan:0,rowSpan:0,headerGroup:null,getLeafHeaders:()=>{const l=[],a=u=>{u.subHeaders&&u.subHeaders.length&&u.subHeaders.map(a),l.push(u)};return a(i),l},getContext:()=>({table:e,header:i,column:s})};return e._features.forEach(l=>{l.createHeader==null||l.createHeader(i,e)}),i}const ws={createTable:e=>{e.getHeaderGroups=L(()=>[e.getAllColumns(),e.getVisibleLeafColumns(),e.getState().columnPinning.left,e.getState().columnPinning.right],(s,t,n,r)=>{var i,l;const a=(i=n==null?void 0:n.map(m=>t.find(f=>f.id===m)).filter(Boolean))!=null?i:[],u=(l=r==null?void 0:r.map(m=>t.find(f=>f.id===m)).filter(Boolean))!=null?l:[],c=t.filter(m=>!(n!=null&&n.includes(m.id))&&!(r!=null&&r.includes(m.id)));return Ze(s,[...a,...c,...u],e)},z(e.options,pe)),e.getCenterHeaderGroups=L(()=>[e.getAllColumns(),e.getVisibleLeafColumns(),e.getState().columnPinning.left,e.getState().columnPinning.right],(s,t,n,r)=>(t=t.filter(i=>!(n!=null&&n.includes(i.id))&&!(r!=null&&r.includes(i.id))),Ze(s,t,e,"center")),z(e.options,pe)),e.getLeftHeaderGroups=L(()=>[e.getAllColumns(),e.getVisibleLeafColumns(),e.getState().columnPinning.left],(s,t,n)=>{var r;const i=(r=n==null?void 0:n.map(l=>t.find(a=>a.id===l)).filter(Boolean))!=null?r:[];return Ze(s,i,e,"left")},z(e.options,pe)),e.getRightHeaderGroups=L(()=>[e.getAllColumns(),e.getVisibleLeafColumns(),e.getState().columnPinning.right],(s,t,n)=>{var r;const i=(r=n==null?void 0:n.map(l=>t.find(a=>a.id===l)).filter(Boolean))!=null?r:[];return Ze(s,i,e,"right")},z(e.options,pe)),e.getFooterGroups=L(()=>[e.getHeaderGroups()],s=>[...s].reverse(),z(e.options,pe)),e.getLeftFooterGroups=L(()=>[e.getLeftHeaderGroups()],s=>[...s].reverse(),z(e.options,pe)),e.getCenterFooterGroups=L(()=>[e.getCenterHeaderGroups()],s=>[...s].reverse(),z(e.options,pe)),e.getRightFooterGroups=L(()=>[e.getRightHeaderGroups()],s=>[...s].reverse(),z(e.options,pe)),e.getFlatHeaders=L(()=>[e.getHeaderGroups()],s=>s.map(t=>t.headers).flat(),z(e.options,pe)),e.getLeftFlatHeaders=L(()=>[e.getLeftHeaderGroups()],s=>s.map(t=>t.headers).flat(),z(e.options,pe)),e.getCenterFlatHeaders=L(()=>[e.getCenterHeaderGroups()],s=>s.map(t=>t.headers).flat(),z(e.options,pe)),e.getRightFlatHeaders=L(()=>[e.getRightHeaderGroups()],s=>s.map(t=>t.headers).flat(),z(e.options,pe)),e.getCenterLeafHeaders=L(()=>[e.getCenterFlatHeaders()],s=>s.filter(t=>{var n;return!((n=t.subHeaders)!=null&&n.length)}),z(e.options,pe)),e.getLeftLeafHeaders=L(()=>[e.getLeftFlatHeaders()],s=>s.filter(t=>{var n;return!((n=t.subHeaders)!=null&&n.length)}),z(e.options,pe)),e.getRightLeafHeaders=L(()=>[e.getRightFlatHeaders()],s=>s.filter(t=>{var n;return!((n=t.subHeaders)!=null&&n.length)}),z(e.options,pe)),e.getLeafHeaders=L(()=>[e.getLeftHeaderGroups(),e.getCenterHeaderGroups(),e.getRightHeaderGroups()],(s,t,n)=>{var r,i,l,a,u,c;return[...(r=(i=s[0])==null?void 0:i.headers)!=null?r:[],...(l=(a=t[0])==null?void 0:a.headers)!=null?l:[],...(u=(c=n[0])==null?void 0:c.headers)!=null?u:[]].map(d=>d.getLeafHeaders()).flat()},z(e.options,pe))}};function Ze(e,s,t,n){var r,i;let l=0;const a=function(f,g){g===void 0&&(g=1),l=Math.max(l,g),f.filter(h=>h.getIsVisible()).forEach(h=>{var x;(x=h.columns)!=null&&x.length&&a(h.columns,g+1)},0)};a(e);let u=[];const c=(f,g)=>{const h={depth:g,id:[n,`${g}`].filter(Boolean).join("_"),headers:[]},x=[];f.forEach(y=>{const v=[...x].reverse()[0],C=y.column.depth===h.depth;let w,N=!1;if(C&&y.column.parent?w=y.column.parent:(w=y.column,N=!0),v&&(v==null?void 0:v.column)===w)v.subHeaders.push(y);else{const M=Ut(t,w,{id:[n,g,w.id,y==null?void 0:y.id].filter(Boolean).join("_"),isPlaceholder:N,placeholderId:N?`${x.filter(R=>R.column===w).length}`:void 0,depth:g,index:x.length});M.subHeaders.push(y),x.push(M)}h.headers.push(y),y.headerGroup=h}),u.push(h),g>0&&c(x,g-1)},d=s.map((f,g)=>Ut(t,f,{depth:l,index:g}));c(d,l-1),u.reverse();const m=f=>f.filter(h=>h.column.getIsVisible()).map(h=>{let x=0,y=0,v=[0];h.subHeaders&&h.subHeaders.length?(v=[],m(h.subHeaders).forEach(w=>{let{colSpan:N,rowSpan:M}=w;x+=N,v.push(M)})):x=1;const C=Math.min(...v);return y=y+C,h.colSpan=x,h.rowSpan=y,{colSpan:x,rowSpan:y}});return m((r=(i=u[0])==null?void 0:i.headers)!=null?r:[]),u}const ys=(e,s,t,n,r,i,l)=>{let a={id:s,index:n,original:t,depth:r,parentId:l,_valuesCache:{},_uniqueValuesCache:{},getValue:u=>{if(a._valuesCache.hasOwnProperty(u))return a._valuesCache[u];const c=e.getColumn(u);if(c!=null&&c.accessorFn)return a._valuesCache[u]=c.accessorFn(a.original,n),a._valuesCache[u]},getUniqueValues:u=>{if(a._uniqueValuesCache.hasOwnProperty(u))return a._uniqueValuesCache[u];const c=e.getColumn(u);if(c!=null&&c.accessorFn)return c.columnDef.getUniqueValues?(a._uniqueValuesCache[u]=c.columnDef.getUniqueValues(a.original,n),a._uniqueValuesCache[u]):(a._uniqueValuesCache[u]=[a.getValue(u)],a._uniqueValuesCache[u])},renderValue:u=>{var c;return(c=a.getValue(u))!=null?c:e.options.renderFallbackValue},subRows:[],getLeafRows:()=>hs(a.subRows,u=>u.subRows),getParentRow:()=>a.parentId?e.getRow(a.parentId,!0):void 0,getParentRows:()=>{let u=[],c=a;for(;;){const d=c.getParentRow();if(!d)break;u.push(d),c=d}return u.reverse()},getAllCells:L(()=>[e.getAllLeafColumns()],u=>u.map(c=>xs(e,a,c,c.id)),z(e.options,"debugRows")),_getAllCellsByColumnId:L(()=>[a.getAllCells()],u=>u.reduce((c,d)=>(c[d.column.id]=d,c),{}),z(e.options,"debugRows"))};for(let u=0;u<e._features.length;u++){const c=e._features[u];c==null||c.createRow==null||c.createRow(a,e)}return a},Ss={createColumn:(e,s)=>{e._getFacetedRowModel=s.options.getFacetedRowModel&&s.options.getFacetedRowModel(s,e.id),e.getFacetedRowModel=()=>e._getFacetedRowModel?e._getFacetedRowModel():s.getPreFilteredRowModel(),e._getFacetedUniqueValues=s.options.getFacetedUniqueValues&&s.options.getFacetedUniqueValues(s,e.id),e.getFacetedUniqueValues=()=>e._getFacetedUniqueValues?e._getFacetedUniqueValues():new Map,e._getFacetedMinMaxValues=s.options.getFacetedMinMaxValues&&s.options.getFacetedMinMaxValues(s,e.id),e.getFacetedMinMaxValues=()=>{if(e._getFacetedMinMaxValues)return e._getFacetedMinMaxValues()}}},ln=(e,s,t)=>{var n,r;const i=t==null||(n=t.toString())==null?void 0:n.toLowerCase();return!!(!((r=e.getValue(s))==null||(r=r.toString())==null||(r=r.toLowerCase())==null)&&r.includes(i))};ln.autoRemove=e=>be(e);const un=(e,s,t)=>{var n;return!!(!((n=e.getValue(s))==null||(n=n.toString())==null)&&n.includes(t))};un.autoRemove=e=>be(e);const dn=(e,s,t)=>{var n;return((n=e.getValue(s))==null||(n=n.toString())==null?void 0:n.toLowerCase())===(t==null?void 0:t.toLowerCase())};dn.autoRemove=e=>be(e);const cn=(e,s,t)=>{var n;return(n=e.getValue(s))==null?void 0:n.includes(t)};cn.autoRemove=e=>be(e);const gn=(e,s,t)=>!t.some(n=>{var r;return!((r=e.getValue(s))!=null&&r.includes(n))});gn.autoRemove=e=>be(e)||!(e!=null&&e.length);const fn=(e,s,t)=>t.some(n=>{var r;return(r=e.getValue(s))==null?void 0:r.includes(n)});fn.autoRemove=e=>be(e)||!(e!=null&&e.length);const mn=(e,s,t)=>e.getValue(s)===t;mn.autoRemove=e=>be(e);const pn=(e,s,t)=>e.getValue(s)==t;pn.autoRemove=e=>be(e);const Mt=(e,s,t)=>{let[n,r]=t;const i=e.getValue(s);return i>=n&&i<=r};Mt.resolveFilterValue=e=>{let[s,t]=e,n=typeof s!="number"?parseFloat(s):s,r=typeof t!="number"?parseFloat(t):t,i=s===null||Number.isNaN(n)?-1/0:n,l=t===null||Number.isNaN(r)?1/0:r;if(i>l){const a=i;i=l,l=a}return[i,l]};Mt.autoRemove=e=>be(e)||be(e[0])&&be(e[1]);const $e={includesString:ln,includesStringSensitive:un,equalsString:dn,arrIncludes:cn,arrIncludesAll:gn,arrIncludesSome:fn,equals:mn,weakEquals:pn,inNumberRange:Mt};function be(e){return e==null||e===""}const Cs={getDefaultColumnDef:()=>({filterFn:"auto"}),getInitialState:e=>({columnFilters:[],...e}),getDefaultOptions:e=>({onColumnFiltersChange:ye("columnFilters",e),filterFromLeafRows:!1,maxLeafRowFilterDepth:100}),createColumn:(e,s)=>{e.getAutoFilterFn=()=>{const t=s.getCoreRowModel().flatRows[0],n=t==null?void 0:t.getValue(e.id);return typeof n=="string"?$e.includesString:typeof n=="number"?$e.inNumberRange:typeof n=="boolean"||n!==null&&typeof n=="object"?$e.equals:Array.isArray(n)?$e.arrIncludes:$e.weakEquals},e.getFilterFn=()=>{var t,n;return nt(e.columnDef.filterFn)?e.columnDef.filterFn:e.columnDef.filterFn==="auto"?e.getAutoFilterFn():(t=(n=s.options.filterFns)==null?void 0:n[e.columnDef.filterFn])!=null?t:$e[e.columnDef.filterFn]},e.getCanFilter=()=>{var t,n,r;return((t=e.columnDef.enableColumnFilter)!=null?t:!0)&&((n=s.options.enableColumnFilters)!=null?n:!0)&&((r=s.options.enableFilters)!=null?r:!0)&&!!e.accessorFn},e.getIsFiltered=()=>e.getFilterIndex()>-1,e.getFilterValue=()=>{var t;return(t=s.getState().columnFilters)==null||(t=t.find(n=>n.id===e.id))==null?void 0:t.value},e.getFilterIndex=()=>{var t,n;return(t=(n=s.getState().columnFilters)==null?void 0:n.findIndex(r=>r.id===e.id))!=null?t:-1},e.setFilterValue=t=>{s.setColumnFilters(n=>{const r=e.getFilterFn(),i=n==null?void 0:n.find(d=>d.id===e.id),l=Ee(t,i?i.value:void 0);if(qt(r,l,e)){var a;return(a=n==null?void 0:n.filter(d=>d.id!==e.id))!=null?a:[]}const u={id:e.id,value:l};if(i){var c;return(c=n==null?void 0:n.map(d=>d.id===e.id?u:d))!=null?c:[]}return n!=null&&n.length?[...n,u]:[u]})}},createRow:(e,s)=>{e.columnFilters={},e.columnFiltersMeta={}},createTable:e=>{e.setColumnFilters=s=>{const t=e.getAllLeafColumns(),n=r=>{var i;return(i=Ee(s,r))==null?void 0:i.filter(l=>{const a=t.find(u=>u.id===l.id);if(a){const u=a.getFilterFn();if(qt(u,l.value,a))return!1}return!0})};e.options.onColumnFiltersChange==null||e.options.onColumnFiltersChange(n)},e.resetColumnFilters=s=>{var t,n;e.setColumnFilters(s?[]:(t=(n=e.initialState)==null?void 0:n.columnFilters)!=null?t:[])},e.getPreFilteredRowModel=()=>e.getCoreRowModel(),e.getFilteredRowModel=()=>(!e._getFilteredRowModel&&e.options.getFilteredRowModel&&(e._getFilteredRowModel=e.options.getFilteredRowModel(e)),e.options.manualFiltering||!e._getFilteredRowModel?e.getPreFilteredRowModel():e._getFilteredRowModel())}};function qt(e,s,t){return(e&&e.autoRemove?e.autoRemove(s,t):!1)||typeof s>"u"||typeof s=="string"&&!s}const bs=(e,s,t)=>t.reduce((n,r)=>{const i=r.getValue(e);return n+(typeof i=="number"?i:0)},0),js=(e,s,t)=>{let n;return t.forEach(r=>{const i=r.getValue(e);i!=null&&(n>i||n===void 0&&i>=i)&&(n=i)}),n},Rs=(e,s,t)=>{let n;return t.forEach(r=>{const i=r.getValue(e);i!=null&&(n<i||n===void 0&&i>=i)&&(n=i)}),n},Ns=(e,s,t)=>{let n,r;return t.forEach(i=>{const l=i.getValue(e);l!=null&&(n===void 0?l>=l&&(n=r=l):(n>l&&(n=l),r<l&&(r=l)))}),[n,r]},Fs=(e,s)=>{let t=0,n=0;if(s.forEach(r=>{let i=r.getValue(e);i!=null&&(i=+i)>=i&&(++t,n+=i)}),t)return n/t},$s=(e,s)=>{if(!s.length)return;const t=s.map(i=>i.getValue(e));if(!ps(t))return;if(t.length===1)return t[0];const n=Math.floor(t.length/2),r=t.sort((i,l)=>i-l);return t.length%2!==0?r[n]:(r[n-1]+r[n])/2},_s=(e,s)=>Array.from(new Set(s.map(t=>t.getValue(e))).values()),Ms=(e,s)=>new Set(s.map(t=>t.getValue(e))).size,Es=(e,s)=>s.length,ct={sum:bs,min:js,max:Rs,extent:Ns,mean:Fs,median:$s,unique:_s,uniqueCount:Ms,count:Es},Is={getDefaultColumnDef:()=>({aggregatedCell:e=>{var s,t;return(s=(t=e.getValue())==null||t.toString==null?void 0:t.toString())!=null?s:null},aggregationFn:"auto"}),getInitialState:e=>({grouping:[],...e}),getDefaultOptions:e=>({onGroupingChange:ye("grouping",e),groupedColumnMode:"reorder"}),createColumn:(e,s)=>{e.toggleGrouping=()=>{s.setGrouping(t=>t!=null&&t.includes(e.id)?t.filter(n=>n!==e.id):[...t??[],e.id])},e.getCanGroup=()=>{var t,n;return((t=e.columnDef.enableGrouping)!=null?t:!0)&&((n=s.options.enableGrouping)!=null?n:!0)&&(!!e.accessorFn||!!e.columnDef.getGroupingValue)},e.getIsGrouped=()=>{var t;return(t=s.getState().grouping)==null?void 0:t.includes(e.id)},e.getGroupedIndex=()=>{var t;return(t=s.getState().grouping)==null?void 0:t.indexOf(e.id)},e.getToggleGroupingHandler=()=>{const t=e.getCanGroup();return()=>{t&&e.toggleGrouping()}},e.getAutoAggregationFn=()=>{const t=s.getCoreRowModel().flatRows[0],n=t==null?void 0:t.getValue(e.id);if(typeof n=="number")return ct.sum;if(Object.prototype.toString.call(n)==="[object Date]")return ct.extent},e.getAggregationFn=()=>{var t,n;if(!e)throw new Error;return nt(e.columnDef.aggregationFn)?e.columnDef.aggregationFn:e.columnDef.aggregationFn==="auto"?e.getAutoAggregationFn():(t=(n=s.options.aggregationFns)==null?void 0:n[e.columnDef.aggregationFn])!=null?t:ct[e.columnDef.aggregationFn]}},createTable:e=>{e.setGrouping=s=>e.options.onGroupingChange==null?void 0:e.options.onGroupingChange(s),e.resetGrouping=s=>{var t,n;e.setGrouping(s?[]:(t=(n=e.initialState)==null?void 0:n.grouping)!=null?t:[])},e.getPreGroupedRowModel=()=>e.getFilteredRowModel(),e.getGroupedRowModel=()=>(!e._getGroupedRowModel&&e.options.getGroupedRowModel&&(e._getGroupedRowModel=e.options.getGroupedRowModel(e)),e.options.manualGrouping||!e._getGroupedRowModel?e.getPreGroupedRowModel():e._getGroupedRowModel())},createRow:(e,s)=>{e.getIsGrouped=()=>!!e.groupingColumnId,e.getGroupingValue=t=>{if(e._groupingValuesCache.hasOwnProperty(t))return e._groupingValuesCache[t];const n=s.getColumn(t);return n!=null&&n.columnDef.getGroupingValue?(e._groupingValuesCache[t]=n.columnDef.getGroupingValue(e.original),e._groupingValuesCache[t]):e.getValue(t)},e._groupingValuesCache={}},createCell:(e,s,t,n)=>{e.getIsGrouped=()=>s.getIsGrouped()&&s.id===t.groupingColumnId,e.getIsPlaceholder=()=>!e.getIsGrouped()&&s.getIsGrouped(),e.getIsAggregated=()=>{var r;return!e.getIsGrouped()&&!e.getIsPlaceholder()&&!!((r=t.subRows)!=null&&r.length)}}};function Ps(e,s,t){if(!(s!=null&&s.length)||!t)return e;const n=e.filter(i=>!s.includes(i.id));return t==="remove"?n:[...s.map(i=>e.find(l=>l.id===i)).filter(Boolean),...n]}const Vs={getInitialState:e=>({columnOrder:[],...e}),getDefaultOptions:e=>({onColumnOrderChange:ye("columnOrder",e)}),createColumn:(e,s)=>{e.getIndex=L(t=>[Ge(s,t)],t=>t.findIndex(n=>n.id===e.id),z(s.options,"debugColumns")),e.getIsFirstColumn=t=>{var n;return((n=Ge(s,t)[0])==null?void 0:n.id)===e.id},e.getIsLastColumn=t=>{var n;const r=Ge(s,t);return((n=r[r.length-1])==null?void 0:n.id)===e.id}},createTable:e=>{e.setColumnOrder=s=>e.options.onColumnOrderChange==null?void 0:e.options.onColumnOrderChange(s),e.resetColumnOrder=s=>{var t;e.setColumnOrder(s?[]:(t=e.initialState.columnOrder)!=null?t:[])},e._getOrderColumnsFn=L(()=>[e.getState().columnOrder,e.getState().grouping,e.options.groupedColumnMode],(s,t,n)=>r=>{let i=[];if(!(s!=null&&s.length))i=r;else{const l=[...s],a=[...r];for(;a.length&&l.length;){const u=l.shift(),c=a.findIndex(d=>d.id===u);c>-1&&i.push(a.splice(c,1)[0])}i=[...i,...a]}return Ps(i,t,n)},z(e.options,"debugTable"))}},gt=()=>({left:[],right:[]}),As={getInitialState:e=>({columnPinning:gt(),...e}),getDefaultOptions:e=>({onColumnPinningChange:ye("columnPinning",e)}),createColumn:(e,s)=>{e.pin=t=>{const n=e.getLeafColumns().map(r=>r.id).filter(Boolean);s.setColumnPinning(r=>{var i,l;if(t==="right"){var a,u;return{left:((a=r==null?void 0:r.left)!=null?a:[]).filter(m=>!(n!=null&&n.includes(m))),right:[...((u=r==null?void 0:r.right)!=null?u:[]).filter(m=>!(n!=null&&n.includes(m))),...n]}}if(t==="left"){var c,d;return{left:[...((c=r==null?void 0:r.left)!=null?c:[]).filter(m=>!(n!=null&&n.includes(m))),...n],right:((d=r==null?void 0:r.right)!=null?d:[]).filter(m=>!(n!=null&&n.includes(m)))}}return{left:((i=r==null?void 0:r.left)!=null?i:[]).filter(m=>!(n!=null&&n.includes(m))),right:((l=r==null?void 0:r.right)!=null?l:[]).filter(m=>!(n!=null&&n.includes(m)))}})},e.getCanPin=()=>e.getLeafColumns().some(n=>{var r,i,l;return((r=n.columnDef.enablePinning)!=null?r:!0)&&((i=(l=s.options.enableColumnPinning)!=null?l:s.options.enablePinning)!=null?i:!0)}),e.getIsPinned=()=>{const t=e.getLeafColumns().map(a=>a.id),{left:n,right:r}=s.getState().columnPinning,i=t.some(a=>n==null?void 0:n.includes(a)),l=t.some(a=>r==null?void 0:r.includes(a));return i?"left":l?"right":!1},e.getPinnedIndex=()=>{var t,n;const r=e.getIsPinned();return r?(t=(n=s.getState().columnPinning)==null||(n=n[r])==null?void 0:n.indexOf(e.id))!=null?t:-1:0}},createRow:(e,s)=>{e.getCenterVisibleCells=L(()=>[e._getAllVisibleCells(),s.getState().columnPinning.left,s.getState().columnPinning.right],(t,n,r)=>{const i=[...n??[],...r??[]];return t.filter(l=>!i.includes(l.column.id))},z(s.options,"debugRows")),e.getLeftVisibleCells=L(()=>[e._getAllVisibleCells(),s.getState().columnPinning.left],(t,n)=>(n??[]).map(i=>t.find(l=>l.column.id===i)).filter(Boolean).map(i=>({...i,position:"left"})),z(s.options,"debugRows")),e.getRightVisibleCells=L(()=>[e._getAllVisibleCells(),s.getState().columnPinning.right],(t,n)=>(n??[]).map(i=>t.find(l=>l.column.id===i)).filter(Boolean).map(i=>({...i,position:"right"})),z(s.options,"debugRows"))},createTable:e=>{e.setColumnPinning=s=>e.options.onColumnPinningChange==null?void 0:e.options.onColumnPinningChange(s),e.resetColumnPinning=s=>{var t,n;return e.setColumnPinning(s?gt():(t=(n=e.initialState)==null?void 0:n.columnPinning)!=null?t:gt())},e.getIsSomeColumnsPinned=s=>{var t;const n=e.getState().columnPinning;if(!s){var r,i;return!!((r=n.left)!=null&&r.length||(i=n.right)!=null&&i.length)}return!!((t=n[s])!=null&&t.length)},e.getLeftLeafColumns=L(()=>[e.getAllLeafColumns(),e.getState().columnPinning.left],(s,t)=>(t??[]).map(n=>s.find(r=>r.id===n)).filter(Boolean),z(e.options,"debugColumns")),e.getRightLeafColumns=L(()=>[e.getAllLeafColumns(),e.getState().columnPinning.right],(s,t)=>(t??[]).map(n=>s.find(r=>r.id===n)).filter(Boolean),z(e.options,"debugColumns")),e.getCenterLeafColumns=L(()=>[e.getAllLeafColumns(),e.getState().columnPinning.left,e.getState().columnPinning.right],(s,t,n)=>{const r=[...t??[],...n??[]];return s.filter(i=>!r.includes(i.id))},z(e.options,"debugColumns"))}};function Ds(e){return e||(typeof document<"u"?document:null)}const Qe={size:150,minSize:20,maxSize:Number.MAX_SAFE_INTEGER},ft=()=>({startOffset:null,startSize:null,deltaOffset:null,deltaPercentage:null,isResizingColumn:!1,columnSizingStart:[]}),ks={getDefaultColumnDef:()=>Qe,getInitialState:e=>({columnSizing:{},columnSizingInfo:ft(),...e}),getDefaultOptions:e=>({columnResizeMode:"onEnd",columnResizeDirection:"ltr",onColumnSizingChange:ye("columnSizing",e),onColumnSizingInfoChange:ye("columnSizingInfo",e)}),createColumn:(e,s)=>{e.getSize=()=>{var t,n,r;const i=s.getState().columnSizing[e.id];return Math.min(Math.max((t=e.columnDef.minSize)!=null?t:Qe.minSize,(n=i??e.columnDef.size)!=null?n:Qe.size),(r=e.columnDef.maxSize)!=null?r:Qe.maxSize)},e.getStart=L(t=>[t,Ge(s,t),s.getState().columnSizing],(t,n)=>n.slice(0,e.getIndex(t)).reduce((r,i)=>r+i.getSize(),0),z(s.options,"debugColumns")),e.getAfter=L(t=>[t,Ge(s,t),s.getState().columnSizing],(t,n)=>n.slice(e.getIndex(t)+1).reduce((r,i)=>r+i.getSize(),0),z(s.options,"debugColumns")),e.resetSize=()=>{s.setColumnSizing(t=>{let{[e.id]:n,...r}=t;return r})},e.getCanResize=()=>{var t,n;return((t=e.columnDef.enableResizing)!=null?t:!0)&&((n=s.options.enableColumnResizing)!=null?n:!0)},e.getIsResizing=()=>s.getState().columnSizingInfo.isResizingColumn===e.id},createHeader:(e,s)=>{e.getSize=()=>{let t=0;const n=r=>{if(r.subHeaders.length)r.subHeaders.forEach(n);else{var i;t+=(i=r.column.getSize())!=null?i:0}};return n(e),t},e.getStart=()=>{if(e.index>0){const t=e.headerGroup.headers[e.index-1];return t.getStart()+t.getSize()}return 0},e.getResizeHandler=t=>{const n=s.getColumn(e.column.id),r=n==null?void 0:n.getCanResize();return i=>{if(!n||!r||(i.persist==null||i.persist(),mt(i)&&i.touches&&i.touches.length>1))return;const l=e.getSize(),a=e?e.getLeafHeaders().map(v=>[v.column.id,v.column.getSize()]):[[n.id,n.getSize()]],u=mt(i)?Math.round(i.touches[0].clientX):i.clientX,c={},d=(v,C)=>{typeof C=="number"&&(s.setColumnSizingInfo(w=>{var N,M;const R=s.options.columnResizeDirection==="rtl"?-1:1,V=(C-((N=w==null?void 0:w.startOffset)!=null?N:0))*R,E=Math.max(V/((M=w==null?void 0:w.startSize)!=null?M:0),-.999999);return w.columnSizingStart.forEach(I=>{let[B,P]=I;c[B]=Math.round(Math.max(P+P*E,0)*100)/100}),{...w,deltaOffset:V,deltaPercentage:E}}),(s.options.columnResizeMode==="onChange"||v==="end")&&s.setColumnSizing(w=>({...w,...c})))},m=v=>d("move",v),f=v=>{d("end",v),s.setColumnSizingInfo(C=>({...C,isResizingColumn:!1,startOffset:null,startSize:null,deltaOffset:null,deltaPercentage:null,columnSizingStart:[]}))},g=Ds(t),h={moveHandler:v=>m(v.clientX),upHandler:v=>{g==null||g.removeEventListener("mousemove",h.moveHandler),g==null||g.removeEventListener("mouseup",h.upHandler),f(v.clientX)}},x={moveHandler:v=>(v.cancelable&&(v.preventDefault(),v.stopPropagation()),m(v.touches[0].clientX),!1),upHandler:v=>{var C;g==null||g.removeEventListener("touchmove",x.moveHandler),g==null||g.removeEventListener("touchend",x.upHandler),v.cancelable&&(v.preventDefault(),v.stopPropagation()),f((C=v.touches[0])==null?void 0:C.clientX)}},y=Ls()?{passive:!1}:!1;mt(i)?(g==null||g.addEventListener("touchmove",x.moveHandler,y),g==null||g.addEventListener("touchend",x.upHandler,y)):(g==null||g.addEventListener("mousemove",h.moveHandler,y),g==null||g.addEventListener("mouseup",h.upHandler,y)),s.setColumnSizingInfo(v=>({...v,startOffset:u,startSize:l,deltaOffset:0,deltaPercentage:0,columnSizingStart:a,isResizingColumn:n.id}))}}},createTable:e=>{e.setColumnSizing=s=>e.options.onColumnSizingChange==null?void 0:e.options.onColumnSizingChange(s),e.setColumnSizingInfo=s=>e.options.onColumnSizingInfoChange==null?void 0:e.options.onColumnSizingInfoChange(s),e.resetColumnSizing=s=>{var t;e.setColumnSizing(s?{}:(t=e.initialState.columnSizing)!=null?t:{})},e.resetHeaderSizeInfo=s=>{var t;e.setColumnSizingInfo(s?ft():(t=e.initialState.columnSizingInfo)!=null?t:ft())},e.getTotalSize=()=>{var s,t;return(s=(t=e.getHeaderGroups()[0])==null?void 0:t.headers.reduce((n,r)=>n+r.getSize(),0))!=null?s:0},e.getLeftTotalSize=()=>{var s,t;return(s=(t=e.getLeftHeaderGroups()[0])==null?void 0:t.headers.reduce((n,r)=>n+r.getSize(),0))!=null?s:0},e.getCenterTotalSize=()=>{var s,t;return(s=(t=e.getCenterHeaderGroups()[0])==null?void 0:t.headers.reduce((n,r)=>n+r.getSize(),0))!=null?s:0},e.getRightTotalSize=()=>{var s,t;return(s=(t=e.getRightHeaderGroups()[0])==null?void 0:t.headers.reduce((n,r)=>n+r.getSize(),0))!=null?s:0}}};let Je=null;function Ls(){if(typeof Je=="boolean")return Je;let e=!1;try{const s={get passive(){return e=!0,!1}},t=()=>{};window.addEventListener("test",t,s),window.removeEventListener("test",t)}catch{e=!1}return Je=e,Je}function mt(e){return e.type==="touchstart"}const zs={getInitialState:e=>({columnVisibility:{},...e}),getDefaultOptions:e=>({onColumnVisibilityChange:ye("columnVisibility",e)}),createColumn:(e,s)=>{e.toggleVisibility=t=>{e.getCanHide()&&s.setColumnVisibility(n=>({...n,[e.id]:t??!e.getIsVisible()}))},e.getIsVisible=()=>{var t,n;const r=e.columns;return(t=r.length?r.some(i=>i.getIsVisible()):(n=s.getState().columnVisibility)==null?void 0:n[e.id])!=null?t:!0},e.getCanHide=()=>{var t,n;return((t=e.columnDef.enableHiding)!=null?t:!0)&&((n=s.options.enableHiding)!=null?n:!0)},e.getToggleVisibilityHandler=()=>t=>{e.toggleVisibility==null||e.toggleVisibility(t.target.checked)}},createRow:(e,s)=>{e._getAllVisibleCells=L(()=>[e.getAllCells(),s.getState().columnVisibility],t=>t.filter(n=>n.column.getIsVisible()),z(s.options,"debugRows")),e.getVisibleCells=L(()=>[e.getLeftVisibleCells(),e.getCenterVisibleCells(),e.getRightVisibleCells()],(t,n,r)=>[...t,...n,...r],z(s.options,"debugRows"))},createTable:e=>{const s=(t,n)=>L(()=>[n(),n().filter(r=>r.getIsVisible()).map(r=>r.id).join("_")],r=>r.filter(i=>i.getIsVisible==null?void 0:i.getIsVisible()),z(e.options,"debugColumns"));e.getVisibleFlatColumns=s("getVisibleFlatColumns",()=>e.getAllFlatColumns()),e.getVisibleLeafColumns=s("getVisibleLeafColumns",()=>e.getAllLeafColumns()),e.getLeftVisibleLeafColumns=s("getLeftVisibleLeafColumns",()=>e.getLeftLeafColumns()),e.getRightVisibleLeafColumns=s("getRightVisibleLeafColumns",()=>e.getRightLeafColumns()),e.getCenterVisibleLeafColumns=s("getCenterVisibleLeafColumns",()=>e.getCenterLeafColumns()),e.setColumnVisibility=t=>e.options.onColumnVisibilityChange==null?void 0:e.options.onColumnVisibilityChange(t),e.resetColumnVisibility=t=>{var n;e.setColumnVisibility(t?{}:(n=e.initialState.columnVisibility)!=null?n:{})},e.toggleAllColumnsVisible=t=>{var n;t=(n=t)!=null?n:!e.getIsAllColumnsVisible(),e.setColumnVisibility(e.getAllLeafColumns().reduce((r,i)=>({...r,[i.id]:t||!(i.getCanHide!=null&&i.getCanHide())}),{}))},e.getIsAllColumnsVisible=()=>!e.getAllLeafColumns().some(t=>!(t.getIsVisible!=null&&t.getIsVisible())),e.getIsSomeColumnsVisible=()=>e.getAllLeafColumns().some(t=>t.getIsVisible==null?void 0:t.getIsVisible()),e.getToggleAllColumnsVisibilityHandler=()=>t=>{var n;e.toggleAllColumnsVisible((n=t.target)==null?void 0:n.checked)}}};function Ge(e,s){return s?s==="center"?e.getCenterVisibleLeafColumns():s==="left"?e.getLeftVisibleLeafColumns():e.getRightVisibleLeafColumns():e.getVisibleLeafColumns()}const Ts={createTable:e=>{e._getGlobalFacetedRowModel=e.options.getFacetedRowModel&&e.options.getFacetedRowModel(e,"__global__"),e.getGlobalFacetedRowModel=()=>e.options.manualFiltering||!e._getGlobalFacetedRowModel?e.getPreFilteredRowModel():e._getGlobalFacetedRowModel(),e._getGlobalFacetedUniqueValues=e.options.getFacetedUniqueValues&&e.options.getFacetedUniqueValues(e,"__global__"),e.getGlobalFacetedUniqueValues=()=>e._getGlobalFacetedUniqueValues?e._getGlobalFacetedUniqueValues():new Map,e._getGlobalFacetedMinMaxValues=e.options.getFacetedMinMaxValues&&e.options.getFacetedMinMaxValues(e,"__global__"),e.getGlobalFacetedMinMaxValues=()=>{if(e._getGlobalFacetedMinMaxValues)return e._getGlobalFacetedMinMaxValues()}}},Hs={getInitialState:e=>({globalFilter:void 0,...e}),getDefaultOptions:e=>({onGlobalFilterChange:ye("globalFilter",e),globalFilterFn:"auto",getColumnCanGlobalFilter:s=>{var t;const n=(t=e.getCoreRowModel().flatRows[0])==null||(t=t._getAllCellsByColumnId()[s.id])==null?void 0:t.getValue();return typeof n=="string"||typeof n=="number"}}),createColumn:(e,s)=>{e.getCanGlobalFilter=()=>{var t,n,r,i;return((t=e.columnDef.enableGlobalFilter)!=null?t:!0)&&((n=s.options.enableGlobalFilter)!=null?n:!0)&&((r=s.options.enableFilters)!=null?r:!0)&&((i=s.options.getColumnCanGlobalFilter==null?void 0:s.options.getColumnCanGlobalFilter(e))!=null?i:!0)&&!!e.accessorFn}},createTable:e=>{e.getGlobalAutoFilterFn=()=>$e.includesString,e.getGlobalFilterFn=()=>{var s,t;const{globalFilterFn:n}=e.options;return nt(n)?n:n==="auto"?e.getGlobalAutoFilterFn():(s=(t=e.options.filterFns)==null?void 0:t[n])!=null?s:$e[n]},e.setGlobalFilter=s=>{e.options.onGlobalFilterChange==null||e.options.onGlobalFilterChange(s)},e.resetGlobalFilter=s=>{e.setGlobalFilter(s?void 0:e.initialState.globalFilter)}}},Os={getInitialState:e=>({expanded:{},...e}),getDefaultOptions:e=>({onExpandedChange:ye("expanded",e),paginateExpandedRows:!0}),createTable:e=>{let s=!1,t=!1;e._autoResetExpanded=()=>{var n,r;if(!s){e._queue(()=>{s=!0});return}if((n=(r=e.options.autoResetAll)!=null?r:e.options.autoResetExpanded)!=null?n:!e.options.manualExpanding){if(t)return;t=!0,e._queue(()=>{e.resetExpanded(),t=!1})}},e.setExpanded=n=>e.options.onExpandedChange==null?void 0:e.options.onExpandedChange(n),e.toggleAllRowsExpanded=n=>{n??!e.getIsAllRowsExpanded()?e.setExpanded(!0):e.setExpanded({})},e.resetExpanded=n=>{var r,i;e.setExpanded(n?{}:(r=(i=e.initialState)==null?void 0:i.expanded)!=null?r:{})},e.getCanSomeRowsExpand=()=>e.getPrePaginationRowModel().flatRows.some(n=>n.getCanExpand()),e.getToggleAllRowsExpandedHandler=()=>n=>{n.persist==null||n.persist(),e.toggleAllRowsExpanded()},e.getIsSomeRowsExpanded=()=>{const n=e.getState().expanded;return n===!0||Object.values(n).some(Boolean)},e.getIsAllRowsExpanded=()=>{const n=e.getState().expanded;return typeof n=="boolean"?n===!0:!(!Object.keys(n).length||e.getRowModel().flatRows.some(r=>!r.getIsExpanded()))},e.getExpandedDepth=()=>{let n=0;return(e.getState().expanded===!0?Object.keys(e.getRowModel().rowsById):Object.keys(e.getState().expanded)).forEach(i=>{const l=i.split(".");n=Math.max(n,l.length)}),n},e.getPreExpandedRowModel=()=>e.getSortedRowModel(),e.getExpandedRowModel=()=>(!e._getExpandedRowModel&&e.options.getExpandedRowModel&&(e._getExpandedRowModel=e.options.getExpandedRowModel(e)),e.options.manualExpanding||!e._getExpandedRowModel?e.getPreExpandedRowModel():e._getExpandedRowModel())},createRow:(e,s)=>{e.toggleExpanded=t=>{s.setExpanded(n=>{var r;const i=n===!0?!0:!!(n!=null&&n[e.id]);let l={};if(n===!0?Object.keys(s.getRowModel().rowsById).forEach(a=>{l[a]=!0}):l=n,t=(r=t)!=null?r:!i,!i&&t)return{...l,[e.id]:!0};if(i&&!t){const{[e.id]:a,...u}=l;return u}return n})},e.getIsExpanded=()=>{var t;const n=s.getState().expanded;return!!((t=s.options.getIsRowExpanded==null?void 0:s.options.getIsRowExpanded(e))!=null?t:n===!0||n!=null&&n[e.id])},e.getCanExpand=()=>{var t,n,r;return(t=s.options.getRowCanExpand==null?void 0:s.options.getRowCanExpand(e))!=null?t:((n=s.options.enableExpanding)!=null?n:!0)&&!!((r=e.subRows)!=null&&r.length)},e.getIsAllParentsExpanded=()=>{let t=!0,n=e;for(;t&&n.parentId;)n=s.getRow(n.parentId,!0),t=n.getIsExpanded();return t},e.getToggleExpandedHandler=()=>{const t=e.getCanExpand();return()=>{t&&e.toggleExpanded()}}}},Ct=0,bt=10,pt=()=>({pageIndex:Ct,pageSize:bt}),Gs={getInitialState:e=>({...e,pagination:{...pt(),...e==null?void 0:e.pagination}}),getDefaultOptions:e=>({onPaginationChange:ye("pagination",e)}),createTable:e=>{let s=!1,t=!1;e._autoResetPageIndex=()=>{var n,r;if(!s){e._queue(()=>{s=!0});return}if((n=(r=e.options.autoResetAll)!=null?r:e.options.autoResetPageIndex)!=null?n:!e.options.manualPagination){if(t)return;t=!0,e._queue(()=>{e.resetPageIndex(),t=!1})}},e.setPagination=n=>{const r=i=>Ee(n,i);return e.options.onPaginationChange==null?void 0:e.options.onPaginationChange(r)},e.resetPagination=n=>{var r;e.setPagination(n?pt():(r=e.initialState.pagination)!=null?r:pt())},e.setPageIndex=n=>{e.setPagination(r=>{let i=Ee(n,r.pageIndex);const l=typeof e.options.pageCount>"u"||e.options.pageCount===-1?Number.MAX_SAFE_INTEGER:e.options.pageCount-1;return i=Math.max(0,Math.min(i,l)),{...r,pageIndex:i}})},e.resetPageIndex=n=>{var r,i;e.setPageIndex(n?Ct:(r=(i=e.initialState)==null||(i=i.pagination)==null?void 0:i.pageIndex)!=null?r:Ct)},e.resetPageSize=n=>{var r,i;e.setPageSize(n?bt:(r=(i=e.initialState)==null||(i=i.pagination)==null?void 0:i.pageSize)!=null?r:bt)},e.setPageSize=n=>{e.setPagination(r=>{const i=Math.max(1,Ee(n,r.pageSize)),l=r.pageSize*r.pageIndex,a=Math.floor(l/i);return{...r,pageIndex:a,pageSize:i}})},e.setPageCount=n=>e.setPagination(r=>{var i;let l=Ee(n,(i=e.options.pageCount)!=null?i:-1);return typeof l=="number"&&(l=Math.max(-1,l)),{...r,pageCount:l}}),e.getPageOptions=L(()=>[e.getPageCount()],n=>{let r=[];return n&&n>0&&(r=[...new Array(n)].fill(null).map((i,l)=>l)),r},z(e.options,"debugTable")),e.getCanPreviousPage=()=>e.getState().pagination.pageIndex>0,e.getCanNextPage=()=>{const{pageIndex:n}=e.getState().pagination,r=e.getPageCount();return r===-1?!0:r===0?!1:n<r-1},e.previousPage=()=>e.setPageIndex(n=>n-1),e.nextPage=()=>e.setPageIndex(n=>n+1),e.firstPage=()=>e.setPageIndex(0),e.lastPage=()=>e.setPageIndex(e.getPageCount()-1),e.getPrePaginationRowModel=()=>e.getExpandedRowModel(),e.getPaginationRowModel=()=>(!e._getPaginationRowModel&&e.options.getPaginationRowModel&&(e._getPaginationRowModel=e.options.getPaginationRowModel(e)),e.options.manualPagination||!e._getPaginationRowModel?e.getPrePaginationRowModel():e._getPaginationRowModel()),e.getPageCount=()=>{var n;return(n=e.options.pageCount)!=null?n:Math.ceil(e.getRowCount()/e.getState().pagination.pageSize)},e.getRowCount=()=>{var n;return(n=e.options.rowCount)!=null?n:e.getPrePaginationRowModel().rows.length}}},ht=()=>({top:[],bottom:[]}),Bs={getInitialState:e=>({rowPinning:ht(),...e}),getDefaultOptions:e=>({onRowPinningChange:ye("rowPinning",e)}),createRow:(e,s)=>{e.pin=(t,n,r)=>{const i=n?e.getLeafRows().map(u=>{let{id:c}=u;return c}):[],l=r?e.getParentRows().map(u=>{let{id:c}=u;return c}):[],a=new Set([...l,e.id,...i]);s.setRowPinning(u=>{var c,d;if(t==="bottom"){var m,f;return{top:((m=u==null?void 0:u.top)!=null?m:[]).filter(x=>!(a!=null&&a.has(x))),bottom:[...((f=u==null?void 0:u.bottom)!=null?f:[]).filter(x=>!(a!=null&&a.has(x))),...Array.from(a)]}}if(t==="top"){var g,h;return{top:[...((g=u==null?void 0:u.top)!=null?g:[]).filter(x=>!(a!=null&&a.has(x))),...Array.from(a)],bottom:((h=u==null?void 0:u.bottom)!=null?h:[]).filter(x=>!(a!=null&&a.has(x)))}}return{top:((c=u==null?void 0:u.top)!=null?c:[]).filter(x=>!(a!=null&&a.has(x))),bottom:((d=u==null?void 0:u.bottom)!=null?d:[]).filter(x=>!(a!=null&&a.has(x)))}})},e.getCanPin=()=>{var t;const{enableRowPinning:n,enablePinning:r}=s.options;return typeof n=="function"?n(e):(t=n??r)!=null?t:!0},e.getIsPinned=()=>{const t=[e.id],{top:n,bottom:r}=s.getState().rowPinning,i=t.some(a=>n==null?void 0:n.includes(a)),l=t.some(a=>r==null?void 0:r.includes(a));return i?"top":l?"bottom":!1},e.getPinnedIndex=()=>{var t,n;const r=e.getIsPinned();if(!r)return-1;const i=(t=r==="top"?s.getTopRows():s.getBottomRows())==null?void 0:t.map(l=>{let{id:a}=l;return a});return(n=i==null?void 0:i.indexOf(e.id))!=null?n:-1}},createTable:e=>{e.setRowPinning=s=>e.options.onRowPinningChange==null?void 0:e.options.onRowPinningChange(s),e.resetRowPinning=s=>{var t,n;return e.setRowPinning(s?ht():(t=(n=e.initialState)==null?void 0:n.rowPinning)!=null?t:ht())},e.getIsSomeRowsPinned=s=>{var t;const n=e.getState().rowPinning;if(!s){var r,i;return!!((r=n.top)!=null&&r.length||(i=n.bottom)!=null&&i.length)}return!!((t=n[s])!=null&&t.length)},e._getPinnedRows=(s,t,n)=>{var r;return((r=e.options.keepPinnedRows)==null||r?(t??[]).map(l=>{const a=e.getRow(l,!0);return a.getIsAllParentsExpanded()?a:null}):(t??[]).map(l=>s.find(a=>a.id===l))).filter(Boolean).map(l=>({...l,position:n}))},e.getTopRows=L(()=>[e.getRowModel().rows,e.getState().rowPinning.top],(s,t)=>e._getPinnedRows(s,t,"top"),z(e.options,"debugRows")),e.getBottomRows=L(()=>[e.getRowModel().rows,e.getState().rowPinning.bottom],(s,t)=>e._getPinnedRows(s,t,"bottom"),z(e.options,"debugRows")),e.getCenterRows=L(()=>[e.getRowModel().rows,e.getState().rowPinning.top,e.getState().rowPinning.bottom],(s,t,n)=>{const r=new Set([...t??[],...n??[]]);return s.filter(i=>!r.has(i.id))},z(e.options,"debugRows"))}},Us={getInitialState:e=>({rowSelection:{},...e}),getDefaultOptions:e=>({onRowSelectionChange:ye("rowSelection",e),enableRowSelection:!0,enableMultiRowSelection:!0,enableSubRowSelection:!0}),createTable:e=>{e.setRowSelection=s=>e.options.onRowSelectionChange==null?void 0:e.options.onRowSelectionChange(s),e.resetRowSelection=s=>{var t;return e.setRowSelection(s?{}:(t=e.initialState.rowSelection)!=null?t:{})},e.toggleAllRowsSelected=s=>{e.setRowSelection(t=>{s=typeof s<"u"?s:!e.getIsAllRowsSelected();const n={...t},r=e.getPreGroupedRowModel().flatRows;return s?r.forEach(i=>{i.getCanSelect()&&(n[i.id]=!0)}):r.forEach(i=>{delete n[i.id]}),n})},e.toggleAllPageRowsSelected=s=>e.setRowSelection(t=>{const n=typeof s<"u"?s:!e.getIsAllPageRowsSelected(),r={...t};return e.getRowModel().rows.forEach(i=>{jt(r,i.id,n,!0,e)}),r}),e.getPreSelectedRowModel=()=>e.getCoreRowModel(),e.getSelectedRowModel=L(()=>[e.getState().rowSelection,e.getCoreRowModel()],(s,t)=>Object.keys(s).length?xt(e,t):{rows:[],flatRows:[],rowsById:{}},z(e.options,"debugTable")),e.getFilteredSelectedRowModel=L(()=>[e.getState().rowSelection,e.getFilteredRowModel()],(s,t)=>Object.keys(s).length?xt(e,t):{rows:[],flatRows:[],rowsById:{}},z(e.options,"debugTable")),e.getGroupedSelectedRowModel=L(()=>[e.getState().rowSelection,e.getSortedRowModel()],(s,t)=>Object.keys(s).length?xt(e,t):{rows:[],flatRows:[],rowsById:{}},z(e.options,"debugTable")),e.getIsAllRowsSelected=()=>{const s=e.getFilteredRowModel().flatRows,{rowSelection:t}=e.getState();let n=!!(s.length&&Object.keys(t).length);return n&&s.some(r=>r.getCanSelect()&&!t[r.id])&&(n=!1),n},e.getIsAllPageRowsSelected=()=>{const s=e.getPaginationRowModel().flatRows.filter(r=>r.getCanSelect()),{rowSelection:t}=e.getState();let n=!!s.length;return n&&s.some(r=>!t[r.id])&&(n=!1),n},e.getIsSomeRowsSelected=()=>{var s;const t=Object.keys((s=e.getState().rowSelection)!=null?s:{}).length;return t>0&&t<e.getFilteredRowModel().flatRows.length},e.getIsSomePageRowsSelected=()=>{const s=e.getPaginationRowModel().flatRows;return e.getIsAllPageRowsSelected()?!1:s.filter(t=>t.getCanSelect()).some(t=>t.getIsSelected()||t.getIsSomeSelected())},e.getToggleAllRowsSelectedHandler=()=>s=>{e.toggleAllRowsSelected(s.target.checked)},e.getToggleAllPageRowsSelectedHandler=()=>s=>{e.toggleAllPageRowsSelected(s.target.checked)}},createRow:(e,s)=>{e.toggleSelected=(t,n)=>{const r=e.getIsSelected();s.setRowSelection(i=>{var l;if(t=typeof t<"u"?t:!r,e.getCanSelect()&&r===t)return i;const a={...i};return jt(a,e.id,t,(l=n==null?void 0:n.selectChildren)!=null?l:!0,s),a})},e.getIsSelected=()=>{const{rowSelection:t}=s.getState();return Et(e,t)},e.getIsSomeSelected=()=>{const{rowSelection:t}=s.getState();return Rt(e,t)==="some"},e.getIsAllSubRowsSelected=()=>{const{rowSelection:t}=s.getState();return Rt(e,t)==="all"},e.getCanSelect=()=>{var t;return typeof s.options.enableRowSelection=="function"?s.options.enableRowSelection(e):(t=s.options.enableRowSelection)!=null?t:!0},e.getCanSelectSubRows=()=>{var t;return typeof s.options.enableSubRowSelection=="function"?s.options.enableSubRowSelection(e):(t=s.options.enableSubRowSelection)!=null?t:!0},e.getCanMultiSelect=()=>{var t;return typeof s.options.enableMultiRowSelection=="function"?s.options.enableMultiRowSelection(e):(t=s.options.enableMultiRowSelection)!=null?t:!0},e.getToggleSelectedHandler=()=>{const t=e.getCanSelect();return n=>{var r;t&&e.toggleSelected((r=n.target)==null?void 0:r.checked)}}}},jt=(e,s,t,n,r)=>{var i;const l=r.getRow(s,!0);t?(l.getCanMultiSelect()||Object.keys(e).forEach(a=>delete e[a]),l.getCanSelect()&&(e[s]=!0)):delete e[s],n&&(i=l.subRows)!=null&&i.length&&l.getCanSelectSubRows()&&l.subRows.forEach(a=>jt(e,a.id,t,n,r))};function xt(e,s){const t=e.getState().rowSelection,n=[],r={},i=function(l,a){return l.map(u=>{var c;const d=Et(u,t);if(d&&(n.push(u),r[u.id]=u),(c=u.subRows)!=null&&c.length&&(u={...u,subRows:i(u.subRows)}),d)return u}).filter(Boolean)};return{rows:i(s.rows),flatRows:n,rowsById:r}}function Et(e,s){var t;return(t=s[e.id])!=null?t:!1}function Rt(e,s,t){var n;if(!((n=e.subRows)!=null&&n.length))return!1;let r=!0,i=!1;return e.subRows.forEach(l=>{if(!(i&&!r)&&(l.getCanSelect()&&(Et(l,s)?i=!0:r=!1),l.subRows&&l.subRows.length)){const a=Rt(l,s);a==="all"?i=!0:(a==="some"&&(i=!0),r=!1)}}),r?"all":i?"some":!1}const Nt=/([0-9]+)/gm,qs=(e,s,t)=>hn(Ie(e.getValue(t)).toLowerCase(),Ie(s.getValue(t)).toLowerCase()),Ws=(e,s,t)=>hn(Ie(e.getValue(t)),Ie(s.getValue(t))),Xs=(e,s,t)=>It(Ie(e.getValue(t)).toLowerCase(),Ie(s.getValue(t)).toLowerCase()),Ks=(e,s,t)=>It(Ie(e.getValue(t)),Ie(s.getValue(t))),Ys=(e,s,t)=>{const n=e.getValue(t),r=s.getValue(t);return n>r?1:n<r?-1:0},Zs=(e,s,t)=>It(e.getValue(t),s.getValue(t));function It(e,s){return e===s?0:e>s?1:-1}function Ie(e){return typeof e=="number"?isNaN(e)||e===1/0||e===-1/0?"":String(e):typeof e=="string"?e:""}function hn(e,s){const t=e.split(Nt).filter(Boolean),n=s.split(Nt).filter(Boolean);for(;t.length&&n.length;){const r=t.shift(),i=n.shift(),l=parseInt(r,10),a=parseInt(i,10),u=[l,a].sort();if(isNaN(u[0])){if(r>i)return 1;if(i>r)return-1;continue}if(isNaN(u[1]))return isNaN(l)?-1:1;if(l>a)return 1;if(a>l)return-1}return t.length-n.length}const He={alphanumeric:qs,alphanumericCaseSensitive:Ws,text:Xs,textCaseSensitive:Ks,datetime:Ys,basic:Zs},Qs={getInitialState:e=>({sorting:[],...e}),getDefaultColumnDef:()=>({sortingFn:"auto",sortUndefined:1}),getDefaultOptions:e=>({onSortingChange:ye("sorting",e),isMultiSortEvent:s=>s.shiftKey}),createColumn:(e,s)=>{e.getAutoSortingFn=()=>{const t=s.getFilteredRowModel().flatRows.slice(10);let n=!1;for(const r of t){const i=r==null?void 0:r.getValue(e.id);if(Object.prototype.toString.call(i)==="[object Date]")return He.datetime;if(typeof i=="string"&&(n=!0,i.split(Nt).length>1))return He.alphanumeric}return n?He.text:He.basic},e.getAutoSortDir=()=>{const t=s.getFilteredRowModel().flatRows[0];return typeof(t==null?void 0:t.getValue(e.id))=="string"?"asc":"desc"},e.getSortingFn=()=>{var t,n;if(!e)throw new Error;return nt(e.columnDef.sortingFn)?e.columnDef.sortingFn:e.columnDef.sortingFn==="auto"?e.getAutoSortingFn():(t=(n=s.options.sortingFns)==null?void 0:n[e.columnDef.sortingFn])!=null?t:He[e.columnDef.sortingFn]},e.toggleSorting=(t,n)=>{const r=e.getNextSortingOrder(),i=typeof t<"u"&&t!==null;s.setSorting(l=>{const a=l==null?void 0:l.find(g=>g.id===e.id),u=l==null?void 0:l.findIndex(g=>g.id===e.id);let c=[],d,m=i?t:r==="desc";if(l!=null&&l.length&&e.getCanMultiSort()&&n?a?d="toggle":d="add":l!=null&&l.length&&u!==l.length-1?d="replace":a?d="toggle":d="replace",d==="toggle"&&(i||r||(d="remove")),d==="add"){var f;c=[...l,{id:e.id,desc:m}],c.splice(0,c.length-((f=s.options.maxMultiSortColCount)!=null?f:Number.MAX_SAFE_INTEGER))}else d==="toggle"?c=l.map(g=>g.id===e.id?{...g,desc:m}:g):d==="remove"?c=l.filter(g=>g.id!==e.id):c=[{id:e.id,desc:m}];return c})},e.getFirstSortDir=()=>{var t,n;return((t=(n=e.columnDef.sortDescFirst)!=null?n:s.options.sortDescFirst)!=null?t:e.getAutoSortDir()==="desc")?"desc":"asc"},e.getNextSortingOrder=t=>{var n,r;const i=e.getFirstSortDir(),l=e.getIsSorted();return l?l!==i&&((n=s.options.enableSortingRemoval)==null||n)&&(!(t&&(r=s.options.enableMultiRemove)!=null)||r)?!1:l==="desc"?"asc":"desc":i},e.getCanSort=()=>{var t,n;return((t=e.columnDef.enableSorting)!=null?t:!0)&&((n=s.options.enableSorting)!=null?n:!0)&&!!e.accessorFn},e.getCanMultiSort=()=>{var t,n;return(t=(n=e.columnDef.enableMultiSort)!=null?n:s.options.enableMultiSort)!=null?t:!!e.accessorFn},e.getIsSorted=()=>{var t;const n=(t=s.getState().sorting)==null?void 0:t.find(r=>r.id===e.id);return n?n.desc?"desc":"asc":!1},e.getSortIndex=()=>{var t,n;return(t=(n=s.getState().sorting)==null?void 0:n.findIndex(r=>r.id===e.id))!=null?t:-1},e.clearSorting=()=>{s.setSorting(t=>t!=null&&t.length?t.filter(n=>n.id!==e.id):[])},e.getToggleSortingHandler=()=>{const t=e.getCanSort();return n=>{t&&(n.persist==null||n.persist(),e.toggleSorting==null||e.toggleSorting(void 0,e.getCanMultiSort()?s.options.isMultiSortEvent==null?void 0:s.options.isMultiSortEvent(n):!1))}}},createTable:e=>{e.setSorting=s=>e.options.onSortingChange==null?void 0:e.options.onSortingChange(s),e.resetSorting=s=>{var t,n;e.setSorting(s?[]:(t=(n=e.initialState)==null?void 0:n.sorting)!=null?t:[])},e.getPreSortedRowModel=()=>e.getGroupedRowModel(),e.getSortedRowModel=()=>(!e._getSortedRowModel&&e.options.getSortedRowModel&&(e._getSortedRowModel=e.options.getSortedRowModel(e)),e.options.manualSorting||!e._getSortedRowModel?e.getPreSortedRowModel():e._getSortedRowModel())}},Js=[ws,zs,Vs,As,Ss,Cs,Ts,Hs,Qs,Is,Os,Gs,Bs,Us,ks];function er(e){var s,t;const n=[...Js,...(s=e._features)!=null?s:[]];let r={_features:n};const i=r._features.reduce((f,g)=>Object.assign(f,g.getDefaultOptions==null?void 0:g.getDefaultOptions(r)),{}),l=f=>r.options.mergeOptions?r.options.mergeOptions(i,f):{...i,...f};let u={...{},...(t=e.initialState)!=null?t:{}};r._features.forEach(f=>{var g;u=(g=f.getInitialState==null?void 0:f.getInitialState(u))!=null?g:u});const c=[];let d=!1;const m={_features:n,options:{...i,...e},initialState:u,_queue:f=>{c.push(f),d||(d=!0,Promise.resolve().then(()=>{for(;c.length;)c.shift()();d=!1}).catch(g=>setTimeout(()=>{throw g})))},reset:()=>{r.setState(r.initialState)},setOptions:f=>{const g=Ee(f,r.options);r.options=l(g)},getState:()=>r.options.state,setState:f=>{r.options.onStateChange==null||r.options.onStateChange(f)},_getRowId:(f,g,h)=>{var x;return(x=r.options.getRowId==null?void 0:r.options.getRowId(f,g,h))!=null?x:`${h?[h.id,g].join("."):g}`},getCoreRowModel:()=>(r._getCoreRowModel||(r._getCoreRowModel=r.options.getCoreRowModel(r)),r._getCoreRowModel()),getRowModel:()=>r.getPaginationRowModel(),getRow:(f,g)=>{let h=(g?r.getPrePaginationRowModel():r.getRowModel()).rowsById[f];if(!h&&(h=r.getCoreRowModel().rowsById[f],!h))throw new Error;return h},_getDefaultColumnDef:L(()=>[r.options.defaultColumn],f=>{var g;return f=(g=f)!=null?g:{},{header:h=>{const x=h.header.column.columnDef;return x.accessorKey?x.accessorKey:x.accessorFn?x.id:null},cell:h=>{var x,y;return(x=(y=h.renderValue())==null||y.toString==null?void 0:y.toString())!=null?x:null},...r._features.reduce((h,x)=>Object.assign(h,x.getDefaultColumnDef==null?void 0:x.getDefaultColumnDef()),{}),...f}},z(e,"debugColumns")),_getColumnDefs:()=>r.options.columns,getAllColumns:L(()=>[r._getColumnDefs()],f=>{const g=function(h,x,y){return y===void 0&&(y=0),h.map(v=>{const C=vs(r,v,y,x),w=v;return C.columns=w.columns?g(w.columns,C,y+1):[],C})};return g(f)},z(e,"debugColumns")),getAllFlatColumns:L(()=>[r.getAllColumns()],f=>f.flatMap(g=>g.getFlatColumns()),z(e,"debugColumns")),_getAllFlatColumnsById:L(()=>[r.getAllFlatColumns()],f=>f.reduce((g,h)=>(g[h.id]=h,g),{}),z(e,"debugColumns")),getAllLeafColumns:L(()=>[r.getAllColumns(),r._getOrderColumnsFn()],(f,g)=>{let h=f.flatMap(x=>x.getLeafColumns());return g(h)},z(e,"debugColumns")),getColumn:f=>r._getAllFlatColumnsById()[f]};Object.assign(r,m);for(let f=0;f<r._features.length;f++){const g=r._features[f];g==null||g.createTable==null||g.createTable(r)}return r}function Wt(){return e=>L(()=>[e.options.data],s=>{const t={rows:[],flatRows:[],rowsById:{}},n=function(r,i,l){i===void 0&&(i=0);const a=[];for(let c=0;c<r.length;c++){const d=ys(e,e._getRowId(r[c],c,l),r[c],c,i,void 0,l==null?void 0:l.id);if(t.flatRows.push(d),t.rowsById[d.id]=d,a.push(d),e.options.getSubRows){var u;d.originalSubRows=e.options.getSubRows(r[c],c),(u=d.originalSubRows)!=null&&u.length&&(d.subRows=n(d.originalSubRows,i+1,d))}}return a};return t.rows=n(s),t},z(e.options,"debugTable","getRowModel",()=>e._autoResetPageIndex()))}function tr(e){const s=[],t=n=>{var r;s.push(n),(r=n.subRows)!=null&&r.length&&n.getIsExpanded()&&n.subRows.forEach(t)};return e.rows.forEach(t),{rows:s,flatRows:e.flatRows,rowsById:e.rowsById}}function Xt(e){return s=>L(()=>[s.getState().pagination,s.getPrePaginationRowModel(),s.options.paginateExpandedRows?void 0:s.getState().expanded],(t,n)=>{if(!n.rows.length)return n;const{pageSize:r,pageIndex:i}=t;let{rows:l,flatRows:a,rowsById:u}=n;const c=r*i,d=c+r;l=l.slice(c,d);let m;s.options.paginateExpandedRows?m={rows:l,flatRows:a,rowsById:u}:m=tr({rows:l,flatRows:a,rowsById:u}),m.flatRows=[];const f=g=>{m.flatRows.push(g),g.subRows.length&&g.subRows.forEach(f)};return m.rows.forEach(f),m},z(s.options,"debugTable"))}function Kt(){return e=>L(()=>[e.getState().sorting,e.getPreSortedRowModel()],(s,t)=>{if(!t.rows.length||!(s!=null&&s.length))return t;const n=e.getState().sorting,r=[],i=n.filter(u=>{var c;return(c=e.getColumn(u.id))==null?void 0:c.getCanSort()}),l={};i.forEach(u=>{const c=e.getColumn(u.id);c&&(l[u.id]={sortUndefined:c.columnDef.sortUndefined,invertSorting:c.columnDef.invertSorting,sortingFn:c.getSortingFn()})});const a=u=>{const c=u.map(d=>({...d}));return c.sort((d,m)=>{for(let g=0;g<i.length;g+=1){var f;const h=i[g],x=l[h.id],y=x.sortUndefined,v=(f=h==null?void 0:h.desc)!=null?f:!1;let C=0;if(y){const w=d.getValue(h.id),N=m.getValue(h.id),M=w===void 0,R=N===void 0;if(M||R){if(y==="first")return M?-1:1;if(y==="last")return M?1:-1;C=M&&R?0:M?y:-y}}if(C===0&&(C=x.sortingFn(d,m,h.id)),C!==0)return v&&(C*=-1),x.invertSorting&&(C*=-1),C}return d.index-m.index}),c.forEach(d=>{var m;r.push(d),(m=d.subRows)!=null&&m.length&&(d.subRows=a(d.subRows))}),c};return{rows:a(t.rows),flatRows:r,rowsById:t.rowsById}},z(e.options,"debugTable","getSortedRowModel",()=>e._autoResetPageIndex()))}/**
   * react-table
   *
   * Copyright (c) TanStack
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE.md file in the root directory of this source tree.
   *
   * @license MIT
   */function Yt(e,s){return e?nr(e)?S.createElement(e,s):e:null}function nr(e){return sr(e)||typeof e=="function"||rr(e)}function sr(e){return typeof e=="function"&&(()=>{const s=Object.getPrototypeOf(e);return s.prototype&&s.prototype.isReactComponent})()}function rr(e){return typeof e=="object"&&typeof e.$$typeof=="symbol"&&["react.memo","react.forward_ref"].includes(e.$$typeof.description)}function Zt(e){const s={state:{},onStateChange:()=>{},renderFallbackValue:null,...e},[t]=S.useState(()=>({current:er(s)})),[n,r]=S.useState(()=>t.current.initialState);return t.current.setOptions(i=>({...i,...e,state:{...n,...e.state},onStateChange:l=>{r(l),e.onStateChange==null||e.onStateChange(l)}})),t.current}function xn({nodes:e,edges:s,onNodesChange:t,onEdgesChange:n,onBlur:r,editable:i=!1}){const[l,a]=S.useState("nodes"),[u,c]=S.useState(e),[d,m]=S.useState(s),f=S.useRef(new Map),g=S.useRef(new Map);S.useEffect(()=>{c([...e]),m([...s]),f.current.clear(),g.current.clear()},[e,s]);const h=S.useMemo(()=>{if(e.length===0)return[];const w=new Set;e.forEach(R=>{Object.keys(R).forEach(V=>w.add(V))});const N=Array.from(w);return[...N.includes("id")?["id"]:[],...N.includes("label")?["label"]:[],...N.filter(R=>R!=="id"&&R!=="label")].map(R=>({header:R.charAt(0).toUpperCase()+R.slice(1).replace(/_/g," "),accessorKey:R,cell:V=>{var I;const E=V.getValue();if(i&&R!=="id"){const P=V.row.original.id,G=u.findIndex(q=>q.id===P);if(G===-1)return o.jsx("span",{children:"-"});const _=((I=u[G])==null?void 0:I[R])??E,T=`${P}-${R}`;return o.jsx(vt,{id:T,type:typeof _=="number"?"number":"text",initialValue:_==null?"":String(_),isNumber:typeof _=="number",onBlur:q=>{const X=[...u],Y=typeof _=="number"?parseFloat(q)||0:q;X[G]={...X[G],[R]:Y},c(X),t==null||t(X),r==null||r()}},T)}return E==null?"-":typeof E=="number"?E.toLocaleString():String(E)}}))},[e,i]),x=S.useMemo(()=>{if(s.length===0)return[];const w=new Set;s.forEach(R=>{Object.keys(R).forEach(V=>w.add(V))});const N=Array.from(w);return[...N.includes("source")?["source"]:[],...N.includes("target")?["target"]:[],...N.includes("value")?["value"]:[],...N.filter(R=>R!=="source"&&R!=="target"&&R!=="value")].map(R=>({header:R.charAt(0).toUpperCase()+R.slice(1).replace(/_/g," "),accessorKey:R,cell:V=>{var I,B;const E=V.getValue();if(i&&R!=="source"&&R!=="target"){const P=V.row.original,G=d.findIndex(q=>q.source===P.source&&q.target===P.target&&q.value===P.value);if(G===-1){const q=d.findIndex(Z=>Z.source===P.source&&Z.target===P.target);if(q===-1)return o.jsx("span",{children:"-"});const X=((I=d[q])==null?void 0:I[R])??E,Y=`${P.source}-${P.target}-${R}-fallback`;return o.jsx(vt,{id:Y,type:typeof X=="number"?"number":"text",initialValue:X==null?"":String(X),isNumber:typeof X=="number",onBlur:Z=>{const re=[...d],j=typeof X=="number"?parseFloat(Z)||0:Z;re[q]={...re[q],[R]:j},m(re),n==null||n(re),r==null||r()}},Y)}const _=((B=d[G])==null?void 0:B[R])??E,T=`${P.source}-${P.target}-${R}`;return o.jsx(vt,{id:T,type:typeof _=="number"?"number":"text",initialValue:_==null?"":String(_),isNumber:typeof _=="number",onBlur:q=>{const X=[...d],Y=typeof _=="number"?parseFloat(q)||0:q;X[G]={...X[G],[R]:Y},m(X),n==null||n(X),r==null||r()}},T)}return E==null?"-":typeof E=="number"?E.toLocaleString():String(E)}}))},[s,i]),y=Zt({data:i?u:e,columns:h,getCoreRowModel:Wt(),getSortedRowModel:Kt(),getPaginationRowModel:Xt(),initialState:{pagination:{pageSize:25}}}),v=Zt({data:i?d:s,columns:x,getCoreRowModel:Wt(),getSortedRowModel:Kt(),getPaginationRowModel:Xt(),initialState:{pagination:{pageSize:25}}}),C=l==="nodes"?y:v;return o.jsxs("div",{className:"h-full w-full flex flex-col",style:{height:"100%",maxHeight:"100%"},children:[o.jsxs("div",{className:"flex border-b mb-4 flex-shrink-0",children:[o.jsxs("button",{onClick:()=>a("nodes"),className:`px-4 py-2 font-medium text-sm transition-colors ${l==="nodes"?"border-b-2 border-blue-600 text-blue-600":"text-gray-600 hover:text-gray-900"}`,children:["Nodes (",e.length,")"]}),o.jsxs("button",{onClick:()=>a("edges"),className:`px-4 py-2 font-medium text-sm transition-colors ${l==="edges"?"border-b-2 border-blue-600 text-blue-600":"text-gray-600 hover:text-gray-900"}`,children:["Edges (",s.length,")"]})]}),o.jsx("div",{className:"flex-1 flex flex-col min-h-0 overflow-hidden",children:o.jsxs("div",{className:"overflow-auto flex-1 min-h-0",children:[o.jsxs("table",{className:"min-w-full text-sm",children:[o.jsx("thead",{className:"bg-gray-50 border-b sticky top-0 z-10",children:C.getHeaderGroups().map(w=>o.jsx("tr",{children:w.headers.map(N=>o.jsx("th",{className:"px-4 py-2 text-left font-semibold text-gray-700 bg-gray-50",children:N.isPlaceholder?null:o.jsxs("div",{className:N.column.getCanSort()?"cursor-pointer select-none hover:text-blue-600":"",onClick:N.column.getToggleSortingHandler(),children:[Yt(N.column.columnDef.header,N.getContext()),{asc:" ↑",desc:" ↓"}[N.column.getIsSorted()]??null]})},N.id))},w.id))}),o.jsx("tbody",{className:"divide-y divide-gray-200 bg-white",children:C.getRowModel().rows.map(w=>o.jsx("tr",{className:"hover:bg-gray-50",children:w.getVisibleCells().map(N=>o.jsx("td",{className:"px-4 py-2",children:Yt(N.column.columnDef.cell,N.getContext())},N.id))},w.id))})]}),C.getRowModel().rows.length===0&&o.jsxs("div",{className:"text-center text-gray-500 py-8",children:["No ",l," to display"]})]})}),o.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-t border-gray-200 bg-white flex-shrink-0",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("span",{className:"text-sm text-gray-700",children:"Show"}),o.jsx("select",{value:C.getState().pagination.pageSize,onChange:w=>{C.setPageSize(Number(w.target.value))},className:"border border-gray-300 rounded px-2 py-1 text-sm",children:[10,25,50,100].map(w=>o.jsx("option",{value:w,children:w},w))}),o.jsx("span",{className:"text-sm text-gray-700",children:"entries"})]}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsxs("span",{className:"text-sm text-gray-700",children:["Page ",C.getState().pagination.pageIndex+1," of"," ",C.getPageCount()]}),o.jsxs("div",{className:"flex gap-1",children:[o.jsx("button",{onClick:()=>C.setPageIndex(0),disabled:!C.getCanPreviousPage(),className:"px-2 py-1 text-sm border border-gray-300 rounded disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-50",children:"<<"}),o.jsx("button",{onClick:()=>C.previousPage(),disabled:!C.getCanPreviousPage(),className:"px-2 py-1 text-sm border border-gray-300 rounded disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-50",children:"<"}),o.jsx("button",{onClick:()=>C.nextPage(),disabled:!C.getCanNextPage(),className:"px-2 py-1 text-sm border border-gray-300 rounded disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-50",children:">"}),o.jsx("button",{onClick:()=>C.setPageIndex(C.getPageCount()-1),disabled:!C.getCanNextPage(),className:"px-2 py-1 text-sm border border-gray-300 rounded disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-50",children:">>"})]})]})]})]})}function vt({id:e,type:s,initialValue:t,onBlur:n}){const r=S.useRef(null),[i,l]=S.useState(t);return S.useEffect(()=>{r.current&&document.activeElement!==r.current&&l(t)},[t]),o.jsx("input",{ref:r,id:e,type:s,value:i,onChange:a=>{l(a.target.value)},onBlur:a=>{n(a.target.value)},className:"w-full px-2 py-1 border border-gray-300 rounded text-sm focus:outline-none focus:ring-2 focus:ring-blue-500",autoComplete:"off"})}function or({dataset:e,onClose:s,onSave:t,onDelete:n,onDuplicate:r}){const[i,l]=S.useState(e.name),[a,u]=S.useState(e.notes||""),[c,d]=S.useState(!1),[m,f]=S.useState(!1),[g,h]=S.useState(!1),[x,y]=S.useState("info"),[v,C]=S.useState(null),w=e.snapshots[0]||{timestamp:e.timeRange.start,nodes:[],edges:[]};S.useEffect(()=>{l(e.name),u(e.notes||""),C(null)},[e]);async function N(){d(!0);try{const E={...e,name:i.trim(),notes:a.trim()||void 0};if(v){E.snapshots=v.snapshots;const I=E.snapshots[0]||w;E.metadata=Oe(I)}await t(E),s()}catch(E){console.error("Save error:",E),alert("Failed to save dataset: "+(E instanceof Error?E.message:"Unknown error"))}finally{d(!1)}}async function M(){f(!0);try{await n(),s()}catch(E){console.error("Delete error:",E),alert("Failed to delete dataset: "+(E instanceof Error?E.message:"Unknown error"))}finally{f(!1),h(!1)}}function R(E,I){const B={...w,nodes:E,edges:I};C({...e,snapshots:[B]})}const V=i!==e.name||a!==(e.notes||"")||v!==null;return o.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:o.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-6xl w-full mx-4 max-h-[90vh] flex flex-col",children:[o.jsxs("div",{className:"p-6 border-b flex items-center justify-between",children:[o.jsx("h2",{className:"text-2xl font-bold",children:"Edit Dataset"}),o.jsx("button",{onClick:s,type:"button",className:"text-gray-400 hover:text-gray-600 text-2xl cursor-pointer transition-colors",children:"×"})]}),o.jsxs("div",{className:"border-b flex",children:[o.jsx("button",{onClick:()=>y("info"),type:"button",className:`px-6 py-3 font-medium cursor-pointer transition-colors ${x==="info"?"border-b-2 border-blue-600 text-blue-600":"text-gray-600 hover:text-gray-900"}`,children:"Information"}),o.jsxs("button",{onClick:()=>y("data"),type:"button",className:`px-6 py-3 font-medium cursor-pointer transition-colors ${x==="data"?"border-b-2 border-blue-600 text-blue-600":"text-gray-600 hover:text-gray-900"}`,children:["Data (",w.nodes.length," nodes, ",w.edges.length," edges)"]})]}),o.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:x==="info"?o.jsxs("div",{className:"space-y-6 max-w-2xl",children:[o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Dataset Name ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsx("input",{type:"text",value:i,onChange:E=>l(E.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Enter a name for this dataset"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Notes"}),o.jsx("textarea",{value:a,onChange:E=>u(E.target.value),rows:5,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Add any notes about this dataset..."})]}),o.jsxs("div",{className:"bg-gray-50 p-4 rounded",children:[o.jsx("h3",{className:"font-medium text-gray-700 mb-2",children:"Dataset Information"}),o.jsxs("div",{className:"text-sm text-gray-600 space-y-1",children:[o.jsxs("div",{children:[o.jsx("span",{className:"font-medium",children:"Type:"})," ",e.type.toUpperCase()]}),o.jsxs("div",{children:[o.jsx("span",{className:"font-medium",children:"Time Range:"})," ",e.timeRange.start,e.timeRange.end!==e.timeRange.start?` – ${e.timeRange.end}`:""]}),o.jsxs("div",{children:[o.jsx("span",{className:"font-medium",children:"Snapshots:"})," ",e.snapshots.length]}),e.filename&&o.jsxs("div",{children:[o.jsx("span",{className:"font-medium",children:"Original File:"})," ",e.filename]}),o.jsxs("div",{children:[o.jsx("span",{className:"font-medium",children:"Created:"})," ",new Date(e.createdAt).toLocaleDateString()]})]})]}),o.jsxs("div",{className:"border-t pt-4 space-y-3",children:[o.jsx("button",{onClick:r,type:"button",className:"w-full px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50 cursor-pointer transition-colors",children:"Duplicate Dataset"}),o.jsx("button",{onClick:()=>h(!0),type:"button",className:"w-full px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 cursor-pointer transition-colors",children:"Delete Dataset"})]})]}):o.jsx("div",{className:"h-full",children:o.jsx(ir,{nodes:w.nodes,edges:w.edges,onUpdate:R})})}),o.jsxs("div",{className:"p-6 border-t flex justify-end gap-3",children:[o.jsx("button",{onClick:s,type:"button",disabled:c||m,className:"px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50 disabled:opacity-50 cursor-pointer transition-colors",children:"Cancel"}),o.jsx("button",{onClick:N,type:"button",disabled:c||m||!V&&x==="info"||!i.trim(),className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed cursor-pointer transition-colors",children:c?"Saving...":v?"Save All Changes":"Save Changes"})]}),g&&o.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-60",children:o.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md mx-4",children:[o.jsx("h3",{className:"text-lg font-bold mb-2",children:"Delete Dataset?"}),o.jsxs("p",{className:"text-gray-600 mb-4",children:['Are you sure you want to delete "',e.name,'"? This action cannot be undone.']}),o.jsxs("div",{className:"flex justify-end gap-3",children:[o.jsx("button",{onClick:()=>h(!1),type:"button",disabled:m,className:"px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50 cursor-pointer transition-colors",children:"Cancel"}),o.jsx("button",{onClick:M,type:"button",disabled:m,className:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 disabled:opacity-50 cursor-pointer transition-colors",children:m?"Deleting...":"Delete"})]})]})})]})})}function ir({nodes:e,edges:s,onUpdate:t}){const[n,r]=S.useState(e),[i,l]=S.useState(s);S.useEffect(()=>{r([...e]),l([...s])},[e,s]);const a=S.useRef(n),u=S.useRef(i);S.useEffect(()=>{a.current=n,u.current=i},[n,i]);const c=S.useCallback(g=>{r(g),a.current=g},[]),d=S.useCallback(g=>{l(g),u.current=g},[]),m=S.useRef(!1),f=S.useCallback(()=>{m.current&&(t(a.current,u.current),m.current=!1)},[t]);return o.jsx("div",{className:"h-full",children:o.jsx(xn,{nodes:n,edges:i,onNodesChange:g=>{c(g),m.current=!0},onEdgesChange:g=>{d(g),m.current=!0},onBlur:f,editable:!0})})}class Me extends S.Component{constructor(s){super(s),this.state={hasError:!1,error:null}}static getDerivedStateFromError(s){return{hasError:!0,error:s}}componentDidCatch(s,t){var n,r;console.error("ErrorBoundary caught an error:",s,t),(r=(n=this.props).onError)==null||r.call(n,s,t)}render(){var s;return this.state.hasError?this.props.fallback?this.props.fallback:o.jsxs("div",{className:"p-4 bg-red-50 border border-red-200 rounded-md",children:[o.jsx("h3",{className:"text-lg font-semibold text-red-800 mb-2",children:"Something went wrong"}),o.jsx("p",{className:"text-sm text-red-700 mb-2",children:((s=this.state.error)==null?void 0:s.message)||"An error occurred"}),o.jsx("button",{onClick:()=>this.setState({hasError:!1,error:null}),className:"px-3 py-1 bg-red-600 text-white text-sm rounded hover:bg-red-700 cursor-pointer transition-colors",children:"Try again"})]}):this.props.children}}function ar({selectedId:e,onSelect:s,onRefresh:t}){const[n,r]=S.useState([]),[i,l]=S.useState(!1),[a,u]=S.useState(null),[c,d]=S.useState(!1),[m,f]=S.useState(null),g=S.useRef(null);S.useEffect(()=>{h()},[]);async function h(){const M=await us();r(M)}async function x(M,R){try{const E=`${M.type||"csv"}-${Date.now()}`,I={...M,id:E,snapshots:R.snapshots,metadata:R.metadata,createdAt:Date.now()};await ze(I),await h(),l(!1),f(null),s(E)}catch(V){throw console.error("Import error:",V),V}finally{g.current&&(g.current.value="")}}async function y(M,R){R.stopPropagation();const V=await Te(M);V&&u(V)}async function v(M){await ze(M),await h(),e===M.id&&(t==null||t())}async function C(){a&&(await ds(a.id),await h(),e===a.id&&s(""),u(null))}async function w(){if(!a)return;const M=await cs(a.id);await h(),u(null),s(M.id)}async function N(){await gs(),await h(),d(!1),s(""),window.location.reload()}return o.jsxs("aside",{className:"h-full overflow-y-auto flex flex-col",children:[o.jsxs("div",{className:"p-4 border-b",children:[o.jsx("h2",{className:"text-lg font-bold",children:"Datasets"}),o.jsx("p",{className:"text-xs text-gray-500",children:"Stored in your browser"}),o.jsx("button",{onClick:()=>l(!0),className:"mt-3 w-full px-3 py-2 bg-blue-600 text-white text-sm rounded hover:bg-blue-700",children:"Import Dataset"}),o.jsx("input",{ref:g,type:"file",accept:".csv,.gexf",multiple:!0,className:"hidden"}),i&&o.jsx(Me,{fallback:o.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:o.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md mx-4",children:[o.jsx("h3",{className:"text-lg font-bold text-red-800 mb-2",children:"Import Panel Error"}),o.jsx("p",{className:"text-gray-600 mb-4",children:"The import panel encountered an error."}),o.jsx("button",{onClick:()=>l(!1),className:"px-4 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-700 cursor-pointer transition-colors",children:"Close"})]})}),children:o.jsx(ms,{onClose:()=>{l(!1),f(null),g.current&&(g.current.value="")},onImport:x,fileInputRef:g,onFilesSelected:f,existingFile:m})})]}),o.jsxs("ul",{className:"divide-y flex-1 overflow-y-auto",children:[n.map(M=>o.jsx("li",{children:o.jsxs("div",{className:`flex items-center group ${e===M.id?"bg-blue-50":""}`,children:[o.jsxs("button",{className:"flex-1 text-left p-3 hover:bg-gray-50",onClick:()=>s(M.id),children:[o.jsx("div",{className:"flex items-center justify-between",children:o.jsxs("div",{children:[o.jsx("div",{className:"font-medium",children:M.name}),o.jsxs("div",{className:"text-xs text-gray-500",children:[M.type.toUpperCase()," · ",M.timeRange.start,M.timeRange.end!==M.timeRange.start?`–${M.timeRange.end}`:""]})]})}),M.notes&&o.jsx("div",{className:"text-xs text-gray-600 mt-1 line-clamp-2",children:M.notes})]}),o.jsx("button",{onClick:R=>y(M.id,R),className:"px-2 py-1 text-gray-400 hover:text-blue-600 hover:bg-gray-100 rounded transition-all mr-2 cursor-pointer",title:"Edit dataset",type:"button",children:o.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})})})]})},M.id)),n.length===0&&o.jsx("li",{className:"p-3 text-sm text-gray-500",children:"No datasets yet"})]}),o.jsxs("div",{className:"p-4 border-t",children:[o.jsx("button",{onClick:()=>d(!0),type:"button",className:"w-full px-3 py-2 bg-red-600 text-white text-sm rounded hover:bg-red-700 cursor-pointer transition-colors",children:"Reset All Data"}),o.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"Delete all datasets and reload defaults"})]}),a&&o.jsx(Me,{fallback:o.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:o.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md mx-4",children:[o.jsx("h3",{className:"text-lg font-bold text-red-800 mb-2",children:"Edit Panel Error"}),o.jsx("p",{className:"text-gray-600 mb-4",children:"The edit panel encountered an error."}),o.jsx("button",{onClick:()=>u(null),className:"px-4 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-700 cursor-pointer transition-colors",children:"Close"})]})}),children:o.jsx(or,{dataset:a,onClose:()=>u(null),onSave:v,onDelete:C,onDuplicate:w})}),c&&o.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-60",children:o.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md mx-4",children:[o.jsx("h3",{className:"text-lg font-bold mb-2",children:"Reset All Data?"}),o.jsx("p",{className:"text-gray-600 mb-4",children:"This will delete all datasets and reload the default test data. This action cannot be undone."}),o.jsxs("div",{className:"flex justify-end gap-3",children:[o.jsx("button",{onClick:()=>d(!1),type:"button",className:"px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50 cursor-pointer transition-colors",children:"Cancel"}),o.jsx("button",{onClick:N,type:"button",className:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 cursor-pointer transition-colors",children:"Reset All Data"})]})]})})]})}function lr({nodes:e,edges:s,width:t=1200,height:n=800}){const r=S.useRef(null),[i,l]=S.useState(null),[a,u]=S.useState(null);return S.useEffect(()=>{var Z,re;if(!r.current||s.length===0||e.length===0){r.current&&se(r.current).selectAll("*").remove();return}se(r.current).selectAll("*").remove();const c=new Map;e.forEach(j=>{c.set(j.id,{id:j.id,label:j.label||j.id,outgoing:0,incoming:0})}),s.forEach(j=>{const A=c.get(j.source),Q=c.get(j.target);A&&(A.outgoing+=j.value),Q&&(Q.incoming+=j.value)});const d=Array.from(c.values()).filter(j=>j.outgoing>0||j.incoming>0);if(d.length===0){se(r.current).append("text").attr("x",t/2).attr("y",n/2).attr("text-anchor","middle").attr("font-size","14px").attr("fill","#666").text("No active nodes with flows");return}d.sort((j,A)=>A.outgoing+A.incoming-(j.outgoing+j.incoming));const m=50,f=t-50,g=20,h=15,x=2,y=5,v=d.reduce((j,A)=>j+A.outgoing,0),C=d.reduce((j,A)=>j+A.incoming,0),w=Math.max(n-2*g,400);let N=g;d.forEach(j=>{const A=v>0?Math.max(y,j.outgoing/v*w):Math.max(y,w/d.length);N+=A+x});let M=g;d.forEach(j=>{const A=C>0?Math.max(y,j.incoming/C*w):Math.max(y,w/d.length);M+=A+x});const R=Math.max(n,Math.max(N,M)+100),V=R-2*g,E=se(r.current).attr("width",t).attr("height",R).style("font","12px sans-serif");let I=g;const B=d.map((j,A)=>{const Q=v>0?Math.max(y,j.outgoing/v*V):Math.max(y,V/d.length),ie=I;return I+=Q+x,{node:j,x:m,y:ie,height:Math.max(y,Q-x),side:"left",index:A}});I=g;const P=d.map((j,A)=>{const Q=C>0?Math.max(y,j.incoming/C*V):Math.max(y,V/d.length),ie=I;return I+=Q+x,{node:j,x:f,y:ie,height:Math.max(y,Q-x),side:"right",index:A}});let G=[];i&&a&&(a==="left"?G=s.filter(j=>j.source===i&&j.source!==j.target):G=s.filter(j=>j.target===i&&j.source!==j.target));const _=en(on);if(G.length>0){const j=G.map(D=>{const J=B.find(fe=>fe.node.id===D.source),U=P.find(fe=>fe.node.id===D.target);if(!J||!U)return null;const ee=J.y+J.height/2,ce=U.y+U.height/2;return{edge:D,sourceX:J.x+h,sourceY:ee,targetX:U.x,targetY:ce,value:D.value,leftIndex:J.index,rightIndex:U.index}}).filter(D=>D!==null),A=Math.max(...j.map(D=>D.value),1),Q=2,ie=20,oe=E.append("g").attr("class","links");j.forEach(D=>{const J=Q+D.value/A*(ie-Q),U=`gradient-${D.leftIndex}-${D.rightIndex}`,ee=E.append("defs").append("linearGradient").attr("id",U).attr("gradientUnits","userSpaceOnUse").attr("x1",D.sourceX).attr("x2",D.targetX).attr("y1",D.sourceY).attr("y2",D.targetY);ee.append("stop").attr("offset","0%").attr("stop-color",_(String(D.leftIndex))).attr("stop-opacity",.6),ee.append("stop").attr("offset","100%").attr("stop-color",_(String(D.rightIndex))).attr("stop-opacity",.6);const ce=_t(),fe=(D.sourceX+D.targetX)/2;ce.moveTo(D.sourceX,D.sourceY),ce.bezierCurveTo(fe,D.sourceY,fe,D.targetY,D.targetX,D.targetY),oe.append("path").attr("d",ce.toString()).attr("stroke",`url(#${U})`).attr("stroke-width",J).attr("fill","none").attr("stroke-opacity",.6).style("cursor","pointer").on("mouseover",function(he){se(this).attr("stroke-opacity",1).attr("stroke-width",J+2),se("body").append("div").attr("class","tooltip").style("position","absolute").style("background","rgba(0, 0, 0, 0.8)").style("color","white").style("padding","8px").style("border-radius","4px").style("pointer-events","none").style("opacity",0).html(`${D.edge.source} → ${D.edge.target}<br/>${D.value.toLocaleString()}`).style("opacity",1)}).on("mousemove",function(he){se(".tooltip").style("left",`${he.pageX+10}px`).style("top",`${he.pageY-10}px`)}).on("mouseout",function(){se(this).attr("stroke-opacity",.6).attr("stroke-width",J),se(".tooltip").remove()})})}const q=E.append("g").attr("class","left-nodes").selectAll("g.node").data(B).join("g").attr("class","node").attr("transform",j=>`translate(${j.x}, ${j.y})`).style("cursor","pointer").on("click",function(j,A){j.stopPropagation(),i===A.node.id&&a==="left"?(l(null),u(null)):(l(A.node.id),u("left"))});q.append("rect").attr("width",h).attr("height",j=>j.height).attr("fill",(j,A)=>_(String(A))).attr("stroke",(j,A)=>Ae(_(String(A))).darker()).attr("stroke-width",j=>i===j.node.id&&a==="left"?3:1).attr("opacity",j=>i&&a==="left"&&i!==j.node.id?.3:1).on("mouseover",function(j,A){se(this).attr("fill",Ae(_(String(A.index))).brighter(.5))}).on("mouseout",function(j,A){se(this).attr("fill",_(String(A.index)))}),q.append("text").attr("x",h+6).attr("y",j=>j.height/2).attr("dy","0.35em").attr("text-anchor","start").text(j=>`${j.node.label} (${j.node.outgoing.toLocaleString()})`).style("font-size","11px").style("font-weight","500").style("fill","#333").attr("opacity",j=>i&&a==="left"&&i!==j.node.id?.3:1);const Y=E.append("g").attr("class","right-nodes").selectAll("g.node").data(P).join("g").attr("class","node").attr("transform",j=>`translate(${j.x}, ${j.y})`).style("cursor","pointer").on("click",function(j,A){j.stopPropagation(),i===A.node.id&&a==="right"?(l(null),u(null)):(l(A.node.id),u("right"))});Y.append("rect").attr("x",-h).attr("width",h).attr("height",j=>j.height).attr("fill",(j,A)=>_(String(A))).attr("stroke",(j,A)=>Ae(_(String(A))).darker()).attr("stroke-width",j=>i===j.node.id&&a==="right"?3:1).attr("opacity",j=>i&&a==="right"&&i!==j.node.id?.3:1).on("mouseover",function(j,A){se(this).attr("fill",Ae(_(String(A.index))).brighter(.5))}).on("mouseout",function(j,A){se(this).attr("fill",_(String(A.index)))}),Y.append("text").attr("x",-h-6).attr("y",j=>j.height/2).attr("dy","0.35em").attr("text-anchor","end").text(j=>`${j.node.label} (${j.node.incoming.toLocaleString()})`).style("font-size","11px").style("font-weight","500").style("fill","#333").attr("opacity",j=>i&&a==="right"&&i!==j.node.id?.3:1),i?E.append("text").attr("x",t/2).attr("y",20).attr("text-anchor","middle").attr("font-size","14px").attr("fill","#333").text(a==="left"?`Showing outgoing flows from ${(Z=B.find(j=>j.node.id===i))==null?void 0:Z.node.label}`:`Showing incoming flows to ${(re=P.find(j=>j.node.id===i))==null?void 0:re.node.label}`):E.append("text").attr("x",t/2).attr("y",20).attr("text-anchor","middle").attr("font-size","14px").attr("fill","#666").text("Click a node to see its connections"),E.append("text").attr("x",m+h/2).attr("y",R-10).attr("text-anchor","middle").attr("font-size","12px").attr("font-weight","bold").attr("fill","#333").text("Outgoing"),E.append("text").attr("x",f-h/2).attr("y",R-10).attr("text-anchor","middle").attr("font-size","12px").attr("font-weight","bold").attr("fill","#333").text("Incoming"),E.on("click",function(j){(j.target===r.current||j.target.tagName==="svg")&&(l(null),u(null))})},[e,s,t,n,i,a]),o.jsxs("div",{className:"w-full h-full flex flex-col min-h-0",children:[o.jsxs("div",{className:"text-center text-xs text-gray-500 mb-2 flex-shrink-0",children:["Interaction design inspired by"," ",o.jsx("a",{href:"https://peoplemov.in/#f_AF",target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-800 underline",children:"peoplemov.in by Carlo Zapponi"})]}),o.jsx("div",{className:"flex-1 overflow-auto min-h-0",children:o.jsx("svg",{ref:r,className:"border border-gray-200 rounded bg-white"})})]})}function ur(e,s){const t=e.length,n=new Map;e.forEach((l,a)=>{n.set(l.id,a)});const r=Array(t).fill(null).map(()=>Array(t).fill(0));s.forEach(l=>{const a=n.get(l.source),u=n.get(l.target);a!==void 0&&u!==void 0&&(r[a][u]+=l.value)});const i=e.map(l=>l.label||l.id);return{matrix:r,labels:i,nodes:e}}function dr(e,s,t){return!t||t==="all"?e:e.filter(n=>{const r=n[s];return Array.isArray(r)?r.includes(t):r===t})}function cr(e,s){const t=new Set;return e.forEach(n=>{const r=n[s];r!=null&&(Array.isArray(r)?r.forEach(i=>t.add(i)):t.add(r))}),Array.from(t).sort((n,r)=>typeof n=="number"&&typeof r=="number"?n-r:String(n).localeCompare(String(r)))}function gr({nodes:e,edges:s,width:t=1e3,height:n=800}){const r=S.useRef(null);return S.useEffect(()=>{if(!r.current||s.length===0||e.length===0){r.current&&se(r.current).selectAll("*").remove();return}se(r.current).selectAll("*").remove();const i=ur(e,s),l=se(r.current).attr("width","100%").attr("height","100%").attr("viewBox",`0 0 ${t} ${n}`).attr("preserveAspectRatio","xMidYMid meet"),a=Math.min(t,n)*.5-40,u=a-20,c=Rn().scaleExtent([.1,4]).on("zoom",function(C){x.attr("transform",C.transform.toString())});l.call(c);const d=l.append("g").attr("class","reset-button").style("cursor","pointer").attr("transform",`translate(${t-120}, 10)`).on("click",function(){l.transition().duration(750).call(c.transform,Nn)});d.append("rect").attr("width",110).attr("height",30).attr("rx",4).attr("fill","white").attr("stroke","#ccc").attr("stroke-width",1),d.append("text").attr("x",55).attr("y",20).attr("text-anchor","middle").attr("font-size","12px").attr("fill","#333").text("Reset View");const f=kn().padAngle(.05).sortSubgroups(An)(i.matrix),g=Xn().radius(u),h=en(on),x=l.append("g").attr("class","zoom-group"),y=x.append("g").attr("transform",`translate(${t/2}, ${n/2})`),v=y.append("g").selectAll("g").data(f.groups).join("g");v.append("path").attr("fill",C=>h(String(C.index))).attr("stroke",C=>Ae(h(String(C.index))).darker()).attr("d",is().innerRadius(u).outerRadius(a)).on("mouseover",function(C,w){se(this).attr("fill",Ae(h(String(w.index))).brighter(1)),y.selectAll("path.chord").style("opacity",N=>N.source.index===w.index||N.target.index===w.index?1:.2)}).on("mouseout",function(){se(this).attr("fill",C=>h(String(C.index))),y.selectAll("path.chord").style("opacity",1)}),v.append("text").each(C=>{C.angle=(C.startAngle+C.endAngle)/2}).attr("dy",".35em").attr("transform",C=>`
        rotate(${C.angle*180/Math.PI-90})
        translate(${a+10})
        ${C.angle>Math.PI?"rotate(180)":""}
      `).attr("text-anchor",C=>C.angle>Math.PI?"end":"start").text(C=>i.labels[C.index]).style("font-size","12px").style("font-weight","500"),y.append("g").attr("fill-opacity",.67).selectAll("path").data(f).join("path").attr("class","chord").attr("d",g).attr("fill",C=>h(String(C.source.index))).attr("stroke",C=>Ae(h(String(C.source.index))).darker()).style("stroke-width","1px").on("mouseover",function(C,w){se(this).attr("fill-opacity",1).style("stroke-width","2px"),se("body").append("div").attr("class","tooltip").style("position","absolute").style("background","rgba(0, 0, 0, 0.8)").style("color","white").style("padding","8px").style("border-radius","4px").style("pointer-events","none").style("opacity",0).style("transition","opacity 0.2s").html(`${i.labels[w.source.index]} → ${i.labels[w.target.index]}: ${w.source.value.toLocaleString()}`).style("opacity",1)}).on("mousemove",function(C){se(".tooltip").style("left",`${C.pageX+10}px`).style("top",`${C.pageY-10}px`)}).on("mouseout",function(){se(this).attr("fill-opacity",.67).style("stroke-width","1px"),se(".tooltip").remove()})},[e,s,t,n]),o.jsx("div",{className:"w-full h-full",children:o.jsx("svg",{ref:r,className:"border border-gray-200 rounded bg-white"})})}const fr=200,mr=600,pr=384,Qt=4;function hr({isCollapsed:e,onToggle:s,onResize:t,children:n,title:r="Settings",bottomContent:i}){const[l,a]=S.useState(pr),[u,c]=S.useState(!1),d=S.useRef(null),m=S.useRef(null);return S.useEffect(()=>{if(!u)return;const f=h=>{var x;if(!e&&((x=d.current)==null?void 0:x.getBoundingClientRect())){const v=Math.max(fr,Math.min(mr,window.innerWidth-h.clientX));a(v),t==null||t(v)}},g=()=>{c(!1)};return document.addEventListener("mousemove",f),document.addEventListener("mouseup",g),()=>{document.removeEventListener("mousemove",f),document.removeEventListener("mouseup",g)}},[u,e,t]),o.jsxs("div",{ref:d,className:"bg-white border-l border-gray-200 flex flex-col transition-all duration-300  overflow-hidden relative",style:{minHeight:"100vh",width:e?`${Qt}px`:`${l}px`},children:[e&&o.jsxs(o.Fragment,{children:[o.jsx("div",{onClick:s,className:"w-full h-full bg-gray-100 hover:bg-blue-400 cursor-pointer transition-colors",style:{width:`${Qt}px`},title:"Click to expand settings"}),o.jsx("button",{onClick:s,className:"fixed bottom-4 right-4 z-50 p-3 bg-blue-600 hover:bg-blue-700 text-white rounded-full shadow-lg cursor-pointer transition-all hover:scale-110 flex items-center justify-center",style:{width:"48px",height:"48px"},title:"Open visualization settings","aria-label":"Open visualization settings",children:o.jsx(At,{className:"w-5 h-5"})})]}),!e&&o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:n}),i&&o.jsx("div",{className:"flex-shrink-0 border-t border-gray-200 bg-white",children:i}),o.jsxs("button",{onClick:s,className:"w-full flex items-center justify-between p-2 border-t border-gray-200 flex-shrink-0 bg-gray-50 hover:bg-gray-100 transition-colors cursor-pointer","aria-label":"Collapse settings",children:[o.jsxs("div",{className:"flex items-center gap-2 flex-1",children:[o.jsx(At,{className:"w-4 h-4 text-gray-600"}),o.jsx("span",{className:"text-sm font-medium text-gray-700",children:r})]}),o.jsx(vn,{className:"w-4 h-4 text-gray-600 flex-shrink-0"})]}),o.jsx("div",{ref:m,onMouseDown:f=>{f.preventDefault(),c(!0)},className:"absolute top-0 left-0 w-1 h-full cursor-col-resize hover:bg-blue-400 bg-gray-300 transition-colors z-10",style:{touchAction:"none"},children:o.jsx("div",{className:"absolute top-1/2 left-0 transform -translate-y-1/2 -translate-x-0.5",children:o.jsx(wn,{className:"w-3 h-6 text-gray-500"})})})]})]})}function ke({title:e,subtitle:s,children:t,defaultOpen:n=!1}){const[r,i]=S.useState(n);return o.jsxs("div",{className:"border border-gray-200 rounded-md",children:[o.jsxs("button",{onClick:()=>i(!r),className:"w-full flex items-center justify-between p-3 hover:bg-gray-50 transition-colors text-left",children:[o.jsxs("div",{className:"flex-1",children:[o.jsx("div",{className:"font-semibold text-sm",children:e}),s&&o.jsx("div",{className:"text-xs text-gray-600 mt-0.5",children:s})]}),r?o.jsx(Pn,{className:"w-4 h-4 text-gray-600 flex-shrink-0"}):o.jsx(En,{className:"w-4 h-4 text-gray-600 flex-shrink-0"})]}),r&&o.jsx("div",{className:"p-3 pt-0 border-t border-gray-200",children:t})]})}const Jt=bn(["kriskogram","table","sankey","chord"]),et=e=>{const s=e!==void 0?Vt().default(e):Vt().optional();return wt(t=>{if(t==null||t==="")return e;const n=typeof t=="string"?parseFloat(t):Number(t);return Number.isNaN(n)?e:n},s)};jn({dataset:Pt().optional(),view:wt(e=>typeof e=="string"&&Jt.safeParse(e).success?e:"kriskogram",Jt.default("kriskogram")),year:et(void 0),minThreshold:et(0),maxThreshold:et(2e5),maxEdges:et(500),edgeType:wt(e=>e==="null"||e===""?null:typeof e=="string"?e:void 0,Pt().nullable().optional())});function br(){const e=yn({from:"/explorer"}),s=Sn(),{leftSidebarCollapsed:t,leftSidebarWidth:n,setSidebarContent:r}=Cn(),[i,l]=S.useState(e.dataset),[a,u]=S.useState(void 0),[c,d]=S.useState(e.year),[m,f]=S.useState(!1),[g,h]=S.useState(null),[x,y]=S.useState(0),[v,C]=S.useState(e.minThreshold??0),[w,N]=S.useState(e.maxThreshold??2e5),[M,R]=S.useState(e.maxEdges??500),[V,E]=S.useState(e.edgeType??null),[I,B]=S.useState(e.view),P=S.useRef(null),[G,_]=S.useState(!1),[T,q]=S.useState(384),[X,Y]=S.useState({width:typeof window<"u"?window.innerWidth:1200,height:typeof window<"u"?window.innerHeight:800});S.useEffect(()=>(r(o.jsx(Me,{fallback:o.jsxs("div",{className:"p-4",children:[o.jsx("h2",{className:"text-lg font-bold text-red-800 mb-2",children:"Dataset Sidebar Error"}),o.jsx("p",{className:"text-sm text-red-700",children:"The dataset sidebar encountered an error."})]}),children:o.jsx(ar,{selectedId:i,onSelect:p=>{l(p),ae({dataset:p})},onRefresh:()=>y(p=>p+1)})})),()=>{r(null)}),[i,x]),S.useEffect(()=>{if(typeof window>"u")return;const p=()=>{Y({width:window.innerWidth,height:window.innerHeight})};return p(),window.addEventListener("resize",p),()=>window.removeEventListener("resize",p)},[]),S.useEffect(()=>{typeof window<"u"&&setTimeout(()=>{Y({width:window.innerWidth,height:window.innerHeight})},100)},[t,G,n,T]);const[Z,re]=S.useState("alphabetical"),[j,A]=S.useState(.85),[Q,ie]=S.useState("width"),[oe,D]=S.useState("single"),[J,U]=S.useState(null),[ee,ce]=S.useState("fixed"),[fe,he]=S.useState(null),ae=S.useMemo(()=>p=>{s({to:"/explorer",search:$=>({view:$.view??"kriskogram",...$,...p}),replace:!0})},[s]),qe=S.useMemo(()=>a&&a.timeRange.start!==a.timeRange.end,[a]),Re=S.useRef(!0);S.useEffect(()=>{fs().catch(()=>{}),xr().then(p=>{const $=e.dataset||p;$&&(l($),!e.dataset&&Re.current&&ae({dataset:$})),Re.current=!1}).catch(p=>h(p instanceof Error?p.message:"Failed to preload datasets"))},[]),S.useEffect(()=>{if(!i){u(void 0);return}f(!0),h(null),Te(i).then(p=>{u(p),p&&(d(p.timeRange.start),C(0),R(500))}).catch(p=>h(p instanceof Error?p.message:"Failed to load dataset")).finally(()=>f(!1))},[i,x]);const te=S.useMemo(()=>{if(!(!a||c===void 0))return a.snapshots.find(p=>(typeof p.timestamp=="string"?parseInt(p.timestamp,10):p.timestamp)===c)},[a,c]);S.useEffect(()=>{if(te&&te.edges.length>0){const p=Math.max(...te.edges.map(k=>k.value)),$=Math.min(...te.edges.map(k=>k.value));C($),N(Math.max(p,$)),R(Math.min(500,te.edges.length))}},[te]);const Ne=S.useMemo(()=>{if(!te||!(a!=null&&a.metadata))return null;const $=["migration_type","type","category","edge_type"].find(W=>{var le,ue;return((le=a.metadata)==null?void 0:le.edgeProperties.includes(W))||((ue=a.metadata)==null?void 0:ue.hasCategoricalProperties.edges.includes(W))});if(!$)return null;const k=cr(te.edges,$);return{property:$,values:k.map(W=>String(W))}},[te,a]);S.useEffect(()=>{E(null)},[i]);const b=S.useMemo(()=>{if(!te)return{nodes:[],edges:[]};const $=dr(te.edges,(Ne==null?void 0:Ne.property)||"",V).filter(O=>O.value>=v&&O.value<=w).sort((O,ne)=>ne.value-O.value).slice(0,M),k=new Set;$.forEach(O=>{k.add(O.source),k.add(O.target)});const W=te.nodes.filter(O=>k.has(O.id)),le=new Map,ue=new Map;return $.forEach(O=>{const ne=ue.get(O.source)||0;ue.set(O.source,ne+O.value);const st=le.get(O.target)||0;le.set(O.target,st+O.value)}),{nodes:W.map(O=>({...O,_totalIncoming:le.get(O.id)||0,_totalOutgoing:ue.get(O.id)||0})),edges:$}},[te,v,w,M,V,Ne]),F=S.useMemo(()=>{if(!te)return null;const p=te.edges.length,$=te.nodes.length,k=te.edges.reduce((ue,ve)=>ue+ve.value,0),W=p>0?k/p:0,le=p>0?Math.max(...te.edges.map(ue=>ue.value)):0;return{totalNodes:$,totalEdges:p,visibleNodes:b.nodes.length,visibleEdges:b.edges.length,avgValue:W,maxValue:le}},[te,b]);S.useEffect(()=>{I==="kriskogram"&&b.nodes.length>0&&b.edges.length>0&&P.current&&P.current.updateData(b.nodes,b.edges)},[b,I]);const H=p=>{d(p),Re.current||ae({year:p})};return S.useEffect(()=>{Re.current||ae({minThreshold:v,maxThreshold:w,maxEdges:M})},[v,w,M]),S.useEffect(()=>{Re.current||ae({view:I})},[I]),S.useEffect(()=>{Re.current||ae({edgeType:V})},[V]),S.useEffect(()=>{!Re.current&&i&&ae({dataset:i})},[i]),o.jsx(Me,{fallback:o.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center",children:o.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-8 max-w-lg mx-4",children:[o.jsx("h2",{className:"text-2xl font-bold text-red-800 mb-4",children:"Explorer Error"}),o.jsx("p",{className:"text-gray-700 mb-4",children:"The explorer page encountered an error. Please refresh the page."}),o.jsx("button",{onClick:()=>window.location.reload(),className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 cursor-pointer transition-colors",children:"Reload Page"})]})}),children:o.jsxs("div",{className:"flex flex-1 h-full overflow-hidden",children:[o.jsxs("main",{className:"flex-1 flex flex-col overflow-hidden h-full",children:[m&&o.jsx("div",{className:"p-4 bg-yellow-50 text-yellow-800",children:"Loading…"}),g&&o.jsx("div",{className:"p-4 bg-red-50 text-red-600",children:g}),a?o.jsx("div",{className:"flex-1 flex flex-col overflow-hidden bg-white",children:o.jsx("div",{className:`flex-1 overflow-hidden ${I==="table"?"":"p-4"}`,children:b.nodes.length>0&&b.edges.length>0?o.jsxs(o.Fragment,{children:[I==="kriskogram"&&o.jsx(Me,{fallback:o.jsxs("div",{className:"p-4 bg-red-50 border border-red-200 rounded-md",children:[o.jsx("h3",{className:"text-lg font-semibold text-red-800 mb-2",children:"Kriskogram Error"}),o.jsx("p",{className:"text-sm text-red-700",children:"The Kriskogram visualization encountered an error."})]}),children:o.jsx("div",{className:"w-full h-full",children:o.jsx(Fn,{ref:P,nodes:b.nodes,edges:b.edges,width:Math.max(800,X.width-(t?64:n)-(G?4:T)-40),height:Math.max(600,X.height-80),margin:{top:60,right:40,bottom:60,left:40},arcOpacity:j,title:a.name,accessors:(()=>{const p=b.edges.map(K=>K.value),$=p.length>0?Math.min(...p):0,W=(p.length>0?Math.max(...p):1)-$||1,le=b.nodes.map(K=>K._totalOutgoing||0),ue=b.nodes.map(K=>K._totalIncoming||0),ve=le.length>0?Math.max(...le):1,O=ue.length>0?Math.max(...ue):1,ne=(K,de,ge)=>{const we=Array.from(new Set(b.nodes.map(Fe=>Fe[K]).filter(Fe=>Fe!=null))),Ce=new Map;return we.forEach((Fe,We)=>{Ce.set(Fe,ge[We%ge.length])}),Ce.get(de)||ge[0]},st=["#3b82f6","#f59e0b","#ef4444","#10b981","#8b5cf6","#ec4899","#14b8a6","#f97316"];return{nodeOrder:K=>{if(Z==="alphabetical")return K.label||K.id;const de=K[Z];return de==null?`ZZZ_${K.label||K.id}`:typeof de=="number"?`${String(1e6-de).padStart(10,"0")}_${K.label||K.id}`:`${String(de)}_${K.label||K.id}`},nodeColor:K=>{var de;if(oe==="single")return"#2563eb";if(oe==="outgoing")return`hsl(200, 70%, ${20+(ve>0?(K._totalOutgoing||0)/ve:0)*50}%)`;if(oe==="incoming")return`hsl(200, 70%, ${20+(O>0?(K._totalIncoming||0)/O:0)*50}%)`;if(oe==="attribute"&&J){const ge=K[J];if(ge==null)return"#999";if((de=a==null?void 0:a.metadata)!=null&&de.hasNumericProperties.nodes.includes(J)){const we=b.nodes.map(rt=>rt[J]).filter(rt=>typeof rt=="number");if(we.length===0)return"#2563eb";const Ce=Math.min(...we),We=Math.max(...we)-Ce||1;return`hsl(${120-(Number(ge)-Ce)/We*120}, 70%, 50%)`}else return ne(J,ge,st)}return"#2563eb"},nodeRadius:K=>{if(ee==="fixed")return 6;if(ee==="outgoing")return 3+(ve>0?(K._totalOutgoing||0)/ve:0)*9;if(ee==="incoming")return 3+(O>0?(K._totalIncoming||0)/O:0)*9;if(ee==="attribute"&&fe){const de=K[fe];if(typeof de!="number")return 6;const ge=b.nodes.map(Xe=>Xe[fe]).filter(Xe=>typeof Xe=="number");if(ge.length===0)return 6;const we=Math.min(...ge),Fe=Math.max(...ge)-we||1;return 3+(de-we)/Fe*9}return 6},edgeWidth:K=>Q==="width"?.5+(K.value-$)/W*15:Math.sqrt(K.value)/10,edgeColor:(K,de)=>{const ge=(K.value-$)/W;if(Q==="color")return`hsl(200, 70%, ${75-ge*50}%)`;if(Q==="opacity"){const we=.3+ge*.7,Ce=de?[31,119,180]:[214,39,40];return`rgba(${Ce[0]}, ${Ce[1]}, ${Ce[2]}, ${we})`}else return de?"#1f77b4":"#d62728"}}})()})})}),I==="table"&&o.jsx(Me,{fallback:o.jsxs("div",{className:"p-4 bg-red-50 border border-red-200 rounded-md",children:[o.jsx("h3",{className:"text-lg font-semibold text-red-800 mb-2",children:"Table View Error"}),o.jsx("p",{className:"text-sm text-red-700",children:"The table view encountered an error."})]}),children:o.jsx("div",{className:"h-full w-full flex flex-col min-h-0",children:o.jsx(xn,{nodes:b.nodes,edges:b.edges})})}),I==="sankey"&&o.jsx(Me,{fallback:o.jsxs("div",{className:"p-4 bg-red-50 border border-red-200 rounded-md",children:[o.jsx("h3",{className:"text-lg font-semibold text-red-800 mb-2",children:"Sankey Diagram Error"}),o.jsx("p",{className:"text-sm text-red-700",children:"The Sankey diagram encountered an error."})]}),children:o.jsx("div",{className:"h-full min-h-0",children:o.jsx(lr,{nodes:b.nodes,edges:b.edges,width:Math.max(800,X.width-(t?64:n)-(G?4:T)-40),height:Math.max(600,X.height-80)})})}),I==="chord"&&o.jsx(Me,{fallback:o.jsxs("div",{className:"p-4 bg-red-50 border border-red-200 rounded-md",children:[o.jsx("h3",{className:"text-lg font-semibold text-red-800 mb-2",children:"Chord Diagram Error"}),o.jsx("p",{className:"text-sm text-red-700",children:"The chord diagram encountered an error."})]}),children:o.jsx(gr,{nodes:b.nodes,edges:b.edges,width:Math.max(800,X.width-(t?64:n)-(G?4:T)-40),height:Math.max(600,X.height-80)})})]}):te?o.jsxs("div",{className:"text-center text-gray-500 py-8",children:["No data meets the current threshold range (",v.toLocaleString()," - ",w.toLocaleString(),"). Try adjusting the filters."]}):o.jsx("div",{className:"text-gray-500 py-8 text-center",children:"No snapshot to display"})})}):o.jsx("div",{className:"flex-1 flex items-center justify-center text-gray-500",children:o.jsxs("div",{className:"text-center",children:[o.jsx("p",{className:"text-lg mb-2",children:"No dataset selected"}),o.jsx("p",{className:"text-sm",children:"Select a dataset from the sidebar to begin exploring"})]})})]}),a&&o.jsx(hr,{isCollapsed:G,onToggle:()=>_(!G),onResize:q,title:"Visualization Settings",bottomContent:o.jsxs("div",{className:"p-3",children:[o.jsx("label",{className:"text-xs font-medium text-gray-600 block mb-2",children:"Visualization Type"}),o.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[o.jsx("button",{onClick:()=>{B("kriskogram"),ae({view:"kriskogram"})},className:`px-3 py-2.5 rounded text-sm font-medium transition-colors ${I==="kriskogram"?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"Kriskogram"}),o.jsx("button",{onClick:()=>{B("table"),ae({view:"table"})},className:`px-3 py-2.5 rounded text-sm font-medium transition-colors ${I==="table"?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"Table"}),o.jsx("button",{onClick:()=>{B("sankey"),ae({view:"sankey"})},className:`px-3 py-2.5 rounded text-sm font-medium transition-colors ${I==="sankey"?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"Sankey"}),o.jsx("button",{onClick:()=>{B("chord"),ae({view:"chord"})},className:`px-3 py-2.5 rounded text-sm font-medium transition-colors ${I==="chord"?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"Chord"})]})]}),children:o.jsxs("div",{className:"space-y-4",children:[o.jsxs(ke,{title:a.name,defaultOpen:!0,subtitle:`${a.type.toUpperCase()} · ${a.timeRange.start}${a.timeRange.end!==a.timeRange.start?`–${a.timeRange.end}`:""}`,children:[a.notes&&o.jsx("div",{className:"text-xs text-gray-600 mt-2 whitespace-pre-wrap",children:a.notes}),!a.notes&&o.jsx("div",{className:"text-xs text-gray-500 italic mt-2",children:"No description available"})]}),F&&o.jsxs("div",{className:"p-3 bg-gray-50 rounded grid grid-cols-2 gap-3 text-sm",children:[o.jsxs("div",{children:[o.jsx("div",{className:"text-xs text-gray-600",children:"Nodes"}),o.jsxs("div",{className:"text-lg font-bold",children:[F.visibleNodes,"/",F.totalNodes]})]}),o.jsxs("div",{children:[o.jsx("div",{className:"text-xs text-gray-600",children:"Edges"}),o.jsxs("div",{className:"text-lg font-bold",children:[F.visibleEdges.toLocaleString(),"/",F.totalEdges.toLocaleString()]})]})]}),o.jsx(ke,{title:"General Settings",defaultOpen:!0,children:o.jsxs("div",{className:"space-y-4",children:[qe&&c!==void 0&&o.jsxs("div",{className:"space-y-2",children:[o.jsxs("label",{className:"text-sm font-medium",children:["Year: ",c]}),o.jsx("input",{type:"range",min:a.timeRange.start,max:a.timeRange.end,value:c,onChange:p=>H(parseInt(p.target.value)),className:"w-full"})]}),Ne&&o.jsxs("div",{className:"space-y-2",children:[o.jsxs("label",{className:"text-sm font-medium",children:["Edge Type (",Ne.property,")"]}),o.jsxs("select",{value:V||"all",onChange:p=>{const $=p.target.value==="all"?null:p.target.value;E($),ae({edgeType:$})},className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[o.jsx("option",{value:"all",children:"All Types"}),Ne.values.map(p=>o.jsx("option",{value:p,children:p},p))]})]}),te&&F&&o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{className:"space-y-2",children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("label",{className:"text-sm font-medium",children:["Min: ",v.toLocaleString()]}),(()=>{const p=Math.min(...te.edges.map(k=>k.value)),$=v>p||w<F.maxValue||M<F.totalEdges;return o.jsx("button",{onClick:()=>{C(p),N(F.maxValue),R(Math.max(500,F.totalEdges))},disabled:!$,type:"button",className:`text-xs transition-colors ${$?"text-blue-600 hover:text-blue-800":"text-gray-400 cursor-not-allowed"}`,children:"Show All"})})()]}),o.jsx("input",{type:"range",min:0,max:F.maxValue||2e5,step:Math.max(1,Math.floor((F.maxValue||2e5)/1e3)),value:v,onChange:p=>{const $=parseInt(p.target.value),k=Math.min($,w);C(k),ae({minThreshold:k})},className:"w-full"})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsxs("label",{className:"text-sm font-medium",children:["Max: ",w.toLocaleString()]}),o.jsx("input",{type:"range",min:0,max:F.maxValue||2e5,step:Math.max(1,Math.floor((F.maxValue||2e5)/1e3)),value:w,onChange:p=>{const $=parseInt(p.target.value),k=Math.max($,v);N(k),ae({maxThreshold:k})},className:"w-full"})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsxs("label",{className:"text-sm font-medium",children:["Max Edges: ",M]}),o.jsx("input",{type:"range",min:10,max:Math.max(500,F.totalEdges),step:10,value:M,onChange:p=>{const $=parseInt(p.target.value);R($),ae({maxEdges:$})},className:"w-full"}),o.jsxs("p",{className:"text-xs text-gray-600 italic",children:["After filtering by thresholds and edge type, edges are sorted by value (highest first) and the top ",M," edges are displayed."]})]})]})]})}),I==="kriskogram"&&o.jsx(ke,{title:"Kriskogram Settings",defaultOpen:!0,children:a!=null&&a.metadata?o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{className:"space-y-2",children:[o.jsx("label",{className:"text-xs font-medium text-gray-700",children:"Node Ordering"}),o.jsxs("div",{className:"flex flex-col gap-1.5",children:[o.jsxs("label",{className:"flex items-center gap-2 cursor-pointer text-xs",children:[o.jsx("input",{type:"radio",name:"nodeOrder",value:"alphabetical",checked:Z==="alphabetical",onChange:p=>re(p.target.value),className:"w-3.5 h-3.5"}),o.jsx("span",{children:"Alphabetical"})]}),a.metadata.hasCategoricalProperties.nodes.map(p=>o.jsxs("label",{className:"flex items-center gap-2 cursor-pointer text-xs",children:[o.jsx("input",{type:"radio",name:"nodeOrder",value:p,checked:Z===p,onChange:$=>re($.target.value),className:"w-3.5 h-3.5"}),o.jsxs("span",{children:["By ",p]})]},p)),a.metadata.hasNumericProperties.nodes.map(p=>o.jsxs("label",{className:"flex items-center gap-2 cursor-pointer text-xs",children:[o.jsx("input",{type:"radio",name:"nodeOrder",value:p,checked:Z===p,onChange:$=>re($.target.value),className:"w-3.5 h-3.5"}),o.jsxs("span",{children:["By ",p]})]},p))]})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsxs("label",{className:"text-xs font-medium text-gray-700",children:["Arc Opacity: ",Math.round(j*100),"%"]}),o.jsx("input",{type:"range",min:0,max:1,step:.05,value:j,onChange:p=>A(parseFloat(p.target.value)),className:"w-full"})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsx("label",{className:"text-xs font-medium text-gray-700",children:"Edge Weight"}),o.jsxs("div",{className:"flex flex-col gap-1.5",children:[o.jsxs("label",{className:"flex items-center gap-2 cursor-pointer text-xs",children:[o.jsx("input",{type:"radio",name:"edgeWeight",value:"width",checked:Q==="width",onChange:p=>ie(p.target.value),className:"w-3.5 h-3.5"}),o.jsx("span",{children:"Width"})]}),o.jsxs("label",{className:"flex items-center gap-2 cursor-pointer text-xs",children:[o.jsx("input",{type:"radio",name:"edgeWeight",value:"color",checked:Q==="color",onChange:p=>ie(p.target.value),className:"w-3.5 h-3.5"}),o.jsx("span",{children:"Color Intensity"})]}),o.jsxs("label",{className:"flex items-center gap-2 cursor-pointer text-xs",children:[o.jsx("input",{type:"radio",name:"edgeWeight",value:"opacity",checked:Q==="opacity",onChange:p=>ie(p.target.value),className:"w-3.5 h-3.5"}),o.jsx("span",{children:"Opacity"})]})]})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsx("label",{className:"text-xs font-medium text-gray-700",children:"Node Color"}),o.jsxs("div",{className:"flex flex-col gap-1.5",children:[o.jsxs("label",{className:"flex items-center gap-2 cursor-pointer text-xs",children:[o.jsx("input",{type:"radio",name:"nodeColor",value:"single",checked:oe==="single",onChange:p=>D(p.target.value),className:"w-3.5 h-3.5"}),o.jsx("span",{children:"Single"})]}),o.jsxs("label",{className:"flex items-center gap-2 cursor-pointer text-xs",children:[o.jsx("input",{type:"radio",name:"nodeColor",value:"outgoing",checked:oe==="outgoing",onChange:p=>D(p.target.value),className:"w-3.5 h-3.5"}),o.jsx("span",{children:"Total Outgoing"})]}),o.jsxs("label",{className:"flex items-center gap-2 cursor-pointer text-xs",children:[o.jsx("input",{type:"radio",name:"nodeColor",value:"incoming",checked:oe==="incoming",onChange:p=>D(p.target.value),className:"w-3.5 h-3.5"}),o.jsx("span",{children:"Total Incoming"})]}),o.jsxs("label",{className:"flex items-center gap-2 cursor-pointer text-xs",children:[o.jsx("input",{type:"radio",name:"nodeColor",value:"attribute",checked:oe==="attribute",onChange:p=>D(p.target.value),className:"w-3.5 h-3.5"}),o.jsx("span",{children:"By Attribute"})]})]}),oe==="attribute"&&o.jsxs("select",{value:J||"",onChange:p=>U(p.target.value||null),className:"w-full px-2 py-1.5 text-xs border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[o.jsx("option",{value:"",children:"Select..."}),a.metadata.hasCategoricalProperties.nodes.map(p=>o.jsx("option",{value:p,children:p},p)),a.metadata.hasNumericProperties.nodes.map(p=>o.jsx("option",{value:p,children:p},p))]})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsx("label",{className:"text-xs font-medium text-gray-700",children:"Node Size"}),o.jsxs("div",{className:"flex flex-col gap-1.5",children:[o.jsxs("label",{className:"flex items-center gap-2 cursor-pointer text-xs",children:[o.jsx("input",{type:"radio",name:"nodeSize",value:"fixed",checked:ee==="fixed",onChange:p=>ce(p.target.value),className:"w-3.5 h-3.5"}),o.jsx("span",{children:"Fixed"})]}),o.jsxs("label",{className:"flex items-center gap-2 cursor-pointer text-xs",children:[o.jsx("input",{type:"radio",name:"nodeSize",value:"outgoing",checked:ee==="outgoing",onChange:p=>ce(p.target.value),className:"w-3.5 h-3.5"}),o.jsx("span",{children:"Total Outgoing"})]}),o.jsxs("label",{className:"flex items-center gap-2 cursor-pointer text-xs",children:[o.jsx("input",{type:"radio",name:"nodeSize",value:"incoming",checked:ee==="incoming",onChange:p=>ce(p.target.value),className:"w-3.5 h-3.5"}),o.jsx("span",{children:"Total Incoming"})]}),o.jsxs("label",{className:"flex items-center gap-2 cursor-pointer text-xs",children:[o.jsx("input",{type:"radio",name:"nodeSize",value:"attribute",checked:ee==="attribute",onChange:p=>ce(p.target.value),className:"w-3.5 h-3.5"}),o.jsx("span",{children:"By Attribute"})]})]}),ee==="attribute"&&o.jsxs("select",{value:fe||"",onChange:p=>he(p.target.value||null),className:"w-full px-2 py-1.5 text-xs border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[o.jsx("option",{value:"",children:"Select..."}),a.metadata.hasNumericProperties.nodes.map(p=>o.jsx("option",{value:p,children:p},p))]})]})]}):o.jsx("div",{className:"text-xs text-gray-500 italic",children:"No dataset metadata available"})}),I==="table"&&o.jsx(ke,{title:"Table Settings",defaultOpen:!1,children:o.jsx("div",{className:"text-xs text-gray-500 italic",children:"Settings to be added"})}),I==="sankey"&&o.jsx(ke,{title:"Sankey Settings",defaultOpen:!1,children:o.jsx("div",{className:"text-xs text-gray-500 italic",children:"Settings to be added"})}),I==="chord"&&o.jsx(ke,{title:"Chord Settings",defaultOpen:!1,children:o.jsx("div",{className:"text-xs text-gray-500 italic",children:"Settings to be added"})})]})})]})})}async function xr(){const e="csv-2021",s="gexf-sample",t="swiss-2016",n=await Te(e),r=await Te(s),i=await Te(t);if(!n){const l=new URL("/INF358_Project_Kriskogram/assets/State_to_State_Migrations_Table_2021-CSM7xeRj.csv",import.meta.url),a=await ot(l.toString()),u=tn(a),c={timestamp:2021,nodes:u.nodes,edges:u.edges},d=Oe(c),m={id:e,name:"US State-to-State Migration (2021)",notes:"Real U.S. Census Bureau data showing migration flows between all 50 states from the American Community Survey 1-Year Estimates.",type:"csv",timeRange:{start:2021,end:2021},snapshots:[c],metadata:d,createdAt:Date.now()};await ze(m)}if(!r){const l=new URL("/INF358_Project_Kriskogram/assets/sample-migration-data-d7g-pjXp.gexf",import.meta.url),a=await _n(l.toString()),u=nn(a),c=u.length>0?Oe(u[0]):void 0,d={id:s,name:"Sample Migration (GEXF)",notes:"AI-generated sample network dataset in GEXF format demonstrating temporal migration patterns with multiple time slices. This example dataset includes economic, geographic, and migration type attributes for demonstration purposes.",type:"gexf",timeRange:a.timeRange,snapshots:u,metadata:c,createdAt:Date.now()};await ze(d)}if(!i){const l="/INF358_Project_Kriskogram/",a=`${l}data/Swiss_Relocations_2016_locations.csv`,u=`${l}data/Swiss_Relocations_2016_flows.csv`,c=await ot(a),d=await ot(u),m=an({nodesFile:{content:c,idField:"id",labelField:"name"},edgesFile:{content:d,sourceField:"origin",targetField:"dest",valueField:"count"}}),f={timestamp:2016,nodes:m.nodes,edges:m.edges},g=Oe(f),h={id:t,name:"Swiss Relocations (2016)",notes:"Relocations between Swiss cantons in 2016. This dataset contains 521,510 trips and uses a two-file CSV format with separate files for locations (cantons) and flows (relocations). Created by Ilya Boyandin.",type:"csv-two-file",timeRange:{start:2016,end:2016},snapshots:[f],metadata:g,createdAt:Date.now()};await ze(h)}return e}export{br as component};
