import{c as en,r as x,j as r,s as de,o as In,a as tt,z as Jn,i as es,C as ts,G as ns,u as ss,b as rs,d as os,K as is,_ as as,e as ls,p as qt,f as un,n as cn}from"./main-DPhOau9d.js";import{p as En,l as Et}from"./csv-parser-C3wi6dZF.js";import{p as ds,g as Pn,l as us}from"./gexf-parser-ChiJebeW.js";/**
 * @license lucide-react v0.476.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cs=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],gs=en("ChevronDown",cs);/**
 * @license lucide-react v0.476.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fs=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],ms=en("ChevronUp",fs);/**
 * @license lucide-react v0.476.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ps=[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],gn=en("Settings",ps);function hs(e,s){return e==null||s==null?NaN:s<e?-1:s>e?1:s>=e?0:NaN}var fn=Math.abs,Pt=Math.cos,Vt=Math.sin,Vn=Math.PI,wt=Vn/2,mn=Vn*2,pn=Math.max,At=1e-12;function hn(e,s){return Array.from({length:s-e},(t,n)=>e+n)}function xs(e){return function(s,t){return e(s.source.value+s.target.value,t.source.value+t.target.value)}}function vs(){return ys(!1)}function ys(e,s){var t=0,n=null,o=null,i=null;function l(a){var d=a.length,c=new Array(d),u=hn(0,d),m=new Array(d*d),f=new Array(d),g=0,h;a=Float64Array.from({length:d*d},(v,S)=>a[S/d|0][S%d]);for(let v=0;v<d;++v){let S=0;for(let y=0;y<d;++y)S+=a[v*d+y]+e*a[y*d+v];g+=c[v]=S}g=pn(0,mn-t*d)/g,h=g?t:mn/d;{let v=0;n&&u.sort((S,y)=>n(c[S],c[y]));for(const S of u){const y=v;{const b=hn(0,d).filter(w=>a[S*d+w]||a[w*d+S]);o&&b.sort((w,N)=>o(a[S*d+w],a[S*d+N]));for(const w of b){let N;if(S<w?(N=m[S*d+w]||(m[S*d+w]={source:null,target:null}),N.source={index:S,startAngle:v,endAngle:v+=a[S*d+w]*g,value:a[S*d+w]}):(N=m[w*d+S]||(m[w*d+S]={source:null,target:null}),N.target={index:S,startAngle:v,endAngle:v+=a[S*d+w]*g,value:a[S*d+w]},S===w&&(N.source=N.target)),N.source&&N.target&&N.source.value<N.target.value){const M=N.source;N.source=N.target,N.target=M}}f[S]={index:S,startAngle:y,endAngle:v,value:c[S]}}v+=h}}return m=Object.values(m),m.groups=f,i?m.sort(i):m}return l.padAngle=function(a){return arguments.length?(t=pn(0,a),l):t},l.sortGroups=function(a){return arguments.length?(n=a,l):n},l.sortSubgroups=function(a){return arguments.length?(o=a,l):o},l.sortChords=function(a){return arguments.length?(a==null?i=null:(i=xs(a))._=a,l):i&&i._},l}const Wt=Math.PI,Xt=2*Wt,et=1e-6,ws=Xt-et;function An(e){this._+=e[0];for(let s=1,t=e.length;s<t;++s)this._+=arguments[s]+e[s]}function Ss(e){let s=Math.floor(e);if(!(s>=0))throw new Error(`invalid digits: ${e}`);if(s>15)return An;const t=10**s;return function(n){this._+=n[0];for(let o=1,i=n.length;o<i;++o)this._+=Math.round(arguments[o]*t)/t+n[o]}}class tn{constructor(s){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=s==null?An:Ss(s)}moveTo(s,t){this._append`M${this._x0=this._x1=+s},${this._y0=this._y1=+t}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(s,t){this._append`L${this._x1=+s},${this._y1=+t}`}quadraticCurveTo(s,t,n,o){this._append`Q${+s},${+t},${this._x1=+n},${this._y1=+o}`}bezierCurveTo(s,t,n,o,i,l){this._append`C${+s},${+t},${+n},${+o},${this._x1=+i},${this._y1=+l}`}arcTo(s,t,n,o,i){if(s=+s,t=+t,n=+n,o=+o,i=+i,i<0)throw new Error(`negative radius: ${i}`);let l=this._x1,a=this._y1,d=n-s,c=o-t,u=l-s,m=a-t,f=u*u+m*m;if(this._x1===null)this._append`M${this._x1=s},${this._y1=t}`;else if(f>et)if(!(Math.abs(m*d-c*u)>et)||!i)this._append`L${this._x1=s},${this._y1=t}`;else{let g=n-l,h=o-a,v=d*d+c*c,S=g*g+h*h,y=Math.sqrt(v),b=Math.sqrt(f),w=i*Math.tan((Wt-Math.acos((v+f-S)/(2*y*b)))/2),N=w/b,M=w/y;Math.abs(N-1)>et&&this._append`L${s+N*u},${t+N*m}`,this._append`A${i},${i},0,0,${+(m*g>u*h)},${this._x1=s+M*d},${this._y1=t+M*c}`}}arc(s,t,n,o,i,l){if(s=+s,t=+t,n=+n,l=!!l,n<0)throw new Error(`negative radius: ${n}`);let a=n*Math.cos(o),d=n*Math.sin(o),c=s+a,u=t+d,m=1^l,f=l?o-i:i-o;this._x1===null?this._append`M${c},${u}`:(Math.abs(this._x1-c)>et||Math.abs(this._y1-u)>et)&&this._append`L${c},${u}`,n&&(f<0&&(f=f%Xt+Xt),f>ws?this._append`A${n},${n},0,1,${m},${s-a},${t-d}A${n},${n},0,1,${m},${this._x1=c},${this._y1=u}`:f>et&&this._append`A${n},${n},0,${+(f>=Wt)},${m},${this._x1=s+n*Math.cos(i)},${this._y1=t+n*Math.sin(i)}`)}rect(s,t,n,o){this._append`M${this._x0=this._x1=+s},${this._y0=this._y1=+t}h${n=+n}v${+o}h${-n}Z`}toString(){return this._}}function nn(){return new tn}nn.prototype=tn.prototype;var bs=Array.prototype.slice;function rt(e){return function(){return e}}function Cs(e){return e.source}function js(e){return e.target}function xn(e){return e.radius}function Ns(e){return e.startAngle}function Rs(e){return e.endAngle}function Fs(){return 0}function $s(e){var s=Cs,t=js,n=xn,o=xn,i=Ns,l=Rs,a=Fs,d=null;function c(){var u,m=s.apply(this,arguments),f=t.apply(this,arguments),g=a.apply(this,arguments)/2,h=bs.call(arguments),v=+n.apply(this,(h[0]=m,h)),S=i.apply(this,h)-wt,y=l.apply(this,h)-wt,b=+o.apply(this,(h[0]=f,h)),w=i.apply(this,h)-wt,N=l.apply(this,h)-wt;if(d||(d=u=nn()),g>At&&(fn(y-S)>g*2+At?y>S?(S+=g,y-=g):(S-=g,y+=g):S=y=(S+y)/2,fn(N-w)>g*2+At?N>w?(w+=g,N-=g):(w-=g,N+=g):w=N=(w+N)/2),d.moveTo(v*Pt(S),v*Vt(S)),d.arc(0,0,v,S,y),(S!==w||y!==N)&&(d.quadraticCurveTo(0,0,b*Pt(w),b*Vt(w)),d.arc(0,0,b,w,N)),d.quadraticCurveTo(0,0,v*Pt(S),v*Vt(S)),d.closePath(),u)return d=null,u+""||null}return c.radius=function(u){return arguments.length?(n=o=typeof u=="function"?u:rt(+u),c):n},c.sourceRadius=function(u){return arguments.length?(n=typeof u=="function"?u:rt(+u),c):n},c.targetRadius=function(u){return arguments.length?(o=typeof u=="function"?u:rt(+u),c):o},c.startAngle=function(u){return arguments.length?(i=typeof u=="function"?u:rt(+u),c):i},c.endAngle=function(u){return arguments.length?(l=typeof u=="function"?u:rt(+u),c):l},c.padAngle=function(u){return arguments.length?(a=typeof u=="function"?u:rt(+u),c):a},c.source=function(u){return arguments.length?(s=u,c):s},c.target=function(u){return arguments.length?(t=u,c):t},c.context=function(u){return arguments.length?(d=u??null,c):d},c}function Ms(){return $s()}function _s(e){for(var s=e.length/6|0,t=new Array(s),n=0;n<s;)t[n]="#"+e.slice(n*6,++n*6);return t}const Dn=_s("1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf");function Ge(e){return function(){return e}}const vn=Math.abs,Ce=Math.atan2,Je=Math.cos,Is=Math.max,Dt=Math.min,ze=Math.sin,it=Math.sqrt,Pe=1e-12,pt=Math.PI,Rt=pt/2,Es=2*pt;function Ps(e){return e>1?0:e<-1?pt:Math.acos(e)}function yn(e){return e>=1?Rt:e<=-1?-Rt:Math.asin(e)}function Vs(e){let s=3;return e.digits=function(t){if(!arguments.length)return s;if(t==null)s=null;else{const n=Math.floor(t);if(!(n>=0))throw new RangeError(`invalid digits: ${t}`);s=n}return e},()=>new tn(s)}function As(e){return e.innerRadius}function Ds(e){return e.outerRadius}function ks(e){return e.startAngle}function Ls(e){return e.endAngle}function zs(e){return e&&e.padAngle}function Ts(e,s,t,n,o,i,l,a){var d=t-e,c=n-s,u=l-o,m=a-i,f=m*d-u*c;if(!(f*f<Pe))return f=(u*(s-i)-m*(e-o))/f,[e+f*d,s+f*c]}function St(e,s,t,n,o,i,l){var a=e-t,d=s-n,c=(l?i:-i)/it(a*a+d*d),u=c*d,m=-c*a,f=e+u,g=s+m,h=t+u,v=n+m,S=(f+h)/2,y=(g+v)/2,b=h-f,w=v-g,N=b*b+w*w,M=o-i,j=f*v-h*g,P=(w<0?-1:1)*it(Is(0,M*M*N-j*j)),_=(j*w-b*P)/N,I=(-j*b-w*P)/N,q=(j*w+b*P)/N,E=(-j*b+w*P)/N,U=_-S,$=I-y,T=q-S,W=E-y;return U*U+$*$>T*T+W*W&&(_=q,I=E),{cx:_,cy:I,x01:-u,y01:-m,x11:_*(o/M-1),y11:I*(o/M-1)}}function Hs(){var e=As,s=Ds,t=Ge(0),n=null,o=ks,i=Ls,l=zs,a=null,d=Vs(c);function c(){var u,m,f=+e.apply(this,arguments),g=+s.apply(this,arguments),h=o.apply(this,arguments)-Rt,v=i.apply(this,arguments)-Rt,S=vn(v-h),y=v>h;if(a||(a=u=d()),g<f&&(m=g,g=f,f=m),!(g>Pe))a.moveTo(0,0);else if(S>Es-Pe)a.moveTo(g*Je(h),g*ze(h)),a.arc(0,0,g,h,v,!y),f>Pe&&(a.moveTo(f*Je(v),f*ze(v)),a.arc(0,0,f,v,h,y));else{var b=h,w=v,N=h,M=v,j=S,P=S,_=l.apply(this,arguments)/2,I=_>Pe&&(n?+n.apply(this,arguments):it(f*f+g*g)),q=Dt(vn(g-f)/2,+t.apply(this,arguments)),E=q,U=q,$,T;if(I>Pe){var W=yn(I/f*ze(_)),Y=yn(I/g*ze(_));(j-=W*2)>Pe?(W*=y?1:-1,N+=W,M-=W):(j=0,N=M=(h+v)/2),(P-=Y*2)>Pe?(Y*=y?1:-1,b+=Y,w-=Y):(P=0,b=w=(h+v)/2)}var ee=g*Je(b),te=g*ze(b),ge=f*Je(M),C=f*ze(M);if(q>Pe){var V=g*Je(w),se=g*ze(w),xe=f*Je(N),Se=f*ze(N),H;if(S<pt)if(H=Ts(ee,te,xe,Se,V,se,ge,C)){var O=ee-H[0],B=te-H[1],ue=V-H[0],Ne=se-H[1],ae=1/ze(Ps((O*ue+B*Ne)/(it(O*O+B*B)*it(ue*ue+Ne*Ne)))/2),ye=it(H[0]*H[0]+H[1]*H[1]);E=Dt(q,(f-ye)/(ae-1)),U=Dt(q,(g-ye)/(ae+1))}else E=U=0}P>Pe?U>Pe?($=St(xe,Se,ee,te,g,U,y),T=St(V,se,ge,C,g,U,y),a.moveTo($.cx+$.x01,$.cy+$.y01),U<q?a.arc($.cx,$.cy,U,Ce($.y01,$.x01),Ce(T.y01,T.x01),!y):(a.arc($.cx,$.cy,U,Ce($.y01,$.x01),Ce($.y11,$.x11),!y),a.arc(0,0,g,Ce($.cy+$.y11,$.cx+$.x11),Ce(T.cy+T.y11,T.cx+T.x11),!y),a.arc(T.cx,T.cy,U,Ce(T.y11,T.x11),Ce(T.y01,T.x01),!y))):(a.moveTo(ee,te),a.arc(0,0,g,b,w,!y)):a.moveTo(ee,te),!(f>Pe)||!(j>Pe)?a.lineTo(ge,C):E>Pe?($=St(ge,C,V,se,f,-E,y),T=St(ee,te,xe,Se,f,-E,y),a.lineTo($.cx+$.x01,$.cy+$.y01),E<q?a.arc($.cx,$.cy,E,Ce($.y01,$.x01),Ce(T.y01,T.x01),!y):(a.arc($.cx,$.cy,E,Ce($.y01,$.x01),Ce($.y11,$.x11),!y),a.arc(0,0,f,Ce($.cy+$.y11,$.cx+$.x11),Ce(T.cy+T.y11,T.cx+T.x11),y),a.arc(T.cx,T.cy,E,Ce(T.y11,T.x11),Ce(T.y01,T.x01),!y))):a.arc(0,0,f,M,N,y)}if(a.closePath(),u)return a=null,u+""||null}return c.centroid=function(){var u=(+e.apply(this,arguments)+ +s.apply(this,arguments))/2,m=(+o.apply(this,arguments)+ +i.apply(this,arguments))/2-pt/2;return[Je(m)*u,ze(m)*u]},c.innerRadius=function(u){return arguments.length?(e=typeof u=="function"?u:Ge(+u),c):e},c.outerRadius=function(u){return arguments.length?(s=typeof u=="function"?u:Ge(+u),c):s},c.cornerRadius=function(u){return arguments.length?(t=typeof u=="function"?u:Ge(+u),c):t},c.padRadius=function(u){return arguments.length?(n=u==null?null:typeof u=="function"?u:Ge(+u),c):n},c.startAngle=function(u){return arguments.length?(o=typeof u=="function"?u:Ge(+u),c):o},c.endAngle=function(u){return arguments.length?(i=typeof u=="function"?u:Ge(+u),c):i},c.padAngle=function(u){return arguments.length?(l=typeof u=="function"?u:Ge(+u),c):l},c.context=function(u){return arguments.length?(a=u??null,c):a},c}function ft(e){const s=new Set,t=new Set,n=new Set,o=new Set,i=new Set,l=new Set;return e.nodes.forEach(a=>{Object.keys(a).forEach(d=>{if(d!=="id"&&d!=="label"){s.add(d);const c=a[d];typeof c=="number"?n.add(d):typeof c=="string"&&i.add(d)}})}),e.edges.forEach(a=>{Object.keys(a).forEach(d=>{if(d!=="source"&&d!=="target"&&d!=="value"){t.add(d);const c=a[d];typeof c=="number"?o.add(d):typeof c=="string"&&l.add(d)}})}),{nodeProperties:Array.from(s),edgeProperties:Array.from(t),hasNumericProperties:{nodes:Array.from(n),edges:Array.from(o)},hasCategoricalProperties:{nodes:Array.from(i),edges:Array.from(l)}}}const Os="kriskogram-db",Gs=1,De="datasets";function ht(){return new Promise((e,s)=>{const t=indexedDB.open(Os,Gs);t.onupgradeneeded=()=>{const n=t.result;n.objectStoreNames.contains(De)||n.createObjectStore(De,{keyPath:"id"})},t.onsuccess=()=>e(t.result),t.onerror=()=>s(t.error)})}async function at(e){const s=await ht();return new Promise((t,n)=>{const o=s.transaction(De,"readwrite");o.objectStore(De).put(e),o.oncomplete=()=>t(),o.onerror=()=>n(o.error),o.onabort=()=>n(o.error)})}async function lt(e){const s=await ht();return new Promise((t,n)=>{const l=s.transaction(De,"readonly").objectStore(De).get(e);l.onsuccess=()=>t(l.result),l.onerror=()=>n(l.error)})}async function Bs(){const e=await ht();return new Promise((s,t)=>{const i=e.transaction(De,"readonly").objectStore(De).getAll();i.onsuccess=()=>s(i.result||[]),i.onerror=()=>t(i.error)})}async function Us(e){const s=await ht();return new Promise((t,n)=>{const o=s.transaction(De,"readwrite");o.objectStore(De).delete(e),o.oncomplete=()=>t(),o.onerror=()=>n(o.error)})}async function qs(e){const s=await lt(e);if(!s)throw new Error(`Dataset ${e} not found`);const t={...s,id:`${s.type}-${Date.now()}`,name:`${s.name} (Copy)`,createdAt:Date.now()};return await at(t),t}async function Ws(){const e=await ht();return new Promise((s,t)=>{const n=e.transaction(De,"readwrite");n.objectStore(De).clear(),n.oncomplete=()=>s(),n.onerror=()=>t(n.error)})}async function Xs(){if("storage"in navigator&&"persist"in navigator.storage)try{return await navigator.storage.persist()}catch{return!1}return!1}function wn(e){const s=[];let t="",n=!1;for(let o=0;o<e.length;o++){const i=e[o];i==='"'?n=!n:i===","&&!n?(s.push(t),t=""):t+=i}return s.push(t),s}function Sn(e){const s=e.trim().split(`
`).filter(o=>o.trim());if(s.length===0)throw new Error("CSV file is empty");const t=wn(s[0]).map(o=>o.trim()),n=s.slice(1).map(wn);return{headers:t,rows:n}}function kt(e){const s=e.replace(/[",]/g,"").trim(),t=Number.parseFloat(s);return Number.isNaN(t)?s:t}function kn(e){var M;const{headers:s,rows:t}=Sn(e.nodesFile.content),n=s.map(j=>j.toLowerCase().trim()),o=e.nodesFile.idField.toLowerCase().trim(),i=((M=e.nodesFile.labelField)==null?void 0:M.toLowerCase().trim())||o,l=n.indexOf(o),a=e.nodesFile.labelField?n.indexOf(i):l;if(l===-1)throw new Error(`ID field "${e.nodesFile.idField}" not found in nodes file. Available fields: ${s.join(", ")}`);const d=t.map(j=>{const P={id:String(j[l]||"").trim(),label:a>=0?String(j[a]||"").trim():String(j[l]||"").trim()},_=s[l],I=e.nodesFile.labelField?s[a]:_;return s.forEach((q,E)=>{var U;if(q!==_&&q!==I){const $=((U=j[E])==null?void 0:U.trim())||"";P[q]=kt($)}}),P}).filter(j=>j.id),c=new Map(d.map(j=>[j.id,j])),{headers:u,rows:m}=Sn(e.edgesFile.content),f=u.map(j=>j.toLowerCase().trim()),g=e.edgesFile.sourceField.toLowerCase().trim(),h=e.edgesFile.targetField.toLowerCase().trim(),v=e.edgesFile.valueField.toLowerCase().trim(),S=f.indexOf(g),y=f.indexOf(h),b=f.indexOf(v);if(S===-1)throw new Error(`Source field "${e.edgesFile.sourceField}" not found in edges file. Available fields: ${u.join(", ")}`);if(y===-1)throw new Error(`Target field "${e.edgesFile.targetField}" not found in edges file. Available fields: ${u.join(", ")}`);if(b===-1)throw new Error(`Value field "${e.edgesFile.valueField}" not found in edges file. Available fields: ${u.join(", ")}`);const w=m.map(j=>{const P=String(j[S]||"").trim(),_=String(j[y]||"").trim(),I=String(j[b]||"").trim(),q=kt(I);if(!P||!_||typeof q!="number"||q<=0)return null;(!c.has(P)||!c.has(_))&&console.warn(`Edge references missing node: ${P} -> ${_}`);const E={source:P,target:_,value:q},U=u[S],$=u[y],T=u[b];return u.forEach((W,Y)=>{var ee;if(W!==U&&W!==$&&W!==T){const te=((ee=j[Y])==null?void 0:ee.trim())||"";E[W]=kt(te)}}),E}).filter(j=>j!==null&&c.has(j.source)&&c.has(j.target)),N=new Set;return w.forEach(j=>{N.add(j.source),N.add(j.target)}),N.forEach(j=>{c.has(j)||d.push({id:j,label:j})}),{nodes:d,edges:w}}function Ks({onClose:e,onImport:s,fileInputRef:t,onFilesSelected:n,existingFile:o}){const[i,l]=x.useState(""),[a,d]=x.useState(""),[c,u]=x.useState(!1),[m,f]=x.useState({}),[g,h]=x.useState(!1),[v,S]=x.useState(null),[y,b]=x.useState([]),[w,N]=x.useState([]),[M,j]=x.useState(null),P=x.useRef(null),_=x.useRef(null),[I,q]=x.useState(null),[E,U]=x.useState(null),[$,T]=x.useState([]),[W,Y]=x.useState([]),[ee,te]=x.useState(""),[ge,C]=x.useState(""),[V,se]=x.useState(""),[xe,Se]=x.useState(""),[H,O]=x.useState(""),[B,ue]=x.useState(null);function Ne(R){let F=R.replace(/\.(csv|gexf)$/i,"");return F=F.replace(/([a-z])([A-Z])/g,"$1 $2").replace(/[_-]/g," ").replace(/[^a-zA-Z0-9\s]/g," ").replace(/\s+/g," ").trim(),F.split(" ").map(A=>A.charAt(0).toUpperCase()+A.slice(1).toLowerCase()).join(" ")}x.useEffect(()=>{var R;if(o!=null&&o.parsedData){ue(o.parsedData);const F=((R=o.files[0])==null?void 0:R.name)||"";l(Ne(F)),d(o.files.map(A=>A.name).join(", "))}},[o]),x.useEffect(()=>{var R;if(!o&&y.length>0){if(!i||i===Ne(((R=y[0])==null?void 0:R.name)||"")){const F=y[0].name;l(Ne(F))}a||d(y.map(F=>F.name).join(", "))}},[y]);function ae(R){const F=[];let A="",Q=!1;for(let X=0;X<R.length;X++){const K=R[X];K==='"'?Q=!Q:K===","&&!Q?(F.push(A),A=""):A+=K}return F.push(A),F}function ye(R){const F=R.trim().split(`
`);if(F.length===0)return[];const A=F[0];return ae(A).map(Q=>Q.trim().replace(/^"|"$/g,""))}async function Te(R){const F=Array.from(R.target.files||[]);if(F.length===0)return;b(F);const A=await Promise.all(F.map(X=>X.text()));N(A);const Q=F[0].name.toLowerCase();if(Q.endsWith(".gexf")){j("gexf"),S("single");try{const X=ds(A[0]),K=Pn(X);ue({nodes:K.length>0?K[0].nodes:[],edges:K.length>0?K[0].edges:[],timeRange:X.timeRange}),l(F[0].name.replace(".gexf",""))}catch(X){f([X instanceof Error?X.message:"Failed to parse GEXF"])}}else if(Q.endsWith(".csv")){if(j("csv"),F.length===1){S("single");try{const X=En(A[0]);ue({nodes:X.nodes,edges:X.edges,timeRange:{start:2021,end:2021}}),l(F[0].name.replace(".csv",""))}catch{S("two-file");const K=ye(A[0]);T(K),Y(K),q(0);const J=K.find(re=>re.toLowerCase()==="id"||re.toLowerCase()==="node"||re.toLowerCase()==="name"),Ie=K.find(re=>re.toLowerCase()==="source"||re.toLowerCase()==="origin"||re.toLowerCase()==="from"),We=K.find(re=>re.toLowerCase()==="target"||re.toLowerCase()==="dest"||re.toLowerCase()==="destination"||re.toLowerCase()==="to"),Re=K.find(re=>re.toLowerCase()==="value"||re.toLowerCase()==="count"||re.toLowerCase()==="weight");J&&te(J),Ie&&se(Ie),We&&Se(We),Re&&O(Re),f(["Could not parse as state migration format. Please select which file contains nodes and which contains edges."])}}else if(F.length===2){S("two-file");const X=ye(A[0]),K=ye(A[1]);T(X),Y(K),q(0),U(1);const J=X.find(ce=>ce.toLowerCase()==="id"),Ie=X.find(ce=>ce.toLowerCase()==="name"||ce.toLowerCase()==="label");J&&te(J),Ie&&C(Ie);const We=K.find(ce=>ce.toLowerCase()==="source"||ce.toLowerCase()==="origin"||ce.toLowerCase()==="from"),Re=K.find(ce=>ce.toLowerCase()==="target"||ce.toLowerCase()==="dest"||ce.toLowerCase()==="destination"||ce.toLowerCase()==="to"),re=K.find(ce=>ce.toLowerCase()==="value"||ce.toLowerCase()==="count"||ce.toLowerCase()==="weight");We&&se(We),Re&&Se(Re),re&&O(re),xt()}}t.current&&(t.current.value="")}function xt(){if(I===null||E===null||!ee||!V||!xe||!H){f(["Please select all required fields"]),ue(null);return}try{const R=kn({nodesFile:{content:w[I],idField:ee,labelField:ge||ee},edgesFile:{content:w[E],sourceField:V,targetField:xe,valueField:H}});ue({nodes:R.nodes,edges:R.edges,timeRange:{start:2016,end:2016}}),f([])}catch(R){f([R instanceof Error?R.message:"Failed to parse two-file CSV"]),ue(null)}}x.useEffect(()=>{v==="two-file"&&I!==null&&E!==null&&xt()},[ee,ge,V,xe,H,I,E]);function dt(){const R={},F=[];if(i.trim()||(R.name="Dataset name is required"),v==="two-file"&&(I===null&&(R.nodesFile="Please select which file contains nodes"),E===null&&(R.edgesFile="Please select which file contains edges"),I!==null&&!ee&&(R.nodeIdField="Please select the ID field for nodes"),E!==null&&!V&&(R.edgeSourceField="Please select the source field for edges"),E!==null&&!xe&&(R.edgeTargetField="Please select the target field for edges"),E!==null&&!H&&(R.edgeValueField="Please select the value field for edges")),!B)return R.general="Data parsing failed - please check file format and field selections",R;B.nodes.length===0&&F.push("No nodes found in dataset"),B.edges.length===0&&F.push("No edges found in dataset");const A=new Set(B.nodes.map(X=>X.id));A.size!==B.nodes.length&&F.push(`${B.nodes.length-A.size} duplicate node IDs found`);const Q=B.edges.filter(X=>!A.has(X.source)||!A.has(X.target));return Q.length>0&&F.push(`${Q.length} edges reference non-existent nodes`),F.length>0&&(R.summary=F.join("; ")),R}function vt(){m.name&&P.current?(P.current.scrollIntoView({behavior:"smooth",block:"center"}),P.current.focus()):m.summary&&_.current&&_.current.scrollIntoView({behavior:"smooth",block:"center"})}async function nt(){const R=dt();if(f(R),Object.keys(R).filter(A=>A!=="summary").length>0||!B){setTimeout(()=>vt(),100);return}u(!0);try{const A=B.timeRange||{start:2021,end:2021},Q={timestamp:A.start,nodes:B.nodes,edges:B.edges},X=ft(Q),K=[Q],J={name:i.trim(),filename:y.map(Ie=>Ie.name).join(", "),notes:a.trim()||void 0,type:v==="two-file"?"csv":M||"csv",timeRange:A,snapshots:K,metadata:X};await s(J,{nodes:B.nodes,edges:B.edges,snapshots:K,metadata:X})}catch(A){console.error("Import error:",A),f({general:A instanceof Error?A.message:"Failed to import dataset"}),u(!1),setTimeout(()=>vt(),100)}}return r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:r.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-4xl w-full mx-4 max-h-[90vh] flex flex-col",children:[r.jsxs("div",{className:"p-6 border-b flex items-center justify-between",children:[r.jsx("h2",{className:"text-2xl font-bold",children:"Import Dataset"}),r.jsx("button",{onClick:e,className:"text-gray-400 hover:text-gray-600 text-2xl",children:"×"})]}),r.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:r.jsxs("div",{className:"space-y-6",children:[!v&&r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Select Files ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsxs("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-6 text-center",children:[r.jsx("button",{onClick:()=>{var R;return(R=t.current)==null?void 0:R.click()},className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700",children:"Choose Files"}),r.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"Select 1 file (GEXF or CSV) or 2 files (CSV nodes + CSV edges)"}),r.jsx("input",{ref:t,type:"file",accept:".csv,.gexf",multiple:!0,onChange:Te,className:"hidden"})]})]}),y.length>0&&r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Selected Files"}),r.jsxs("div",{className:"space-y-2",children:[y.map((R,F)=>r.jsxs("div",{className:"flex items-center justify-between bg-gray-50 p-3 rounded",children:[r.jsx("span",{className:"text-sm",children:R.name}),r.jsx("button",{onClick:()=>{const A=[...y];A.splice(F,1),b(A);const Q=[...w];Q.splice(F,1),N(Q),v==="two-file"&&(I===F&&q(null),E===F&&U(null),I&&I>F&&q(I-1),E&&E>F&&U(E-1))},className:"text-red-600 text-sm hover:text-red-800",children:"Remove"})]},F)),r.jsx("button",{type:"button",onClick:()=>{const R=document.createElement("input");R.type="file",R.accept=".csv,.gexf",R.multiple=!0,R.onchange=async F=>{const A=F.target,Q=Array.from(A.files||[]);if(Q.length>0){const X=await Promise.all(Q.map(J=>J.text()));b([...y,...Q]),N([...w,...X]);const K=[...y,...Q];K.length===2&&K.every(J=>J.name.toLowerCase().endsWith(".csv"))&&(S("two-file"),j("csv"))}},R.click()},className:"text-sm text-blue-600 hover:text-blue-800",children:"+ Add More Files"})]})]}),v==="two-file"&&y.length>0&&r.jsxs("div",{className:"border-t pt-4 space-y-4","data-file-select":!0,children:[r.jsx("h3",{className:"font-semibold",children:"Map Files and Fields"}),r.jsxs("div",{"data-field-select":!0,children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Nodes File (Locations) ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsxs("select",{value:I??"",onChange:R=>{const F=parseInt(R.target.value);q(F);const A=ye(w[F]);T(A);const Q=A.find(X=>X.toLowerCase()==="id");if(Q&&te(Q),m.nodesFile){const X={...m};delete X.nodesFile,f(X)}},className:`w-full px-3 py-2 border rounded-md ${m.nodesFile?"border-red-500":"border-gray-300"}`,children:[r.jsx("option",{value:"",children:"Select file..."}),y.map((R,F)=>r.jsx("option",{value:F,children:R.name},F))]}),m.nodesFile&&r.jsx("p",{className:"mt-1 text-sm text-red-600",children:m.nodesFile}),I!==null&&$.length>0&&r.jsxs("div",{className:"mt-2 space-y-2",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"ID Field *"}),r.jsxs("select",{value:ee,onChange:R=>{if(te(R.target.value),m.nodeIdField){const F={...m};delete F.nodeIdField,f(F)}},className:`w-full px-2 py-1 border rounded text-sm ${m.nodeIdField?"border-red-500":"border-gray-300"}`,children:[r.jsx("option",{value:"",children:"Select field..."}),$.map(R=>r.jsx("option",{value:R,children:R},R))]}),m.nodeIdField&&r.jsx("p",{className:"mt-1 text-xs text-red-600",children:m.nodeIdField})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"Label Field (optional)"}),r.jsxs("select",{value:ge,onChange:R=>C(R.target.value),className:"w-full px-2 py-1 border border-gray-300 rounded text-sm",children:[r.jsx("option",{value:"",children:"Use ID field"}),$.map(R=>r.jsx("option",{value:R,children:R},R))]})]})]})]}),r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Edges File (Flows) ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsxs("select",{value:E??"",onChange:R=>{const F=parseInt(R.target.value);U(F);const A=ye(w[F]);Y(A);const Q=A.find(J=>J.toLowerCase()==="source"||J.toLowerCase()==="origin"||J.toLowerCase()==="from"),X=A.find(J=>J.toLowerCase()==="target"||J.toLowerCase()==="dest"||J.toLowerCase()==="to"),K=A.find(J=>J.toLowerCase()==="value"||J.toLowerCase()==="count"||J.toLowerCase()==="weight");if(Q&&se(Q),X&&Se(X),K&&O(K),m.edgesFile){const J={...m};delete J.edgesFile,f(J)}},className:`w-full px-3 py-2 border rounded-md ${m.edgesFile?"border-red-500":"border-gray-300"}`,children:[r.jsx("option",{value:"",children:"Select file..."}),y.map((R,F)=>r.jsx("option",{value:F,children:R.name},F))]}),m.edgesFile&&r.jsx("p",{className:"mt-1 text-sm text-red-600",children:m.edgesFile}),E!==null&&W.length>0&&r.jsxs("div",{className:"mt-2 space-y-2",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"Source Field *"}),r.jsxs("select",{value:V,onChange:R=>{if(se(R.target.value),m.edgeSourceField){const F={...m};delete F.edgeSourceField,f(F)}},className:`w-full px-2 py-1 border rounded text-sm ${m.edgeSourceField?"border-red-500":"border-gray-300"}`,children:[r.jsx("option",{value:"",children:"Select field..."}),W.map(R=>r.jsx("option",{value:R,children:R},R))]}),m.edgeSourceField&&r.jsx("p",{className:"mt-1 text-xs text-red-600",children:m.edgeSourceField})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"Target Field *"}),r.jsxs("select",{value:xe,onChange:R=>{if(Se(R.target.value),m.edgeTargetField){const F={...m};delete F.edgeTargetField,f(F)}},className:`w-full px-2 py-1 border rounded text-sm ${m.edgeTargetField?"border-red-500":"border-gray-300"}`,children:[r.jsx("option",{value:"",children:"Select field..."}),W.map(R=>r.jsx("option",{value:R,children:R},R))]}),m.edgeTargetField&&r.jsx("p",{className:"mt-1 text-xs text-red-600",children:m.edgeTargetField})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"Value Field *"}),r.jsxs("select",{value:H,onChange:R=>{if(O(R.target.value),m.edgeValueField){const F={...m};delete F.edgeValueField,f(F)}},className:`w-full px-2 py-1 border rounded text-sm ${m.edgeValueField?"border-red-500":"border-gray-300"}`,children:[r.jsx("option",{value:"",children:"Select field..."}),W.map(R=>r.jsx("option",{value:R,children:R},R))]}),m.edgeValueField&&r.jsx("p",{className:"mt-1 text-xs text-red-600",children:m.edgeValueField})]})]})]})]}),r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Dataset Name ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsx("input",{ref:P,type:"text",value:i,onChange:R=>{if(l(R.target.value),m.name){const F={...m};delete F.name,f(F)}},className:`w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 ${m.name?"border-red-500 focus:ring-red-500":"border-gray-300 focus:ring-blue-500"}`,placeholder:"Enter a name for this dataset"}),m.name&&r.jsx("p",{className:"mt-1 text-sm text-red-600",children:m.name})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Notes (optional)"}),r.jsx("textarea",{value:a,onChange:R=>d(R.target.value),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Add any notes about this dataset..."})]}),m.general&&r.jsxs("div",{className:"bg-red-50 border border-red-200 rounded p-3",children:[r.jsx("h4",{className:"font-semibold text-red-800 mb-2",children:"Error:"}),r.jsx("p",{className:"text-sm text-red-700",children:m.general})]}),B&&r.jsxs("div",{ref:_,className:"bg-blue-50 border border-blue-200 rounded p-3",children:[r.jsx("h4",{className:"font-semibold text-blue-800 mb-2",children:"Data Summary"}),r.jsxs("div",{className:"text-sm text-blue-700 space-y-1",children:[r.jsxs("div",{children:[r.jsx("span",{className:"font-medium",children:"Nodes:"})," ",B.nodes.length]}),r.jsxs("div",{children:[r.jsx("span",{className:"font-medium",children:"Edges:"})," ",B.edges.length]}),B.timeRange&&r.jsxs("div",{children:[r.jsx("span",{className:"font-medium",children:"Time Range:"})," ",B.timeRange.start,B.timeRange.end!==B.timeRange.start?` – ${B.timeRange.end}`:""]}),B.nodes.length>0&&r.jsxs("div",{className:"mt-2 text-xs",children:[r.jsx("span",{className:"font-medium",children:"Sample node properties:"})," ",Object.keys(B.nodes[0]).slice(0,5).join(", "),Object.keys(B.nodes[0]).length>5&&"..."]}),m.summary&&r.jsxs("div",{className:"mt-2 pt-2 border-t border-blue-300",children:[r.jsx("span",{className:"font-medium text-orange-700",children:"Warnings:"})," ",r.jsx("span",{className:"text-orange-600",children:m.summary})]})]})]})]})}),r.jsxs("div",{className:"p-6 border-t flex justify-end gap-3",children:[r.jsx("button",{onClick:e,type:"button",disabled:c,className:"px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50 disabled:opacity-50 cursor-pointer transition-colors",children:"Cancel"}),r.jsx("button",{onClick:nt,type:"button",disabled:c||(Object.keys(m).filter(F=>F!=="summary").length>0||!B),className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed cursor-pointer transition-colors",children:c?"Importing...":"Import Dataset"})]})]})})}/**
   * table-core
   *
   * Copyright (c) TanStack
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE.md file in the root directory of this source tree.
   *
   * @license MIT
   */function Ue(e,s){return typeof e=="function"?e(s):e}function Ae(e,s){return t=>{s.setState(n=>({...n,[e]:Ue(t,n[e])}))}}function Ft(e){return e instanceof Function}function Ys(e){return Array.isArray(e)&&e.every(s=>typeof s=="number")}function Zs(e,s){const t=[],n=o=>{o.forEach(i=>{t.push(i);const l=s(i);l!=null&&l.length&&n(l)})};return n(e),t}function L(e,s,t){let n=[],o;return i=>{let l;t.key&&t.debug&&(l=Date.now());const a=e(i);if(!(a.length!==n.length||a.some((u,m)=>n[m]!==u)))return o;n=a;let c;if(t.key&&t.debug&&(c=Date.now()),o=s(...a),t==null||t.onChange==null||t.onChange(o),t.key&&t.debug&&t!=null&&t.debug()){const u=Math.round((Date.now()-l)*100)/100,m=Math.round((Date.now()-c)*100)/100,f=m/16,g=(h,v)=>{for(h=String(h);h.length<v;)h=" "+h;return h};console.info(`%c⏱ ${g(m,5)} /${g(u,5)} ms`,`
            font-size: .6rem;
            font-weight: bold;
            color: hsl(${Math.max(0,Math.min(120-120*f,120))}deg 100% 31%);`,t==null?void 0:t.key)}return o}}function z(e,s,t,n){return{debug:()=>{var o;return(o=e==null?void 0:e.debugAll)!=null?o:e[s]},key:!1,onChange:n}}function Qs(e,s,t,n){const o=()=>{var l;return(l=i.getValue())!=null?l:e.options.renderFallbackValue},i={id:`${s.id}_${t.id}`,row:s,column:t,getValue:()=>s.getValue(n),renderValue:o,getContext:L(()=>[e,t,s,i],(l,a,d,c)=>({table:l,column:a,row:d,cell:c,getValue:c.getValue,renderValue:c.renderValue}),z(e.options,"debugCells"))};return e._features.forEach(l=>{l.createCell==null||l.createCell(i,t,s,e)},{}),i}function Js(e,s,t,n){var o,i;const a={...e._getDefaultColumnDef(),...s},d=a.accessorKey;let c=(o=(i=a.id)!=null?i:d?typeof String.prototype.replaceAll=="function"?d.replaceAll(".","_"):d.replace(/\./g,"_"):void 0)!=null?o:typeof a.header=="string"?a.header:void 0,u;if(a.accessorFn?u=a.accessorFn:d&&(d.includes(".")?u=f=>{let g=f;for(const v of d.split(".")){var h;g=(h=g)==null?void 0:h[v]}return g}:u=f=>f[a.accessorKey]),!c)throw new Error;let m={id:`${String(c)}`,accessorFn:u,parent:n,depth:t,columnDef:a,columns:[],getFlatColumns:L(()=>[!0],()=>{var f;return[m,...(f=m.columns)==null?void 0:f.flatMap(g=>g.getFlatColumns())]},z(e.options,"debugColumns")),getLeafColumns:L(()=>[e._getOrderColumnsFn()],f=>{var g;if((g=m.columns)!=null&&g.length){let h=m.columns.flatMap(v=>v.getLeafColumns());return f(h)}return[m]},z(e.options,"debugColumns"))};for(const f of e._features)f.createColumn==null||f.createColumn(m,e);return m}const je="debugHeaders";function bn(e,s,t){var n;let i={id:(n=t.id)!=null?n:s.id,column:s,index:t.index,isPlaceholder:!!t.isPlaceholder,placeholderId:t.placeholderId,depth:t.depth,subHeaders:[],colSpan:0,rowSpan:0,headerGroup:null,getLeafHeaders:()=>{const l=[],a=d=>{d.subHeaders&&d.subHeaders.length&&d.subHeaders.map(a),l.push(d)};return a(i),l},getContext:()=>({table:e,header:i,column:s})};return e._features.forEach(l=>{l.createHeader==null||l.createHeader(i,e)}),i}const er={createTable:e=>{e.getHeaderGroups=L(()=>[e.getAllColumns(),e.getVisibleLeafColumns(),e.getState().columnPinning.left,e.getState().columnPinning.right],(s,t,n,o)=>{var i,l;const a=(i=n==null?void 0:n.map(m=>t.find(f=>f.id===m)).filter(Boolean))!=null?i:[],d=(l=o==null?void 0:o.map(m=>t.find(f=>f.id===m)).filter(Boolean))!=null?l:[],c=t.filter(m=>!(n!=null&&n.includes(m.id))&&!(o!=null&&o.includes(m.id)));return bt(s,[...a,...c,...d],e)},z(e.options,je)),e.getCenterHeaderGroups=L(()=>[e.getAllColumns(),e.getVisibleLeafColumns(),e.getState().columnPinning.left,e.getState().columnPinning.right],(s,t,n,o)=>(t=t.filter(i=>!(n!=null&&n.includes(i.id))&&!(o!=null&&o.includes(i.id))),bt(s,t,e,"center")),z(e.options,je)),e.getLeftHeaderGroups=L(()=>[e.getAllColumns(),e.getVisibleLeafColumns(),e.getState().columnPinning.left],(s,t,n)=>{var o;const i=(o=n==null?void 0:n.map(l=>t.find(a=>a.id===l)).filter(Boolean))!=null?o:[];return bt(s,i,e,"left")},z(e.options,je)),e.getRightHeaderGroups=L(()=>[e.getAllColumns(),e.getVisibleLeafColumns(),e.getState().columnPinning.right],(s,t,n)=>{var o;const i=(o=n==null?void 0:n.map(l=>t.find(a=>a.id===l)).filter(Boolean))!=null?o:[];return bt(s,i,e,"right")},z(e.options,je)),e.getFooterGroups=L(()=>[e.getHeaderGroups()],s=>[...s].reverse(),z(e.options,je)),e.getLeftFooterGroups=L(()=>[e.getLeftHeaderGroups()],s=>[...s].reverse(),z(e.options,je)),e.getCenterFooterGroups=L(()=>[e.getCenterHeaderGroups()],s=>[...s].reverse(),z(e.options,je)),e.getRightFooterGroups=L(()=>[e.getRightHeaderGroups()],s=>[...s].reverse(),z(e.options,je)),e.getFlatHeaders=L(()=>[e.getHeaderGroups()],s=>s.map(t=>t.headers).flat(),z(e.options,je)),e.getLeftFlatHeaders=L(()=>[e.getLeftHeaderGroups()],s=>s.map(t=>t.headers).flat(),z(e.options,je)),e.getCenterFlatHeaders=L(()=>[e.getCenterHeaderGroups()],s=>s.map(t=>t.headers).flat(),z(e.options,je)),e.getRightFlatHeaders=L(()=>[e.getRightHeaderGroups()],s=>s.map(t=>t.headers).flat(),z(e.options,je)),e.getCenterLeafHeaders=L(()=>[e.getCenterFlatHeaders()],s=>s.filter(t=>{var n;return!((n=t.subHeaders)!=null&&n.length)}),z(e.options,je)),e.getLeftLeafHeaders=L(()=>[e.getLeftFlatHeaders()],s=>s.filter(t=>{var n;return!((n=t.subHeaders)!=null&&n.length)}),z(e.options,je)),e.getRightLeafHeaders=L(()=>[e.getRightFlatHeaders()],s=>s.filter(t=>{var n;return!((n=t.subHeaders)!=null&&n.length)}),z(e.options,je)),e.getLeafHeaders=L(()=>[e.getLeftHeaderGroups(),e.getCenterHeaderGroups(),e.getRightHeaderGroups()],(s,t,n)=>{var o,i,l,a,d,c;return[...(o=(i=s[0])==null?void 0:i.headers)!=null?o:[],...(l=(a=t[0])==null?void 0:a.headers)!=null?l:[],...(d=(c=n[0])==null?void 0:c.headers)!=null?d:[]].map(u=>u.getLeafHeaders()).flat()},z(e.options,je))}};function bt(e,s,t,n){var o,i;let l=0;const a=function(f,g){g===void 0&&(g=1),l=Math.max(l,g),f.filter(h=>h.getIsVisible()).forEach(h=>{var v;(v=h.columns)!=null&&v.length&&a(h.columns,g+1)},0)};a(e);let d=[];const c=(f,g)=>{const h={depth:g,id:[n,`${g}`].filter(Boolean).join("_"),headers:[]},v=[];f.forEach(S=>{const y=[...v].reverse()[0],b=S.column.depth===h.depth;let w,N=!1;if(b&&S.column.parent?w=S.column.parent:(w=S.column,N=!0),y&&(y==null?void 0:y.column)===w)y.subHeaders.push(S);else{const M=bn(t,w,{id:[n,g,w.id,S==null?void 0:S.id].filter(Boolean).join("_"),isPlaceholder:N,placeholderId:N?`${v.filter(j=>j.column===w).length}`:void 0,depth:g,index:v.length});M.subHeaders.push(S),v.push(M)}h.headers.push(S),S.headerGroup=h}),d.push(h),g>0&&c(v,g-1)},u=s.map((f,g)=>bn(t,f,{depth:l,index:g}));c(u,l-1),d.reverse();const m=f=>f.filter(h=>h.column.getIsVisible()).map(h=>{let v=0,S=0,y=[0];h.subHeaders&&h.subHeaders.length?(y=[],m(h.subHeaders).forEach(w=>{let{colSpan:N,rowSpan:M}=w;v+=N,y.push(M)})):v=1;const b=Math.min(...y);return S=S+b,h.colSpan=v,h.rowSpan=S,{colSpan:v,rowSpan:S}});return m((o=(i=d[0])==null?void 0:i.headers)!=null?o:[]),d}const tr=(e,s,t,n,o,i,l)=>{let a={id:s,index:n,original:t,depth:o,parentId:l,_valuesCache:{},_uniqueValuesCache:{},getValue:d=>{if(a._valuesCache.hasOwnProperty(d))return a._valuesCache[d];const c=e.getColumn(d);if(c!=null&&c.accessorFn)return a._valuesCache[d]=c.accessorFn(a.original,n),a._valuesCache[d]},getUniqueValues:d=>{if(a._uniqueValuesCache.hasOwnProperty(d))return a._uniqueValuesCache[d];const c=e.getColumn(d);if(c!=null&&c.accessorFn)return c.columnDef.getUniqueValues?(a._uniqueValuesCache[d]=c.columnDef.getUniqueValues(a.original,n),a._uniqueValuesCache[d]):(a._uniqueValuesCache[d]=[a.getValue(d)],a._uniqueValuesCache[d])},renderValue:d=>{var c;return(c=a.getValue(d))!=null?c:e.options.renderFallbackValue},subRows:[],getLeafRows:()=>Zs(a.subRows,d=>d.subRows),getParentRow:()=>a.parentId?e.getRow(a.parentId,!0):void 0,getParentRows:()=>{let d=[],c=a;for(;;){const u=c.getParentRow();if(!u)break;d.push(u),c=u}return d.reverse()},getAllCells:L(()=>[e.getAllLeafColumns()],d=>d.map(c=>Qs(e,a,c,c.id)),z(e.options,"debugRows")),_getAllCellsByColumnId:L(()=>[a.getAllCells()],d=>d.reduce((c,u)=>(c[u.column.id]=u,c),{}),z(e.options,"debugRows"))};for(let d=0;d<e._features.length;d++){const c=e._features[d];c==null||c.createRow==null||c.createRow(a,e)}return a},nr={createColumn:(e,s)=>{e._getFacetedRowModel=s.options.getFacetedRowModel&&s.options.getFacetedRowModel(s,e.id),e.getFacetedRowModel=()=>e._getFacetedRowModel?e._getFacetedRowModel():s.getPreFilteredRowModel(),e._getFacetedUniqueValues=s.options.getFacetedUniqueValues&&s.options.getFacetedUniqueValues(s,e.id),e.getFacetedUniqueValues=()=>e._getFacetedUniqueValues?e._getFacetedUniqueValues():new Map,e._getFacetedMinMaxValues=s.options.getFacetedMinMaxValues&&s.options.getFacetedMinMaxValues(s,e.id),e.getFacetedMinMaxValues=()=>{if(e._getFacetedMinMaxValues)return e._getFacetedMinMaxValues()}}},Ln=(e,s,t)=>{var n,o;const i=t==null||(n=t.toString())==null?void 0:n.toLowerCase();return!!(!((o=e.getValue(s))==null||(o=o.toString())==null||(o=o.toLowerCase())==null)&&o.includes(i))};Ln.autoRemove=e=>Le(e);const zn=(e,s,t)=>{var n;return!!(!((n=e.getValue(s))==null||(n=n.toString())==null)&&n.includes(t))};zn.autoRemove=e=>Le(e);const Tn=(e,s,t)=>{var n;return((n=e.getValue(s))==null||(n=n.toString())==null?void 0:n.toLowerCase())===(t==null?void 0:t.toLowerCase())};Tn.autoRemove=e=>Le(e);const Hn=(e,s,t)=>{var n;return(n=e.getValue(s))==null?void 0:n.includes(t)};Hn.autoRemove=e=>Le(e);const On=(e,s,t)=>!t.some(n=>{var o;return!((o=e.getValue(s))!=null&&o.includes(n))});On.autoRemove=e=>Le(e)||!(e!=null&&e.length);const Gn=(e,s,t)=>t.some(n=>{var o;return(o=e.getValue(s))==null?void 0:o.includes(n)});Gn.autoRemove=e=>Le(e)||!(e!=null&&e.length);const Bn=(e,s,t)=>e.getValue(s)===t;Bn.autoRemove=e=>Le(e);const Un=(e,s,t)=>e.getValue(s)==t;Un.autoRemove=e=>Le(e);const sn=(e,s,t)=>{let[n,o]=t;const i=e.getValue(s);return i>=n&&i<=o};sn.resolveFilterValue=e=>{let[s,t]=e,n=typeof s!="number"?parseFloat(s):s,o=typeof t!="number"?parseFloat(t):t,i=s===null||Number.isNaN(n)?-1/0:n,l=t===null||Number.isNaN(o)?1/0:o;if(i>l){const a=i;i=l,l=a}return[i,l]};sn.autoRemove=e=>Le(e)||Le(e[0])&&Le(e[1]);const Oe={includesString:Ln,includesStringSensitive:zn,equalsString:Tn,arrIncludes:Hn,arrIncludesAll:On,arrIncludesSome:Gn,equals:Bn,weakEquals:Un,inNumberRange:sn};function Le(e){return e==null||e===""}const sr={getDefaultColumnDef:()=>({filterFn:"auto"}),getInitialState:e=>({columnFilters:[],...e}),getDefaultOptions:e=>({onColumnFiltersChange:Ae("columnFilters",e),filterFromLeafRows:!1,maxLeafRowFilterDepth:100}),createColumn:(e,s)=>{e.getAutoFilterFn=()=>{const t=s.getCoreRowModel().flatRows[0],n=t==null?void 0:t.getValue(e.id);return typeof n=="string"?Oe.includesString:typeof n=="number"?Oe.inNumberRange:typeof n=="boolean"||n!==null&&typeof n=="object"?Oe.equals:Array.isArray(n)?Oe.arrIncludes:Oe.weakEquals},e.getFilterFn=()=>{var t,n;return Ft(e.columnDef.filterFn)?e.columnDef.filterFn:e.columnDef.filterFn==="auto"?e.getAutoFilterFn():(t=(n=s.options.filterFns)==null?void 0:n[e.columnDef.filterFn])!=null?t:Oe[e.columnDef.filterFn]},e.getCanFilter=()=>{var t,n,o;return((t=e.columnDef.enableColumnFilter)!=null?t:!0)&&((n=s.options.enableColumnFilters)!=null?n:!0)&&((o=s.options.enableFilters)!=null?o:!0)&&!!e.accessorFn},e.getIsFiltered=()=>e.getFilterIndex()>-1,e.getFilterValue=()=>{var t;return(t=s.getState().columnFilters)==null||(t=t.find(n=>n.id===e.id))==null?void 0:t.value},e.getFilterIndex=()=>{var t,n;return(t=(n=s.getState().columnFilters)==null?void 0:n.findIndex(o=>o.id===e.id))!=null?t:-1},e.setFilterValue=t=>{s.setColumnFilters(n=>{const o=e.getFilterFn(),i=n==null?void 0:n.find(u=>u.id===e.id),l=Ue(t,i?i.value:void 0);if(Cn(o,l,e)){var a;return(a=n==null?void 0:n.filter(u=>u.id!==e.id))!=null?a:[]}const d={id:e.id,value:l};if(i){var c;return(c=n==null?void 0:n.map(u=>u.id===e.id?d:u))!=null?c:[]}return n!=null&&n.length?[...n,d]:[d]})}},createRow:(e,s)=>{e.columnFilters={},e.columnFiltersMeta={}},createTable:e=>{e.setColumnFilters=s=>{const t=e.getAllLeafColumns(),n=o=>{var i;return(i=Ue(s,o))==null?void 0:i.filter(l=>{const a=t.find(d=>d.id===l.id);if(a){const d=a.getFilterFn();if(Cn(d,l.value,a))return!1}return!0})};e.options.onColumnFiltersChange==null||e.options.onColumnFiltersChange(n)},e.resetColumnFilters=s=>{var t,n;e.setColumnFilters(s?[]:(t=(n=e.initialState)==null?void 0:n.columnFilters)!=null?t:[])},e.getPreFilteredRowModel=()=>e.getCoreRowModel(),e.getFilteredRowModel=()=>(!e._getFilteredRowModel&&e.options.getFilteredRowModel&&(e._getFilteredRowModel=e.options.getFilteredRowModel(e)),e.options.manualFiltering||!e._getFilteredRowModel?e.getPreFilteredRowModel():e._getFilteredRowModel())}};function Cn(e,s,t){return(e&&e.autoRemove?e.autoRemove(s,t):!1)||typeof s>"u"||typeof s=="string"&&!s}const rr=(e,s,t)=>t.reduce((n,o)=>{const i=o.getValue(e);return n+(typeof i=="number"?i:0)},0),or=(e,s,t)=>{let n;return t.forEach(o=>{const i=o.getValue(e);i!=null&&(n>i||n===void 0&&i>=i)&&(n=i)}),n},ir=(e,s,t)=>{let n;return t.forEach(o=>{const i=o.getValue(e);i!=null&&(n<i||n===void 0&&i>=i)&&(n=i)}),n},ar=(e,s,t)=>{let n,o;return t.forEach(i=>{const l=i.getValue(e);l!=null&&(n===void 0?l>=l&&(n=o=l):(n>l&&(n=l),o<l&&(o=l)))}),[n,o]},lr=(e,s)=>{let t=0,n=0;if(s.forEach(o=>{let i=o.getValue(e);i!=null&&(i=+i)>=i&&(++t,n+=i)}),t)return n/t},dr=(e,s)=>{if(!s.length)return;const t=s.map(i=>i.getValue(e));if(!Ys(t))return;if(t.length===1)return t[0];const n=Math.floor(t.length/2),o=t.sort((i,l)=>i-l);return t.length%2!==0?o[n]:(o[n-1]+o[n])/2},ur=(e,s)=>Array.from(new Set(s.map(t=>t.getValue(e))).values()),cr=(e,s)=>new Set(s.map(t=>t.getValue(e))).size,gr=(e,s)=>s.length,Lt={sum:rr,min:or,max:ir,extent:ar,mean:lr,median:dr,unique:ur,uniqueCount:cr,count:gr},fr={getDefaultColumnDef:()=>({aggregatedCell:e=>{var s,t;return(s=(t=e.getValue())==null||t.toString==null?void 0:t.toString())!=null?s:null},aggregationFn:"auto"}),getInitialState:e=>({grouping:[],...e}),getDefaultOptions:e=>({onGroupingChange:Ae("grouping",e),groupedColumnMode:"reorder"}),createColumn:(e,s)=>{e.toggleGrouping=()=>{s.setGrouping(t=>t!=null&&t.includes(e.id)?t.filter(n=>n!==e.id):[...t??[],e.id])},e.getCanGroup=()=>{var t,n;return((t=e.columnDef.enableGrouping)!=null?t:!0)&&((n=s.options.enableGrouping)!=null?n:!0)&&(!!e.accessorFn||!!e.columnDef.getGroupingValue)},e.getIsGrouped=()=>{var t;return(t=s.getState().grouping)==null?void 0:t.includes(e.id)},e.getGroupedIndex=()=>{var t;return(t=s.getState().grouping)==null?void 0:t.indexOf(e.id)},e.getToggleGroupingHandler=()=>{const t=e.getCanGroup();return()=>{t&&e.toggleGrouping()}},e.getAutoAggregationFn=()=>{const t=s.getCoreRowModel().flatRows[0],n=t==null?void 0:t.getValue(e.id);if(typeof n=="number")return Lt.sum;if(Object.prototype.toString.call(n)==="[object Date]")return Lt.extent},e.getAggregationFn=()=>{var t,n;if(!e)throw new Error;return Ft(e.columnDef.aggregationFn)?e.columnDef.aggregationFn:e.columnDef.aggregationFn==="auto"?e.getAutoAggregationFn():(t=(n=s.options.aggregationFns)==null?void 0:n[e.columnDef.aggregationFn])!=null?t:Lt[e.columnDef.aggregationFn]}},createTable:e=>{e.setGrouping=s=>e.options.onGroupingChange==null?void 0:e.options.onGroupingChange(s),e.resetGrouping=s=>{var t,n;e.setGrouping(s?[]:(t=(n=e.initialState)==null?void 0:n.grouping)!=null?t:[])},e.getPreGroupedRowModel=()=>e.getFilteredRowModel(),e.getGroupedRowModel=()=>(!e._getGroupedRowModel&&e.options.getGroupedRowModel&&(e._getGroupedRowModel=e.options.getGroupedRowModel(e)),e.options.manualGrouping||!e._getGroupedRowModel?e.getPreGroupedRowModel():e._getGroupedRowModel())},createRow:(e,s)=>{e.getIsGrouped=()=>!!e.groupingColumnId,e.getGroupingValue=t=>{if(e._groupingValuesCache.hasOwnProperty(t))return e._groupingValuesCache[t];const n=s.getColumn(t);return n!=null&&n.columnDef.getGroupingValue?(e._groupingValuesCache[t]=n.columnDef.getGroupingValue(e.original),e._groupingValuesCache[t]):e.getValue(t)},e._groupingValuesCache={}},createCell:(e,s,t,n)=>{e.getIsGrouped=()=>s.getIsGrouped()&&s.id===t.groupingColumnId,e.getIsPlaceholder=()=>!e.getIsGrouped()&&s.getIsGrouped(),e.getIsAggregated=()=>{var o;return!e.getIsGrouped()&&!e.getIsPlaceholder()&&!!((o=t.subRows)!=null&&o.length)}}};function mr(e,s,t){if(!(s!=null&&s.length)||!t)return e;const n=e.filter(i=>!s.includes(i.id));return t==="remove"?n:[...s.map(i=>e.find(l=>l.id===i)).filter(Boolean),...n]}const pr={getInitialState:e=>({columnOrder:[],...e}),getDefaultOptions:e=>({onColumnOrderChange:Ae("columnOrder",e)}),createColumn:(e,s)=>{e.getIndex=L(t=>[mt(s,t)],t=>t.findIndex(n=>n.id===e.id),z(s.options,"debugColumns")),e.getIsFirstColumn=t=>{var n;return((n=mt(s,t)[0])==null?void 0:n.id)===e.id},e.getIsLastColumn=t=>{var n;const o=mt(s,t);return((n=o[o.length-1])==null?void 0:n.id)===e.id}},createTable:e=>{e.setColumnOrder=s=>e.options.onColumnOrderChange==null?void 0:e.options.onColumnOrderChange(s),e.resetColumnOrder=s=>{var t;e.setColumnOrder(s?[]:(t=e.initialState.columnOrder)!=null?t:[])},e._getOrderColumnsFn=L(()=>[e.getState().columnOrder,e.getState().grouping,e.options.groupedColumnMode],(s,t,n)=>o=>{let i=[];if(!(s!=null&&s.length))i=o;else{const l=[...s],a=[...o];for(;a.length&&l.length;){const d=l.shift(),c=a.findIndex(u=>u.id===d);c>-1&&i.push(a.splice(c,1)[0])}i=[...i,...a]}return mr(i,t,n)},z(e.options,"debugTable"))}},zt=()=>({left:[],right:[]}),hr={getInitialState:e=>({columnPinning:zt(),...e}),getDefaultOptions:e=>({onColumnPinningChange:Ae("columnPinning",e)}),createColumn:(e,s)=>{e.pin=t=>{const n=e.getLeafColumns().map(o=>o.id).filter(Boolean);s.setColumnPinning(o=>{var i,l;if(t==="right"){var a,d;return{left:((a=o==null?void 0:o.left)!=null?a:[]).filter(m=>!(n!=null&&n.includes(m))),right:[...((d=o==null?void 0:o.right)!=null?d:[]).filter(m=>!(n!=null&&n.includes(m))),...n]}}if(t==="left"){var c,u;return{left:[...((c=o==null?void 0:o.left)!=null?c:[]).filter(m=>!(n!=null&&n.includes(m))),...n],right:((u=o==null?void 0:o.right)!=null?u:[]).filter(m=>!(n!=null&&n.includes(m)))}}return{left:((i=o==null?void 0:o.left)!=null?i:[]).filter(m=>!(n!=null&&n.includes(m))),right:((l=o==null?void 0:o.right)!=null?l:[]).filter(m=>!(n!=null&&n.includes(m)))}})},e.getCanPin=()=>e.getLeafColumns().some(n=>{var o,i,l;return((o=n.columnDef.enablePinning)!=null?o:!0)&&((i=(l=s.options.enableColumnPinning)!=null?l:s.options.enablePinning)!=null?i:!0)}),e.getIsPinned=()=>{const t=e.getLeafColumns().map(a=>a.id),{left:n,right:o}=s.getState().columnPinning,i=t.some(a=>n==null?void 0:n.includes(a)),l=t.some(a=>o==null?void 0:o.includes(a));return i?"left":l?"right":!1},e.getPinnedIndex=()=>{var t,n;const o=e.getIsPinned();return o?(t=(n=s.getState().columnPinning)==null||(n=n[o])==null?void 0:n.indexOf(e.id))!=null?t:-1:0}},createRow:(e,s)=>{e.getCenterVisibleCells=L(()=>[e._getAllVisibleCells(),s.getState().columnPinning.left,s.getState().columnPinning.right],(t,n,o)=>{const i=[...n??[],...o??[]];return t.filter(l=>!i.includes(l.column.id))},z(s.options,"debugRows")),e.getLeftVisibleCells=L(()=>[e._getAllVisibleCells(),s.getState().columnPinning.left],(t,n)=>(n??[]).map(i=>t.find(l=>l.column.id===i)).filter(Boolean).map(i=>({...i,position:"left"})),z(s.options,"debugRows")),e.getRightVisibleCells=L(()=>[e._getAllVisibleCells(),s.getState().columnPinning.right],(t,n)=>(n??[]).map(i=>t.find(l=>l.column.id===i)).filter(Boolean).map(i=>({...i,position:"right"})),z(s.options,"debugRows"))},createTable:e=>{e.setColumnPinning=s=>e.options.onColumnPinningChange==null?void 0:e.options.onColumnPinningChange(s),e.resetColumnPinning=s=>{var t,n;return e.setColumnPinning(s?zt():(t=(n=e.initialState)==null?void 0:n.columnPinning)!=null?t:zt())},e.getIsSomeColumnsPinned=s=>{var t;const n=e.getState().columnPinning;if(!s){var o,i;return!!((o=n.left)!=null&&o.length||(i=n.right)!=null&&i.length)}return!!((t=n[s])!=null&&t.length)},e.getLeftLeafColumns=L(()=>[e.getAllLeafColumns(),e.getState().columnPinning.left],(s,t)=>(t??[]).map(n=>s.find(o=>o.id===n)).filter(Boolean),z(e.options,"debugColumns")),e.getRightLeafColumns=L(()=>[e.getAllLeafColumns(),e.getState().columnPinning.right],(s,t)=>(t??[]).map(n=>s.find(o=>o.id===n)).filter(Boolean),z(e.options,"debugColumns")),e.getCenterLeafColumns=L(()=>[e.getAllLeafColumns(),e.getState().columnPinning.left,e.getState().columnPinning.right],(s,t,n)=>{const o=[...t??[],...n??[]];return s.filter(i=>!o.includes(i.id))},z(e.options,"debugColumns"))}};function xr(e){return e||(typeof document<"u"?document:null)}const Ct={size:150,minSize:20,maxSize:Number.MAX_SAFE_INTEGER},Tt=()=>({startOffset:null,startSize:null,deltaOffset:null,deltaPercentage:null,isResizingColumn:!1,columnSizingStart:[]}),vr={getDefaultColumnDef:()=>Ct,getInitialState:e=>({columnSizing:{},columnSizingInfo:Tt(),...e}),getDefaultOptions:e=>({columnResizeMode:"onEnd",columnResizeDirection:"ltr",onColumnSizingChange:Ae("columnSizing",e),onColumnSizingInfoChange:Ae("columnSizingInfo",e)}),createColumn:(e,s)=>{e.getSize=()=>{var t,n,o;const i=s.getState().columnSizing[e.id];return Math.min(Math.max((t=e.columnDef.minSize)!=null?t:Ct.minSize,(n=i??e.columnDef.size)!=null?n:Ct.size),(o=e.columnDef.maxSize)!=null?o:Ct.maxSize)},e.getStart=L(t=>[t,mt(s,t),s.getState().columnSizing],(t,n)=>n.slice(0,e.getIndex(t)).reduce((o,i)=>o+i.getSize(),0),z(s.options,"debugColumns")),e.getAfter=L(t=>[t,mt(s,t),s.getState().columnSizing],(t,n)=>n.slice(e.getIndex(t)+1).reduce((o,i)=>o+i.getSize(),0),z(s.options,"debugColumns")),e.resetSize=()=>{s.setColumnSizing(t=>{let{[e.id]:n,...o}=t;return o})},e.getCanResize=()=>{var t,n;return((t=e.columnDef.enableResizing)!=null?t:!0)&&((n=s.options.enableColumnResizing)!=null?n:!0)},e.getIsResizing=()=>s.getState().columnSizingInfo.isResizingColumn===e.id},createHeader:(e,s)=>{e.getSize=()=>{let t=0;const n=o=>{if(o.subHeaders.length)o.subHeaders.forEach(n);else{var i;t+=(i=o.column.getSize())!=null?i:0}};return n(e),t},e.getStart=()=>{if(e.index>0){const t=e.headerGroup.headers[e.index-1];return t.getStart()+t.getSize()}return 0},e.getResizeHandler=t=>{const n=s.getColumn(e.column.id),o=n==null?void 0:n.getCanResize();return i=>{if(!n||!o||(i.persist==null||i.persist(),Ht(i)&&i.touches&&i.touches.length>1))return;const l=e.getSize(),a=e?e.getLeafHeaders().map(y=>[y.column.id,y.column.getSize()]):[[n.id,n.getSize()]],d=Ht(i)?Math.round(i.touches[0].clientX):i.clientX,c={},u=(y,b)=>{typeof b=="number"&&(s.setColumnSizingInfo(w=>{var N,M;const j=s.options.columnResizeDirection==="rtl"?-1:1,P=(b-((N=w==null?void 0:w.startOffset)!=null?N:0))*j,_=Math.max(P/((M=w==null?void 0:w.startSize)!=null?M:0),-.999999);return w.columnSizingStart.forEach(I=>{let[q,E]=I;c[q]=Math.round(Math.max(E+E*_,0)*100)/100}),{...w,deltaOffset:P,deltaPercentage:_}}),(s.options.columnResizeMode==="onChange"||y==="end")&&s.setColumnSizing(w=>({...w,...c})))},m=y=>u("move",y),f=y=>{u("end",y),s.setColumnSizingInfo(b=>({...b,isResizingColumn:!1,startOffset:null,startSize:null,deltaOffset:null,deltaPercentage:null,columnSizingStart:[]}))},g=xr(t),h={moveHandler:y=>m(y.clientX),upHandler:y=>{g==null||g.removeEventListener("mousemove",h.moveHandler),g==null||g.removeEventListener("mouseup",h.upHandler),f(y.clientX)}},v={moveHandler:y=>(y.cancelable&&(y.preventDefault(),y.stopPropagation()),m(y.touches[0].clientX),!1),upHandler:y=>{var b;g==null||g.removeEventListener("touchmove",v.moveHandler),g==null||g.removeEventListener("touchend",v.upHandler),y.cancelable&&(y.preventDefault(),y.stopPropagation()),f((b=y.touches[0])==null?void 0:b.clientX)}},S=yr()?{passive:!1}:!1;Ht(i)?(g==null||g.addEventListener("touchmove",v.moveHandler,S),g==null||g.addEventListener("touchend",v.upHandler,S)):(g==null||g.addEventListener("mousemove",h.moveHandler,S),g==null||g.addEventListener("mouseup",h.upHandler,S)),s.setColumnSizingInfo(y=>({...y,startOffset:d,startSize:l,deltaOffset:0,deltaPercentage:0,columnSizingStart:a,isResizingColumn:n.id}))}}},createTable:e=>{e.setColumnSizing=s=>e.options.onColumnSizingChange==null?void 0:e.options.onColumnSizingChange(s),e.setColumnSizingInfo=s=>e.options.onColumnSizingInfoChange==null?void 0:e.options.onColumnSizingInfoChange(s),e.resetColumnSizing=s=>{var t;e.setColumnSizing(s?{}:(t=e.initialState.columnSizing)!=null?t:{})},e.resetHeaderSizeInfo=s=>{var t;e.setColumnSizingInfo(s?Tt():(t=e.initialState.columnSizingInfo)!=null?t:Tt())},e.getTotalSize=()=>{var s,t;return(s=(t=e.getHeaderGroups()[0])==null?void 0:t.headers.reduce((n,o)=>n+o.getSize(),0))!=null?s:0},e.getLeftTotalSize=()=>{var s,t;return(s=(t=e.getLeftHeaderGroups()[0])==null?void 0:t.headers.reduce((n,o)=>n+o.getSize(),0))!=null?s:0},e.getCenterTotalSize=()=>{var s,t;return(s=(t=e.getCenterHeaderGroups()[0])==null?void 0:t.headers.reduce((n,o)=>n+o.getSize(),0))!=null?s:0},e.getRightTotalSize=()=>{var s,t;return(s=(t=e.getRightHeaderGroups()[0])==null?void 0:t.headers.reduce((n,o)=>n+o.getSize(),0))!=null?s:0}}};let jt=null;function yr(){if(typeof jt=="boolean")return jt;let e=!1;try{const s={get passive(){return e=!0,!1}},t=()=>{};window.addEventListener("test",t,s),window.removeEventListener("test",t)}catch{e=!1}return jt=e,jt}function Ht(e){return e.type==="touchstart"}const wr={getInitialState:e=>({columnVisibility:{},...e}),getDefaultOptions:e=>({onColumnVisibilityChange:Ae("columnVisibility",e)}),createColumn:(e,s)=>{e.toggleVisibility=t=>{e.getCanHide()&&s.setColumnVisibility(n=>({...n,[e.id]:t??!e.getIsVisible()}))},e.getIsVisible=()=>{var t,n;const o=e.columns;return(t=o.length?o.some(i=>i.getIsVisible()):(n=s.getState().columnVisibility)==null?void 0:n[e.id])!=null?t:!0},e.getCanHide=()=>{var t,n;return((t=e.columnDef.enableHiding)!=null?t:!0)&&((n=s.options.enableHiding)!=null?n:!0)},e.getToggleVisibilityHandler=()=>t=>{e.toggleVisibility==null||e.toggleVisibility(t.target.checked)}},createRow:(e,s)=>{e._getAllVisibleCells=L(()=>[e.getAllCells(),s.getState().columnVisibility],t=>t.filter(n=>n.column.getIsVisible()),z(s.options,"debugRows")),e.getVisibleCells=L(()=>[e.getLeftVisibleCells(),e.getCenterVisibleCells(),e.getRightVisibleCells()],(t,n,o)=>[...t,...n,...o],z(s.options,"debugRows"))},createTable:e=>{const s=(t,n)=>L(()=>[n(),n().filter(o=>o.getIsVisible()).map(o=>o.id).join("_")],o=>o.filter(i=>i.getIsVisible==null?void 0:i.getIsVisible()),z(e.options,"debugColumns"));e.getVisibleFlatColumns=s("getVisibleFlatColumns",()=>e.getAllFlatColumns()),e.getVisibleLeafColumns=s("getVisibleLeafColumns",()=>e.getAllLeafColumns()),e.getLeftVisibleLeafColumns=s("getLeftVisibleLeafColumns",()=>e.getLeftLeafColumns()),e.getRightVisibleLeafColumns=s("getRightVisibleLeafColumns",()=>e.getRightLeafColumns()),e.getCenterVisibleLeafColumns=s("getCenterVisibleLeafColumns",()=>e.getCenterLeafColumns()),e.setColumnVisibility=t=>e.options.onColumnVisibilityChange==null?void 0:e.options.onColumnVisibilityChange(t),e.resetColumnVisibility=t=>{var n;e.setColumnVisibility(t?{}:(n=e.initialState.columnVisibility)!=null?n:{})},e.toggleAllColumnsVisible=t=>{var n;t=(n=t)!=null?n:!e.getIsAllColumnsVisible(),e.setColumnVisibility(e.getAllLeafColumns().reduce((o,i)=>({...o,[i.id]:t||!(i.getCanHide!=null&&i.getCanHide())}),{}))},e.getIsAllColumnsVisible=()=>!e.getAllLeafColumns().some(t=>!(t.getIsVisible!=null&&t.getIsVisible())),e.getIsSomeColumnsVisible=()=>e.getAllLeafColumns().some(t=>t.getIsVisible==null?void 0:t.getIsVisible()),e.getToggleAllColumnsVisibilityHandler=()=>t=>{var n;e.toggleAllColumnsVisible((n=t.target)==null?void 0:n.checked)}}};function mt(e,s){return s?s==="center"?e.getCenterVisibleLeafColumns():s==="left"?e.getLeftVisibleLeafColumns():e.getRightVisibleLeafColumns():e.getVisibleLeafColumns()}const Sr={createTable:e=>{e._getGlobalFacetedRowModel=e.options.getFacetedRowModel&&e.options.getFacetedRowModel(e,"__global__"),e.getGlobalFacetedRowModel=()=>e.options.manualFiltering||!e._getGlobalFacetedRowModel?e.getPreFilteredRowModel():e._getGlobalFacetedRowModel(),e._getGlobalFacetedUniqueValues=e.options.getFacetedUniqueValues&&e.options.getFacetedUniqueValues(e,"__global__"),e.getGlobalFacetedUniqueValues=()=>e._getGlobalFacetedUniqueValues?e._getGlobalFacetedUniqueValues():new Map,e._getGlobalFacetedMinMaxValues=e.options.getFacetedMinMaxValues&&e.options.getFacetedMinMaxValues(e,"__global__"),e.getGlobalFacetedMinMaxValues=()=>{if(e._getGlobalFacetedMinMaxValues)return e._getGlobalFacetedMinMaxValues()}}},br={getInitialState:e=>({globalFilter:void 0,...e}),getDefaultOptions:e=>({onGlobalFilterChange:Ae("globalFilter",e),globalFilterFn:"auto",getColumnCanGlobalFilter:s=>{var t;const n=(t=e.getCoreRowModel().flatRows[0])==null||(t=t._getAllCellsByColumnId()[s.id])==null?void 0:t.getValue();return typeof n=="string"||typeof n=="number"}}),createColumn:(e,s)=>{e.getCanGlobalFilter=()=>{var t,n,o,i;return((t=e.columnDef.enableGlobalFilter)!=null?t:!0)&&((n=s.options.enableGlobalFilter)!=null?n:!0)&&((o=s.options.enableFilters)!=null?o:!0)&&((i=s.options.getColumnCanGlobalFilter==null?void 0:s.options.getColumnCanGlobalFilter(e))!=null?i:!0)&&!!e.accessorFn}},createTable:e=>{e.getGlobalAutoFilterFn=()=>Oe.includesString,e.getGlobalFilterFn=()=>{var s,t;const{globalFilterFn:n}=e.options;return Ft(n)?n:n==="auto"?e.getGlobalAutoFilterFn():(s=(t=e.options.filterFns)==null?void 0:t[n])!=null?s:Oe[n]},e.setGlobalFilter=s=>{e.options.onGlobalFilterChange==null||e.options.onGlobalFilterChange(s)},e.resetGlobalFilter=s=>{e.setGlobalFilter(s?void 0:e.initialState.globalFilter)}}},Cr={getInitialState:e=>({expanded:{},...e}),getDefaultOptions:e=>({onExpandedChange:Ae("expanded",e),paginateExpandedRows:!0}),createTable:e=>{let s=!1,t=!1;e._autoResetExpanded=()=>{var n,o;if(!s){e._queue(()=>{s=!0});return}if((n=(o=e.options.autoResetAll)!=null?o:e.options.autoResetExpanded)!=null?n:!e.options.manualExpanding){if(t)return;t=!0,e._queue(()=>{e.resetExpanded(),t=!1})}},e.setExpanded=n=>e.options.onExpandedChange==null?void 0:e.options.onExpandedChange(n),e.toggleAllRowsExpanded=n=>{n??!e.getIsAllRowsExpanded()?e.setExpanded(!0):e.setExpanded({})},e.resetExpanded=n=>{var o,i;e.setExpanded(n?{}:(o=(i=e.initialState)==null?void 0:i.expanded)!=null?o:{})},e.getCanSomeRowsExpand=()=>e.getPrePaginationRowModel().flatRows.some(n=>n.getCanExpand()),e.getToggleAllRowsExpandedHandler=()=>n=>{n.persist==null||n.persist(),e.toggleAllRowsExpanded()},e.getIsSomeRowsExpanded=()=>{const n=e.getState().expanded;return n===!0||Object.values(n).some(Boolean)},e.getIsAllRowsExpanded=()=>{const n=e.getState().expanded;return typeof n=="boolean"?n===!0:!(!Object.keys(n).length||e.getRowModel().flatRows.some(o=>!o.getIsExpanded()))},e.getExpandedDepth=()=>{let n=0;return(e.getState().expanded===!0?Object.keys(e.getRowModel().rowsById):Object.keys(e.getState().expanded)).forEach(i=>{const l=i.split(".");n=Math.max(n,l.length)}),n},e.getPreExpandedRowModel=()=>e.getSortedRowModel(),e.getExpandedRowModel=()=>(!e._getExpandedRowModel&&e.options.getExpandedRowModel&&(e._getExpandedRowModel=e.options.getExpandedRowModel(e)),e.options.manualExpanding||!e._getExpandedRowModel?e.getPreExpandedRowModel():e._getExpandedRowModel())},createRow:(e,s)=>{e.toggleExpanded=t=>{s.setExpanded(n=>{var o;const i=n===!0?!0:!!(n!=null&&n[e.id]);let l={};if(n===!0?Object.keys(s.getRowModel().rowsById).forEach(a=>{l[a]=!0}):l=n,t=(o=t)!=null?o:!i,!i&&t)return{...l,[e.id]:!0};if(i&&!t){const{[e.id]:a,...d}=l;return d}return n})},e.getIsExpanded=()=>{var t;const n=s.getState().expanded;return!!((t=s.options.getIsRowExpanded==null?void 0:s.options.getIsRowExpanded(e))!=null?t:n===!0||n!=null&&n[e.id])},e.getCanExpand=()=>{var t,n,o;return(t=s.options.getRowCanExpand==null?void 0:s.options.getRowCanExpand(e))!=null?t:((n=s.options.enableExpanding)!=null?n:!0)&&!!((o=e.subRows)!=null&&o.length)},e.getIsAllParentsExpanded=()=>{let t=!0,n=e;for(;t&&n.parentId;)n=s.getRow(n.parentId,!0),t=n.getIsExpanded();return t},e.getToggleExpandedHandler=()=>{const t=e.getCanExpand();return()=>{t&&e.toggleExpanded()}}}},Kt=0,Yt=10,Ot=()=>({pageIndex:Kt,pageSize:Yt}),jr={getInitialState:e=>({...e,pagination:{...Ot(),...e==null?void 0:e.pagination}}),getDefaultOptions:e=>({onPaginationChange:Ae("pagination",e)}),createTable:e=>{let s=!1,t=!1;e._autoResetPageIndex=()=>{var n,o;if(!s){e._queue(()=>{s=!0});return}if((n=(o=e.options.autoResetAll)!=null?o:e.options.autoResetPageIndex)!=null?n:!e.options.manualPagination){if(t)return;t=!0,e._queue(()=>{e.resetPageIndex(),t=!1})}},e.setPagination=n=>{const o=i=>Ue(n,i);return e.options.onPaginationChange==null?void 0:e.options.onPaginationChange(o)},e.resetPagination=n=>{var o;e.setPagination(n?Ot():(o=e.initialState.pagination)!=null?o:Ot())},e.setPageIndex=n=>{e.setPagination(o=>{let i=Ue(n,o.pageIndex);const l=typeof e.options.pageCount>"u"||e.options.pageCount===-1?Number.MAX_SAFE_INTEGER:e.options.pageCount-1;return i=Math.max(0,Math.min(i,l)),{...o,pageIndex:i}})},e.resetPageIndex=n=>{var o,i;e.setPageIndex(n?Kt:(o=(i=e.initialState)==null||(i=i.pagination)==null?void 0:i.pageIndex)!=null?o:Kt)},e.resetPageSize=n=>{var o,i;e.setPageSize(n?Yt:(o=(i=e.initialState)==null||(i=i.pagination)==null?void 0:i.pageSize)!=null?o:Yt)},e.setPageSize=n=>{e.setPagination(o=>{const i=Math.max(1,Ue(n,o.pageSize)),l=o.pageSize*o.pageIndex,a=Math.floor(l/i);return{...o,pageIndex:a,pageSize:i}})},e.setPageCount=n=>e.setPagination(o=>{var i;let l=Ue(n,(i=e.options.pageCount)!=null?i:-1);return typeof l=="number"&&(l=Math.max(-1,l)),{...o,pageCount:l}}),e.getPageOptions=L(()=>[e.getPageCount()],n=>{let o=[];return n&&n>0&&(o=[...new Array(n)].fill(null).map((i,l)=>l)),o},z(e.options,"debugTable")),e.getCanPreviousPage=()=>e.getState().pagination.pageIndex>0,e.getCanNextPage=()=>{const{pageIndex:n}=e.getState().pagination,o=e.getPageCount();return o===-1?!0:o===0?!1:n<o-1},e.previousPage=()=>e.setPageIndex(n=>n-1),e.nextPage=()=>e.setPageIndex(n=>n+1),e.firstPage=()=>e.setPageIndex(0),e.lastPage=()=>e.setPageIndex(e.getPageCount()-1),e.getPrePaginationRowModel=()=>e.getExpandedRowModel(),e.getPaginationRowModel=()=>(!e._getPaginationRowModel&&e.options.getPaginationRowModel&&(e._getPaginationRowModel=e.options.getPaginationRowModel(e)),e.options.manualPagination||!e._getPaginationRowModel?e.getPrePaginationRowModel():e._getPaginationRowModel()),e.getPageCount=()=>{var n;return(n=e.options.pageCount)!=null?n:Math.ceil(e.getRowCount()/e.getState().pagination.pageSize)},e.getRowCount=()=>{var n;return(n=e.options.rowCount)!=null?n:e.getPrePaginationRowModel().rows.length}}},Gt=()=>({top:[],bottom:[]}),Nr={getInitialState:e=>({rowPinning:Gt(),...e}),getDefaultOptions:e=>({onRowPinningChange:Ae("rowPinning",e)}),createRow:(e,s)=>{e.pin=(t,n,o)=>{const i=n?e.getLeafRows().map(d=>{let{id:c}=d;return c}):[],l=o?e.getParentRows().map(d=>{let{id:c}=d;return c}):[],a=new Set([...l,e.id,...i]);s.setRowPinning(d=>{var c,u;if(t==="bottom"){var m,f;return{top:((m=d==null?void 0:d.top)!=null?m:[]).filter(v=>!(a!=null&&a.has(v))),bottom:[...((f=d==null?void 0:d.bottom)!=null?f:[]).filter(v=>!(a!=null&&a.has(v))),...Array.from(a)]}}if(t==="top"){var g,h;return{top:[...((g=d==null?void 0:d.top)!=null?g:[]).filter(v=>!(a!=null&&a.has(v))),...Array.from(a)],bottom:((h=d==null?void 0:d.bottom)!=null?h:[]).filter(v=>!(a!=null&&a.has(v)))}}return{top:((c=d==null?void 0:d.top)!=null?c:[]).filter(v=>!(a!=null&&a.has(v))),bottom:((u=d==null?void 0:d.bottom)!=null?u:[]).filter(v=>!(a!=null&&a.has(v)))}})},e.getCanPin=()=>{var t;const{enableRowPinning:n,enablePinning:o}=s.options;return typeof n=="function"?n(e):(t=n??o)!=null?t:!0},e.getIsPinned=()=>{const t=[e.id],{top:n,bottom:o}=s.getState().rowPinning,i=t.some(a=>n==null?void 0:n.includes(a)),l=t.some(a=>o==null?void 0:o.includes(a));return i?"top":l?"bottom":!1},e.getPinnedIndex=()=>{var t,n;const o=e.getIsPinned();if(!o)return-1;const i=(t=o==="top"?s.getTopRows():s.getBottomRows())==null?void 0:t.map(l=>{let{id:a}=l;return a});return(n=i==null?void 0:i.indexOf(e.id))!=null?n:-1}},createTable:e=>{e.setRowPinning=s=>e.options.onRowPinningChange==null?void 0:e.options.onRowPinningChange(s),e.resetRowPinning=s=>{var t,n;return e.setRowPinning(s?Gt():(t=(n=e.initialState)==null?void 0:n.rowPinning)!=null?t:Gt())},e.getIsSomeRowsPinned=s=>{var t;const n=e.getState().rowPinning;if(!s){var o,i;return!!((o=n.top)!=null&&o.length||(i=n.bottom)!=null&&i.length)}return!!((t=n[s])!=null&&t.length)},e._getPinnedRows=(s,t,n)=>{var o;return((o=e.options.keepPinnedRows)==null||o?(t??[]).map(l=>{const a=e.getRow(l,!0);return a.getIsAllParentsExpanded()?a:null}):(t??[]).map(l=>s.find(a=>a.id===l))).filter(Boolean).map(l=>({...l,position:n}))},e.getTopRows=L(()=>[e.getRowModel().rows,e.getState().rowPinning.top],(s,t)=>e._getPinnedRows(s,t,"top"),z(e.options,"debugRows")),e.getBottomRows=L(()=>[e.getRowModel().rows,e.getState().rowPinning.bottom],(s,t)=>e._getPinnedRows(s,t,"bottom"),z(e.options,"debugRows")),e.getCenterRows=L(()=>[e.getRowModel().rows,e.getState().rowPinning.top,e.getState().rowPinning.bottom],(s,t,n)=>{const o=new Set([...t??[],...n??[]]);return s.filter(i=>!o.has(i.id))},z(e.options,"debugRows"))}},Rr={getInitialState:e=>({rowSelection:{},...e}),getDefaultOptions:e=>({onRowSelectionChange:Ae("rowSelection",e),enableRowSelection:!0,enableMultiRowSelection:!0,enableSubRowSelection:!0}),createTable:e=>{e.setRowSelection=s=>e.options.onRowSelectionChange==null?void 0:e.options.onRowSelectionChange(s),e.resetRowSelection=s=>{var t;return e.setRowSelection(s?{}:(t=e.initialState.rowSelection)!=null?t:{})},e.toggleAllRowsSelected=s=>{e.setRowSelection(t=>{s=typeof s<"u"?s:!e.getIsAllRowsSelected();const n={...t},o=e.getPreGroupedRowModel().flatRows;return s?o.forEach(i=>{i.getCanSelect()&&(n[i.id]=!0)}):o.forEach(i=>{delete n[i.id]}),n})},e.toggleAllPageRowsSelected=s=>e.setRowSelection(t=>{const n=typeof s<"u"?s:!e.getIsAllPageRowsSelected(),o={...t};return e.getRowModel().rows.forEach(i=>{Zt(o,i.id,n,!0,e)}),o}),e.getPreSelectedRowModel=()=>e.getCoreRowModel(),e.getSelectedRowModel=L(()=>[e.getState().rowSelection,e.getCoreRowModel()],(s,t)=>Object.keys(s).length?Bt(e,t):{rows:[],flatRows:[],rowsById:{}},z(e.options,"debugTable")),e.getFilteredSelectedRowModel=L(()=>[e.getState().rowSelection,e.getFilteredRowModel()],(s,t)=>Object.keys(s).length?Bt(e,t):{rows:[],flatRows:[],rowsById:{}},z(e.options,"debugTable")),e.getGroupedSelectedRowModel=L(()=>[e.getState().rowSelection,e.getSortedRowModel()],(s,t)=>Object.keys(s).length?Bt(e,t):{rows:[],flatRows:[],rowsById:{}},z(e.options,"debugTable")),e.getIsAllRowsSelected=()=>{const s=e.getFilteredRowModel().flatRows,{rowSelection:t}=e.getState();let n=!!(s.length&&Object.keys(t).length);return n&&s.some(o=>o.getCanSelect()&&!t[o.id])&&(n=!1),n},e.getIsAllPageRowsSelected=()=>{const s=e.getPaginationRowModel().flatRows.filter(o=>o.getCanSelect()),{rowSelection:t}=e.getState();let n=!!s.length;return n&&s.some(o=>!t[o.id])&&(n=!1),n},e.getIsSomeRowsSelected=()=>{var s;const t=Object.keys((s=e.getState().rowSelection)!=null?s:{}).length;return t>0&&t<e.getFilteredRowModel().flatRows.length},e.getIsSomePageRowsSelected=()=>{const s=e.getPaginationRowModel().flatRows;return e.getIsAllPageRowsSelected()?!1:s.filter(t=>t.getCanSelect()).some(t=>t.getIsSelected()||t.getIsSomeSelected())},e.getToggleAllRowsSelectedHandler=()=>s=>{e.toggleAllRowsSelected(s.target.checked)},e.getToggleAllPageRowsSelectedHandler=()=>s=>{e.toggleAllPageRowsSelected(s.target.checked)}},createRow:(e,s)=>{e.toggleSelected=(t,n)=>{const o=e.getIsSelected();s.setRowSelection(i=>{var l;if(t=typeof t<"u"?t:!o,e.getCanSelect()&&o===t)return i;const a={...i};return Zt(a,e.id,t,(l=n==null?void 0:n.selectChildren)!=null?l:!0,s),a})},e.getIsSelected=()=>{const{rowSelection:t}=s.getState();return rn(e,t)},e.getIsSomeSelected=()=>{const{rowSelection:t}=s.getState();return Qt(e,t)==="some"},e.getIsAllSubRowsSelected=()=>{const{rowSelection:t}=s.getState();return Qt(e,t)==="all"},e.getCanSelect=()=>{var t;return typeof s.options.enableRowSelection=="function"?s.options.enableRowSelection(e):(t=s.options.enableRowSelection)!=null?t:!0},e.getCanSelectSubRows=()=>{var t;return typeof s.options.enableSubRowSelection=="function"?s.options.enableSubRowSelection(e):(t=s.options.enableSubRowSelection)!=null?t:!0},e.getCanMultiSelect=()=>{var t;return typeof s.options.enableMultiRowSelection=="function"?s.options.enableMultiRowSelection(e):(t=s.options.enableMultiRowSelection)!=null?t:!0},e.getToggleSelectedHandler=()=>{const t=e.getCanSelect();return n=>{var o;t&&e.toggleSelected((o=n.target)==null?void 0:o.checked)}}}},Zt=(e,s,t,n,o)=>{var i;const l=o.getRow(s,!0);t?(l.getCanMultiSelect()||Object.keys(e).forEach(a=>delete e[a]),l.getCanSelect()&&(e[s]=!0)):delete e[s],n&&(i=l.subRows)!=null&&i.length&&l.getCanSelectSubRows()&&l.subRows.forEach(a=>Zt(e,a.id,t,n,o))};function Bt(e,s){const t=e.getState().rowSelection,n=[],o={},i=function(l,a){return l.map(d=>{var c;const u=rn(d,t);if(u&&(n.push(d),o[d.id]=d),(c=d.subRows)!=null&&c.length&&(d={...d,subRows:i(d.subRows)}),u)return d}).filter(Boolean)};return{rows:i(s.rows),flatRows:n,rowsById:o}}function rn(e,s){var t;return(t=s[e.id])!=null?t:!1}function Qt(e,s,t){var n;if(!((n=e.subRows)!=null&&n.length))return!1;let o=!0,i=!1;return e.subRows.forEach(l=>{if(!(i&&!o)&&(l.getCanSelect()&&(rn(l,s)?i=!0:o=!1),l.subRows&&l.subRows.length)){const a=Qt(l,s);a==="all"?i=!0:(a==="some"&&(i=!0),o=!1)}}),o?"all":i?"some":!1}const Jt=/([0-9]+)/gm,Fr=(e,s,t)=>qn(qe(e.getValue(t)).toLowerCase(),qe(s.getValue(t)).toLowerCase()),$r=(e,s,t)=>qn(qe(e.getValue(t)),qe(s.getValue(t))),Mr=(e,s,t)=>on(qe(e.getValue(t)).toLowerCase(),qe(s.getValue(t)).toLowerCase()),_r=(e,s,t)=>on(qe(e.getValue(t)),qe(s.getValue(t))),Ir=(e,s,t)=>{const n=e.getValue(t),o=s.getValue(t);return n>o?1:n<o?-1:0},Er=(e,s,t)=>on(e.getValue(t),s.getValue(t));function on(e,s){return e===s?0:e>s?1:-1}function qe(e){return typeof e=="number"?isNaN(e)||e===1/0||e===-1/0?"":String(e):typeof e=="string"?e:""}function qn(e,s){const t=e.split(Jt).filter(Boolean),n=s.split(Jt).filter(Boolean);for(;t.length&&n.length;){const o=t.shift(),i=n.shift(),l=parseInt(o,10),a=parseInt(i,10),d=[l,a].sort();if(isNaN(d[0])){if(o>i)return 1;if(i>o)return-1;continue}if(isNaN(d[1]))return isNaN(l)?-1:1;if(l>a)return 1;if(a>l)return-1}return t.length-n.length}const gt={alphanumeric:Fr,alphanumericCaseSensitive:$r,text:Mr,textCaseSensitive:_r,datetime:Ir,basic:Er},Pr={getInitialState:e=>({sorting:[],...e}),getDefaultColumnDef:()=>({sortingFn:"auto",sortUndefined:1}),getDefaultOptions:e=>({onSortingChange:Ae("sorting",e),isMultiSortEvent:s=>s.shiftKey}),createColumn:(e,s)=>{e.getAutoSortingFn=()=>{const t=s.getFilteredRowModel().flatRows.slice(10);let n=!1;for(const o of t){const i=o==null?void 0:o.getValue(e.id);if(Object.prototype.toString.call(i)==="[object Date]")return gt.datetime;if(typeof i=="string"&&(n=!0,i.split(Jt).length>1))return gt.alphanumeric}return n?gt.text:gt.basic},e.getAutoSortDir=()=>{const t=s.getFilteredRowModel().flatRows[0];return typeof(t==null?void 0:t.getValue(e.id))=="string"?"asc":"desc"},e.getSortingFn=()=>{var t,n;if(!e)throw new Error;return Ft(e.columnDef.sortingFn)?e.columnDef.sortingFn:e.columnDef.sortingFn==="auto"?e.getAutoSortingFn():(t=(n=s.options.sortingFns)==null?void 0:n[e.columnDef.sortingFn])!=null?t:gt[e.columnDef.sortingFn]},e.toggleSorting=(t,n)=>{const o=e.getNextSortingOrder(),i=typeof t<"u"&&t!==null;s.setSorting(l=>{const a=l==null?void 0:l.find(g=>g.id===e.id),d=l==null?void 0:l.findIndex(g=>g.id===e.id);let c=[],u,m=i?t:o==="desc";if(l!=null&&l.length&&e.getCanMultiSort()&&n?a?u="toggle":u="add":l!=null&&l.length&&d!==l.length-1?u="replace":a?u="toggle":u="replace",u==="toggle"&&(i||o||(u="remove")),u==="add"){var f;c=[...l,{id:e.id,desc:m}],c.splice(0,c.length-((f=s.options.maxMultiSortColCount)!=null?f:Number.MAX_SAFE_INTEGER))}else u==="toggle"?c=l.map(g=>g.id===e.id?{...g,desc:m}:g):u==="remove"?c=l.filter(g=>g.id!==e.id):c=[{id:e.id,desc:m}];return c})},e.getFirstSortDir=()=>{var t,n;return((t=(n=e.columnDef.sortDescFirst)!=null?n:s.options.sortDescFirst)!=null?t:e.getAutoSortDir()==="desc")?"desc":"asc"},e.getNextSortingOrder=t=>{var n,o;const i=e.getFirstSortDir(),l=e.getIsSorted();return l?l!==i&&((n=s.options.enableSortingRemoval)==null||n)&&(!(t&&(o=s.options.enableMultiRemove)!=null)||o)?!1:l==="desc"?"asc":"desc":i},e.getCanSort=()=>{var t,n;return((t=e.columnDef.enableSorting)!=null?t:!0)&&((n=s.options.enableSorting)!=null?n:!0)&&!!e.accessorFn},e.getCanMultiSort=()=>{var t,n;return(t=(n=e.columnDef.enableMultiSort)!=null?n:s.options.enableMultiSort)!=null?t:!!e.accessorFn},e.getIsSorted=()=>{var t;const n=(t=s.getState().sorting)==null?void 0:t.find(o=>o.id===e.id);return n?n.desc?"desc":"asc":!1},e.getSortIndex=()=>{var t,n;return(t=(n=s.getState().sorting)==null?void 0:n.findIndex(o=>o.id===e.id))!=null?t:-1},e.clearSorting=()=>{s.setSorting(t=>t!=null&&t.length?t.filter(n=>n.id!==e.id):[])},e.getToggleSortingHandler=()=>{const t=e.getCanSort();return n=>{t&&(n.persist==null||n.persist(),e.toggleSorting==null||e.toggleSorting(void 0,e.getCanMultiSort()?s.options.isMultiSortEvent==null?void 0:s.options.isMultiSortEvent(n):!1))}}},createTable:e=>{e.setSorting=s=>e.options.onSortingChange==null?void 0:e.options.onSortingChange(s),e.resetSorting=s=>{var t,n;e.setSorting(s?[]:(t=(n=e.initialState)==null?void 0:n.sorting)!=null?t:[])},e.getPreSortedRowModel=()=>e.getGroupedRowModel(),e.getSortedRowModel=()=>(!e._getSortedRowModel&&e.options.getSortedRowModel&&(e._getSortedRowModel=e.options.getSortedRowModel(e)),e.options.manualSorting||!e._getSortedRowModel?e.getPreSortedRowModel():e._getSortedRowModel())}},Vr=[er,wr,pr,hr,nr,sr,Sr,br,Pr,fr,Cr,jr,Nr,Rr,vr];function Ar(e){var s,t;const n=[...Vr,...(s=e._features)!=null?s:[]];let o={_features:n};const i=o._features.reduce((f,g)=>Object.assign(f,g.getDefaultOptions==null?void 0:g.getDefaultOptions(o)),{}),l=f=>o.options.mergeOptions?o.options.mergeOptions(i,f):{...i,...f};let d={...{},...(t=e.initialState)!=null?t:{}};o._features.forEach(f=>{var g;d=(g=f.getInitialState==null?void 0:f.getInitialState(d))!=null?g:d});const c=[];let u=!1;const m={_features:n,options:{...i,...e},initialState:d,_queue:f=>{c.push(f),u||(u=!0,Promise.resolve().then(()=>{for(;c.length;)c.shift()();u=!1}).catch(g=>setTimeout(()=>{throw g})))},reset:()=>{o.setState(o.initialState)},setOptions:f=>{const g=Ue(f,o.options);o.options=l(g)},getState:()=>o.options.state,setState:f=>{o.options.onStateChange==null||o.options.onStateChange(f)},_getRowId:(f,g,h)=>{var v;return(v=o.options.getRowId==null?void 0:o.options.getRowId(f,g,h))!=null?v:`${h?[h.id,g].join("."):g}`},getCoreRowModel:()=>(o._getCoreRowModel||(o._getCoreRowModel=o.options.getCoreRowModel(o)),o._getCoreRowModel()),getRowModel:()=>o.getPaginationRowModel(),getRow:(f,g)=>{let h=(g?o.getPrePaginationRowModel():o.getRowModel()).rowsById[f];if(!h&&(h=o.getCoreRowModel().rowsById[f],!h))throw new Error;return h},_getDefaultColumnDef:L(()=>[o.options.defaultColumn],f=>{var g;return f=(g=f)!=null?g:{},{header:h=>{const v=h.header.column.columnDef;return v.accessorKey?v.accessorKey:v.accessorFn?v.id:null},cell:h=>{var v,S;return(v=(S=h.renderValue())==null||S.toString==null?void 0:S.toString())!=null?v:null},...o._features.reduce((h,v)=>Object.assign(h,v.getDefaultColumnDef==null?void 0:v.getDefaultColumnDef()),{}),...f}},z(e,"debugColumns")),_getColumnDefs:()=>o.options.columns,getAllColumns:L(()=>[o._getColumnDefs()],f=>{const g=function(h,v,S){return S===void 0&&(S=0),h.map(y=>{const b=Js(o,y,S,v),w=y;return b.columns=w.columns?g(w.columns,b,S+1):[],b})};return g(f)},z(e,"debugColumns")),getAllFlatColumns:L(()=>[o.getAllColumns()],f=>f.flatMap(g=>g.getFlatColumns()),z(e,"debugColumns")),_getAllFlatColumnsById:L(()=>[o.getAllFlatColumns()],f=>f.reduce((g,h)=>(g[h.id]=h,g),{}),z(e,"debugColumns")),getAllLeafColumns:L(()=>[o.getAllColumns(),o._getOrderColumnsFn()],(f,g)=>{let h=f.flatMap(v=>v.getLeafColumns());return g(h)},z(e,"debugColumns")),getColumn:f=>o._getAllFlatColumnsById()[f]};Object.assign(o,m);for(let f=0;f<o._features.length;f++){const g=o._features[f];g==null||g.createTable==null||g.createTable(o)}return o}function jn(){return e=>L(()=>[e.options.data],s=>{const t={rows:[],flatRows:[],rowsById:{}},n=function(o,i,l){i===void 0&&(i=0);const a=[];for(let c=0;c<o.length;c++){const u=tr(e,e._getRowId(o[c],c,l),o[c],c,i,void 0,l==null?void 0:l.id);if(t.flatRows.push(u),t.rowsById[u.id]=u,a.push(u),e.options.getSubRows){var d;u.originalSubRows=e.options.getSubRows(o[c],c),(d=u.originalSubRows)!=null&&d.length&&(u.subRows=n(u.originalSubRows,i+1,u))}}return a};return t.rows=n(s),t},z(e.options,"debugTable","getRowModel",()=>e._autoResetPageIndex()))}function Dr(e){const s=[],t=n=>{var o;s.push(n),(o=n.subRows)!=null&&o.length&&n.getIsExpanded()&&n.subRows.forEach(t)};return e.rows.forEach(t),{rows:s,flatRows:e.flatRows,rowsById:e.rowsById}}function Nn(e){return s=>L(()=>[s.getState().pagination,s.getPrePaginationRowModel(),s.options.paginateExpandedRows?void 0:s.getState().expanded],(t,n)=>{if(!n.rows.length)return n;const{pageSize:o,pageIndex:i}=t;let{rows:l,flatRows:a,rowsById:d}=n;const c=o*i,u=c+o;l=l.slice(c,u);let m;s.options.paginateExpandedRows?m={rows:l,flatRows:a,rowsById:d}:m=Dr({rows:l,flatRows:a,rowsById:d}),m.flatRows=[];const f=g=>{m.flatRows.push(g),g.subRows.length&&g.subRows.forEach(f)};return m.rows.forEach(f),m},z(s.options,"debugTable"))}function Rn(){return e=>L(()=>[e.getState().sorting,e.getPreSortedRowModel()],(s,t)=>{if(!t.rows.length||!(s!=null&&s.length))return t;const n=e.getState().sorting,o=[],i=n.filter(d=>{var c;return(c=e.getColumn(d.id))==null?void 0:c.getCanSort()}),l={};i.forEach(d=>{const c=e.getColumn(d.id);c&&(l[d.id]={sortUndefined:c.columnDef.sortUndefined,invertSorting:c.columnDef.invertSorting,sortingFn:c.getSortingFn()})});const a=d=>{const c=d.map(u=>({...u}));return c.sort((u,m)=>{for(let g=0;g<i.length;g+=1){var f;const h=i[g],v=l[h.id],S=v.sortUndefined,y=(f=h==null?void 0:h.desc)!=null?f:!1;let b=0;if(S){const w=u.getValue(h.id),N=m.getValue(h.id),M=w===void 0,j=N===void 0;if(M||j){if(S==="first")return M?-1:1;if(S==="last")return M?1:-1;b=M&&j?0:M?S:-S}}if(b===0&&(b=v.sortingFn(u,m,h.id)),b!==0)return y&&(b*=-1),v.invertSorting&&(b*=-1),b}return u.index-m.index}),c.forEach(u=>{var m;o.push(u),(m=u.subRows)!=null&&m.length&&(u.subRows=a(u.subRows))}),c};return{rows:a(t.rows),flatRows:o,rowsById:t.rowsById}},z(e.options,"debugTable","getSortedRowModel",()=>e._autoResetPageIndex()))}/**
   * react-table
   *
   * Copyright (c) TanStack
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE.md file in the root directory of this source tree.
   *
   * @license MIT
   */function Fn(e,s){return e?kr(e)?x.createElement(e,s):e:null}function kr(e){return Lr(e)||typeof e=="function"||zr(e)}function Lr(e){return typeof e=="function"&&(()=>{const s=Object.getPrototypeOf(e);return s.prototype&&s.prototype.isReactComponent})()}function zr(e){return typeof e=="object"&&typeof e.$$typeof=="symbol"&&["react.memo","react.forward_ref"].includes(e.$$typeof.description)}function $n(e){const s={state:{},onStateChange:()=>{},renderFallbackValue:null,...e},[t]=x.useState(()=>({current:Ar(s)})),[n,o]=x.useState(()=>t.current.initialState);return t.current.setOptions(i=>({...i,...e,state:{...n,...e.state},onStateChange:l=>{o(l),e.onStateChange==null||e.onStateChange(l)}})),t.current}function Wn({nodes:e,edges:s,onNodesChange:t,onEdgesChange:n,onBlur:o,editable:i=!1}){const[l,a]=x.useState("nodes"),[d,c]=x.useState(e),[u,m]=x.useState(s),f=x.useRef(new Map),g=x.useRef(new Map);x.useEffect(()=>{c([...e]),m([...s]),f.current.clear(),g.current.clear()},[e,s]);const h=x.useMemo(()=>{if(e.length===0)return[];const w=new Set;e.forEach(j=>{Object.keys(j).forEach(P=>w.add(P))});const N=Array.from(w);return[...N.includes("id")?["id"]:[],...N.includes("label")?["label"]:[],...N.filter(j=>j!=="id"&&j!=="label")].map(j=>({header:j.charAt(0).toUpperCase()+j.slice(1).replace(/_/g," "),accessorKey:j,cell:P=>{var I;const _=P.getValue();if(i&&j!=="id"){const E=P.row.original.id,U=d.findIndex(W=>W.id===E);if(U===-1)return r.jsx("span",{children:"-"});const $=((I=d[U])==null?void 0:I[j])??_,T=`${E}-${j}`;return r.jsx(Ut,{id:T,type:typeof $=="number"?"number":"text",initialValue:$==null?"":String($),isNumber:typeof $=="number",onBlur:W=>{const Y=[...d],ee=typeof $=="number"?parseFloat(W)||0:W;Y[U]={...Y[U],[j]:ee},c(Y),t==null||t(Y),o==null||o()}},T)}return _==null?"-":typeof _=="number"?_.toLocaleString():String(_)}}))},[e,i]),v=x.useMemo(()=>{if(s.length===0)return[];const w=new Set;s.forEach(j=>{Object.keys(j).forEach(P=>w.add(P))});const N=Array.from(w);return[...N.includes("source")?["source"]:[],...N.includes("target")?["target"]:[],...N.includes("value")?["value"]:[],...N.filter(j=>j!=="source"&&j!=="target"&&j!=="value")].map(j=>({header:j.charAt(0).toUpperCase()+j.slice(1).replace(/_/g," "),accessorKey:j,cell:P=>{var I,q;const _=P.getValue();if(i&&j!=="source"&&j!=="target"){const E=P.row.original,U=u.findIndex(W=>W.source===E.source&&W.target===E.target&&W.value===E.value);if(U===-1){const W=u.findIndex(te=>te.source===E.source&&te.target===E.target);if(W===-1)return r.jsx("span",{children:"-"});const Y=((I=u[W])==null?void 0:I[j])??_,ee=`${E.source}-${E.target}-${j}-fallback`;return r.jsx(Ut,{id:ee,type:typeof Y=="number"?"number":"text",initialValue:Y==null?"":String(Y),isNumber:typeof Y=="number",onBlur:te=>{const ge=[...u],C=typeof Y=="number"?parseFloat(te)||0:te;ge[W]={...ge[W],[j]:C},m(ge),n==null||n(ge),o==null||o()}},ee)}const $=((q=u[U])==null?void 0:q[j])??_,T=`${E.source}-${E.target}-${j}`;return r.jsx(Ut,{id:T,type:typeof $=="number"?"number":"text",initialValue:$==null?"":String($),isNumber:typeof $=="number",onBlur:W=>{const Y=[...u],ee=typeof $=="number"?parseFloat(W)||0:W;Y[U]={...Y[U],[j]:ee},m(Y),n==null||n(Y),o==null||o()}},T)}return _==null?"-":typeof _=="number"?_.toLocaleString():String(_)}}))},[s,i]),S=$n({data:i?d:e,columns:h,getCoreRowModel:jn(),getSortedRowModel:Rn(),getPaginationRowModel:Nn(),initialState:{pagination:{pageSize:25}}}),y=$n({data:i?u:s,columns:v,getCoreRowModel:jn(),getSortedRowModel:Rn(),getPaginationRowModel:Nn(),initialState:{pagination:{pageSize:25}}}),b=l==="nodes"?S:y;return r.jsxs("div",{className:"h-full w-full flex flex-col",style:{height:"100%",maxHeight:"100%"},children:[r.jsxs("div",{className:"flex border-b mb-4 flex-shrink-0",children:[r.jsxs("button",{onClick:()=>a("nodes"),className:`px-4 py-2 font-medium text-sm transition-colors ${l==="nodes"?"border-b-2 border-blue-600 text-blue-600":"text-gray-600 hover:text-gray-900"}`,children:["Nodes (",e.length,")"]}),r.jsxs("button",{onClick:()=>a("edges"),className:`px-4 py-2 font-medium text-sm transition-colors ${l==="edges"?"border-b-2 border-blue-600 text-blue-600":"text-gray-600 hover:text-gray-900"}`,children:["Edges (",s.length,")"]})]}),r.jsx("div",{className:"flex-1 flex flex-col min-h-0 overflow-hidden",children:r.jsxs("div",{className:"overflow-auto flex-1 min-h-0",children:[r.jsxs("table",{className:"min-w-full text-sm",children:[r.jsx("thead",{className:"bg-gray-50 border-b sticky top-0 z-10",children:b.getHeaderGroups().map(w=>r.jsx("tr",{children:w.headers.map(N=>r.jsx("th",{className:"px-4 py-2 text-left font-semibold text-gray-700 bg-gray-50",children:N.isPlaceholder?null:r.jsxs("div",{className:N.column.getCanSort()?"cursor-pointer select-none hover:text-blue-600":"",onClick:N.column.getToggleSortingHandler(),children:[Fn(N.column.columnDef.header,N.getContext()),{asc:" ↑",desc:" ↓"}[N.column.getIsSorted()]??null]})},N.id))},w.id))}),r.jsx("tbody",{className:"divide-y divide-gray-200 bg-white",children:b.getRowModel().rows.map(w=>r.jsx("tr",{className:"hover:bg-gray-50",children:w.getVisibleCells().map(N=>r.jsx("td",{className:"px-4 py-2",children:Fn(N.column.columnDef.cell,N.getContext())},N.id))},w.id))})]}),b.getRowModel().rows.length===0&&r.jsxs("div",{className:"text-center text-gray-500 py-8",children:["No ",l," to display"]})]})}),r.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-t border-gray-200 bg-white flex-shrink-0",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("span",{className:"text-sm text-gray-700",children:"Show"}),r.jsx("select",{value:b.getState().pagination.pageSize,onChange:w=>{b.setPageSize(Number(w.target.value))},className:"border border-gray-300 rounded px-2 py-1 text-sm",children:[10,25,50,100].map(w=>r.jsx("option",{value:w,children:w},w))}),r.jsx("span",{className:"text-sm text-gray-700",children:"entries"})]}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsxs("span",{className:"text-sm text-gray-700",children:["Page ",b.getState().pagination.pageIndex+1," of"," ",b.getPageCount()]}),r.jsxs("div",{className:"flex gap-1",children:[r.jsx("button",{onClick:()=>b.setPageIndex(0),disabled:!b.getCanPreviousPage(),className:"px-2 py-1 text-sm border border-gray-300 rounded disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-50",children:"<<"}),r.jsx("button",{onClick:()=>b.previousPage(),disabled:!b.getCanPreviousPage(),className:"px-2 py-1 text-sm border border-gray-300 rounded disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-50",children:"<"}),r.jsx("button",{onClick:()=>b.nextPage(),disabled:!b.getCanNextPage(),className:"px-2 py-1 text-sm border border-gray-300 rounded disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-50",children:">"}),r.jsx("button",{onClick:()=>b.setPageIndex(b.getPageCount()-1),disabled:!b.getCanNextPage(),className:"px-2 py-1 text-sm border border-gray-300 rounded disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-50",children:">>"})]})]})]})]})}function Ut({id:e,type:s,initialValue:t,onBlur:n}){const o=x.useRef(null),[i,l]=x.useState(t);return x.useEffect(()=>{o.current&&document.activeElement!==o.current&&l(t)},[t]),r.jsx("input",{ref:o,id:e,type:s,value:i,onChange:a=>{l(a.target.value)},onBlur:a=>{n(a.target.value)},className:"w-full px-2 py-1 border border-gray-300 rounded text-sm focus:outline-none focus:ring-2 focus:ring-blue-500",autoComplete:"off"})}function Tr({dataset:e,onClose:s,onSave:t,onDelete:n,onDuplicate:o}){const[i,l]=x.useState(e.name),[a,d]=x.useState(e.notes||""),[c,u]=x.useState(!1),[m,f]=x.useState(!1),[g,h]=x.useState(!1),[v,S]=x.useState("info"),[y,b]=x.useState(null),w=e.snapshots[0]||{timestamp:e.timeRange.start,nodes:[],edges:[]};x.useEffect(()=>{l(e.name),d(e.notes||""),b(null)},[e]);async function N(){u(!0);try{const _={...e,name:i.trim(),notes:a.trim()||void 0};if(y){_.snapshots=y.snapshots;const I=_.snapshots[0]||w;_.metadata=ft(I)}await t(_),s()}catch(_){console.error("Save error:",_),alert("Failed to save dataset: "+(_ instanceof Error?_.message:"Unknown error"))}finally{u(!1)}}async function M(){f(!0);try{await n(),s()}catch(_){console.error("Delete error:",_),alert("Failed to delete dataset: "+(_ instanceof Error?_.message:"Unknown error"))}finally{f(!1),h(!1)}}function j(_,I){const q={...w,nodes:_,edges:I};b({...e,snapshots:[q]})}const P=i!==e.name||a!==(e.notes||"")||y!==null;return r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:r.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-6xl w-full mx-4 max-h-[90vh] flex flex-col",children:[r.jsxs("div",{className:"p-6 border-b flex items-center justify-between",children:[r.jsx("h2",{className:"text-2xl font-bold",children:"Edit Dataset"}),r.jsx("button",{onClick:s,type:"button",className:"text-gray-400 hover:text-gray-600 text-2xl cursor-pointer transition-colors",children:"×"})]}),r.jsxs("div",{className:"border-b flex",children:[r.jsx("button",{onClick:()=>S("info"),type:"button",className:`px-6 py-3 font-medium cursor-pointer transition-colors ${v==="info"?"border-b-2 border-blue-600 text-blue-600":"text-gray-600 hover:text-gray-900"}`,children:"Information"}),r.jsxs("button",{onClick:()=>S("data"),type:"button",className:`px-6 py-3 font-medium cursor-pointer transition-colors ${v==="data"?"border-b-2 border-blue-600 text-blue-600":"text-gray-600 hover:text-gray-900"}`,children:["Data (",w.nodes.length," nodes, ",w.edges.length," edges)"]})]}),r.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:v==="info"?r.jsxs("div",{className:"space-y-6 max-w-2xl",children:[r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Dataset Name ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsx("input",{type:"text",value:i,onChange:_=>l(_.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Enter a name for this dataset"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Notes"}),r.jsx("textarea",{value:a,onChange:_=>d(_.target.value),rows:5,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Add any notes about this dataset..."})]}),r.jsxs("div",{className:"bg-gray-50 p-4 rounded",children:[r.jsx("h3",{className:"font-medium text-gray-700 mb-2",children:"Dataset Information"}),r.jsxs("div",{className:"text-sm text-gray-600 space-y-1",children:[r.jsxs("div",{children:[r.jsx("span",{className:"font-medium",children:"Type:"})," ",e.type.toUpperCase()]}),r.jsxs("div",{children:[r.jsx("span",{className:"font-medium",children:"Time Range:"})," ",e.timeRange.start,e.timeRange.end!==e.timeRange.start?` – ${e.timeRange.end}`:""]}),r.jsxs("div",{children:[r.jsx("span",{className:"font-medium",children:"Snapshots:"})," ",e.snapshots.length]}),e.filename&&r.jsxs("div",{children:[r.jsx("span",{className:"font-medium",children:"Original File:"})," ",e.filename]}),r.jsxs("div",{children:[r.jsx("span",{className:"font-medium",children:"Created:"})," ",new Date(e.createdAt).toLocaleDateString()]})]})]}),r.jsxs("div",{className:"border-t pt-4 space-y-3",children:[r.jsx("button",{onClick:o,type:"button",className:"w-full px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50 cursor-pointer transition-colors",children:"Duplicate Dataset"}),r.jsx("button",{onClick:()=>h(!0),type:"button",className:"w-full px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 cursor-pointer transition-colors",children:"Delete Dataset"})]})]}):r.jsx("div",{className:"h-full",children:r.jsx(Hr,{nodes:w.nodes,edges:w.edges,onUpdate:j})})}),r.jsxs("div",{className:"p-6 border-t flex justify-end gap-3",children:[r.jsx("button",{onClick:s,type:"button",disabled:c||m,className:"px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50 disabled:opacity-50 cursor-pointer transition-colors",children:"Cancel"}),r.jsx("button",{onClick:N,type:"button",disabled:c||m||!P&&v==="info"||!i.trim(),className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed cursor-pointer transition-colors",children:c?"Saving...":y?"Save All Changes":"Save Changes"})]}),g&&r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-60",children:r.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md mx-4",children:[r.jsx("h3",{className:"text-lg font-bold mb-2",children:"Delete Dataset?"}),r.jsxs("p",{className:"text-gray-600 mb-4",children:['Are you sure you want to delete "',e.name,'"? This action cannot be undone.']}),r.jsxs("div",{className:"flex justify-end gap-3",children:[r.jsx("button",{onClick:()=>h(!1),type:"button",disabled:m,className:"px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50 cursor-pointer transition-colors",children:"Cancel"}),r.jsx("button",{onClick:M,type:"button",disabled:m,className:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 disabled:opacity-50 cursor-pointer transition-colors",children:m?"Deleting...":"Delete"})]})]})})]})})}function Hr({nodes:e,edges:s,onUpdate:t}){const[n,o]=x.useState(e),[i,l]=x.useState(s);x.useEffect(()=>{o([...e]),l([...s])},[e,s]);const a=x.useRef(n),d=x.useRef(i);x.useEffect(()=>{a.current=n,d.current=i},[n,i]);const c=x.useCallback(g=>{o(g),a.current=g},[]),u=x.useCallback(g=>{l(g),d.current=g},[]),m=x.useRef(!1),f=x.useCallback(()=>{m.current&&(t(a.current,d.current),m.current=!1)},[t]);return r.jsx("div",{className:"h-full",children:r.jsx(Wn,{nodes:n,edges:i,onNodesChange:g=>{c(g),m.current=!0},onEdgesChange:g=>{u(g),m.current=!0},onBlur:f,editable:!0})})}class Be extends x.Component{constructor(s){super(s),this.state={hasError:!1,error:null}}static getDerivedStateFromError(s){return{hasError:!0,error:s}}componentDidCatch(s,t){var n,o;console.error("ErrorBoundary caught an error:",s,t),(o=(n=this.props).onError)==null||o.call(n,s,t)}render(){var s;return this.state.hasError?this.props.fallback?this.props.fallback:r.jsxs("div",{className:"p-4 bg-red-50 border border-red-200 rounded-md",children:[r.jsx("h3",{className:"text-lg font-semibold text-red-800 mb-2",children:"Something went wrong"}),r.jsx("p",{className:"text-sm text-red-700 mb-2",children:((s=this.state.error)==null?void 0:s.message)||"An error occurred"}),r.jsx("button",{onClick:()=>this.setState({hasError:!1,error:null}),className:"px-3 py-1 bg-red-600 text-white text-sm rounded hover:bg-red-700 cursor-pointer transition-colors",children:"Try again"})]}):this.props.children}}function Or({selectedId:e,onSelect:s,onRefresh:t}){const[n,o]=x.useState([]),[i,l]=x.useState(!1),[a,d]=x.useState(null),[c,u]=x.useState(!1),[m,f]=x.useState(null),g=x.useRef(null);x.useEffect(()=>{h()},[]);async function h(){const M=await Bs();o(M)}async function v(M,j){try{const _=`${M.type||"csv"}-${Date.now()}`,I={...M,id:_,snapshots:j.snapshots,metadata:j.metadata,createdAt:Date.now()};await at(I),await h(),l(!1),f(null),s(_)}catch(P){throw console.error("Import error:",P),P}finally{g.current&&(g.current.value="")}}async function S(M,j){j.stopPropagation();const P=await lt(M);P&&d(P)}async function y(M){await at(M),await h(),e===M.id&&(t==null||t())}async function b(){a&&(await Us(a.id),await h(),e===a.id&&s(""),d(null))}async function w(){if(!a)return;const M=await qs(a.id);await h(),d(null),s(M.id)}async function N(){await Ws(),await h(),u(!1),s(""),window.location.reload()}return r.jsxs("aside",{className:"h-full overflow-y-auto flex flex-col",children:[r.jsxs("div",{className:"p-4 border-b",children:[r.jsx("h2",{className:"text-lg font-bold",children:"Datasets"}),r.jsx("p",{className:"text-xs text-gray-500",children:"Stored in your browser"}),r.jsx("button",{onClick:()=>l(!0),className:"mt-3 w-full px-3 py-2 bg-blue-600 text-white text-sm rounded hover:bg-blue-700",children:"Import Dataset"}),r.jsx("input",{ref:g,type:"file",accept:".csv,.gexf",multiple:!0,className:"hidden"}),i&&r.jsx(Be,{fallback:r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:r.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md mx-4",children:[r.jsx("h3",{className:"text-lg font-bold text-red-800 mb-2",children:"Import Panel Error"}),r.jsx("p",{className:"text-gray-600 mb-4",children:"The import panel encountered an error."}),r.jsx("button",{onClick:()=>l(!1),className:"px-4 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-700 cursor-pointer transition-colors",children:"Close"})]})}),children:r.jsx(Ks,{onClose:()=>{l(!1),f(null),g.current&&(g.current.value="")},onImport:v,fileInputRef:g,onFilesSelected:f,existingFile:m})})]}),r.jsxs("ul",{className:"divide-y flex-1 overflow-y-auto",children:[n.map(M=>r.jsx("li",{children:r.jsxs("div",{className:`flex items-center group ${e===M.id?"bg-blue-50":""}`,children:[r.jsxs("button",{className:"flex-1 text-left p-3 hover:bg-gray-50",onClick:()=>s(M.id),children:[r.jsx("div",{className:"flex items-center justify-between",children:r.jsxs("div",{children:[r.jsx("div",{className:"font-medium",children:M.name}),r.jsxs("div",{className:"text-xs text-gray-500",children:[M.type.toUpperCase()," · ",M.timeRange.start,M.timeRange.end!==M.timeRange.start?`–${M.timeRange.end}`:""]})]})}),M.notes&&r.jsx("div",{className:"text-xs text-gray-600 mt-1 line-clamp-2",children:M.notes})]}),r.jsx("button",{onClick:j=>S(M.id,j),className:"px-2 py-1 text-gray-400 hover:text-blue-600 hover:bg-gray-100 rounded transition-all mr-2 cursor-pointer",title:"Edit dataset",type:"button",children:r.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})})})]})},M.id)),n.length===0&&r.jsx("li",{className:"p-3 text-sm text-gray-500",children:"No datasets yet"})]}),r.jsxs("div",{className:"p-4 border-t",children:[r.jsx("button",{onClick:()=>u(!0),type:"button",className:"w-full px-3 py-2 bg-red-600 text-white text-sm rounded hover:bg-red-700 cursor-pointer transition-colors",children:"Reset All Data"}),r.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"Delete all datasets and reload defaults"})]}),a&&r.jsx(Be,{fallback:r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:r.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md mx-4",children:[r.jsx("h3",{className:"text-lg font-bold text-red-800 mb-2",children:"Edit Panel Error"}),r.jsx("p",{className:"text-gray-600 mb-4",children:"The edit panel encountered an error."}),r.jsx("button",{onClick:()=>d(null),className:"px-4 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-700 cursor-pointer transition-colors",children:"Close"})]})}),children:r.jsx(Tr,{dataset:a,onClose:()=>d(null),onSave:y,onDelete:b,onDuplicate:w})}),c&&r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-60",children:r.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md mx-4",children:[r.jsx("h3",{className:"text-lg font-bold mb-2",children:"Reset All Data?"}),r.jsx("p",{className:"text-gray-600 mb-4",children:"This will delete all datasets and reload the default test data. This action cannot be undone."}),r.jsxs("div",{className:"flex justify-end gap-3",children:[r.jsx("button",{onClick:()=>u(!1),type:"button",className:"px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50 cursor-pointer transition-colors",children:"Cancel"}),r.jsx("button",{onClick:N,type:"button",className:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 cursor-pointer transition-colors",children:"Reset All Data"})]})]})})]})}function Gr({nodes:e,edges:s,width:t=1200,height:n=800}){const o=x.useRef(null),[i,l]=x.useState(null),[a,d]=x.useState(null);return x.useEffect(()=>{var te,ge;if(!o.current||s.length===0||e.length===0){o.current&&de(o.current).selectAll("*").remove();return}de(o.current).selectAll("*").remove();const c=new Map;e.forEach(C=>{c.set(C.id,{id:C.id,label:C.label||C.id,outgoing:0,incoming:0})}),s.forEach(C=>{const V=c.get(C.source),se=c.get(C.target);V&&(V.outgoing+=C.value),se&&(se.incoming+=C.value)});const u=Array.from(c.values()).filter(C=>C.outgoing>0||C.incoming>0);if(u.length===0){de(o.current).append("text").attr("x",t/2).attr("y",n/2).attr("text-anchor","middle").attr("font-size","14px").attr("fill","#666").text("No active nodes with flows");return}u.sort((C,V)=>V.outgoing+V.incoming-(C.outgoing+C.incoming));const m=50,f=t-50,g=20,h=15,v=2,S=5,y=u.reduce((C,V)=>C+V.outgoing,0),b=u.reduce((C,V)=>C+V.incoming,0),w=Math.max(n-2*g,400);let N=g;u.forEach(C=>{const V=y>0?Math.max(S,C.outgoing/y*w):Math.max(S,w/u.length);N+=V+v});let M=g;u.forEach(C=>{const V=b>0?Math.max(S,C.incoming/b*w):Math.max(S,w/u.length);M+=V+v});const j=Math.max(n,Math.max(N,M)+100),P=j-2*g,_=de(o.current).attr("width",t).attr("height",j).style("font","12px sans-serif");let I=g;const q=u.map((C,V)=>{const se=y>0?Math.max(S,C.outgoing/y*P):Math.max(S,P/u.length),xe=I;return I+=se+v,{node:C,x:m,y:xe,height:Math.max(S,se-v),side:"left",index:V}});I=g;const E=u.map((C,V)=>{const se=b>0?Math.max(S,C.incoming/b*P):Math.max(S,P/u.length),xe=I;return I+=se+v,{node:C,x:f,y:xe,height:Math.max(S,se-v),side:"right",index:V}});let U=[];i&&a&&(a==="left"?U=s.filter(C=>C.source===i&&C.source!==C.target):U=s.filter(C=>C.target===i&&C.source!==C.target));const $=In(Dn);if(U.length>0){const C=U.map(H=>{const O=q.find(ae=>ae.node.id===H.source),B=E.find(ae=>ae.node.id===H.target);if(!O||!B)return null;const ue=O.y+O.height/2,Ne=B.y+B.height/2;return{edge:H,sourceX:O.x+h,sourceY:ue,targetX:B.x,targetY:Ne,value:H.value,leftIndex:O.index,rightIndex:B.index}}).filter(H=>H!==null),V=Math.max(...C.map(H=>H.value),1),se=2,xe=20,Se=_.append("g").attr("class","links");C.forEach(H=>{const O=se+H.value/V*(xe-se),B=`gradient-${H.leftIndex}-${H.rightIndex}`,ue=_.append("defs").append("linearGradient").attr("id",B).attr("gradientUnits","userSpaceOnUse").attr("x1",H.sourceX).attr("x2",H.targetX).attr("y1",H.sourceY).attr("y2",H.targetY);ue.append("stop").attr("offset","0%").attr("stop-color",$(String(H.leftIndex))).attr("stop-opacity",.6),ue.append("stop").attr("offset","100%").attr("stop-color",$(String(H.rightIndex))).attr("stop-opacity",.6);const Ne=nn(),ae=(H.sourceX+H.targetX)/2;Ne.moveTo(H.sourceX,H.sourceY),Ne.bezierCurveTo(ae,H.sourceY,ae,H.targetY,H.targetX,H.targetY),Se.append("path").attr("d",Ne.toString()).attr("stroke",`url(#${B})`).attr("stroke-width",O).attr("fill","none").attr("stroke-opacity",.6).style("cursor","pointer").on("mouseover",function(ye){de(this).attr("stroke-opacity",1).attr("stroke-width",O+2),de("body").append("div").attr("class","tooltip").style("position","absolute").style("background","rgba(0, 0, 0, 0.8)").style("color","white").style("padding","8px").style("border-radius","4px").style("pointer-events","none").style("opacity",0).html(`${H.edge.source} → ${H.edge.target}<br/>${H.value.toLocaleString()}`).style("opacity",1)}).on("mousemove",function(ye){de(".tooltip").style("left",`${ye.pageX+10}px`).style("top",`${ye.pageY-10}px`)}).on("mouseout",function(){de(this).attr("stroke-opacity",.6).attr("stroke-width",O),de(".tooltip").remove()})})}const W=_.append("g").attr("class","left-nodes").selectAll("g.node").data(q).join("g").attr("class","node").attr("transform",C=>`translate(${C.x}, ${C.y})`).style("cursor","pointer").on("click",function(C,V){C.stopPropagation(),i===V.node.id&&a==="left"?(l(null),d(null)):(l(V.node.id),d("left"))});W.append("rect").attr("width",h).attr("height",C=>C.height).attr("fill",(C,V)=>$(String(V))).attr("stroke",(C,V)=>tt($(String(V))).darker()).attr("stroke-width",C=>i===C.node.id&&a==="left"?3:1).attr("opacity",C=>i&&a==="left"&&i!==C.node.id?.3:1).on("mouseover",function(C,V){de(this).attr("fill",tt($(String(V.index))).brighter(.5))}).on("mouseout",function(C,V){de(this).attr("fill",$(String(V.index)))}),W.append("text").attr("x",h+6).attr("y",C=>C.height/2).attr("dy","0.35em").attr("text-anchor","start").text(C=>`${C.node.label} (${C.node.outgoing.toLocaleString()})`).style("font-size","11px").style("font-weight","500").style("fill","#333").attr("opacity",C=>i&&a==="left"&&i!==C.node.id?.3:1);const ee=_.append("g").attr("class","right-nodes").selectAll("g.node").data(E).join("g").attr("class","node").attr("transform",C=>`translate(${C.x}, ${C.y})`).style("cursor","pointer").on("click",function(C,V){C.stopPropagation(),i===V.node.id&&a==="right"?(l(null),d(null)):(l(V.node.id),d("right"))});ee.append("rect").attr("x",-h).attr("width",h).attr("height",C=>C.height).attr("fill",(C,V)=>$(String(V))).attr("stroke",(C,V)=>tt($(String(V))).darker()).attr("stroke-width",C=>i===C.node.id&&a==="right"?3:1).attr("opacity",C=>i&&a==="right"&&i!==C.node.id?.3:1).on("mouseover",function(C,V){de(this).attr("fill",tt($(String(V.index))).brighter(.5))}).on("mouseout",function(C,V){de(this).attr("fill",$(String(V.index)))}),ee.append("text").attr("x",-h-6).attr("y",C=>C.height/2).attr("dy","0.35em").attr("text-anchor","end").text(C=>`${C.node.label} (${C.node.incoming.toLocaleString()})`).style("font-size","11px").style("font-weight","500").style("fill","#333").attr("opacity",C=>i&&a==="right"&&i!==C.node.id?.3:1),i?_.append("text").attr("x",t/2).attr("y",20).attr("text-anchor","middle").attr("font-size","14px").attr("fill","#333").text(a==="left"?`Showing outgoing flows from ${(te=q.find(C=>C.node.id===i))==null?void 0:te.node.label}`:`Showing incoming flows to ${(ge=E.find(C=>C.node.id===i))==null?void 0:ge.node.label}`):_.append("text").attr("x",t/2).attr("y",20).attr("text-anchor","middle").attr("font-size","14px").attr("fill","#666").text("Click a node to see its connections"),_.append("text").attr("x",m+h/2).attr("y",j-10).attr("text-anchor","middle").attr("font-size","12px").attr("font-weight","bold").attr("fill","#333").text("Outgoing"),_.append("text").attr("x",f-h/2).attr("y",j-10).attr("text-anchor","middle").attr("font-size","12px").attr("font-weight","bold").attr("fill","#333").text("Incoming"),_.on("click",function(C){(C.target===o.current||C.target.tagName==="svg")&&(l(null),d(null))})},[e,s,t,n,i,a]),r.jsxs("div",{className:"w-full h-full flex flex-col min-h-0",children:[r.jsxs("div",{className:"text-center text-xs text-gray-500 mb-2 flex-shrink-0",children:["Interaction design inspired by"," ",r.jsx("a",{href:"https://peoplemov.in/#f_AF",target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-800 underline",children:"peoplemov.in by Carlo Zapponi"})]}),r.jsx("div",{className:"flex-1 overflow-auto min-h-0",children:r.jsx("svg",{ref:o,className:"border border-gray-200 rounded bg-white"})})]})}function Br(e,s){const t=e.length,n=new Map;e.forEach((l,a)=>{n.set(l.id,a)});const o=Array(t).fill(null).map(()=>Array(t).fill(0));s.forEach(l=>{const a=n.get(l.source),d=n.get(l.target);a!==void 0&&d!==void 0&&(o[a][d]+=l.value)});const i=e.map(l=>l.label||l.id);return{matrix:o,labels:i,nodes:e}}function Ur(e,s,t){return!t||t==="all"?e:e.filter(n=>{const o=n[s];return Array.isArray(o)?o.includes(t):o===t})}function qr(e,s){const t=new Set;return e.forEach(n=>{const o=n[s];o!=null&&(Array.isArray(o)?o.forEach(i=>t.add(i)):t.add(o))}),Array.from(t).sort((n,o)=>typeof n=="number"&&typeof o=="number"?n-o:String(n).localeCompare(String(o)))}function Wr({nodes:e,edges:s,width:t=1e3,height:n=800}){const o=x.useRef(null);return x.useEffect(()=>{if(!o.current||s.length===0||e.length===0){o.current&&de(o.current).selectAll("*").remove();return}de(o.current).selectAll("*").remove();const i=Br(e,s),l=de(o.current).attr("width","100%").attr("height","100%").attr("viewBox",`0 0 ${t} ${n}`).attr("preserveAspectRatio","xMidYMid meet"),a=Math.min(t,n)*.5-40,d=a-20,c=Jn().scaleExtent([.1,4]).on("zoom",function(b){v.attr("transform",b.transform.toString())});l.call(c);const u=l.append("g").attr("class","reset-button").style("cursor","pointer").attr("transform",`translate(${t-120}, 10)`).on("click",function(){l.transition().duration(750).call(c.transform,es)});u.append("rect").attr("width",110).attr("height",30).attr("rx",4).attr("fill","white").attr("stroke","#ccc").attr("stroke-width",1),u.append("text").attr("x",55).attr("y",20).attr("text-anchor","middle").attr("font-size","12px").attr("fill","#333").text("Reset View");const f=vs().padAngle(.05).sortSubgroups(hs)(i.matrix),g=Ms().radius(d),h=In(Dn),v=l.append("g").attr("class","zoom-group"),S=v.append("g").attr("transform",`translate(${t/2}, ${n/2})`),y=S.append("g").selectAll("g").data(f.groups).join("g");y.append("path").attr("fill",b=>h(String(b.index))).attr("stroke",b=>tt(h(String(b.index))).darker()).attr("d",Hs().innerRadius(d).outerRadius(a)).on("mouseover",function(b,w){de(this).attr("fill",tt(h(String(w.index))).brighter(1)),S.selectAll("path.chord").style("opacity",N=>N.source.index===w.index||N.target.index===w.index?1:.2)}).on("mouseout",function(){de(this).attr("fill",b=>h(String(b.index))),S.selectAll("path.chord").style("opacity",1)}),y.append("text").each(b=>{b.angle=(b.startAngle+b.endAngle)/2}).attr("dy",".35em").attr("transform",b=>`
        rotate(${b.angle*180/Math.PI-90})
        translate(${a+10})
        ${b.angle>Math.PI?"rotate(180)":""}
      `).attr("text-anchor",b=>b.angle>Math.PI?"end":"start").text(b=>i.labels[b.index]).style("font-size","12px").style("font-weight","500"),S.append("g").attr("fill-opacity",.67).selectAll("path").data(f).join("path").attr("class","chord").attr("d",g).attr("fill",b=>h(String(b.source.index))).attr("stroke",b=>tt(h(String(b.source.index))).darker()).style("stroke-width","1px").on("mouseover",function(b,w){de(this).attr("fill-opacity",1).style("stroke-width","2px"),de("body").append("div").attr("class","tooltip").style("position","absolute").style("background","rgba(0, 0, 0, 0.8)").style("color","white").style("padding","8px").style("border-radius","4px").style("pointer-events","none").style("opacity",0).style("transition","opacity 0.2s").html(`${i.labels[w.source.index]} → ${i.labels[w.target.index]}: ${w.source.value.toLocaleString()}`).style("opacity",1)}).on("mousemove",function(b){de(".tooltip").style("left",`${b.pageX+10}px`).style("top",`${b.pageY-10}px`)}).on("mouseout",function(){de(this).attr("fill-opacity",.67).style("stroke-width","1px"),de(".tooltip").remove()})},[e,s,t,n]),r.jsx("div",{className:"w-full h-full",children:r.jsx("svg",{ref:o,className:"border border-gray-200 rounded bg-white"})})}const Xr=200,Kr=600,Yr=384,Mn=4;function Zr({isCollapsed:e,onToggle:s,onResize:t,children:n,title:o="Settings",bottomContent:i}){const[l,a]=x.useState(Yr),[d,c]=x.useState(!1),u=x.useRef(null),m=x.useRef(null);return x.useEffect(()=>{if(!d)return;const f=h=>{var v;if(!e&&((v=u.current)==null?void 0:v.getBoundingClientRect())){const y=Math.max(Xr,Math.min(Kr,window.innerWidth-h.clientX));a(y),t==null||t(y)}},g=()=>{c(!1)};return document.addEventListener("mousemove",f),document.addEventListener("mouseup",g),()=>{document.removeEventListener("mousemove",f),document.removeEventListener("mouseup",g)}},[d,e,t]),r.jsxs("div",{ref:u,className:"bg-white border-l border-gray-200 flex flex-col transition-all duration-300  overflow-hidden relative",style:{minHeight:"100vh",width:e?`${Mn}px`:`${l}px`},children:[e&&r.jsxs(r.Fragment,{children:[r.jsx("div",{onClick:s,className:"w-full h-full bg-gray-100 hover:bg-blue-400 cursor-pointer transition-colors",style:{width:`${Mn}px`},title:"Click to expand settings"}),r.jsx("button",{onClick:s,className:"fixed bottom-4 right-4 z-50 p-3 bg-blue-600 hover:bg-blue-700 text-white rounded-full shadow-lg cursor-pointer transition-all hover:scale-110 flex items-center justify-center",style:{width:"48px",height:"48px"},title:"Open visualization settings","aria-label":"Open visualization settings",children:r.jsx(gn,{className:"w-5 h-5"})})]}),!e&&r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:n}),i&&r.jsx("div",{className:"flex-shrink-0 border-t border-gray-200 bg-white",children:i}),r.jsxs("button",{onClick:s,className:"w-full flex items-center justify-between p-2 border-t border-gray-200 flex-shrink-0 bg-gray-50 hover:bg-gray-100 transition-colors cursor-pointer","aria-label":"Collapse settings",children:[r.jsxs("div",{className:"flex items-center gap-2 flex-1",children:[r.jsx(gn,{className:"w-4 h-4 text-gray-600"}),r.jsx("span",{className:"text-sm font-medium text-gray-700",children:o})]}),r.jsx(ts,{className:"w-4 h-4 text-gray-600 flex-shrink-0"})]}),r.jsx("div",{ref:m,onMouseDown:f=>{f.preventDefault(),c(!0)},className:"absolute top-0 left-0 w-1 h-full cursor-col-resize hover:bg-blue-400 bg-gray-300 transition-colors z-10",style:{touchAction:"none"},children:r.jsx("div",{className:"absolute top-1/2 left-0 transform -translate-y-1/2 -translate-x-0.5",children:r.jsx(ns,{className:"w-3 h-6 text-gray-500"})})})]})]})}function ot({title:e,subtitle:s,children:t,defaultOpen:n=!1}){const[o,i]=x.useState(n);return r.jsxs("div",{className:"border border-gray-200 rounded-md",children:[r.jsxs("button",{onClick:()=>i(!o),className:"w-full flex items-center justify-between p-3 hover:bg-gray-50 transition-colors text-left",children:[r.jsxs("div",{className:"flex-1",children:[r.jsx("div",{className:"font-semibold text-sm",children:e}),s&&r.jsx("div",{className:"text-xs text-gray-600 mt-0.5",children:s})]}),o?r.jsx(ms,{className:"w-4 h-4 text-gray-600 flex-shrink-0"}):r.jsx(gs,{className:"w-4 h-4 text-gray-600 flex-shrink-0"})]}),o&&r.jsx("div",{className:"p-3 pt-0 border-t border-gray-200",children:t})]})}const _n=as(["kriskogram","table","sankey","chord"]),Nt=e=>{const s=e!==void 0?cn().default(e):cn().optional();return qt(t=>{if(t==null||t==="")return e;const n=typeof t=="string"?parseFloat(t):Number(t);return Number.isNaN(n)?e:n},s)};ls({dataset:un().optional(),view:qt(e=>typeof e=="string"&&_n.safeParse(e).success?e:"kriskogram",_n.default("kriskogram")),year:Nt(void 0),minThreshold:Nt(0),maxThreshold:Nt(2e5),maxEdges:Nt(500),edgeType:qt(e=>e==="null"||e===""?null:typeof e=="string"?e:void 0,un().nullable().optional())});function so(){const e=ss({from:"/explorer"}),s=rs(),{leftSidebarCollapsed:t,leftSidebarWidth:n,setSidebarContent:o}=os(),[i,l]=x.useState(e.dataset),[a,d]=x.useState(void 0),[c,u]=x.useState(e.year),[m,f]=x.useState(!1),[g,h]=x.useState(null),[v,S]=x.useState(0),[y,b]=x.useState(e.minThreshold??0),[w,N]=x.useState(e.maxThreshold??2e5),[M,j]=x.useState(e.maxEdges??500),[P,_]=x.useState(e.edgeType??null),[I,q]=x.useState(e.view),E=x.useRef(null),[U,$]=x.useState(!1),[T,W]=x.useState(384),[Y,ee]=x.useState({width:typeof window<"u"?window.innerWidth:1200,height:typeof window<"u"?window.innerHeight:800});x.useEffect(()=>(o(r.jsx(Be,{fallback:r.jsxs("div",{className:"p-4",children:[r.jsx("h2",{className:"text-lg font-bold text-red-800 mb-2",children:"Dataset Sidebar Error"}),r.jsx("p",{className:"text-sm text-red-700",children:"The dataset sidebar encountered an error."})]}),children:r.jsx(Or,{selectedId:i,onSelect:p=>{l(p),Fe({dataset:p})},onRefresh:()=>S(p=>p+1)})})),()=>{o(null)}),[i,v]),x.useEffect(()=>{if(typeof window>"u")return;const p=()=>{ee({width:window.innerWidth,height:window.innerHeight})};return p(),window.addEventListener("resize",p),()=>window.removeEventListener("resize",p)},[]),x.useEffect(()=>{typeof window<"u"&&setTimeout(()=>{ee({width:window.innerWidth,height:window.innerHeight})},100)},[t,U,n,T]);const[te,ge]=x.useState("alphabetical"),[C,V]=x.useState(.85),[se,xe]=x.useState("weight"),[Se,H]=x.useState(!1),[O,B]=x.useState("direction"),[ue,Ne]=x.useState(null),[ae,ye]=x.useState("weight"),[Te,xt]=x.useState(null),[dt,vt]=x.useState(.6),[nt,R]=x.useState(!0),[F,A]=x.useState("none"),[Q,X]=x.useState(2),[K,J]=x.useState("single"),[Ie,We]=x.useState(null),[Re,re]=x.useState("fixed"),[ce,Xn]=x.useState(null),[st,an]=x.useState("pan"),[ln,Kn]=x.useState(80),[dn,Yn]=x.useState({x:0,y:0}),Fe=x.useMemo(()=>p=>{s({to:"/explorer",search:D=>({view:D.view??"kriskogram",...D,...p}),replace:!0})},[s]),Zn=x.useMemo(()=>a&&a.timeRange.start!==a.timeRange.end,[a]),Xe=x.useRef(!0);x.useEffect(()=>{Xs().catch(()=>{}),Qr().then(p=>{const D=e.dataset||p;D&&(l(D),!e.dataset&&Xe.current&&Fe({dataset:D})),Xe.current=!1}).catch(p=>h(p instanceof Error?p.message:"Failed to preload datasets"))},[]),x.useEffect(()=>{if(!i){d(void 0);return}f(!0),h(null),lt(i).then(p=>{d(p),p&&(u(p.timeRange.start),b(0),j(500))}).catch(p=>h(p instanceof Error?p.message:"Failed to load dataset")).finally(()=>f(!1))},[i,v]);const le=x.useMemo(()=>{if(!(!a||c===void 0))return a.snapshots.find(p=>(typeof p.timestamp=="string"?parseInt(p.timestamp,10):p.timestamp)===c)},[a,c]);x.useEffect(()=>{if(le&&le.edges.length>0){const p=Math.max(...le.edges.map(oe=>oe.value)),D=Math.min(...le.edges.map(oe=>oe.value));b(D),N(Math.max(p,D)),j(Math.min(500,le.edges.length))}},[le]);const Ke=x.useMemo(()=>{if(!le||!(a!=null&&a.metadata))return null;const D=["migration_type","type","category","edge_type"].find(pe=>{var Me,Ve;return((Me=a.metadata)==null?void 0:Me.edgeProperties.includes(pe))||((Ve=a.metadata)==null?void 0:Ve.hasCategoricalProperties.edges.includes(pe))});if(!D)return null;const oe=qr(le.edges,D);return{property:D,values:oe.map(pe=>String(pe))}},[le,a]);x.useEffect(()=>{_(null)},[i]);const G=x.useMemo(()=>{if(!le)return{nodes:[],edges:[]};let p=Ur(le.edges,(Ke==null?void 0:Ke.property)||"",P);if(F!=="none"){const Z=new Map(le.nodes.map(fe=>[fe.id,fe]));F==="region"?p=p.filter(fe=>{const he=Z.get(fe.source),k=Z.get(fe.target);return he&&k&&he.region&&k.region&&he.region===k.region}):F==="division"?p=p.filter(fe=>{const he=Z.get(fe.source),k=Z.get(fe.target);return he&&k&&he.division&&k.division&&he.division===k.division}):F==="interRegion"?p=p.filter(fe=>{const he=Z.get(fe.source),k=Z.get(fe.target);return he&&k&&he.region&&k.region&&he.region!==k.region}):F==="interDivision"&&(p=p.filter(fe=>{const he=Z.get(fe.source),k=Z.get(fe.target);return he&&k&&he.division&&k.division&&he.division!==k.division}))}const D=p.filter(Z=>Z.value>=y&&Z.value<=w).sort((Z,fe)=>fe.value-Z.value).slice(0,M),oe=new Set;D.forEach(Z=>{oe.add(Z.source),oe.add(Z.target)});const pe=le.nodes.filter(Z=>oe.has(Z.id)),Me=new Map,Ve=new Map;return D.forEach(Z=>{const fe=Ve.get(Z.source)||0;Ve.set(Z.source,fe+Z.value);const he=Me.get(Z.target)||0;Me.set(Z.target,he+Z.value)}),{nodes:pe.map(Z=>({...Z,_totalIncoming:Me.get(Z.id)||0,_totalOutgoing:Ve.get(Z.id)||0})),edges:D}},[le,y,w,M,P,Ke,F]),$e=x.useMemo(()=>{if(!le)return null;const p=le.edges.length,D=le.nodes.length,oe=le.edges.reduce((Ve,Ye)=>Ve+Ye.value,0),pe=p>0?oe/p:0,Me=p>0?Math.max(...le.edges.map(Ve=>Ve.value)):0;return{totalNodes:D,totalEdges:p,visibleNodes:G.nodes.length,visibleEdges:G.edges.length,avgValue:pe,maxValue:Me}},[le,G]),$t=x.useMemo(()=>{if(!(!G||G.edges.length===0))return Math.min(...G.edges.map(p=>p.value))},[G]),ut=x.useMemo(()=>G.nodes.some(p=>p&&p.region),[G]),ct=x.useMemo(()=>G.nodes.some(p=>p&&p.division),[G]),Mt=x.useMemo(()=>{if(!(!G||G.edges.length===0))return Math.max(...G.edges.map(p=>p.value))},[G]);x.useEffect(()=>{I==="kriskogram"&&G.nodes.length>0&&G.edges.length>0&&E.current&&E.current.updateData(G.nodes,G.edges)},[G,I]);const Qn=p=>{u(p),Xe.current||Fe({year:p})};return x.useEffect(()=>{Xe.current||Fe({minThreshold:y,maxThreshold:w,maxEdges:M})},[y,w,M]),x.useEffect(()=>{Xe.current||Fe({view:I})},[I]),x.useEffect(()=>{Xe.current||Fe({edgeType:P})},[P]),x.useEffect(()=>{!Xe.current&&i&&Fe({dataset:i})},[i]),r.jsx(Be,{fallback:r.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center",children:r.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-8 max-w-lg mx-4",children:[r.jsx("h2",{className:"text-2xl font-bold text-red-800 mb-4",children:"Explorer Error"}),r.jsx("p",{className:"text-gray-700 mb-4",children:"The explorer page encountered an error. Please refresh the page."}),r.jsx("button",{onClick:()=>window.location.reload(),className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 cursor-pointer transition-colors",children:"Reload Page"})]})}),children:r.jsxs("div",{className:"flex flex-1 h-full overflow-hidden",children:[r.jsxs("main",{className:"flex-1 flex flex-col overflow-hidden h-full relative",children:[m&&r.jsx("div",{className:"p-4 bg-yellow-50 text-yellow-800",children:"Loading…"}),g&&r.jsx("div",{className:"p-4 bg-red-50 text-red-600",children:g}),a?r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"flex-1 flex flex-col overflow-hidden bg-white",children:r.jsx("div",{className:`flex-1 overflow-hidden ${I==="table"?"":"p-4"}`,children:G.nodes.length>0&&G.edges.length>0?r.jsxs(r.Fragment,{children:[I==="kriskogram"&&r.jsx(Be,{fallback:r.jsxs("div",{className:"p-4 bg-red-50 border border-red-200 rounded-md",children:[r.jsx("h3",{className:"text-lg font-semibold text-red-800 mb-2",children:"Kriskogram Error"}),r.jsx("p",{className:"text-sm text-red-700",children:"The Kriskogram visualization encountered an error."})]}),children:r.jsx("div",{className:"w-full h-full",children:r.jsx(is,{ref:E,nodes:G.nodes,edges:G.edges,width:Math.max(800,Y.width-(t?64:n)-(U?4:T)-40),height:Math.max(600,Y.height-80),margin:{top:60,right:40,bottom:60,left:40},arcOpacity:C,title:a.name,accessors:(()=>{const p=G.edges.map(k=>k.value),D=p.length>0?Math.min(...p):0,pe=(p.length>0?Math.max(...p):1)-D||1,Me=G.nodes.map(k=>k._totalOutgoing||0),Ve=G.nodes.map(k=>k._totalIncoming||0),Ye=Me.length>0?Math.max(...Me):1,Z=Ve.length>0?Math.max(...Ve):1,fe=(k,me,be)=>{const we=Array.from(new Set(G.nodes.map(Ee=>Ee[k]).filter(Ee=>Ee!=null))),_e=new Map;return we.forEach((Ee,Ze)=>{_e.set(Ee,be[Ze%be.length])}),_e.get(me)||be[0]},he=["#3b82f6","#f59e0b","#ef4444","#10b981","#8b5cf6","#ec4899","#14b8a6","#f97316"];return{nodeOrder:k=>{if(te==="alphabetical")return k.label||k.id;const me=k[te];return me==null?`ZZZ_${k.label||k.id}`:typeof me=="number"?`${String(1e6-me).padStart(10,"0")}_${k.label||k.id}`:`${String(me)}_${k.label||k.id}`},nodeColor:k=>{var me;if(K==="single")return"#2563eb";if(K==="outgoing")return`hsl(200, 70%, ${20+(Ye>0?(k._totalOutgoing||0)/Ye:0)*50}%)`;if(K==="incoming")return`hsl(200, 70%, ${20+(Z>0?(k._totalIncoming||0)/Z:0)*50}%)`;if(K==="attribute"&&Ie){const be=k[Ie];if(be==null)return"#999";if((me=a==null?void 0:a.metadata)!=null&&me.hasNumericProperties.nodes.includes(Ie)){const we=G.nodes.map(ne=>ne[Ie]).filter(ne=>typeof ne=="number");if(we.length===0)return"#2563eb";const _e=Math.min(...we),Ze=Math.max(...we)-_e||1;return`hsl(${120-(Number(be)-_e)/Ze*120}, 70%, 50%)`}else return fe(Ie,be,he)}return"#2563eb"},nodeRadius:k=>{if(Re==="fixed")return 6;if(Re==="outgoing")return 3+(Ye>0?(k._totalOutgoing||0)/Ye:0)*9;if(Re==="incoming")return 3+(Z>0?(k._totalIncoming||0)/Z:0)*9;if(Re==="attribute"&&ce){const me=k[ce];if(typeof me!="number")return 6;const be=G.nodes.map(Qe=>Qe[ce]).filter(Qe=>typeof Qe=="number");if(be.length===0)return 6;const we=Math.min(...be),Ee=Math.max(...be)-we||1;return 3+(me-we)/Ee*9}return 6},edgeWidth:k=>se==="weight"?.5+(k.value-D)/pe*15:Q,edgeColor:(k,me)=>{var Qe,_t;const be=(k.value-D)/pe,we=["#3b82f6","#f59e0b","#ef4444","#10b981","#8b5cf6","#ec4899","#14b8a6","#f97316"];if(!Se&&O==="direction")return me?"#1f77b4":"#d62728";let _e="#2563eb";if(O==="direction")_e=me?"#1f77b4":"#d62728";else if(O==="region"){const ne=G.nodes.find(ie=>ie.id===k.source),ve=Array.from(new Set(G.nodes.map(ie=>ie.region).filter(Boolean))),ke=new Map(ve.map((ie,He)=>[ie,we[He%we.length]]));_e=ne&&ne.region&&ke.get(ne.region)||"#2563eb"}else if(O==="division"){const ne=G.nodes.find(ie=>ie.id===k.source),ve=Array.from(new Set(G.nodes.map(ie=>ie.division).filter(Boolean))),ke=new Map(ve.map((ie,He)=>[ie,we[He%we.length]]));_e=ne&&ne.division&&ke.get(ne.division)||"#2563eb"}else if(O==="attribute"&&ue){const ne=k[ue];if(ne!=null)if((Qe=a==null?void 0:a.metadata)!=null&&Qe.hasNumericProperties.edges.includes(ue)){const ve=G.edges.map(It=>It[ue]).filter(It=>typeof It=="number"),ke=Math.min(...ve),He=Math.max(...ve)-ke||1;_e=`hsl(${120-(Number(ne)-ke)/He*120}, 70%, 50%)`}else{const ve=Array.from(new Set(G.edges.map(ie=>ie[ue]).filter(ie=>ie!=null)));_e=new Map(ve.map((ie,He)=>[ie,we[He%we.length]])).get(ne)||"#2563eb"}}else O==="single"&&(_e="#2563eb");let Ee=.6;if(ae==="weight")Ee=Math.max(0,Math.min(1,be));else if(ae==="attribute"&&Te){const ne=k[Te];if(ne!=null&&((_t=a==null?void 0:a.metadata)!=null&&_t.hasNumericProperties.edges.includes(Te))){const ve=G.edges.map(yt=>yt[Te]).filter(yt=>typeof yt=="number"),ke=Math.min(...ve),He=Math.max(...ve)-ke||1;Ee=Math.max(0,Math.min(1,(Number(ne)-ke)/He))}}else ae==="constant"&&(Ee=Math.max(0,Math.min(1,dt)));if(nt&&(O==="region"||O==="division")){const ne=G.nodes.find(ie=>ie.id===k.source),ve=G.nodes.find(ie=>ie.id===k.target);if(!(O==="region"?(ne==null?void 0:ne.region)&&ne.region===(ve==null?void 0:ve.region):(ne==null?void 0:ne.division)&&ne.division===(ve==null?void 0:ve.division)))return`hsl(0, 0%, ${80-Ee*50}%)`}const Ze=80-Ee*55;return O==="direction"?`hsl(${me?0:200}, 70%, ${Math.round(Ze)}%)`:O==="single"?`hsl(210, 70%, ${Math.round(Ze)}%)`:_e}}})(),legend:(()=>{if(Se){if(O==="region"&&ut){const p=Array.from(new Set(G.nodes.map(pe=>pe.region).filter(Boolean))),D=["#3b82f6","#f59e0b","#ef4444","#10b981","#8b5cf6","#ec4899","#14b8a6","#f97316"];return{type:"categorical",title:"Regions",entries:p.slice(0,10).map((pe,Me)=>({label:pe,color:D[Me%D.length]})),interNote:nt?"Inter edges: grayscale by intensity":void 0}}if(O==="division"&&ct){const p=Array.from(new Set(G.nodes.map(pe=>pe.division).filter(Boolean))),D=["#3b82f6","#f59e0b","#ef4444","#10b981","#8b5cf6","#ec4899","#14b8a6","#f97316"];return{type:"categorical",title:"Divisions",entries:p.slice(0,10).map((pe,Me)=>({label:pe,color:D[Me%D.length]})),interNote:nt?"Inter edges: grayscale by intensity":void 0}}if(O==="single"&&ae==="weight")return{type:"weight",color:"#1f77b4"}}else{if(O==="direction")return{type:"direction"};if(O==="single"&&ae==="weight")return{type:"weight",color:"#1f77b4"}}})(),lens:{enabled:st==="lens",x:dn.x,y:dn.y,radius:ln},onMouseMoveInCanvas:p=>{st==="lens"&&Yn(p)},onWheelInCanvas:p=>{st==="lens"&&Kn(D=>Math.max(20,Math.min(300,D+(p>0?-10:10))))}})})}),I==="table"&&r.jsx(Be,{fallback:r.jsxs("div",{className:"p-4 bg-red-50 border border-red-200 rounded-md",children:[r.jsx("h3",{className:"text-lg font-semibold text-red-800 mb-2",children:"Table View Error"}),r.jsx("p",{className:"text-sm text-red-700",children:"The table view encountered an error."})]}),children:r.jsx("div",{className:"h-full w-full flex flex-col min-h-0",children:r.jsx(Wn,{nodes:G.nodes,edges:G.edges})})}),I==="sankey"&&r.jsx(Be,{fallback:r.jsxs("div",{className:"p-4 bg-red-50 border border-red-200 rounded-md",children:[r.jsx("h3",{className:"text-lg font-semibold text-red-800 mb-2",children:"Sankey Diagram Error"}),r.jsx("p",{className:"text-sm text-red-700",children:"The Sankey diagram encountered an error."})]}),children:r.jsx("div",{className:"h-full min-h-0",children:r.jsx(Gr,{nodes:G.nodes,edges:G.edges,width:Math.max(800,Y.width-(t?64:n)-(U?4:T)-40),height:Math.max(600,Y.height-80)})})}),I==="chord"&&r.jsx(Be,{fallback:r.jsxs("div",{className:"p-4 bg-red-50 border border-red-200 rounded-md",children:[r.jsx("h3",{className:"text-lg font-semibold text-red-800 mb-2",children:"Chord Diagram Error"}),r.jsx("p",{className:"text-sm text-red-700",children:"The chord diagram encountered an error."})]}),children:r.jsx(Wr,{nodes:G.nodes,edges:G.edges,width:Math.max(800,Y.width-(t?64:n)-(U?4:T)-40),height:Math.max(600,Y.height-80)})})]}):le?r.jsxs("div",{className:"text-center text-gray-500 py-8",children:["No data meets the current threshold range (",y.toLocaleString()," - ",w.toLocaleString(),"). Try adjusting the filters."]}):r.jsx("div",{className:"text-gray-500 py-8 text-center",children:"No snapshot to display"})})}),I==="kriskogram"&&r.jsxs("div",{className:"absolute bottom-4 right-4 flex items-center gap-2 bg-white/90 backdrop-blur px-3 py-2 rounded shadow border border-gray-200",children:[r.jsx("label",{className:"text-xs font-medium text-gray-700",children:"Mode:"}),r.jsx("button",{type:"button",onClick:()=>an("pan"),className:["text-xs px-2 py-1 rounded border",st==="pan"?"bg-blue-600 text-white border-blue-600":"bg-white text-gray-700 border-gray-300"].join(" "),children:"Pan"}),r.jsx("button",{type:"button",onClick:()=>an("lens"),className:["text-xs px-2 py-1 rounded border",st==="lens"?"bg-blue-600 text-white border-blue-600":"bg-white text-gray-700 border-gray-300"].join(" "),children:"Edge Lens"}),st==="lens"&&r.jsxs("span",{className:"text-[10px] text-gray-600",children:["Wheel: radius (",ln,"px)"]})]})]}):r.jsx("div",{className:"flex-1 flex items-center justify-center text-gray-500",children:r.jsxs("div",{className:"text-center",children:[r.jsx("p",{className:"text-lg mb-2",children:"No dataset selected"}),r.jsx("p",{className:"text-sm",children:"Select a dataset from the sidebar to begin exploring"})]})})]}),a&&r.jsx(Zr,{isCollapsed:U,onToggle:()=>$(!U),onResize:W,title:"Visualization Settings",bottomContent:r.jsxs("div",{className:"p-3",children:[r.jsx("label",{className:"text-xs font-medium text-gray-600 block mb-2",children:"Visualization Type"}),r.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[r.jsx("button",{onClick:()=>{q("kriskogram"),Fe({view:"kriskogram"})},className:`px-3 py-2.5 rounded text-sm font-medium transition-colors ${I==="kriskogram"?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"Kriskogram"}),r.jsx("button",{onClick:()=>{q("table"),Fe({view:"table"})},className:`px-3 py-2.5 rounded text-sm font-medium transition-colors ${I==="table"?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"Table"}),r.jsx("button",{onClick:()=>{q("sankey"),Fe({view:"sankey"})},className:`px-3 py-2.5 rounded text-sm font-medium transition-colors ${I==="sankey"?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"Sankey"}),r.jsx("button",{onClick:()=>{q("chord"),Fe({view:"chord"})},className:`px-3 py-2.5 rounded text-sm font-medium transition-colors ${I==="chord"?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"Chord"})]})]}),children:r.jsxs("div",{className:"space-y-4",children:[r.jsxs(ot,{title:a.name,defaultOpen:!0,subtitle:`${a.type.toUpperCase()} · ${a.timeRange.start}${a.timeRange.end!==a.timeRange.start?`–${a.timeRange.end}`:""}`,children:[a.notes&&r.jsx("div",{className:"text-xs text-gray-600 mt-2 whitespace-pre-wrap",children:a.notes}),!a.notes&&r.jsx("div",{className:"text-xs text-gray-500 italic mt-2",children:"No description available"})]}),$e&&r.jsxs("div",{className:"p-3 bg-gray-50 rounded grid grid-cols-2 gap-3 text-sm",children:[r.jsxs("div",{children:[r.jsx("div",{className:"text-xs text-gray-600",children:"Nodes"}),r.jsxs("div",{className:"text-lg font-bold",children:[$e.visibleNodes,"/",$e.totalNodes]})]}),r.jsxs("div",{children:[r.jsx("div",{className:"text-xs text-gray-600",children:"Edges"}),r.jsxs("div",{className:"text-lg font-bold",children:[$e.visibleEdges.toLocaleString(),"/",$e.totalEdges.toLocaleString()]})]})]}),r.jsx(ot,{title:"General Settings",defaultOpen:!0,children:r.jsxs("div",{className:"space-y-4",children:[Zn&&c!==void 0&&r.jsxs("div",{className:"space-y-2",children:[r.jsxs("label",{className:"text-sm font-medium",children:["Year: ",c]}),r.jsx("input",{type:"range",min:a.timeRange.start,max:a.timeRange.end,value:c,onChange:p=>Qn(parseInt(p.target.value)),className:"w-full"})]}),Ke&&r.jsxs("div",{className:"space-y-2",children:[r.jsxs("label",{className:"text-sm font-medium",children:["Edge Type (",Ke.property,")"]}),r.jsxs("select",{value:P||"all",onChange:p=>{const D=p.target.value==="all"?null:p.target.value;_(D),Fe({edgeType:D})},className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[r.jsx("option",{value:"all",children:"All Types"}),Ke.values.map(p=>r.jsx("option",{value:p,children:p},p))]})]}),(ut||ct)&&r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-sm font-medium",children:"Edge Scope"}),r.jsxs("div",{className:"flex items-center gap-3 text-xs",children:[r.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[r.jsx("input",{type:"radio",name:"edgeScope",value:"none",className:"w-3.5 h-3.5",checked:F==="none",onChange:()=>A("none")}),r.jsx("span",{children:"All"})]}),ut&&r.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[r.jsx("input",{type:"radio",name:"edgeScope",value:"region",className:"w-3.5 h-3.5",checked:F==="region",onChange:()=>A("region")}),r.jsx("span",{children:"Intra Region"})]}),ct&&r.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[r.jsx("input",{type:"radio",name:"edgeScope",value:"division",className:"w-3.5 h-3.5",checked:F==="division",onChange:()=>A("division")}),r.jsx("span",{children:"Intra Division"})]}),ut&&r.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[r.jsx("input",{type:"radio",name:"edgeScope",value:"interRegion",className:"w-3.5 h-3.5",checked:F==="interRegion",onChange:()=>A("interRegion")}),r.jsx("span",{children:"Inter Region"})]}),ct&&r.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[r.jsx("input",{type:"radio",name:"edgeScope",value:"interDivision",className:"w-3.5 h-3.5",checked:F==="interDivision",onChange:()=>A("interDivision")}),r.jsx("span",{children:"Inter Division"})]})]})]}),le&&$e&&r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("label",{className:"text-sm font-medium flex items-center gap-2",children:[r.jsxs("span",{children:["Min: ",y.toLocaleString()]}),$t!==void 0&&$t>y&&r.jsxs("span",{className:"text-xs text-gray-400",children:["(actual ",$t.toLocaleString(),")"]})]}),(()=>{const p=Math.min(...le.edges.map(oe=>oe.value)),D=y>p||w<$e.maxValue||M<$e.totalEdges;return r.jsx("button",{onClick:()=>{b(p),N($e.maxValue),j(Math.max(500,$e.totalEdges))},disabled:!D,type:"button",className:`text-xs transition-colors ${D?"text-blue-600 hover:text-blue-800":"text-gray-400 cursor-not-allowed"}`,children:"Show All"})})()]}),r.jsx("input",{type:"range",min:0,max:$e.maxValue||2e5,step:Math.max(1,Math.floor(($e.maxValue||2e5)/1e3)),value:y,onChange:p=>{const D=parseInt(p.target.value),oe=Math.min(D,w);b(oe),Fe({minThreshold:oe})},className:"w-full"})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsxs("label",{className:"text-sm font-medium flex items-center gap-2",children:[r.jsxs("span",{children:["Max: ",w.toLocaleString()]}),Mt!==void 0&&Mt<w&&r.jsxs("span",{className:"text-xs text-gray-400",children:["(actual ",Mt.toLocaleString(),")"]})]}),r.jsx("input",{type:"range",min:0,max:$e.maxValue||2e5,step:Math.max(1,Math.floor(($e.maxValue||2e5)/1e3)),value:w,onChange:p=>{const D=parseInt(p.target.value),oe=Math.max(D,y);N(oe),Fe({maxThreshold:oe})},className:"w-full"})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsxs("label",{className:"text-sm font-medium",children:["Max Edges: ",M]}),r.jsx("input",{type:"range",min:10,max:Math.max(500,$e.totalEdges),step:10,value:M,onChange:p=>{const D=parseInt(p.target.value);j(D),Fe({maxEdges:D})},className:"w-full"}),r.jsxs("p",{className:"text-xs text-gray-600 italic",children:["After filtering by thresholds and edge type, edges are sorted by value (highest first) and the top ",M," edges are displayed."]})]})]})]})}),I==="kriskogram"&&r.jsx(ot,{title:"Kriskogram Settings",defaultOpen:!0,children:a!=null&&a.metadata?r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsx("label",{className:"text-xs font-medium text-gray-700",children:"Node Ordering"}),r.jsxs("div",{className:"flex flex-col gap-1.5",children:[r.jsxs("label",{className:"flex items-center gap-2 cursor-pointer text-xs",children:[r.jsx("input",{type:"radio",name:"nodeOrder",value:"alphabetical",checked:te==="alphabetical",onChange:p=>ge(p.target.value),className:"w-3.5 h-3.5"}),r.jsx("span",{children:"Alphabetical"})]}),a.metadata.hasCategoricalProperties.nodes.map(p=>r.jsxs("label",{className:"flex items-center gap-2 cursor-pointer text-xs",children:[r.jsx("input",{type:"radio",name:"nodeOrder",value:p,checked:te===p,onChange:D=>ge(D.target.value),className:"w-3.5 h-3.5"}),r.jsxs("span",{children:["By ",p]})]},p)),a.metadata.hasNumericProperties.nodes.map(p=>r.jsxs("label",{className:"flex items-center gap-2 cursor-pointer text-xs",children:[r.jsx("input",{type:"radio",name:"nodeOrder",value:p,checked:te===p,onChange:D=>ge(D.target.value),className:"w-3.5 h-3.5"}),r.jsxs("span",{children:["By ",p]})]},p))]})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsxs("label",{className:"text-xs font-medium text-gray-700",children:["Arc Opacity: ",Math.round(C*100),"%"]}),r.jsx("input",{type:"range",min:0,max:1,step:.05,value:C,onChange:p=>V(parseFloat(p.target.value)),className:"w-full"})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx("label",{className:"text-xs font-medium text-gray-700",children:"Edge Width"}),r.jsxs("div",{className:"flex items-center gap-3 text-xs",children:[r.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[r.jsx("input",{type:"radio",name:"edgeWidthMode",value:"weight",checked:se==="weight",onChange:()=>xe("weight"),className:"w-3.5 h-3.5"}),r.jsx("span",{children:"By Weight"})]}),r.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[r.jsx("input",{type:"radio",name:"edgeWidthMode",value:"fixed",checked:se==="fixed",onChange:()=>xe("fixed"),className:"w-3.5 h-3.5"}),r.jsx("span",{children:"Fixed"})]})]}),se==="fixed"&&r.jsxs("div",{className:"mt-2",children:[r.jsxs("label",{className:"text-xs font-medium text-gray-700",children:["Base Edge Width: ",Q.toFixed(1),"px"]}),r.jsx("input",{type:"range",min:.5,max:8,step:.1,value:Q,onChange:p=>X(parseFloat(p.target.value)),className:"w-full"})]})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("label",{className:"text-xs font-medium text-gray-700",children:"Edge Color"}),r.jsxs("label",{className:"flex items-center gap-1 text-[11px] text-gray-600 cursor-pointer",children:[r.jsx("input",{type:"checkbox",className:"w-3.5 h-3.5",checked:Se,onChange:p=>H(p.target.checked)}),"Advanced"]})]}),!Se&&r.jsxs("div",{className:"flex flex-col gap-1.5 text-xs",children:[r.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[r.jsx("input",{type:"radio",name:"edgeColorHueSimple",value:"direction",checked:O==="direction",onChange:()=>B("direction"),className:"w-3.5 h-3.5"}),r.jsx("span",{children:"By Direction (Above/Below)"})]}),r.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[r.jsx("input",{type:"radio",name:"edgeColorHueSimple",value:"weight",checked:ae==="weight"&&O==="single",onChange:()=>{B("single"),ye("weight")},className:"w-3.5 h-3.5"}),r.jsx("span",{children:"By Weight Intensity"})]})]}),Se&&r.jsxs("div",{className:"space-y-3",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-gray-700",children:"Hue Source"}),r.jsxs("div",{className:"grid grid-cols-2 gap-2 text-xs",children:[r.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[r.jsx("input",{type:"radio",name:"edgeHue",value:"direction",className:"w-3.5 h-3.5",checked:O==="direction",onChange:()=>B("direction")}),r.jsx("span",{children:"Direction"})]}),ut&&r.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[r.jsx("input",{type:"radio",name:"edgeHue",value:"region",className:"w-3.5 h-3.5",checked:O==="region",onChange:()=>B("region")}),r.jsx("span",{children:"Region"})]}),ct&&r.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[r.jsx("input",{type:"radio",name:"edgeHue",value:"division",className:"w-3.5 h-3.5",checked:O==="division",onChange:()=>B("division")}),r.jsx("span",{children:"Division"})]}),r.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[r.jsx("input",{type:"radio",name:"edgeHue",value:"attribute",className:"w-3.5 h-3.5",checked:O==="attribute",onChange:()=>B("attribute")}),r.jsx("span",{children:"Attribute"})]}),r.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[r.jsx("input",{type:"radio",name:"edgeHue",value:"single",className:"w-3.5 h-3.5",checked:O==="single",onChange:()=>B("single")}),r.jsx("span",{children:"Single"})]})]}),O==="attribute"&&(a==null?void 0:a.metadata)&&r.jsxs("div",{className:"mt-2",children:[r.jsx("label",{className:"text-xs text-gray-600",children:"Hue Attribute"}),r.jsxs("select",{className:"w-full px-2 py-1.5 text-xs border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",value:ue||"",onChange:p=>Ne(p.target.value||null),children:[r.jsx("option",{value:"",children:"Select attribute…"}),[...a.metadata.hasNumericProperties.edges,...a.metadata.hasCategoricalProperties.edges].filter((p,D,oe)=>oe.indexOf(p)===D).map(p=>r.jsx("option",{value:p,children:p},p))]})]}),(O==="region"||O==="division")&&r.jsxs("label",{className:"flex items-center gap-2 mt-2 text-[11px] text-gray-600 cursor-pointer",children:[r.jsx("input",{type:"checkbox",className:"w-3.5 h-3.5",checked:nt,onChange:p=>R(p.target.checked)}),"Inter edges grayscale by intensity"]})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-gray-700",children:"Intensity Source"}),r.jsxs("div",{className:"flex items-center gap-3 text-xs",children:[r.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[r.jsx("input",{type:"radio",name:"edgeIntensity",value:"weight",className:"w-3.5 h-3.5",checked:ae==="weight",onChange:()=>ye("weight")}),r.jsx("span",{children:"Weight"})]}),r.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[r.jsx("input",{type:"radio",name:"edgeIntensity",value:"constant",className:"w-3.5 h-3.5",checked:ae==="constant",onChange:()=>ye("constant")}),r.jsx("span",{children:"Constant"})]}),r.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[r.jsx("input",{type:"radio",name:"edgeIntensity",value:"attribute",className:"w-3.5 h-3.5",checked:ae==="attribute",onChange:()=>ye("attribute")}),r.jsx("span",{children:"Attribute"})]})]}),ae==="constant"&&r.jsxs("div",{className:"mt-2",children:[r.jsxs("label",{className:"text-xs text-gray-600",children:["Constant Intensity: ",(dt*100).toFixed(0),"%"]}),r.jsx("input",{type:"range",min:0,max:1,step:.01,value:dt,onChange:p=>vt(parseFloat(p.target.value)),className:"w-full"})]}),ae==="attribute"&&(a==null?void 0:a.metadata)&&r.jsxs("div",{className:"mt-2",children:[r.jsx("label",{className:"text-xs text-gray-600",children:"Intensity Attribute"}),r.jsxs("select",{className:"w-full px-2 py-1.5 text-xs border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",value:Te||"",onChange:p=>xt(p.target.value||null),children:[r.jsx("option",{value:"",children:"Select attribute…"}),a.metadata.hasNumericProperties.edges.map(p=>r.jsx("option",{value:p,children:p},p))]})]})]})]})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx("label",{className:"text-xs font-medium text-gray-700",children:"Node Color"}),r.jsxs("div",{className:"flex flex-col gap-1.5",children:[r.jsxs("label",{className:"flex items-center gap-2 cursor-pointer text-xs",children:[r.jsx("input",{type:"radio",name:"nodeColor",value:"single",checked:K==="single",onChange:p=>J(p.target.value),className:"w-3.5 h-3.5"}),r.jsx("span",{children:"Single"})]}),r.jsxs("label",{className:"flex items-center gap-2 cursor-pointer text-xs",children:[r.jsx("input",{type:"radio",name:"nodeColor",value:"outgoing",checked:K==="outgoing",onChange:p=>J(p.target.value),className:"w-3.5 h-3.5"}),r.jsx("span",{children:"Total Outgoing"})]}),r.jsxs("label",{className:"flex items-center gap-2 cursor-pointer text-xs",children:[r.jsx("input",{type:"radio",name:"nodeColor",value:"incoming",checked:K==="incoming",onChange:p=>J(p.target.value),className:"w-3.5 h-3.5"}),r.jsx("span",{children:"Total Incoming"})]}),r.jsxs("label",{className:"flex items-center gap-2 cursor-pointer text-xs",children:[r.jsx("input",{type:"radio",name:"nodeColor",value:"attribute",checked:K==="attribute",onChange:p=>J(p.target.value),className:"w-3.5 h-3.5"}),r.jsx("span",{children:"By Attribute"})]})]}),K==="attribute"&&r.jsxs("select",{value:Ie||"",onChange:p=>We(p.target.value||null),className:"w-full px-2 py-1.5 text-xs border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[r.jsx("option",{value:"",children:"Select..."}),a.metadata.hasCategoricalProperties.nodes.map(p=>r.jsx("option",{value:p,children:p},p)),a.metadata.hasNumericProperties.nodes.map(p=>r.jsx("option",{value:p,children:p},p))]})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx("label",{className:"text-xs font-medium text-gray-700",children:"Node Size"}),r.jsxs("div",{className:"flex flex-col gap-1.5",children:[r.jsxs("label",{className:"flex items-center gap-2 cursor-pointer text-xs",children:[r.jsx("input",{type:"radio",name:"nodeSize",value:"fixed",checked:Re==="fixed",onChange:p=>re(p.target.value),className:"w-3.5 h-3.5"}),r.jsx("span",{children:"Fixed"})]}),r.jsxs("label",{className:"flex items-center gap-2 cursor-pointer text-xs",children:[r.jsx("input",{type:"radio",name:"nodeSize",value:"outgoing",checked:Re==="outgoing",onChange:p=>re(p.target.value),className:"w-3.5 h-3.5"}),r.jsx("span",{children:"Total Outgoing"})]}),r.jsxs("label",{className:"flex items-center gap-2 cursor-pointer text-xs",children:[r.jsx("input",{type:"radio",name:"nodeSize",value:"incoming",checked:Re==="incoming",onChange:p=>re(p.target.value),className:"w-3.5 h-3.5"}),r.jsx("span",{children:"Total Incoming"})]}),r.jsxs("label",{className:"flex items-center gap-2 cursor-pointer text-xs",children:[r.jsx("input",{type:"radio",name:"nodeSize",value:"attribute",checked:Re==="attribute",onChange:p=>re(p.target.value),className:"w-3.5 h-3.5"}),r.jsx("span",{children:"By Attribute"})]})]}),Re==="attribute"&&r.jsxs("select",{value:ce||"",onChange:p=>Xn(p.target.value||null),className:"w-full px-2 py-1.5 text-xs border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[r.jsx("option",{value:"",children:"Select..."}),a.metadata.hasNumericProperties.nodes.map(p=>r.jsx("option",{value:p,children:p},p))]})]})]}):r.jsx("div",{className:"text-xs text-gray-500 italic",children:"No dataset metadata available"})}),I==="table"&&r.jsx(ot,{title:"Table Settings",defaultOpen:!1,children:r.jsx("div",{className:"text-xs text-gray-500 italic",children:"Settings to be added"})}),I==="sankey"&&r.jsx(ot,{title:"Sankey Settings",defaultOpen:!1,children:r.jsx("div",{className:"text-xs text-gray-500 italic",children:"Settings to be added"})}),I==="chord"&&r.jsx(ot,{title:"Chord Settings",defaultOpen:!1,children:r.jsx("div",{className:"text-xs text-gray-500 italic",children:"Settings to be added"})})]})})]})})}async function Qr(){const e="csv-2021",s="gexf-sample",t="swiss-2016",n=await lt(e),o=await lt(s),i=await lt(t);if(!n){const l=new URL("/INF358_Project_Kriskogram/assets/State_to_State_Migrations_Table_2021-CSM7xeRj.csv",import.meta.url),a=await Et(l.toString()),d=En(a),c={timestamp:2021,nodes:d.nodes,edges:d.edges},u=ft(c),m={id:e,name:"US State-to-State Migration (2021)",notes:"Real U.S. Census Bureau data showing migration flows between all 50 states from the American Community Survey 1-Year Estimates.",type:"csv",timeRange:{start:2021,end:2021},snapshots:[c],metadata:u,createdAt:Date.now()};await at(m)}if(!o){const l=new URL("/INF358_Project_Kriskogram/assets/sample-migration-data-d7g-pjXp.gexf",import.meta.url),a=await us(l.toString()),d=Pn(a),c=d.length>0?ft(d[0]):void 0,u={id:s,name:"Sample Migration (GEXF)",notes:"AI-generated sample network dataset in GEXF format demonstrating temporal migration patterns with multiple time slices. This example dataset includes economic, geographic, and migration type attributes for demonstration purposes.",type:"gexf",timeRange:a.timeRange,snapshots:d,metadata:c,createdAt:Date.now()};await at(u)}if(!i){const l="/INF358_Project_Kriskogram/",a=`${l}data/Swiss_Relocations_2016_locations.csv`,d=`${l}data/Swiss_Relocations_2016_flows.csv`,c=await Et(a),u=await Et(d),m=kn({nodesFile:{content:c,idField:"id",labelField:"name"},edgesFile:{content:u,sourceField:"origin",targetField:"dest",valueField:"count"}}),f={timestamp:2016,nodes:m.nodes,edges:m.edges},g=ft(f),h={id:t,name:"Swiss Relocations (2016)",notes:"Relocations between Swiss cantons in 2016. This dataset contains 521,510 trips and uses a two-file CSV format with separate files for locations (cantons) and flows (relocations). Created by Ilya Boyandin.",type:"csv-two-file",timeRange:{start:2016,end:2016},snapshots:[f],metadata:g,createdAt:Date.now()};await at(h)}return e}export{so as component};
