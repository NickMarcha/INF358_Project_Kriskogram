import{r,j as e,K as E}from"./main-BzCnkqc8.js";import{l as R,g as K,c as A}from"./gexf-parser-ChiJebeW.js";function I({gexfUrl:m}){const[l,d]=r.useState(2020),[h,f]=r.useState([]),[j,u]=r.useState(!1),[x,g]=r.useState(null),[i,p]=r.useState({start:2020,end:2024}),o=r.useRef(null);r.useEffect(()=>{b()},[m]);const b=async()=>{u(!0),g(null);try{let s;if(m){const t=await R(m);s=K(t),p(t.timeRange)}else{const t=A();s=[{nodes:t.nodes,edges:t.edges,timestamp:2020}],p({start:2020,end:2020})}f(s),d(i.start)}catch(s){g(s instanceof Error?s.message:"Failed to load data")}finally{u(!1)}},a=h.find(s=>s.timestamp===l),v=s=>{d(s);const t=h.find(n=>n.timestamp===s);t&&o.current&&o.current.updateData(t.nodes,t.edges)},N=()=>{let s=i.start;const t=setInterval(()=>{if(s<=i.end){d(s);const n=h.find(c=>c.timestamp===s);n&&o.current&&o.current.updateData(n.nodes,n.edges),s++}else clearInterval(t)},1e3)};return j?e.jsx("div",{className:"flex items-center justify-center p-8",children:e.jsx("div",{className:"text-lg",children:"Loading GEXF data..."})}):x?e.jsx("div",{className:"flex items-center justify-center p-8",children:e.jsxs("div",{className:"text-red-600",children:["Error: ",x]})}):e.jsx("div",{className:"p-6 space-y-6",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[e.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Kriskogram Demo"}),e.jsxs("div",{className:"mb-6 space-y-4",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("label",{className:"text-sm font-medium",children:"Year:"}),e.jsx("input",{type:"range",min:i.start,max:i.end,value:l,onChange:s=>v(parseInt(s.target.value)),className:"flex-1"}),e.jsx("span",{className:"text-lg font-mono w-16",children:l})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("button",{onClick:N,className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700",children:"Play Animation"}),e.jsx("button",{onClick:()=>d(i.start),className:"px-4 py-2 bg-gray-600 text-white rounded hover:bg-gray-700",children:"Reset"})]})]}),a&&e.jsxs("div",{className:"mb-6 p-4 bg-gray-50 rounded",children:[e.jsxs("h3",{className:"font-semibold mb-2",children:["Current Snapshot (",l,")"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Nodes:"})," ",a.nodes.length]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Edges:"})," ",a.edges.length]})]})]}),e.jsx("div",{className:"border-2 border-gray-200 rounded-lg p-4",children:a?e.jsxs("div",{children:[e.jsx(E,{ref:o,nodes:a.nodes,edges:a.edges,width:1e3,height:600,margin:{top:60,right:40,bottom:60,left:40},accessors:{nodeOrder:s=>s.id,nodeColor:s=>s.economic_index?`hsl(${s.economic_index*120}, 70%, 50%)`:"#555",nodeRadius:s=>s.population?Math.sqrt(s.population)/1e3:6,edgeWidth:s=>Math.sqrt(s.value)/10,edgeColor:(s,t)=>{const n=a.edges.map(D=>D.value),c=Math.min(...n),y=Math.max(...n),S=(s.value-c)/(y-c),k=200,w=70,C=75-S*50;return`hsl(${k}, ${w}%, ${C}%)`}}}),e.jsxs("details",{className:"mt-4 text-left",children:[e.jsx("summary",{className:"cursor-pointer text-sm font-medium",children:"Debug Data"}),e.jsx("pre",{className:"mt-2 text-xs bg-gray-100 p-2 rounded overflow-auto max-h-40",children:JSON.stringify(a,null,2)})]})]}):e.jsxs("div",{className:"text-center text-gray-500 py-8",children:["No data available for year ",l]})}),e.jsxs("div",{className:"mt-6 p-4 bg-blue-50 rounded",children:[e.jsx("h3",{className:"font-semibold text-blue-900 mb-2",children:"Usage Instructions"}),e.jsxs("ul",{className:"text-sm text-blue-800 space-y-1",children:[e.jsx("li",{children:"• Use the slider to navigate through different years"}),e.jsx("li",{children:'• Click "Play Animation" to see the temporal changes'}),e.jsx("li",{children:"• The data includes migration flows between major US cities"}),e.jsx("li",{children:"• Each edge represents migration volume and includes attributes like distance and economic factors"})]})]})]})})}const $=I;export{$ as component};
