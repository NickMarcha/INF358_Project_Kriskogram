import{c as hs,r as p,j as r,s as De,o as lo,a as un,z as ko,i as Po,C as Vo,G as Do,u as Oo,b as To,d as Lo,K as zo,e as an,f as Ho,p as $e,g as dn,n as pt,h as Go,k as Bo}from"./main-BzCnkqc8.js";import{p as is,l as Sr}from"./csv-parser-BH7H656y.js";import{p as Uo,g as uo,l as Wo}from"./gexf-parser-ChiJebeW.js";import{S as qo,a as Ls}from"./stateMigrationFiles-CyfipyKt.js";/**
 * @license lucide-react v0.476.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ko=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],Yo=hs("ChevronDown",Ko);/**
 * @license lucide-react v0.476.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xo=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],Zo=hs("ChevronUp",Xo);/**
 * @license lucide-react v0.476.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qo=[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],zs=hs("Settings",Qo);function Jo(e,n){return e==null||n==null?NaN:n<e?-1:n>e?1:n>=e?0:NaN}var Hs=Math.abs,qr=Math.cos,Kr=Math.sin,co=Math.PI,wr=co/2,Gs=co*2,Bs=Math.max,Yr=1e-12;function Us(e,n){return Array.from({length:n-e},(t,s)=>e+s)}function ea(e){return function(n,t){return e(n.source.value+n.target.value,t.source.value+t.target.value)}}function ta(){return na(!1)}function na(e,n){var t=0,s=null,o=null,i=null;function u(a){var d=a.length,m=new Array(d),g=Us(0,d),y=new Array(d*d),h=new Array(d),f=0,_;a=Float64Array.from({length:d*d},(C,w)=>a[w/d|0][w%d]);for(let C=0;C<d;++C){let w=0;for(let v=0;v<d;++v)w+=a[C*d+v]+e*a[v*d+C];f+=m[C]=w}f=Bs(0,Gs-t*d)/f,_=f?t:Gs/d;{let C=0;s&&g.sort((w,v)=>s(m[w],m[v]));for(const w of g){const v=C;{const S=Us(0,d).filter(b=>a[w*d+b]||a[b*d+w]);o&&S.sort((b,j)=>o(a[w*d+b],a[w*d+j]));for(const b of S){let j;if(w<b?(j=y[w*d+b]||(y[w*d+b]={source:null,target:null}),j.source={index:w,startAngle:C,endAngle:C+=a[w*d+b]*f,value:a[w*d+b]}):(j=y[b*d+w]||(y[b*d+w]={source:null,target:null}),j.target={index:w,startAngle:C,endAngle:C+=a[w*d+b]*f,value:a[w*d+b]},w===b&&(j.source=j.target)),j.source&&j.target&&j.source.value<j.target.value){const k=j.source;j.source=j.target,j.target=k}}h[w]={index:w,startAngle:v,endAngle:C,value:m[w]}}C+=_}}return y=Object.values(y),y.groups=h,i?y.sort(i):y}return u.padAngle=function(a){return arguments.length?(t=Bs(0,a),u):t},u.sortGroups=function(a){return arguments.length?(s=a,u):s},u.sortSubgroups=function(a){return arguments.length?(o=a,u):o},u.sortChords=function(a){return arguments.length?(a==null?i=null:(i=ea(a))._=a,u):i&&i._},u}const ls=Math.PI,us=2*ls,on=1e-6,ra=us-on;function go(e){this._+=e[0];for(let n=1,t=e.length;n<t;++n)this._+=arguments[n]+e[n]}function sa(e){let n=Math.floor(e);if(!(n>=0))throw new Error(`invalid digits: ${e}`);if(n>15)return go;const t=10**n;return function(s){this._+=s[0];for(let o=1,i=s.length;o<i;++o)this._+=Math.round(arguments[o]*t)/t+s[o]}}class xs{constructor(n){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=n==null?go:sa(n)}moveTo(n,t){this._append`M${this._x0=this._x1=+n},${this._y0=this._y1=+t}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(n,t){this._append`L${this._x1=+n},${this._y1=+t}`}quadraticCurveTo(n,t,s,o){this._append`Q${+n},${+t},${this._x1=+s},${this._y1=+o}`}bezierCurveTo(n,t,s,o,i,u){this._append`C${+n},${+t},${+s},${+o},${this._x1=+i},${this._y1=+u}`}arcTo(n,t,s,o,i){if(n=+n,t=+t,s=+s,o=+o,i=+i,i<0)throw new Error(`negative radius: ${i}`);let u=this._x1,a=this._y1,d=s-n,m=o-t,g=u-n,y=a-t,h=g*g+y*y;if(this._x1===null)this._append`M${this._x1=n},${this._y1=t}`;else if(h>on)if(!(Math.abs(y*d-m*g)>on)||!i)this._append`L${this._x1=n},${this._y1=t}`;else{let f=s-u,_=o-a,C=d*d+m*m,w=f*f+_*_,v=Math.sqrt(C),S=Math.sqrt(h),b=i*Math.tan((ls-Math.acos((C+h-w)/(2*v*S)))/2),j=b/S,k=b/v;Math.abs(j-1)>on&&this._append`L${n+j*g},${t+j*y}`,this._append`A${i},${i},0,0,${+(y*f>g*_)},${this._x1=n+k*d},${this._y1=t+k*m}`}}arc(n,t,s,o,i,u){if(n=+n,t=+t,s=+s,u=!!u,s<0)throw new Error(`negative radius: ${s}`);let a=s*Math.cos(o),d=s*Math.sin(o),m=n+a,g=t+d,y=1^u,h=u?o-i:i-o;this._x1===null?this._append`M${m},${g}`:(Math.abs(this._x1-m)>on||Math.abs(this._y1-g)>on)&&this._append`L${m},${g}`,s&&(h<0&&(h=h%us+us),h>ra?this._append`A${s},${s},0,1,${y},${n-a},${t-d}A${s},${s},0,1,${y},${this._x1=m},${this._y1=g}`:h>on&&this._append`A${s},${s},0,${+(h>=ls)},${y},${this._x1=n+s*Math.cos(i)},${this._y1=t+s*Math.sin(i)}`)}rect(n,t,s,o){this._append`M${this._x0=this._x1=+n},${this._y0=this._y1=+t}h${s=+s}v${+o}h${-s}Z`}toString(){return this._}}function ys(){return new xs}ys.prototype=xs.prototype;var oa=Array.prototype.slice;function Fn(e){return function(){return e}}function aa(e){return e.source}function ia(e){return e.target}function Ws(e){return e.radius}function la(e){return e.startAngle}function ua(e){return e.endAngle}function da(){return 0}function ca(e){var n=aa,t=ia,s=Ws,o=Ws,i=la,u=ua,a=da,d=null;function m(){var g,y=n.apply(this,arguments),h=t.apply(this,arguments),f=a.apply(this,arguments)/2,_=oa.call(arguments),C=+s.apply(this,(_[0]=y,_)),w=i.apply(this,_)-wr,v=u.apply(this,_)-wr,S=+o.apply(this,(_[0]=h,_)),b=i.apply(this,_)-wr,j=u.apply(this,_)-wr;if(d||(d=g=ys()),f>Yr&&(Hs(v-w)>f*2+Yr?v>w?(w+=f,v-=f):(w-=f,v+=f):w=v=(w+v)/2,Hs(j-b)>f*2+Yr?j>b?(b+=f,j-=f):(b-=f,j+=f):b=j=(b+j)/2),d.moveTo(C*qr(w),C*Kr(w)),d.arc(0,0,C,w,v),(w!==b||v!==j)&&(d.quadraticCurveTo(0,0,S*qr(b),S*Kr(b)),d.arc(0,0,S,b,j)),d.quadraticCurveTo(0,0,C*qr(w),C*Kr(w)),d.closePath(),g)return d=null,g+""||null}return m.radius=function(g){return arguments.length?(s=o=typeof g=="function"?g:Fn(+g),m):s},m.sourceRadius=function(g){return arguments.length?(s=typeof g=="function"?g:Fn(+g),m):s},m.targetRadius=function(g){return arguments.length?(o=typeof g=="function"?g:Fn(+g),m):o},m.startAngle=function(g){return arguments.length?(i=typeof g=="function"?g:Fn(+g),m):i},m.endAngle=function(g){return arguments.length?(u=typeof g=="function"?g:Fn(+g),m):u},m.padAngle=function(g){return arguments.length?(a=typeof g=="function"?g:Fn(+g),m):a},m.source=function(g){return arguments.length?(n=g,m):n},m.target=function(g){return arguments.length?(t=g,m):t},m.context=function(g){return arguments.length?(d=g??null,m):d},m}function ga(){return ca()}function ma(e){for(var n=e.length/6|0,t=new Array(n),s=0;s<n;)t[s]="#"+e.slice(s*6,++s*6);return t}const mo=ma("1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf");function Lt(e){return function(){return e}}const qs=Math.abs,Ye=Math.atan2,nn=Math.cos,fa=Math.max,Xr=Math.min,jt=Math.sin,$n=Math.sqrt,ot=1e-12,qn=Math.PI,Fr=qn/2,pa=2*qn;function ha(e){return e>1?0:e<-1?qn:Math.acos(e)}function Ks(e){return e>=1?Fr:e<=-1?-Fr:Math.asin(e)}function xa(e){let n=3;return e.digits=function(t){if(!arguments.length)return n;if(t==null)n=null;else{const s=Math.floor(t);if(!(s>=0))throw new RangeError(`invalid digits: ${t}`);n=s}return e},()=>new xs(n)}function ya(e){return e.innerRadius}function va(e){return e.outerRadius}function ba(e){return e.startAngle}function Sa(e){return e.endAngle}function wa(e){return e&&e.padAngle}function _a(e,n,t,s,o,i,u,a){var d=t-e,m=s-n,g=u-o,y=a-i,h=y*d-g*m;if(!(h*h<ot))return h=(g*(n-i)-y*(e-o))/h,[e+h*d,n+h*m]}function _r(e,n,t,s,o,i,u){var a=e-t,d=n-s,m=(u?i:-i)/$n(a*a+d*d),g=m*d,y=-m*a,h=e+g,f=n+y,_=t+g,C=s+y,w=(h+_)/2,v=(f+C)/2,S=_-h,b=C-f,j=S*S+b*b,k=o-i,R=h*C-_*f,U=(b<0?-1:1)*$n(fa(0,k*k*j-R*R)),O=(R*b-S*U)/j,H=(-R*S-b*U)/j,ie=(R*b+S*U)/j,K=(-R*S+b*U)/j,ue=O-w,E=H-v,re=ie-w,le=K-v;return ue*ue+E*E>re*re+le*le&&(O=ie,H=K),{cx:O,cy:H,x01:-g,y01:-y,x11:O*(o/k-1),y11:H*(o/k-1)}}function Ca(){var e=ya,n=va,t=Lt(0),s=null,o=ba,i=Sa,u=wa,a=null,d=xa(m);function m(){var g,y,h=+e.apply(this,arguments),f=+n.apply(this,arguments),_=o.apply(this,arguments)-Fr,C=i.apply(this,arguments)-Fr,w=qs(C-_),v=C>_;if(a||(a=g=d()),f<h&&(y=f,f=h,h=y),!(f>ot))a.moveTo(0,0);else if(w>pa-ot)a.moveTo(f*nn(_),f*jt(_)),a.arc(0,0,f,_,C,!v),h>ot&&(a.moveTo(h*nn(C),h*jt(C)),a.arc(0,0,h,C,_,v));else{var S=_,b=C,j=_,k=C,R=w,U=w,O=u.apply(this,arguments)/2,H=O>ot&&(s?+s.apply(this,arguments):$n(h*h+f*f)),ie=Xr(qs(f-h)/2,+t.apply(this,arguments)),K=ie,ue=ie,E,re;if(H>ot){var le=Ks(H/h*jt(O)),be=Ks(H/f*jt(O));(R-=le*2)>ot?(le*=v?1:-1,j+=le,k-=le):(R=0,j=k=(_+C)/2),(U-=be*2)>ot?(be*=v?1:-1,S+=be,b-=be):(U=0,S=b=(_+C)/2)}var de=f*nn(S),Ne=f*jt(S),Ee=h*nn(k),$=h*jt(k);if(ie>ot){var q=f*nn(b),Ie=f*jt(b),ge=h*nn(j),Ze=h*jt(j),L;if(w<qn)if(L=_a(de,Ne,ge,Ze,q,Ie,Ee,$)){var Te=de-L[0],J=Ne-L[1],Be=q-L[0],Me=Ie-L[1],Qe=1/jt(ha((Te*Be+J*Me)/($n(Te*Te+J*J)*$n(Be*Be+Me*Me)))/2),Ae=$n(L[0]*L[0]+L[1]*L[1]);K=Xr(ie,(h-Ae)/(Qe-1)),ue=Xr(ie,(f-Ae)/(Qe+1))}else K=ue=0}U>ot?ue>ot?(E=_r(ge,Ze,de,Ne,f,ue,v),re=_r(q,Ie,Ee,$,f,ue,v),a.moveTo(E.cx+E.x01,E.cy+E.y01),ue<ie?a.arc(E.cx,E.cy,ue,Ye(E.y01,E.x01),Ye(re.y01,re.x01),!v):(a.arc(E.cx,E.cy,ue,Ye(E.y01,E.x01),Ye(E.y11,E.x11),!v),a.arc(0,0,f,Ye(E.cy+E.y11,E.cx+E.x11),Ye(re.cy+re.y11,re.cx+re.x11),!v),a.arc(re.cx,re.cy,ue,Ye(re.y11,re.x11),Ye(re.y01,re.x01),!v))):(a.moveTo(de,Ne),a.arc(0,0,f,S,b,!v)):a.moveTo(de,Ne),!(h>ot)||!(R>ot)?a.lineTo(Ee,$):K>ot?(E=_r(Ee,$,q,Ie,h,-K,v),re=_r(de,Ne,ge,Ze,h,-K,v),a.lineTo(E.cx+E.x01,E.cy+E.y01),K<ie?a.arc(E.cx,E.cy,K,Ye(E.y01,E.x01),Ye(re.y01,re.x01),!v):(a.arc(E.cx,E.cy,K,Ye(E.y01,E.x01),Ye(E.y11,E.x11),!v),a.arc(0,0,h,Ye(E.cy+E.y11,E.cx+E.x11),Ye(re.cy+re.y11,re.cx+re.x11),v),a.arc(re.cx,re.cy,K,Ye(re.y11,re.x11),Ye(re.y01,re.x01),!v))):a.arc(0,0,h,k,j,v)}if(a.closePath(),g)return a=null,g+""||null}return m.centroid=function(){var g=(+e.apply(this,arguments)+ +n.apply(this,arguments))/2,y=(+o.apply(this,arguments)+ +i.apply(this,arguments))/2-qn/2;return[nn(y)*g,jt(y)*g]},m.innerRadius=function(g){return arguments.length?(e=typeof g=="function"?g:Lt(+g),m):e},m.outerRadius=function(g){return arguments.length?(n=typeof g=="function"?g:Lt(+g),m):n},m.cornerRadius=function(g){return arguments.length?(t=typeof g=="function"?g:Lt(+g),m):t},m.padRadius=function(g){return arguments.length?(s=g==null?null:typeof g=="function"?g:Lt(+g),m):s},m.startAngle=function(g){return arguments.length?(o=typeof g=="function"?g:Lt(+g),m):o},m.endAngle=function(g){return arguments.length?(i=typeof g=="function"?g:Lt(+g),m):i},m.padAngle=function(g){return arguments.length?(u=typeof g=="function"?g:Lt(+g),m):u},m.context=function(g){return arguments.length?(a=g??null,m):a},m}const Na="/INF358_Project_Kriskogram/assets/state_to_state_migration_table_2022_t13_updated_2024_06_27_2022-D7hzY5-5.csv",ja="/INF358_Project_Kriskogram/assets/state_to_state_migration_table_2023_t13_2023-Da-tSzHC.csv",Ma="/INF358_Project_Kriskogram/assets/state_to_state_migrations_table_2005_2005-5D0dAV6T.csv",Fa="/INF358_Project_Kriskogram/assets/state_to_state_migrations_table_2005_2007_2005-2007-C2gBOjzD.csv",Ra="/INF358_Project_Kriskogram/assets/state_to_state_migrations_table_2005_2009_2005-2009-oSLcshdC.csv",$a="/INF358_Project_Kriskogram/assets/state_to_state_migrations_table_2006_2006-C-EFanec.csv",Ea="/INF358_Project_Kriskogram/assets/state_to_state_migrations_table_2006_2008_2006-2008-Cp1NRBpc.csv",Ia="/INF358_Project_Kriskogram/assets/state_to_state_migrations_table_2007_2007-BXoQRRMn.csv",Aa="/INF358_Project_Kriskogram/assets/state_to_state_migrations_table_2007_2009_2007-2009-Qdd3KwND.csv",ka="/INF358_Project_Kriskogram/assets/state_to_state_migrations_table_2008_2008--00JWAqc.csv",Pa="/INF358_Project_Kriskogram/assets/state_to_state_migrations_table_2009_2009-5yGj8NCd.csv",Va="/INF358_Project_Kriskogram/assets/state_to_state_migrations_table_2010_2010-CSB90FrU.csv",Da="/INF358_Project_Kriskogram/assets/state_to_state_migrations_table_2011_2011-BzRnLs5h.csv",Oa="/INF358_Project_Kriskogram/assets/state_to_state_migrations_table_2012_2012-DrbWwk1R.csv",Ta="/INF358_Project_Kriskogram/assets/state_to_state_migrations_table_2013_2013-CTsYcw-F.csv",La="/INF358_Project_Kriskogram/assets/state_to_state_migrations_table_2014_2014-D8ze7hKk.csv",za="/INF358_Project_Kriskogram/assets/state_to_state_migrations_table_2015_2015-Sg6Ir2qO.csv",Ha="/INF358_Project_Kriskogram/assets/state_to_state_migrations_table_2016_2016-C26kP0Bk.csv",Ga="/INF358_Project_Kriskogram/assets/state_to_state_migrations_table_2017_2017-BNMbL_en.csv",Ba="/INF358_Project_Kriskogram/assets/state_to_state_migrations_table_2018_2018-DTnLPVgj.csv",Ua="/INF358_Project_Kriskogram/assets/state_to_state_migrations_table_2019_2019-Bd1nphS1.csv",Wa="/INF358_Project_Kriskogram/assets/State_to_State_Migrations_Table_2021-N7RTh5uH.csv";function ln(e){const n=new Set,t=new Set,s=new Set,o=new Set,i=new Set,u=new Set;return e.nodes.forEach(a=>{Object.keys(a).forEach(d=>{if(d!=="id"&&d!=="label"){n.add(d);const m=a[d];typeof m=="number"?s.add(d):typeof m=="string"&&i.add(d)}})}),e.edges.forEach(a=>{Object.keys(a).forEach(d=>{if(d!=="source"&&d!=="target"&&d!=="value"){t.add(d);const m=a[d];typeof m=="number"?o.add(d):typeof m=="string"&&u.add(d)}})}),{nodeProperties:Array.from(n),edgeProperties:Array.from(t),hasNumericProperties:{nodes:Array.from(s),edges:Array.from(o)},hasCategoricalProperties:{nodes:Array.from(i),edges:Array.from(u)}}}const qa="kriskogram-db",Ka=1,ht="datasets";function Kn(){return new Promise((e,n)=>{const t=indexedDB.open(qa,Ka);t.onupgradeneeded=()=>{const s=t.result;s.objectStoreNames.contains(ht)||s.createObjectStore(ht,{keyPath:"id"})},t.onsuccess=()=>e(t.result),t.onerror=()=>n(t.error)})}async function Bt(e){const n=await Kn();return new Promise((t,s)=>{const o=n.transaction(ht,"readwrite");o.objectStore(ht).put(e),o.oncomplete=()=>t(),o.onerror=()=>s(o.error),o.onabort=()=>s(o.error)})}async function Ut(e){const n=await Kn();return new Promise((t,s)=>{const u=n.transaction(ht,"readonly").objectStore(ht).get(e);u.onsuccess=()=>t(u.result),u.onerror=()=>s(u.error)})}async function Ya(){const e=await Kn();return new Promise((n,t)=>{const i=e.transaction(ht,"readonly").objectStore(ht).getAll();i.onsuccess=()=>n(i.result||[]),i.onerror=()=>t(i.error)})}async function ds(e){const n=await Kn();return new Promise((t,s)=>{const o=n.transaction(ht,"readwrite");o.objectStore(ht).delete(e),o.oncomplete=()=>t(),o.onerror=()=>s(o.error)})}async function Xa(e){const n=await Ut(e);if(!n)throw new Error(`Dataset ${e} not found`);const t={...n,id:`${n.type}-${Date.now()}`,name:`${n.name} (Copy)`,createdAt:Date.now()};return await Bt(t),t}async function Za(){const e=await Kn();return new Promise((n,t)=>{const s=e.transaction(ht,"readwrite");s.objectStore(ht).clear(),s.oncomplete=()=>n(),s.onerror=()=>t(s.error)})}async function Qa(){if("storage"in navigator&&"persist"in navigator.storage)try{return await navigator.storage.persist()}catch{return!1}return!1}function Ys(e){const n=[];let t="",s=!1;for(let o=0;o<e.length;o++){const i=e[o];i==='"'?s=!s:i===","&&!s?(n.push(t),t=""):t+=i}return n.push(t),n}function Xs(e){const n=e.trim().split(`
`).filter(o=>o.trim());if(n.length===0)throw new Error("CSV file is empty");const t=Ys(n[0]).map(o=>o.trim()),s=n.slice(1).map(Ys);return{headers:t,rows:s}}function Zr(e){const n=e.replace(/[",]/g,"").trim(),t=Number.parseFloat(n);return Number.isNaN(t)?n:t}function fo(e){var k;const{headers:n,rows:t}=Xs(e.nodesFile.content),s=n.map(R=>R.toLowerCase().trim()),o=e.nodesFile.idField.toLowerCase().trim(),i=((k=e.nodesFile.labelField)==null?void 0:k.toLowerCase().trim())||o,u=s.indexOf(o),a=e.nodesFile.labelField?s.indexOf(i):u;if(u===-1)throw new Error(`ID field "${e.nodesFile.idField}" not found in nodes file. Available fields: ${n.join(", ")}`);const d=t.map(R=>{const U={id:String(R[u]||"").trim(),label:a>=0?String(R[a]||"").trim():String(R[u]||"").trim()},O=n[u],H=e.nodesFile.labelField?n[a]:O;return n.forEach((ie,K)=>{var ue;if(ie!==O&&ie!==H){const E=((ue=R[K])==null?void 0:ue.trim())||"";U[ie]=Zr(E)}}),U}).filter(R=>R.id),m=new Map(d.map(R=>[R.id,R])),{headers:g,rows:y}=Xs(e.edgesFile.content),h=g.map(R=>R.toLowerCase().trim()),f=e.edgesFile.sourceField.toLowerCase().trim(),_=e.edgesFile.targetField.toLowerCase().trim(),C=e.edgesFile.valueField.toLowerCase().trim(),w=h.indexOf(f),v=h.indexOf(_),S=h.indexOf(C);if(w===-1)throw new Error(`Source field "${e.edgesFile.sourceField}" not found in edges file. Available fields: ${g.join(", ")}`);if(v===-1)throw new Error(`Target field "${e.edgesFile.targetField}" not found in edges file. Available fields: ${g.join(", ")}`);if(S===-1)throw new Error(`Value field "${e.edgesFile.valueField}" not found in edges file. Available fields: ${g.join(", ")}`);const b=y.map(R=>{const U=String(R[w]||"").trim(),O=String(R[v]||"").trim(),H=String(R[S]||"").trim(),ie=Zr(H);if(!U||!O||typeof ie!="number"||ie<=0)return null;(!m.has(U)||!m.has(O))&&console.warn(`Edge references missing node: ${U} -> ${O}`);const K={source:U,target:O,value:ie},ue=g[w],E=g[v],re=g[S];return g.forEach((le,be)=>{var de;if(le!==ue&&le!==E&&le!==re){const Ne=((de=R[be])==null?void 0:de.trim())||"";K[le]=Zr(Ne)}}),K}).filter(R=>R!==null&&m.has(R.source)&&m.has(R.target)),j=new Set;return b.forEach(R=>{j.add(R.source),j.add(R.target)}),j.forEach(R=>{m.has(R)||d.push({id:R,label:R})}),{nodes:d,edges:b}}function Ja({onClose:e,onImport:n,fileInputRef:t,onFilesSelected:s,existingFile:o}){const[i,u]=p.useState(""),[a,d]=p.useState(""),[m,g]=p.useState(!1),[y,h]=p.useState({}),[f,_]=p.useState(!1),[C,w]=p.useState(null),[v,S]=p.useState([]),[b,j]=p.useState([]),[k,R]=p.useState(null),U=p.useRef(null),O=p.useRef(null),[H,ie]=p.useState(null),[K,ue]=p.useState(null),[E,re]=p.useState([]),[le,be]=p.useState([]),[de,Ne]=p.useState(""),[Ee,$]=p.useState(""),[q,Ie]=p.useState(""),[ge,Ze]=p.useState(""),[L,Te]=p.useState(""),[J,Be]=p.useState(null);function Me(A){let T=A.replace(/\.(csv|gexf)$/i,"");return T=T.replace(/([a-z])([A-Z])/g,"$1 $2").replace(/[_-]/g," ").replace(/[^a-zA-Z0-9\s]/g," ").replace(/\s+/g," ").trim(),T.split(" ").map(Z=>Z.charAt(0).toUpperCase()+Z.slice(1).toLowerCase()).join(" ")}p.useEffect(()=>{var A;if(o!=null&&o.parsedData){Be(o.parsedData);const T=((A=o.files[0])==null?void 0:A.name)||"";u(Me(T)),d(o.files.map(Z=>Z.name).join(", "))}},[o]),p.useEffect(()=>{var A;if(!o&&v.length>0){if(!i||i===Me(((A=v[0])==null?void 0:A.name)||"")){const T=v[0].name;u(Me(T))}a||d(v.map(T=>T.name).join(", "))}},[v]);function Qe(A){const T=[];let Z="",Se=!1;for(let se=0;se<A.length;se++){const ye=A[se];ye==='"'?Se=!Se:ye===","&&!Se?(T.push(Z),Z=""):Z+=ye}return T.push(Z),T}function Ae(A){const T=A.trim().split(`
`);if(T.length===0)return[];const Z=T[0];return Qe(Z).map(Se=>Se.trim().replace(/^"|"$/g,""))}async function cn(A){const T=Array.from(A.target.files||[]);if(T.length===0)return;S(T);const Z=await Promise.all(T.map(se=>se.text()));j(Z);const Se=T[0].name.toLowerCase();if(Se.endsWith(".gexf")){R("gexf"),w("single");try{const se=Uo(Z[0]),ye=uo(se);Be({nodes:ye.length>0?ye[0].nodes:[],edges:ye.length>0?ye[0].edges:[],timeRange:se.timeRange}),u(T[0].name.replace(".gexf",""))}catch(se){h({general:se instanceof Error?se.message:"Failed to parse GEXF"})}}else if(Se.endsWith(".csv")){if(R("csv"),T.length===1){w("single");try{const se=is(Z[0]);Be({nodes:se.nodes,edges:se.edges,timeRange:{start:2021,end:2021}}),u(T[0].name.replace(".csv",""))}catch{w("two-file");const ye=Ae(Z[0]);re(ye),be(ye),ie(0);const fe=ye.find(je=>je.toLowerCase()==="id"||je.toLowerCase()==="node"||je.toLowerCase()==="name"),xt=ye.find(je=>je.toLowerCase()==="source"||je.toLowerCase()==="origin"||je.toLowerCase()==="from"),et=ye.find(je=>je.toLowerCase()==="target"||je.toLowerCase()==="dest"||je.toLowerCase()==="destination"||je.toLowerCase()==="to"),Et=ye.find(je=>je.toLowerCase()==="value"||je.toLowerCase()==="count"||je.toLowerCase()==="weight");fe&&Ne(fe),xt&&Ie(xt),et&&Ze(et),Et&&Te(Et),h({general:"Could not parse as state migration format. Please select which file contains nodes and which contains edges."})}}else if(T.length===2){w("two-file");const se=Ae(Z[0]),ye=Ae(Z[1]);re(se),be(ye),ie(0),ue(1);const fe=se.find(Le=>Le.toLowerCase()==="id"),xt=se.find(Le=>Le.toLowerCase()==="name"||Le.toLowerCase()==="label");fe&&Ne(fe),xt&&$(xt);const et=ye.find(Le=>Le.toLowerCase()==="source"||Le.toLowerCase()==="origin"||Le.toLowerCase()==="from"),Et=ye.find(Le=>Le.toLowerCase()==="target"||Le.toLowerCase()==="dest"||Le.toLowerCase()==="destination"||Le.toLowerCase()==="to"),je=ye.find(Le=>Le.toLowerCase()==="value"||Le.toLowerCase()==="count"||Le.toLowerCase()==="weight");et&&Ie(et),Et&&Ze(Et),je&&Te(je),dt()}}t.current&&(t.current.value="")}function dt(){if(H===null||K===null||!de||!q||!ge||!L){h({general:"Please select all required fields"}),Be(null);return}try{const A=fo({nodesFile:{content:b[H],idField:de,labelField:Ee||de},edgesFile:{content:b[K],sourceField:q,targetField:ge,valueField:L}});Be({nodes:A.nodes,edges:A.edges,timeRange:{start:2016,end:2016}}),h({})}catch(A){h({general:A instanceof Error?A.message:"Failed to parse two-file CSV"}),Be(null)}}p.useEffect(()=>{C==="two-file"&&H!==null&&K!==null&&dt()},[de,Ee,q,ge,L,H,K]);function Yn(){const A={},T=[];if(i.trim()||(A.name="Dataset name is required"),C==="two-file"&&(H===null&&(A.nodesFile="Please select which file contains nodes"),K===null&&(A.edgesFile="Please select which file contains edges"),H!==null&&!de&&(A.nodeIdField="Please select the ID field for nodes"),K!==null&&!q&&(A.edgeSourceField="Please select the source field for edges"),K!==null&&!ge&&(A.edgeTargetField="Please select the target field for edges"),K!==null&&!L&&(A.edgeValueField="Please select the value field for edges")),!J)return A.general="Data parsing failed - please check file format and field selections",A;J.nodes.length===0&&T.push("No nodes found in dataset"),J.edges.length===0&&T.push("No edges found in dataset");const Z=new Set(J.nodes.map(se=>se.id));Z.size!==J.nodes.length&&T.push(`${J.nodes.length-Z.size} duplicate node IDs found`);const Se=J.edges.filter(se=>!Z.has(se.source)||!Z.has(se.target));return Se.length>0&&T.push(`${Se.length} edges reference non-existent nodes`),T.length>0&&(A.summary=T.join("; ")),A}function Je(){y.name&&U.current?(U.current.scrollIntoView({behavior:"smooth",block:"center"}),U.current.focus()):y.summary&&O.current&&O.current.scrollIntoView({behavior:"smooth",block:"center"})}async function Xn(){const A=Yn();if(h(A),Object.keys(A).filter(Z=>Z!=="summary").length>0||!J){setTimeout(()=>Je(),100);return}g(!0);try{const Z=J.timeRange||{start:2021,end:2021},Se={timestamp:Z.start,nodes:J.nodes,edges:J.edges},se=ln(Se),ye=[Se],fe={name:i.trim(),filename:v.map(xt=>xt.name).join(", "),notes:a.trim()||void 0,type:C==="two-file"?"csv":k||"csv",timeRange:Z,snapshots:ye,metadata:se};await n(fe,{nodes:J.nodes,edges:J.edges,snapshots:ye,metadata:se})}catch(Z){console.error("Import error:",Z),h({general:Z instanceof Error?Z.message:"Failed to import dataset"}),g(!1),setTimeout(()=>Je(),100)}}return r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:r.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-4xl w-full mx-4 max-h-[90vh] flex flex-col",children:[r.jsxs("div",{className:"p-6 border-b flex items-center justify-between",children:[r.jsx("h2",{className:"text-2xl font-bold",children:"Import Dataset"}),r.jsx("button",{onClick:e,className:"text-gray-400 hover:text-gray-600 text-2xl",children:"×"})]}),r.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:r.jsxs("div",{className:"space-y-6",children:[!C&&r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Select Files ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsxs("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-6 text-center",children:[r.jsx("button",{onClick:()=>{var A;return(A=t.current)==null?void 0:A.click()},className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700",children:"Choose Files"}),r.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"Select 1 file (GEXF or CSV) or 2 files (CSV nodes + CSV edges)"}),r.jsx("input",{ref:t,type:"file",accept:".csv,.gexf",multiple:!0,onChange:cn,className:"hidden"})]})]}),v.length>0&&r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Selected Files"}),r.jsxs("div",{className:"space-y-2",children:[v.map((A,T)=>r.jsxs("div",{className:"flex items-center justify-between bg-gray-50 p-3 rounded",children:[r.jsx("span",{className:"text-sm",children:A.name}),r.jsx("button",{onClick:()=>{const Z=[...v];Z.splice(T,1),S(Z);const Se=[...b];Se.splice(T,1),j(Se),C==="two-file"&&(H===T&&ie(null),K===T&&ue(null),H&&H>T&&ie(H-1),K&&K>T&&ue(K-1))},className:"text-red-600 text-sm hover:text-red-800",children:"Remove"})]},T)),r.jsx("button",{type:"button",onClick:()=>{const A=document.createElement("input");A.type="file",A.accept=".csv,.gexf",A.multiple=!0,A.onchange=async T=>{const Z=T.target,Se=Array.from(Z.files||[]);if(Se.length>0){const se=await Promise.all(Se.map(fe=>fe.text()));S([...v,...Se]),j([...b,...se]);const ye=[...v,...Se];ye.length===2&&ye.every(fe=>fe.name.toLowerCase().endsWith(".csv"))&&(w("two-file"),R("csv"))}},A.click()},className:"text-sm text-blue-600 hover:text-blue-800",children:"+ Add More Files"})]})]}),C==="two-file"&&v.length>0&&r.jsxs("div",{className:"border-t pt-4 space-y-4","data-file-select":!0,children:[r.jsx("h3",{className:"font-semibold",children:"Map Files and Fields"}),r.jsxs("div",{"data-field-select":!0,children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Nodes File (Locations) ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsxs("select",{value:H??"",onChange:A=>{const T=parseInt(A.target.value);ie(T);const Z=Ae(b[T]);re(Z);const Se=Z.find(se=>se.toLowerCase()==="id");if(Se&&Ne(Se),y.nodesFile){const se={...y};delete se.nodesFile,h(se)}},className:`w-full px-3 py-2 border rounded-md ${y.nodesFile?"border-red-500":"border-gray-300"}`,children:[r.jsx("option",{value:"",children:"Select file..."}),v.map((A,T)=>r.jsx("option",{value:T,children:A.name},T))]}),y.nodesFile&&r.jsx("p",{className:"mt-1 text-sm text-red-600",children:y.nodesFile}),H!==null&&E.length>0&&r.jsxs("div",{className:"mt-2 space-y-2",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"ID Field *"}),r.jsxs("select",{value:de,onChange:A=>{if(Ne(A.target.value),y.nodeIdField){const T={...y};delete T.nodeIdField,h(T)}},className:`w-full px-2 py-1 border rounded text-sm ${y.nodeIdField?"border-red-500":"border-gray-300"}`,children:[r.jsx("option",{value:"",children:"Select field..."}),E.map(A=>r.jsx("option",{value:A,children:A},A))]}),y.nodeIdField&&r.jsx("p",{className:"mt-1 text-xs text-red-600",children:y.nodeIdField})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"Label Field (optional)"}),r.jsxs("select",{value:Ee,onChange:A=>$(A.target.value),className:"w-full px-2 py-1 border border-gray-300 rounded text-sm",children:[r.jsx("option",{value:"",children:"Use ID field"}),E.map(A=>r.jsx("option",{value:A,children:A},A))]})]})]})]}),r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Edges File (Flows) ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsxs("select",{value:K??"",onChange:A=>{const T=parseInt(A.target.value);ue(T);const Z=Ae(b[T]);be(Z);const Se=Z.find(fe=>fe.toLowerCase()==="source"||fe.toLowerCase()==="origin"||fe.toLowerCase()==="from"),se=Z.find(fe=>fe.toLowerCase()==="target"||fe.toLowerCase()==="dest"||fe.toLowerCase()==="to"),ye=Z.find(fe=>fe.toLowerCase()==="value"||fe.toLowerCase()==="count"||fe.toLowerCase()==="weight");if(Se&&Ie(Se),se&&Ze(se),ye&&Te(ye),y.edgesFile){const fe={...y};delete fe.edgesFile,h(fe)}},className:`w-full px-3 py-2 border rounded-md ${y.edgesFile?"border-red-500":"border-gray-300"}`,children:[r.jsx("option",{value:"",children:"Select file..."}),v.map((A,T)=>r.jsx("option",{value:T,children:A.name},T))]}),y.edgesFile&&r.jsx("p",{className:"mt-1 text-sm text-red-600",children:y.edgesFile}),K!==null&&le.length>0&&r.jsxs("div",{className:"mt-2 space-y-2",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"Source Field *"}),r.jsxs("select",{value:q,onChange:A=>{if(Ie(A.target.value),y.edgeSourceField){const T={...y};delete T.edgeSourceField,h(T)}},className:`w-full px-2 py-1 border rounded text-sm ${y.edgeSourceField?"border-red-500":"border-gray-300"}`,children:[r.jsx("option",{value:"",children:"Select field..."}),le.map(A=>r.jsx("option",{value:A,children:A},A))]}),y.edgeSourceField&&r.jsx("p",{className:"mt-1 text-xs text-red-600",children:y.edgeSourceField})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"Target Field *"}),r.jsxs("select",{value:ge,onChange:A=>{if(Ze(A.target.value),y.edgeTargetField){const T={...y};delete T.edgeTargetField,h(T)}},className:`w-full px-2 py-1 border rounded text-sm ${y.edgeTargetField?"border-red-500":"border-gray-300"}`,children:[r.jsx("option",{value:"",children:"Select field..."}),le.map(A=>r.jsx("option",{value:A,children:A},A))]}),y.edgeTargetField&&r.jsx("p",{className:"mt-1 text-xs text-red-600",children:y.edgeTargetField})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"Value Field *"}),r.jsxs("select",{value:L,onChange:A=>{if(Te(A.target.value),y.edgeValueField){const T={...y};delete T.edgeValueField,h(T)}},className:`w-full px-2 py-1 border rounded text-sm ${y.edgeValueField?"border-red-500":"border-gray-300"}`,children:[r.jsx("option",{value:"",children:"Select field..."}),le.map(A=>r.jsx("option",{value:A,children:A},A))]}),y.edgeValueField&&r.jsx("p",{className:"mt-1 text-xs text-red-600",children:y.edgeValueField})]})]})]})]}),r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Dataset Name ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsx("input",{ref:U,type:"text",value:i,onChange:A=>{if(u(A.target.value),y.name){const T={...y};delete T.name,h(T)}},className:`w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 ${y.name?"border-red-500 focus:ring-red-500":"border-gray-300 focus:ring-blue-500"}`,placeholder:"Enter a name for this dataset"}),y.name&&r.jsx("p",{className:"mt-1 text-sm text-red-600",children:y.name})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Notes (optional)"}),r.jsx("textarea",{value:a,onChange:A=>d(A.target.value),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Add any notes about this dataset..."})]}),y.general&&r.jsxs("div",{className:"bg-red-50 border border-red-200 rounded p-3",children:[r.jsx("h4",{className:"font-semibold text-red-800 mb-2",children:"Error:"}),r.jsx("p",{className:"text-sm text-red-700",children:y.general})]}),J&&r.jsxs("div",{ref:O,className:"bg-blue-50 border border-blue-200 rounded p-3",children:[r.jsx("h4",{className:"font-semibold text-blue-800 mb-2",children:"Data Summary"}),r.jsxs("div",{className:"text-sm text-blue-700 space-y-1",children:[r.jsxs("div",{children:[r.jsx("span",{className:"font-medium",children:"Nodes:"})," ",J.nodes.length]}),r.jsxs("div",{children:[r.jsx("span",{className:"font-medium",children:"Edges:"})," ",J.edges.length]}),J.timeRange&&r.jsxs("div",{children:[r.jsx("span",{className:"font-medium",children:"Time Range:"})," ",J.timeRange.start,J.timeRange.end!==J.timeRange.start?` – ${J.timeRange.end}`:""]}),J.nodes.length>0&&r.jsxs("div",{className:"mt-2 text-xs",children:[r.jsx("span",{className:"font-medium",children:"Sample node properties:"})," ",Object.keys(J.nodes[0]).slice(0,5).join(", "),Object.keys(J.nodes[0]).length>5&&"..."]}),y.summary&&r.jsxs("div",{className:"mt-2 pt-2 border-t border-blue-300",children:[r.jsx("span",{className:"font-medium text-orange-700",children:"Warnings:"})," ",r.jsx("span",{className:"text-orange-600",children:y.summary})]})]})]})]})}),r.jsxs("div",{className:"p-6 border-t flex justify-end gap-3",children:[r.jsx("button",{onClick:e,type:"button",disabled:m,className:"px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50 disabled:opacity-50 cursor-pointer transition-colors",children:"Cancel"}),r.jsx("button",{onClick:Xn,type:"button",disabled:m||(Object.keys(y).filter(T=>T!=="summary").length>0||!J),className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed cursor-pointer transition-colors",children:m?"Importing...":"Import Dataset"})]})]})})}/**
   * table-core
   *
   * Copyright (c) TanStack
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE.md file in the root directory of this source tree.
   *
   * @license MIT
   */function Wt(e,n){return typeof e=="function"?e(n):e}function ut(e,n){return t=>{n.setState(s=>({...s,[e]:Wt(t,s[e])}))}}function Rr(e){return e instanceof Function}function ei(e){return Array.isArray(e)&&e.every(n=>typeof n=="number")}function ti(e,n){const t=[],s=o=>{o.forEach(i=>{t.push(i);const u=n(i);u!=null&&u.length&&s(u)})};return s(e),t}function te(e,n,t){let s=[],o;return i=>{let u;t.key&&t.debug&&(u=Date.now());const a=e(i);if(!(a.length!==s.length||a.some((g,y)=>s[y]!==g)))return o;s=a;let m;if(t.key&&t.debug&&(m=Date.now()),o=n(...a),t==null||t.onChange==null||t.onChange(o),t.key&&t.debug&&t!=null&&t.debug()){const g=Math.round((Date.now()-u)*100)/100,y=Math.round((Date.now()-m)*100)/100,h=y/16,f=(_,C)=>{for(_=String(_);_.length<C;)_=" "+_;return _};console.info(`%c⏱ ${f(y,5)} /${f(g,5)} ms`,`
            font-size: .6rem;
            font-weight: bold;
            color: hsl(${Math.max(0,Math.min(120-120*h,120))}deg 100% 31%);`,t==null?void 0:t.key)}return o}}function ne(e,n,t,s){return{debug:()=>{var o;return(o=e==null?void 0:e.debugAll)!=null?o:e[n]},key:!1,onChange:s}}function ni(e,n,t,s){const o=()=>{var u;return(u=i.getValue())!=null?u:e.options.renderFallbackValue},i={id:`${n.id}_${t.id}`,row:n,column:t,getValue:()=>n.getValue(s),renderValue:o,getContext:te(()=>[e,t,n,i],(u,a,d,m)=>({table:u,column:a,row:d,cell:m,getValue:m.getValue,renderValue:m.renderValue}),ne(e.options,"debugCells"))};return e._features.forEach(u=>{u.createCell==null||u.createCell(i,t,n,e)},{}),i}function ri(e,n,t,s){var o,i;const a={...e._getDefaultColumnDef(),...n},d=a.accessorKey;let m=(o=(i=a.id)!=null?i:d?typeof String.prototype.replaceAll=="function"?d.replaceAll(".","_"):d.replace(/\./g,"_"):void 0)!=null?o:typeof a.header=="string"?a.header:void 0,g;if(a.accessorFn?g=a.accessorFn:d&&(d.includes(".")?g=h=>{let f=h;for(const C of d.split(".")){var _;f=(_=f)==null?void 0:_[C]}return f}:g=h=>h[a.accessorKey]),!m)throw new Error;let y={id:`${String(m)}`,accessorFn:g,parent:s,depth:t,columnDef:a,columns:[],getFlatColumns:te(()=>[!0],()=>{var h;return[y,...(h=y.columns)==null?void 0:h.flatMap(f=>f.getFlatColumns())]},ne(e.options,"debugColumns")),getLeafColumns:te(()=>[e._getOrderColumnsFn()],h=>{var f;if((f=y.columns)!=null&&f.length){let _=y.columns.flatMap(C=>C.getLeafColumns());return h(_)}return[y]},ne(e.options,"debugColumns"))};for(const h of e._features)h.createColumn==null||h.createColumn(y,e);return y}const Xe="debugHeaders";function Zs(e,n,t){var s;let i={id:(s=t.id)!=null?s:n.id,column:n,index:t.index,isPlaceholder:!!t.isPlaceholder,placeholderId:t.placeholderId,depth:t.depth,subHeaders:[],colSpan:0,rowSpan:0,headerGroup:null,getLeafHeaders:()=>{const u=[],a=d=>{d.subHeaders&&d.subHeaders.length&&d.subHeaders.map(a),u.push(d)};return a(i),u},getContext:()=>({table:e,header:i,column:n})};return e._features.forEach(u=>{u.createHeader==null||u.createHeader(i,e)}),i}const si={createTable:e=>{e.getHeaderGroups=te(()=>[e.getAllColumns(),e.getVisibleLeafColumns(),e.getState().columnPinning.left,e.getState().columnPinning.right],(n,t,s,o)=>{var i,u;const a=(i=s==null?void 0:s.map(y=>t.find(h=>h.id===y)).filter(Boolean))!=null?i:[],d=(u=o==null?void 0:o.map(y=>t.find(h=>h.id===y)).filter(Boolean))!=null?u:[],m=t.filter(y=>!(s!=null&&s.includes(y.id))&&!(o!=null&&o.includes(y.id)));return Cr(n,[...a,...m,...d],e)},ne(e.options,Xe)),e.getCenterHeaderGroups=te(()=>[e.getAllColumns(),e.getVisibleLeafColumns(),e.getState().columnPinning.left,e.getState().columnPinning.right],(n,t,s,o)=>(t=t.filter(i=>!(s!=null&&s.includes(i.id))&&!(o!=null&&o.includes(i.id))),Cr(n,t,e,"center")),ne(e.options,Xe)),e.getLeftHeaderGroups=te(()=>[e.getAllColumns(),e.getVisibleLeafColumns(),e.getState().columnPinning.left],(n,t,s)=>{var o;const i=(o=s==null?void 0:s.map(u=>t.find(a=>a.id===u)).filter(Boolean))!=null?o:[];return Cr(n,i,e,"left")},ne(e.options,Xe)),e.getRightHeaderGroups=te(()=>[e.getAllColumns(),e.getVisibleLeafColumns(),e.getState().columnPinning.right],(n,t,s)=>{var o;const i=(o=s==null?void 0:s.map(u=>t.find(a=>a.id===u)).filter(Boolean))!=null?o:[];return Cr(n,i,e,"right")},ne(e.options,Xe)),e.getFooterGroups=te(()=>[e.getHeaderGroups()],n=>[...n].reverse(),ne(e.options,Xe)),e.getLeftFooterGroups=te(()=>[e.getLeftHeaderGroups()],n=>[...n].reverse(),ne(e.options,Xe)),e.getCenterFooterGroups=te(()=>[e.getCenterHeaderGroups()],n=>[...n].reverse(),ne(e.options,Xe)),e.getRightFooterGroups=te(()=>[e.getRightHeaderGroups()],n=>[...n].reverse(),ne(e.options,Xe)),e.getFlatHeaders=te(()=>[e.getHeaderGroups()],n=>n.map(t=>t.headers).flat(),ne(e.options,Xe)),e.getLeftFlatHeaders=te(()=>[e.getLeftHeaderGroups()],n=>n.map(t=>t.headers).flat(),ne(e.options,Xe)),e.getCenterFlatHeaders=te(()=>[e.getCenterHeaderGroups()],n=>n.map(t=>t.headers).flat(),ne(e.options,Xe)),e.getRightFlatHeaders=te(()=>[e.getRightHeaderGroups()],n=>n.map(t=>t.headers).flat(),ne(e.options,Xe)),e.getCenterLeafHeaders=te(()=>[e.getCenterFlatHeaders()],n=>n.filter(t=>{var s;return!((s=t.subHeaders)!=null&&s.length)}),ne(e.options,Xe)),e.getLeftLeafHeaders=te(()=>[e.getLeftFlatHeaders()],n=>n.filter(t=>{var s;return!((s=t.subHeaders)!=null&&s.length)}),ne(e.options,Xe)),e.getRightLeafHeaders=te(()=>[e.getRightFlatHeaders()],n=>n.filter(t=>{var s;return!((s=t.subHeaders)!=null&&s.length)}),ne(e.options,Xe)),e.getLeafHeaders=te(()=>[e.getLeftHeaderGroups(),e.getCenterHeaderGroups(),e.getRightHeaderGroups()],(n,t,s)=>{var o,i,u,a,d,m;return[...(o=(i=n[0])==null?void 0:i.headers)!=null?o:[],...(u=(a=t[0])==null?void 0:a.headers)!=null?u:[],...(d=(m=s[0])==null?void 0:m.headers)!=null?d:[]].map(g=>g.getLeafHeaders()).flat()},ne(e.options,Xe))}};function Cr(e,n,t,s){var o,i;let u=0;const a=function(h,f){f===void 0&&(f=1),u=Math.max(u,f),h.filter(_=>_.getIsVisible()).forEach(_=>{var C;(C=_.columns)!=null&&C.length&&a(_.columns,f+1)},0)};a(e);let d=[];const m=(h,f)=>{const _={depth:f,id:[s,`${f}`].filter(Boolean).join("_"),headers:[]},C=[];h.forEach(w=>{const v=[...C].reverse()[0],S=w.column.depth===_.depth;let b,j=!1;if(S&&w.column.parent?b=w.column.parent:(b=w.column,j=!0),v&&(v==null?void 0:v.column)===b)v.subHeaders.push(w);else{const k=Zs(t,b,{id:[s,f,b.id,w==null?void 0:w.id].filter(Boolean).join("_"),isPlaceholder:j,placeholderId:j?`${C.filter(R=>R.column===b).length}`:void 0,depth:f,index:C.length});k.subHeaders.push(w),C.push(k)}_.headers.push(w),w.headerGroup=_}),d.push(_),f>0&&m(C,f-1)},g=n.map((h,f)=>Zs(t,h,{depth:u,index:f}));m(g,u-1),d.reverse();const y=h=>h.filter(_=>_.column.getIsVisible()).map(_=>{let C=0,w=0,v=[0];_.subHeaders&&_.subHeaders.length?(v=[],y(_.subHeaders).forEach(b=>{let{colSpan:j,rowSpan:k}=b;C+=j,v.push(k)})):C=1;const S=Math.min(...v);return w=w+S,_.colSpan=C,_.rowSpan=w,{colSpan:C,rowSpan:w}});return y((o=(i=d[0])==null?void 0:i.headers)!=null?o:[]),d}const oi=(e,n,t,s,o,i,u)=>{let a={id:n,index:s,original:t,depth:o,parentId:u,_valuesCache:{},_uniqueValuesCache:{},getValue:d=>{if(a._valuesCache.hasOwnProperty(d))return a._valuesCache[d];const m=e.getColumn(d);if(m!=null&&m.accessorFn)return a._valuesCache[d]=m.accessorFn(a.original,s),a._valuesCache[d]},getUniqueValues:d=>{if(a._uniqueValuesCache.hasOwnProperty(d))return a._uniqueValuesCache[d];const m=e.getColumn(d);if(m!=null&&m.accessorFn)return m.columnDef.getUniqueValues?(a._uniqueValuesCache[d]=m.columnDef.getUniqueValues(a.original,s),a._uniqueValuesCache[d]):(a._uniqueValuesCache[d]=[a.getValue(d)],a._uniqueValuesCache[d])},renderValue:d=>{var m;return(m=a.getValue(d))!=null?m:e.options.renderFallbackValue},subRows:[],getLeafRows:()=>ti(a.subRows,d=>d.subRows),getParentRow:()=>a.parentId?e.getRow(a.parentId,!0):void 0,getParentRows:()=>{let d=[],m=a;for(;;){const g=m.getParentRow();if(!g)break;d.push(g),m=g}return d.reverse()},getAllCells:te(()=>[e.getAllLeafColumns()],d=>d.map(m=>ni(e,a,m,m.id)),ne(e.options,"debugRows")),_getAllCellsByColumnId:te(()=>[a.getAllCells()],d=>d.reduce((m,g)=>(m[g.column.id]=g,m),{}),ne(e.options,"debugRows"))};for(let d=0;d<e._features.length;d++){const m=e._features[d];m==null||m.createRow==null||m.createRow(a,e)}return a},ai={createColumn:(e,n)=>{e._getFacetedRowModel=n.options.getFacetedRowModel&&n.options.getFacetedRowModel(n,e.id),e.getFacetedRowModel=()=>e._getFacetedRowModel?e._getFacetedRowModel():n.getPreFilteredRowModel(),e._getFacetedUniqueValues=n.options.getFacetedUniqueValues&&n.options.getFacetedUniqueValues(n,e.id),e.getFacetedUniqueValues=()=>e._getFacetedUniqueValues?e._getFacetedUniqueValues():new Map,e._getFacetedMinMaxValues=n.options.getFacetedMinMaxValues&&n.options.getFacetedMinMaxValues(n,e.id),e.getFacetedMinMaxValues=()=>{if(e._getFacetedMinMaxValues)return e._getFacetedMinMaxValues()}}},po=(e,n,t)=>{var s,o;const i=t==null||(s=t.toString())==null?void 0:s.toLowerCase();return!!(!((o=e.getValue(n))==null||(o=o.toString())==null||(o=o.toLowerCase())==null)&&o.includes(i))};po.autoRemove=e=>bt(e);const ho=(e,n,t)=>{var s;return!!(!((s=e.getValue(n))==null||(s=s.toString())==null)&&s.includes(t))};ho.autoRemove=e=>bt(e);const xo=(e,n,t)=>{var s;return((s=e.getValue(n))==null||(s=s.toString())==null?void 0:s.toLowerCase())===(t==null?void 0:t.toLowerCase())};xo.autoRemove=e=>bt(e);const yo=(e,n,t)=>{var s;return(s=e.getValue(n))==null?void 0:s.includes(t)};yo.autoRemove=e=>bt(e);const vo=(e,n,t)=>!t.some(s=>{var o;return!((o=e.getValue(n))!=null&&o.includes(s))});vo.autoRemove=e=>bt(e)||!(e!=null&&e.length);const bo=(e,n,t)=>t.some(s=>{var o;return(o=e.getValue(n))==null?void 0:o.includes(s)});bo.autoRemove=e=>bt(e)||!(e!=null&&e.length);const So=(e,n,t)=>e.getValue(n)===t;So.autoRemove=e=>bt(e);const wo=(e,n,t)=>e.getValue(n)==t;wo.autoRemove=e=>bt(e);const vs=(e,n,t)=>{let[s,o]=t;const i=e.getValue(n);return i>=s&&i<=o};vs.resolveFilterValue=e=>{let[n,t]=e,s=typeof n!="number"?parseFloat(n):n,o=typeof t!="number"?parseFloat(t):t,i=n===null||Number.isNaN(s)?-1/0:s,u=t===null||Number.isNaN(o)?1/0:o;if(i>u){const a=i;i=u,u=a}return[i,u]};vs.autoRemove=e=>bt(e)||bt(e[0])&&bt(e[1]);const $t={includesString:po,includesStringSensitive:ho,equalsString:xo,arrIncludes:yo,arrIncludesAll:vo,arrIncludesSome:bo,equals:So,weakEquals:wo,inNumberRange:vs};function bt(e){return e==null||e===""}const ii={getDefaultColumnDef:()=>({filterFn:"auto"}),getInitialState:e=>({columnFilters:[],...e}),getDefaultOptions:e=>({onColumnFiltersChange:ut("columnFilters",e),filterFromLeafRows:!1,maxLeafRowFilterDepth:100}),createColumn:(e,n)=>{e.getAutoFilterFn=()=>{const t=n.getCoreRowModel().flatRows[0],s=t==null?void 0:t.getValue(e.id);return typeof s=="string"?$t.includesString:typeof s=="number"?$t.inNumberRange:typeof s=="boolean"||s!==null&&typeof s=="object"?$t.equals:Array.isArray(s)?$t.arrIncludes:$t.weakEquals},e.getFilterFn=()=>{var t,s;return Rr(e.columnDef.filterFn)?e.columnDef.filterFn:e.columnDef.filterFn==="auto"?e.getAutoFilterFn():(t=(s=n.options.filterFns)==null?void 0:s[e.columnDef.filterFn])!=null?t:$t[e.columnDef.filterFn]},e.getCanFilter=()=>{var t,s,o;return((t=e.columnDef.enableColumnFilter)!=null?t:!0)&&((s=n.options.enableColumnFilters)!=null?s:!0)&&((o=n.options.enableFilters)!=null?o:!0)&&!!e.accessorFn},e.getIsFiltered=()=>e.getFilterIndex()>-1,e.getFilterValue=()=>{var t;return(t=n.getState().columnFilters)==null||(t=t.find(s=>s.id===e.id))==null?void 0:t.value},e.getFilterIndex=()=>{var t,s;return(t=(s=n.getState().columnFilters)==null?void 0:s.findIndex(o=>o.id===e.id))!=null?t:-1},e.setFilterValue=t=>{n.setColumnFilters(s=>{const o=e.getFilterFn(),i=s==null?void 0:s.find(g=>g.id===e.id),u=Wt(t,i?i.value:void 0);if(Qs(o,u,e)){var a;return(a=s==null?void 0:s.filter(g=>g.id!==e.id))!=null?a:[]}const d={id:e.id,value:u};if(i){var m;return(m=s==null?void 0:s.map(g=>g.id===e.id?d:g))!=null?m:[]}return s!=null&&s.length?[...s,d]:[d]})}},createRow:(e,n)=>{e.columnFilters={},e.columnFiltersMeta={}},createTable:e=>{e.setColumnFilters=n=>{const t=e.getAllLeafColumns(),s=o=>{var i;return(i=Wt(n,o))==null?void 0:i.filter(u=>{const a=t.find(d=>d.id===u.id);if(a){const d=a.getFilterFn();if(Qs(d,u.value,a))return!1}return!0})};e.options.onColumnFiltersChange==null||e.options.onColumnFiltersChange(s)},e.resetColumnFilters=n=>{var t,s;e.setColumnFilters(n?[]:(t=(s=e.initialState)==null?void 0:s.columnFilters)!=null?t:[])},e.getPreFilteredRowModel=()=>e.getCoreRowModel(),e.getFilteredRowModel=()=>(!e._getFilteredRowModel&&e.options.getFilteredRowModel&&(e._getFilteredRowModel=e.options.getFilteredRowModel(e)),e.options.manualFiltering||!e._getFilteredRowModel?e.getPreFilteredRowModel():e._getFilteredRowModel())}};function Qs(e,n,t){return(e&&e.autoRemove?e.autoRemove(n,t):!1)||typeof n>"u"||typeof n=="string"&&!n}const li=(e,n,t)=>t.reduce((s,o)=>{const i=o.getValue(e);return s+(typeof i=="number"?i:0)},0),ui=(e,n,t)=>{let s;return t.forEach(o=>{const i=o.getValue(e);i!=null&&(s>i||s===void 0&&i>=i)&&(s=i)}),s},di=(e,n,t)=>{let s;return t.forEach(o=>{const i=o.getValue(e);i!=null&&(s<i||s===void 0&&i>=i)&&(s=i)}),s},ci=(e,n,t)=>{let s,o;return t.forEach(i=>{const u=i.getValue(e);u!=null&&(s===void 0?u>=u&&(s=o=u):(s>u&&(s=u),o<u&&(o=u)))}),[s,o]},gi=(e,n)=>{let t=0,s=0;if(n.forEach(o=>{let i=o.getValue(e);i!=null&&(i=+i)>=i&&(++t,s+=i)}),t)return s/t},mi=(e,n)=>{if(!n.length)return;const t=n.map(i=>i.getValue(e));if(!ei(t))return;if(t.length===1)return t[0];const s=Math.floor(t.length/2),o=t.sort((i,u)=>i-u);return t.length%2!==0?o[s]:(o[s-1]+o[s])/2},fi=(e,n)=>Array.from(new Set(n.map(t=>t.getValue(e))).values()),pi=(e,n)=>new Set(n.map(t=>t.getValue(e))).size,hi=(e,n)=>n.length,Qr={sum:li,min:ui,max:di,extent:ci,mean:gi,median:mi,unique:fi,uniqueCount:pi,count:hi},xi={getDefaultColumnDef:()=>({aggregatedCell:e=>{var n,t;return(n=(t=e.getValue())==null||t.toString==null?void 0:t.toString())!=null?n:null},aggregationFn:"auto"}),getInitialState:e=>({grouping:[],...e}),getDefaultOptions:e=>({onGroupingChange:ut("grouping",e),groupedColumnMode:"reorder"}),createColumn:(e,n)=>{e.toggleGrouping=()=>{n.setGrouping(t=>t!=null&&t.includes(e.id)?t.filter(s=>s!==e.id):[...t??[],e.id])},e.getCanGroup=()=>{var t,s;return((t=e.columnDef.enableGrouping)!=null?t:!0)&&((s=n.options.enableGrouping)!=null?s:!0)&&(!!e.accessorFn||!!e.columnDef.getGroupingValue)},e.getIsGrouped=()=>{var t;return(t=n.getState().grouping)==null?void 0:t.includes(e.id)},e.getGroupedIndex=()=>{var t;return(t=n.getState().grouping)==null?void 0:t.indexOf(e.id)},e.getToggleGroupingHandler=()=>{const t=e.getCanGroup();return()=>{t&&e.toggleGrouping()}},e.getAutoAggregationFn=()=>{const t=n.getCoreRowModel().flatRows[0],s=t==null?void 0:t.getValue(e.id);if(typeof s=="number")return Qr.sum;if(Object.prototype.toString.call(s)==="[object Date]")return Qr.extent},e.getAggregationFn=()=>{var t,s;if(!e)throw new Error;return Rr(e.columnDef.aggregationFn)?e.columnDef.aggregationFn:e.columnDef.aggregationFn==="auto"?e.getAutoAggregationFn():(t=(s=n.options.aggregationFns)==null?void 0:s[e.columnDef.aggregationFn])!=null?t:Qr[e.columnDef.aggregationFn]}},createTable:e=>{e.setGrouping=n=>e.options.onGroupingChange==null?void 0:e.options.onGroupingChange(n),e.resetGrouping=n=>{var t,s;e.setGrouping(n?[]:(t=(s=e.initialState)==null?void 0:s.grouping)!=null?t:[])},e.getPreGroupedRowModel=()=>e.getFilteredRowModel(),e.getGroupedRowModel=()=>(!e._getGroupedRowModel&&e.options.getGroupedRowModel&&(e._getGroupedRowModel=e.options.getGroupedRowModel(e)),e.options.manualGrouping||!e._getGroupedRowModel?e.getPreGroupedRowModel():e._getGroupedRowModel())},createRow:(e,n)=>{e.getIsGrouped=()=>!!e.groupingColumnId,e.getGroupingValue=t=>{if(e._groupingValuesCache.hasOwnProperty(t))return e._groupingValuesCache[t];const s=n.getColumn(t);return s!=null&&s.columnDef.getGroupingValue?(e._groupingValuesCache[t]=s.columnDef.getGroupingValue(e.original),e._groupingValuesCache[t]):e.getValue(t)},e._groupingValuesCache={}},createCell:(e,n,t,s)=>{e.getIsGrouped=()=>n.getIsGrouped()&&n.id===t.groupingColumnId,e.getIsPlaceholder=()=>!e.getIsGrouped()&&n.getIsGrouped(),e.getIsAggregated=()=>{var o;return!e.getIsGrouped()&&!e.getIsPlaceholder()&&!!((o=t.subRows)!=null&&o.length)}}};function yi(e,n,t){if(!(n!=null&&n.length)||!t)return e;const s=e.filter(i=>!n.includes(i.id));return t==="remove"?s:[...n.map(i=>e.find(u=>u.id===i)).filter(Boolean),...s]}const vi={getInitialState:e=>({columnOrder:[],...e}),getDefaultOptions:e=>({onColumnOrderChange:ut("columnOrder",e)}),createColumn:(e,n)=>{e.getIndex=te(t=>[Wn(n,t)],t=>t.findIndex(s=>s.id===e.id),ne(n.options,"debugColumns")),e.getIsFirstColumn=t=>{var s;return((s=Wn(n,t)[0])==null?void 0:s.id)===e.id},e.getIsLastColumn=t=>{var s;const o=Wn(n,t);return((s=o[o.length-1])==null?void 0:s.id)===e.id}},createTable:e=>{e.setColumnOrder=n=>e.options.onColumnOrderChange==null?void 0:e.options.onColumnOrderChange(n),e.resetColumnOrder=n=>{var t;e.setColumnOrder(n?[]:(t=e.initialState.columnOrder)!=null?t:[])},e._getOrderColumnsFn=te(()=>[e.getState().columnOrder,e.getState().grouping,e.options.groupedColumnMode],(n,t,s)=>o=>{let i=[];if(!(n!=null&&n.length))i=o;else{const u=[...n],a=[...o];for(;a.length&&u.length;){const d=u.shift(),m=a.findIndex(g=>g.id===d);m>-1&&i.push(a.splice(m,1)[0])}i=[...i,...a]}return yi(i,t,s)},ne(e.options,"debugTable"))}},Jr=()=>({left:[],right:[]}),bi={getInitialState:e=>({columnPinning:Jr(),...e}),getDefaultOptions:e=>({onColumnPinningChange:ut("columnPinning",e)}),createColumn:(e,n)=>{e.pin=t=>{const s=e.getLeafColumns().map(o=>o.id).filter(Boolean);n.setColumnPinning(o=>{var i,u;if(t==="right"){var a,d;return{left:((a=o==null?void 0:o.left)!=null?a:[]).filter(y=>!(s!=null&&s.includes(y))),right:[...((d=o==null?void 0:o.right)!=null?d:[]).filter(y=>!(s!=null&&s.includes(y))),...s]}}if(t==="left"){var m,g;return{left:[...((m=o==null?void 0:o.left)!=null?m:[]).filter(y=>!(s!=null&&s.includes(y))),...s],right:((g=o==null?void 0:o.right)!=null?g:[]).filter(y=>!(s!=null&&s.includes(y)))}}return{left:((i=o==null?void 0:o.left)!=null?i:[]).filter(y=>!(s!=null&&s.includes(y))),right:((u=o==null?void 0:o.right)!=null?u:[]).filter(y=>!(s!=null&&s.includes(y)))}})},e.getCanPin=()=>e.getLeafColumns().some(s=>{var o,i,u;return((o=s.columnDef.enablePinning)!=null?o:!0)&&((i=(u=n.options.enableColumnPinning)!=null?u:n.options.enablePinning)!=null?i:!0)}),e.getIsPinned=()=>{const t=e.getLeafColumns().map(a=>a.id),{left:s,right:o}=n.getState().columnPinning,i=t.some(a=>s==null?void 0:s.includes(a)),u=t.some(a=>o==null?void 0:o.includes(a));return i?"left":u?"right":!1},e.getPinnedIndex=()=>{var t,s;const o=e.getIsPinned();return o?(t=(s=n.getState().columnPinning)==null||(s=s[o])==null?void 0:s.indexOf(e.id))!=null?t:-1:0}},createRow:(e,n)=>{e.getCenterVisibleCells=te(()=>[e._getAllVisibleCells(),n.getState().columnPinning.left,n.getState().columnPinning.right],(t,s,o)=>{const i=[...s??[],...o??[]];return t.filter(u=>!i.includes(u.column.id))},ne(n.options,"debugRows")),e.getLeftVisibleCells=te(()=>[e._getAllVisibleCells(),n.getState().columnPinning.left],(t,s)=>(s??[]).map(i=>t.find(u=>u.column.id===i)).filter(Boolean).map(i=>({...i,position:"left"})),ne(n.options,"debugRows")),e.getRightVisibleCells=te(()=>[e._getAllVisibleCells(),n.getState().columnPinning.right],(t,s)=>(s??[]).map(i=>t.find(u=>u.column.id===i)).filter(Boolean).map(i=>({...i,position:"right"})),ne(n.options,"debugRows"))},createTable:e=>{e.setColumnPinning=n=>e.options.onColumnPinningChange==null?void 0:e.options.onColumnPinningChange(n),e.resetColumnPinning=n=>{var t,s;return e.setColumnPinning(n?Jr():(t=(s=e.initialState)==null?void 0:s.columnPinning)!=null?t:Jr())},e.getIsSomeColumnsPinned=n=>{var t;const s=e.getState().columnPinning;if(!n){var o,i;return!!((o=s.left)!=null&&o.length||(i=s.right)!=null&&i.length)}return!!((t=s[n])!=null&&t.length)},e.getLeftLeafColumns=te(()=>[e.getAllLeafColumns(),e.getState().columnPinning.left],(n,t)=>(t??[]).map(s=>n.find(o=>o.id===s)).filter(Boolean),ne(e.options,"debugColumns")),e.getRightLeafColumns=te(()=>[e.getAllLeafColumns(),e.getState().columnPinning.right],(n,t)=>(t??[]).map(s=>n.find(o=>o.id===s)).filter(Boolean),ne(e.options,"debugColumns")),e.getCenterLeafColumns=te(()=>[e.getAllLeafColumns(),e.getState().columnPinning.left,e.getState().columnPinning.right],(n,t,s)=>{const o=[...t??[],...s??[]];return n.filter(i=>!o.includes(i.id))},ne(e.options,"debugColumns"))}};function Si(e){return e||(typeof document<"u"?document:null)}const Nr={size:150,minSize:20,maxSize:Number.MAX_SAFE_INTEGER},es=()=>({startOffset:null,startSize:null,deltaOffset:null,deltaPercentage:null,isResizingColumn:!1,columnSizingStart:[]}),wi={getDefaultColumnDef:()=>Nr,getInitialState:e=>({columnSizing:{},columnSizingInfo:es(),...e}),getDefaultOptions:e=>({columnResizeMode:"onEnd",columnResizeDirection:"ltr",onColumnSizingChange:ut("columnSizing",e),onColumnSizingInfoChange:ut("columnSizingInfo",e)}),createColumn:(e,n)=>{e.getSize=()=>{var t,s,o;const i=n.getState().columnSizing[e.id];return Math.min(Math.max((t=e.columnDef.minSize)!=null?t:Nr.minSize,(s=i??e.columnDef.size)!=null?s:Nr.size),(o=e.columnDef.maxSize)!=null?o:Nr.maxSize)},e.getStart=te(t=>[t,Wn(n,t),n.getState().columnSizing],(t,s)=>s.slice(0,e.getIndex(t)).reduce((o,i)=>o+i.getSize(),0),ne(n.options,"debugColumns")),e.getAfter=te(t=>[t,Wn(n,t),n.getState().columnSizing],(t,s)=>s.slice(e.getIndex(t)+1).reduce((o,i)=>o+i.getSize(),0),ne(n.options,"debugColumns")),e.resetSize=()=>{n.setColumnSizing(t=>{let{[e.id]:s,...o}=t;return o})},e.getCanResize=()=>{var t,s;return((t=e.columnDef.enableResizing)!=null?t:!0)&&((s=n.options.enableColumnResizing)!=null?s:!0)},e.getIsResizing=()=>n.getState().columnSizingInfo.isResizingColumn===e.id},createHeader:(e,n)=>{e.getSize=()=>{let t=0;const s=o=>{if(o.subHeaders.length)o.subHeaders.forEach(s);else{var i;t+=(i=o.column.getSize())!=null?i:0}};return s(e),t},e.getStart=()=>{if(e.index>0){const t=e.headerGroup.headers[e.index-1];return t.getStart()+t.getSize()}return 0},e.getResizeHandler=t=>{const s=n.getColumn(e.column.id),o=s==null?void 0:s.getCanResize();return i=>{if(!s||!o||(i.persist==null||i.persist(),ts(i)&&i.touches&&i.touches.length>1))return;const u=e.getSize(),a=e?e.getLeafHeaders().map(v=>[v.column.id,v.column.getSize()]):[[s.id,s.getSize()]],d=ts(i)?Math.round(i.touches[0].clientX):i.clientX,m={},g=(v,S)=>{typeof S=="number"&&(n.setColumnSizingInfo(b=>{var j,k;const R=n.options.columnResizeDirection==="rtl"?-1:1,U=(S-((j=b==null?void 0:b.startOffset)!=null?j:0))*R,O=Math.max(U/((k=b==null?void 0:b.startSize)!=null?k:0),-.999999);return b.columnSizingStart.forEach(H=>{let[ie,K]=H;m[ie]=Math.round(Math.max(K+K*O,0)*100)/100}),{...b,deltaOffset:U,deltaPercentage:O}}),(n.options.columnResizeMode==="onChange"||v==="end")&&n.setColumnSizing(b=>({...b,...m})))},y=v=>g("move",v),h=v=>{g("end",v),n.setColumnSizingInfo(S=>({...S,isResizingColumn:!1,startOffset:null,startSize:null,deltaOffset:null,deltaPercentage:null,columnSizingStart:[]}))},f=Si(t),_={moveHandler:v=>y(v.clientX),upHandler:v=>{f==null||f.removeEventListener("mousemove",_.moveHandler),f==null||f.removeEventListener("mouseup",_.upHandler),h(v.clientX)}},C={moveHandler:v=>(v.cancelable&&(v.preventDefault(),v.stopPropagation()),y(v.touches[0].clientX),!1),upHandler:v=>{var S;f==null||f.removeEventListener("touchmove",C.moveHandler),f==null||f.removeEventListener("touchend",C.upHandler),v.cancelable&&(v.preventDefault(),v.stopPropagation()),h((S=v.touches[0])==null?void 0:S.clientX)}},w=_i()?{passive:!1}:!1;ts(i)?(f==null||f.addEventListener("touchmove",C.moveHandler,w),f==null||f.addEventListener("touchend",C.upHandler,w)):(f==null||f.addEventListener("mousemove",_.moveHandler,w),f==null||f.addEventListener("mouseup",_.upHandler,w)),n.setColumnSizingInfo(v=>({...v,startOffset:d,startSize:u,deltaOffset:0,deltaPercentage:0,columnSizingStart:a,isResizingColumn:s.id}))}}},createTable:e=>{e.setColumnSizing=n=>e.options.onColumnSizingChange==null?void 0:e.options.onColumnSizingChange(n),e.setColumnSizingInfo=n=>e.options.onColumnSizingInfoChange==null?void 0:e.options.onColumnSizingInfoChange(n),e.resetColumnSizing=n=>{var t;e.setColumnSizing(n?{}:(t=e.initialState.columnSizing)!=null?t:{})},e.resetHeaderSizeInfo=n=>{var t;e.setColumnSizingInfo(n?es():(t=e.initialState.columnSizingInfo)!=null?t:es())},e.getTotalSize=()=>{var n,t;return(n=(t=e.getHeaderGroups()[0])==null?void 0:t.headers.reduce((s,o)=>s+o.getSize(),0))!=null?n:0},e.getLeftTotalSize=()=>{var n,t;return(n=(t=e.getLeftHeaderGroups()[0])==null?void 0:t.headers.reduce((s,o)=>s+o.getSize(),0))!=null?n:0},e.getCenterTotalSize=()=>{var n,t;return(n=(t=e.getCenterHeaderGroups()[0])==null?void 0:t.headers.reduce((s,o)=>s+o.getSize(),0))!=null?n:0},e.getRightTotalSize=()=>{var n,t;return(n=(t=e.getRightHeaderGroups()[0])==null?void 0:t.headers.reduce((s,o)=>s+o.getSize(),0))!=null?n:0}}};let jr=null;function _i(){if(typeof jr=="boolean")return jr;let e=!1;try{const n={get passive(){return e=!0,!1}},t=()=>{};window.addEventListener("test",t,n),window.removeEventListener("test",t)}catch{e=!1}return jr=e,jr}function ts(e){return e.type==="touchstart"}const Ci={getInitialState:e=>({columnVisibility:{},...e}),getDefaultOptions:e=>({onColumnVisibilityChange:ut("columnVisibility",e)}),createColumn:(e,n)=>{e.toggleVisibility=t=>{e.getCanHide()&&n.setColumnVisibility(s=>({...s,[e.id]:t??!e.getIsVisible()}))},e.getIsVisible=()=>{var t,s;const o=e.columns;return(t=o.length?o.some(i=>i.getIsVisible()):(s=n.getState().columnVisibility)==null?void 0:s[e.id])!=null?t:!0},e.getCanHide=()=>{var t,s;return((t=e.columnDef.enableHiding)!=null?t:!0)&&((s=n.options.enableHiding)!=null?s:!0)},e.getToggleVisibilityHandler=()=>t=>{e.toggleVisibility==null||e.toggleVisibility(t.target.checked)}},createRow:(e,n)=>{e._getAllVisibleCells=te(()=>[e.getAllCells(),n.getState().columnVisibility],t=>t.filter(s=>s.column.getIsVisible()),ne(n.options,"debugRows")),e.getVisibleCells=te(()=>[e.getLeftVisibleCells(),e.getCenterVisibleCells(),e.getRightVisibleCells()],(t,s,o)=>[...t,...s,...o],ne(n.options,"debugRows"))},createTable:e=>{const n=(t,s)=>te(()=>[s(),s().filter(o=>o.getIsVisible()).map(o=>o.id).join("_")],o=>o.filter(i=>i.getIsVisible==null?void 0:i.getIsVisible()),ne(e.options,"debugColumns"));e.getVisibleFlatColumns=n("getVisibleFlatColumns",()=>e.getAllFlatColumns()),e.getVisibleLeafColumns=n("getVisibleLeafColumns",()=>e.getAllLeafColumns()),e.getLeftVisibleLeafColumns=n("getLeftVisibleLeafColumns",()=>e.getLeftLeafColumns()),e.getRightVisibleLeafColumns=n("getRightVisibleLeafColumns",()=>e.getRightLeafColumns()),e.getCenterVisibleLeafColumns=n("getCenterVisibleLeafColumns",()=>e.getCenterLeafColumns()),e.setColumnVisibility=t=>e.options.onColumnVisibilityChange==null?void 0:e.options.onColumnVisibilityChange(t),e.resetColumnVisibility=t=>{var s;e.setColumnVisibility(t?{}:(s=e.initialState.columnVisibility)!=null?s:{})},e.toggleAllColumnsVisible=t=>{var s;t=(s=t)!=null?s:!e.getIsAllColumnsVisible(),e.setColumnVisibility(e.getAllLeafColumns().reduce((o,i)=>({...o,[i.id]:t||!(i.getCanHide!=null&&i.getCanHide())}),{}))},e.getIsAllColumnsVisible=()=>!e.getAllLeafColumns().some(t=>!(t.getIsVisible!=null&&t.getIsVisible())),e.getIsSomeColumnsVisible=()=>e.getAllLeafColumns().some(t=>t.getIsVisible==null?void 0:t.getIsVisible()),e.getToggleAllColumnsVisibilityHandler=()=>t=>{var s;e.toggleAllColumnsVisible((s=t.target)==null?void 0:s.checked)}}};function Wn(e,n){return n?n==="center"?e.getCenterVisibleLeafColumns():n==="left"?e.getLeftVisibleLeafColumns():e.getRightVisibleLeafColumns():e.getVisibleLeafColumns()}const Ni={createTable:e=>{e._getGlobalFacetedRowModel=e.options.getFacetedRowModel&&e.options.getFacetedRowModel(e,"__global__"),e.getGlobalFacetedRowModel=()=>e.options.manualFiltering||!e._getGlobalFacetedRowModel?e.getPreFilteredRowModel():e._getGlobalFacetedRowModel(),e._getGlobalFacetedUniqueValues=e.options.getFacetedUniqueValues&&e.options.getFacetedUniqueValues(e,"__global__"),e.getGlobalFacetedUniqueValues=()=>e._getGlobalFacetedUniqueValues?e._getGlobalFacetedUniqueValues():new Map,e._getGlobalFacetedMinMaxValues=e.options.getFacetedMinMaxValues&&e.options.getFacetedMinMaxValues(e,"__global__"),e.getGlobalFacetedMinMaxValues=()=>{if(e._getGlobalFacetedMinMaxValues)return e._getGlobalFacetedMinMaxValues()}}},ji={getInitialState:e=>({globalFilter:void 0,...e}),getDefaultOptions:e=>({onGlobalFilterChange:ut("globalFilter",e),globalFilterFn:"auto",getColumnCanGlobalFilter:n=>{var t;const s=(t=e.getCoreRowModel().flatRows[0])==null||(t=t._getAllCellsByColumnId()[n.id])==null?void 0:t.getValue();return typeof s=="string"||typeof s=="number"}}),createColumn:(e,n)=>{e.getCanGlobalFilter=()=>{var t,s,o,i;return((t=e.columnDef.enableGlobalFilter)!=null?t:!0)&&((s=n.options.enableGlobalFilter)!=null?s:!0)&&((o=n.options.enableFilters)!=null?o:!0)&&((i=n.options.getColumnCanGlobalFilter==null?void 0:n.options.getColumnCanGlobalFilter(e))!=null?i:!0)&&!!e.accessorFn}},createTable:e=>{e.getGlobalAutoFilterFn=()=>$t.includesString,e.getGlobalFilterFn=()=>{var n,t;const{globalFilterFn:s}=e.options;return Rr(s)?s:s==="auto"?e.getGlobalAutoFilterFn():(n=(t=e.options.filterFns)==null?void 0:t[s])!=null?n:$t[s]},e.setGlobalFilter=n=>{e.options.onGlobalFilterChange==null||e.options.onGlobalFilterChange(n)},e.resetGlobalFilter=n=>{e.setGlobalFilter(n?void 0:e.initialState.globalFilter)}}},Mi={getInitialState:e=>({expanded:{},...e}),getDefaultOptions:e=>({onExpandedChange:ut("expanded",e),paginateExpandedRows:!0}),createTable:e=>{let n=!1,t=!1;e._autoResetExpanded=()=>{var s,o;if(!n){e._queue(()=>{n=!0});return}if((s=(o=e.options.autoResetAll)!=null?o:e.options.autoResetExpanded)!=null?s:!e.options.manualExpanding){if(t)return;t=!0,e._queue(()=>{e.resetExpanded(),t=!1})}},e.setExpanded=s=>e.options.onExpandedChange==null?void 0:e.options.onExpandedChange(s),e.toggleAllRowsExpanded=s=>{s??!e.getIsAllRowsExpanded()?e.setExpanded(!0):e.setExpanded({})},e.resetExpanded=s=>{var o,i;e.setExpanded(s?{}:(o=(i=e.initialState)==null?void 0:i.expanded)!=null?o:{})},e.getCanSomeRowsExpand=()=>e.getPrePaginationRowModel().flatRows.some(s=>s.getCanExpand()),e.getToggleAllRowsExpandedHandler=()=>s=>{s.persist==null||s.persist(),e.toggleAllRowsExpanded()},e.getIsSomeRowsExpanded=()=>{const s=e.getState().expanded;return s===!0||Object.values(s).some(Boolean)},e.getIsAllRowsExpanded=()=>{const s=e.getState().expanded;return typeof s=="boolean"?s===!0:!(!Object.keys(s).length||e.getRowModel().flatRows.some(o=>!o.getIsExpanded()))},e.getExpandedDepth=()=>{let s=0;return(e.getState().expanded===!0?Object.keys(e.getRowModel().rowsById):Object.keys(e.getState().expanded)).forEach(i=>{const u=i.split(".");s=Math.max(s,u.length)}),s},e.getPreExpandedRowModel=()=>e.getSortedRowModel(),e.getExpandedRowModel=()=>(!e._getExpandedRowModel&&e.options.getExpandedRowModel&&(e._getExpandedRowModel=e.options.getExpandedRowModel(e)),e.options.manualExpanding||!e._getExpandedRowModel?e.getPreExpandedRowModel():e._getExpandedRowModel())},createRow:(e,n)=>{e.toggleExpanded=t=>{n.setExpanded(s=>{var o;const i=s===!0?!0:!!(s!=null&&s[e.id]);let u={};if(s===!0?Object.keys(n.getRowModel().rowsById).forEach(a=>{u[a]=!0}):u=s,t=(o=t)!=null?o:!i,!i&&t)return{...u,[e.id]:!0};if(i&&!t){const{[e.id]:a,...d}=u;return d}return s})},e.getIsExpanded=()=>{var t;const s=n.getState().expanded;return!!((t=n.options.getIsRowExpanded==null?void 0:n.options.getIsRowExpanded(e))!=null?t:s===!0||s!=null&&s[e.id])},e.getCanExpand=()=>{var t,s,o;return(t=n.options.getRowCanExpand==null?void 0:n.options.getRowCanExpand(e))!=null?t:((s=n.options.enableExpanding)!=null?s:!0)&&!!((o=e.subRows)!=null&&o.length)},e.getIsAllParentsExpanded=()=>{let t=!0,s=e;for(;t&&s.parentId;)s=n.getRow(s.parentId,!0),t=s.getIsExpanded();return t},e.getToggleExpandedHandler=()=>{const t=e.getCanExpand();return()=>{t&&e.toggleExpanded()}}}},cs=0,gs=10,ns=()=>({pageIndex:cs,pageSize:gs}),Fi={getInitialState:e=>({...e,pagination:{...ns(),...e==null?void 0:e.pagination}}),getDefaultOptions:e=>({onPaginationChange:ut("pagination",e)}),createTable:e=>{let n=!1,t=!1;e._autoResetPageIndex=()=>{var s,o;if(!n){e._queue(()=>{n=!0});return}if((s=(o=e.options.autoResetAll)!=null?o:e.options.autoResetPageIndex)!=null?s:!e.options.manualPagination){if(t)return;t=!0,e._queue(()=>{e.resetPageIndex(),t=!1})}},e.setPagination=s=>{const o=i=>Wt(s,i);return e.options.onPaginationChange==null?void 0:e.options.onPaginationChange(o)},e.resetPagination=s=>{var o;e.setPagination(s?ns():(o=e.initialState.pagination)!=null?o:ns())},e.setPageIndex=s=>{e.setPagination(o=>{let i=Wt(s,o.pageIndex);const u=typeof e.options.pageCount>"u"||e.options.pageCount===-1?Number.MAX_SAFE_INTEGER:e.options.pageCount-1;return i=Math.max(0,Math.min(i,u)),{...o,pageIndex:i}})},e.resetPageIndex=s=>{var o,i;e.setPageIndex(s?cs:(o=(i=e.initialState)==null||(i=i.pagination)==null?void 0:i.pageIndex)!=null?o:cs)},e.resetPageSize=s=>{var o,i;e.setPageSize(s?gs:(o=(i=e.initialState)==null||(i=i.pagination)==null?void 0:i.pageSize)!=null?o:gs)},e.setPageSize=s=>{e.setPagination(o=>{const i=Math.max(1,Wt(s,o.pageSize)),u=o.pageSize*o.pageIndex,a=Math.floor(u/i);return{...o,pageIndex:a,pageSize:i}})},e.setPageCount=s=>e.setPagination(o=>{var i;let u=Wt(s,(i=e.options.pageCount)!=null?i:-1);return typeof u=="number"&&(u=Math.max(-1,u)),{...o,pageCount:u}}),e.getPageOptions=te(()=>[e.getPageCount()],s=>{let o=[];return s&&s>0&&(o=[...new Array(s)].fill(null).map((i,u)=>u)),o},ne(e.options,"debugTable")),e.getCanPreviousPage=()=>e.getState().pagination.pageIndex>0,e.getCanNextPage=()=>{const{pageIndex:s}=e.getState().pagination,o=e.getPageCount();return o===-1?!0:o===0?!1:s<o-1},e.previousPage=()=>e.setPageIndex(s=>s-1),e.nextPage=()=>e.setPageIndex(s=>s+1),e.firstPage=()=>e.setPageIndex(0),e.lastPage=()=>e.setPageIndex(e.getPageCount()-1),e.getPrePaginationRowModel=()=>e.getExpandedRowModel(),e.getPaginationRowModel=()=>(!e._getPaginationRowModel&&e.options.getPaginationRowModel&&(e._getPaginationRowModel=e.options.getPaginationRowModel(e)),e.options.manualPagination||!e._getPaginationRowModel?e.getPrePaginationRowModel():e._getPaginationRowModel()),e.getPageCount=()=>{var s;return(s=e.options.pageCount)!=null?s:Math.ceil(e.getRowCount()/e.getState().pagination.pageSize)},e.getRowCount=()=>{var s;return(s=e.options.rowCount)!=null?s:e.getPrePaginationRowModel().rows.length}}},rs=()=>({top:[],bottom:[]}),Ri={getInitialState:e=>({rowPinning:rs(),...e}),getDefaultOptions:e=>({onRowPinningChange:ut("rowPinning",e)}),createRow:(e,n)=>{e.pin=(t,s,o)=>{const i=s?e.getLeafRows().map(d=>{let{id:m}=d;return m}):[],u=o?e.getParentRows().map(d=>{let{id:m}=d;return m}):[],a=new Set([...u,e.id,...i]);n.setRowPinning(d=>{var m,g;if(t==="bottom"){var y,h;return{top:((y=d==null?void 0:d.top)!=null?y:[]).filter(C=>!(a!=null&&a.has(C))),bottom:[...((h=d==null?void 0:d.bottom)!=null?h:[]).filter(C=>!(a!=null&&a.has(C))),...Array.from(a)]}}if(t==="top"){var f,_;return{top:[...((f=d==null?void 0:d.top)!=null?f:[]).filter(C=>!(a!=null&&a.has(C))),...Array.from(a)],bottom:((_=d==null?void 0:d.bottom)!=null?_:[]).filter(C=>!(a!=null&&a.has(C)))}}return{top:((m=d==null?void 0:d.top)!=null?m:[]).filter(C=>!(a!=null&&a.has(C))),bottom:((g=d==null?void 0:d.bottom)!=null?g:[]).filter(C=>!(a!=null&&a.has(C)))}})},e.getCanPin=()=>{var t;const{enableRowPinning:s,enablePinning:o}=n.options;return typeof s=="function"?s(e):(t=s??o)!=null?t:!0},e.getIsPinned=()=>{const t=[e.id],{top:s,bottom:o}=n.getState().rowPinning,i=t.some(a=>s==null?void 0:s.includes(a)),u=t.some(a=>o==null?void 0:o.includes(a));return i?"top":u?"bottom":!1},e.getPinnedIndex=()=>{var t,s;const o=e.getIsPinned();if(!o)return-1;const i=(t=o==="top"?n.getTopRows():n.getBottomRows())==null?void 0:t.map(u=>{let{id:a}=u;return a});return(s=i==null?void 0:i.indexOf(e.id))!=null?s:-1}},createTable:e=>{e.setRowPinning=n=>e.options.onRowPinningChange==null?void 0:e.options.onRowPinningChange(n),e.resetRowPinning=n=>{var t,s;return e.setRowPinning(n?rs():(t=(s=e.initialState)==null?void 0:s.rowPinning)!=null?t:rs())},e.getIsSomeRowsPinned=n=>{var t;const s=e.getState().rowPinning;if(!n){var o,i;return!!((o=s.top)!=null&&o.length||(i=s.bottom)!=null&&i.length)}return!!((t=s[n])!=null&&t.length)},e._getPinnedRows=(n,t,s)=>{var o;return((o=e.options.keepPinnedRows)==null||o?(t??[]).map(u=>{const a=e.getRow(u,!0);return a.getIsAllParentsExpanded()?a:null}):(t??[]).map(u=>n.find(a=>a.id===u))).filter(Boolean).map(u=>({...u,position:s}))},e.getTopRows=te(()=>[e.getRowModel().rows,e.getState().rowPinning.top],(n,t)=>e._getPinnedRows(n,t,"top"),ne(e.options,"debugRows")),e.getBottomRows=te(()=>[e.getRowModel().rows,e.getState().rowPinning.bottom],(n,t)=>e._getPinnedRows(n,t,"bottom"),ne(e.options,"debugRows")),e.getCenterRows=te(()=>[e.getRowModel().rows,e.getState().rowPinning.top,e.getState().rowPinning.bottom],(n,t,s)=>{const o=new Set([...t??[],...s??[]]);return n.filter(i=>!o.has(i.id))},ne(e.options,"debugRows"))}},$i={getInitialState:e=>({rowSelection:{},...e}),getDefaultOptions:e=>({onRowSelectionChange:ut("rowSelection",e),enableRowSelection:!0,enableMultiRowSelection:!0,enableSubRowSelection:!0}),createTable:e=>{e.setRowSelection=n=>e.options.onRowSelectionChange==null?void 0:e.options.onRowSelectionChange(n),e.resetRowSelection=n=>{var t;return e.setRowSelection(n?{}:(t=e.initialState.rowSelection)!=null?t:{})},e.toggleAllRowsSelected=n=>{e.setRowSelection(t=>{n=typeof n<"u"?n:!e.getIsAllRowsSelected();const s={...t},o=e.getPreGroupedRowModel().flatRows;return n?o.forEach(i=>{i.getCanSelect()&&(s[i.id]=!0)}):o.forEach(i=>{delete s[i.id]}),s})},e.toggleAllPageRowsSelected=n=>e.setRowSelection(t=>{const s=typeof n<"u"?n:!e.getIsAllPageRowsSelected(),o={...t};return e.getRowModel().rows.forEach(i=>{ms(o,i.id,s,!0,e)}),o}),e.getPreSelectedRowModel=()=>e.getCoreRowModel(),e.getSelectedRowModel=te(()=>[e.getState().rowSelection,e.getCoreRowModel()],(n,t)=>Object.keys(n).length?ss(e,t):{rows:[],flatRows:[],rowsById:{}},ne(e.options,"debugTable")),e.getFilteredSelectedRowModel=te(()=>[e.getState().rowSelection,e.getFilteredRowModel()],(n,t)=>Object.keys(n).length?ss(e,t):{rows:[],flatRows:[],rowsById:{}},ne(e.options,"debugTable")),e.getGroupedSelectedRowModel=te(()=>[e.getState().rowSelection,e.getSortedRowModel()],(n,t)=>Object.keys(n).length?ss(e,t):{rows:[],flatRows:[],rowsById:{}},ne(e.options,"debugTable")),e.getIsAllRowsSelected=()=>{const n=e.getFilteredRowModel().flatRows,{rowSelection:t}=e.getState();let s=!!(n.length&&Object.keys(t).length);return s&&n.some(o=>o.getCanSelect()&&!t[o.id])&&(s=!1),s},e.getIsAllPageRowsSelected=()=>{const n=e.getPaginationRowModel().flatRows.filter(o=>o.getCanSelect()),{rowSelection:t}=e.getState();let s=!!n.length;return s&&n.some(o=>!t[o.id])&&(s=!1),s},e.getIsSomeRowsSelected=()=>{var n;const t=Object.keys((n=e.getState().rowSelection)!=null?n:{}).length;return t>0&&t<e.getFilteredRowModel().flatRows.length},e.getIsSomePageRowsSelected=()=>{const n=e.getPaginationRowModel().flatRows;return e.getIsAllPageRowsSelected()?!1:n.filter(t=>t.getCanSelect()).some(t=>t.getIsSelected()||t.getIsSomeSelected())},e.getToggleAllRowsSelectedHandler=()=>n=>{e.toggleAllRowsSelected(n.target.checked)},e.getToggleAllPageRowsSelectedHandler=()=>n=>{e.toggleAllPageRowsSelected(n.target.checked)}},createRow:(e,n)=>{e.toggleSelected=(t,s)=>{const o=e.getIsSelected();n.setRowSelection(i=>{var u;if(t=typeof t<"u"?t:!o,e.getCanSelect()&&o===t)return i;const a={...i};return ms(a,e.id,t,(u=s==null?void 0:s.selectChildren)!=null?u:!0,n),a})},e.getIsSelected=()=>{const{rowSelection:t}=n.getState();return bs(e,t)},e.getIsSomeSelected=()=>{const{rowSelection:t}=n.getState();return fs(e,t)==="some"},e.getIsAllSubRowsSelected=()=>{const{rowSelection:t}=n.getState();return fs(e,t)==="all"},e.getCanSelect=()=>{var t;return typeof n.options.enableRowSelection=="function"?n.options.enableRowSelection(e):(t=n.options.enableRowSelection)!=null?t:!0},e.getCanSelectSubRows=()=>{var t;return typeof n.options.enableSubRowSelection=="function"?n.options.enableSubRowSelection(e):(t=n.options.enableSubRowSelection)!=null?t:!0},e.getCanMultiSelect=()=>{var t;return typeof n.options.enableMultiRowSelection=="function"?n.options.enableMultiRowSelection(e):(t=n.options.enableMultiRowSelection)!=null?t:!0},e.getToggleSelectedHandler=()=>{const t=e.getCanSelect();return s=>{var o;t&&e.toggleSelected((o=s.target)==null?void 0:o.checked)}}}},ms=(e,n,t,s,o)=>{var i;const u=o.getRow(n,!0);t?(u.getCanMultiSelect()||Object.keys(e).forEach(a=>delete e[a]),u.getCanSelect()&&(e[n]=!0)):delete e[n],s&&(i=u.subRows)!=null&&i.length&&u.getCanSelectSubRows()&&u.subRows.forEach(a=>ms(e,a.id,t,s,o))};function ss(e,n){const t=e.getState().rowSelection,s=[],o={},i=function(u,a){return u.map(d=>{var m;const g=bs(d,t);if(g&&(s.push(d),o[d.id]=d),(m=d.subRows)!=null&&m.length&&(d={...d,subRows:i(d.subRows)}),g)return d}).filter(Boolean)};return{rows:i(n.rows),flatRows:s,rowsById:o}}function bs(e,n){var t;return(t=n[e.id])!=null?t:!1}function fs(e,n,t){var s;if(!((s=e.subRows)!=null&&s.length))return!1;let o=!0,i=!1;return e.subRows.forEach(u=>{if(!(i&&!o)&&(u.getCanSelect()&&(bs(u,n)?i=!0:o=!1),u.subRows&&u.subRows.length)){const a=fs(u,n);a==="all"?i=!0:(a==="some"&&(i=!0),o=!1)}}),o?"all":i?"some":!1}const ps=/([0-9]+)/gm,Ei=(e,n,t)=>_o(qt(e.getValue(t)).toLowerCase(),qt(n.getValue(t)).toLowerCase()),Ii=(e,n,t)=>_o(qt(e.getValue(t)),qt(n.getValue(t))),Ai=(e,n,t)=>Ss(qt(e.getValue(t)).toLowerCase(),qt(n.getValue(t)).toLowerCase()),ki=(e,n,t)=>Ss(qt(e.getValue(t)),qt(n.getValue(t))),Pi=(e,n,t)=>{const s=e.getValue(t),o=n.getValue(t);return s>o?1:s<o?-1:0},Vi=(e,n,t)=>Ss(e.getValue(t),n.getValue(t));function Ss(e,n){return e===n?0:e>n?1:-1}function qt(e){return typeof e=="number"?isNaN(e)||e===1/0||e===-1/0?"":String(e):typeof e=="string"?e:""}function _o(e,n){const t=e.split(ps).filter(Boolean),s=n.split(ps).filter(Boolean);for(;t.length&&s.length;){const o=t.shift(),i=s.shift(),u=parseInt(o,10),a=parseInt(i,10),d=[u,a].sort();if(isNaN(d[0])){if(o>i)return 1;if(i>o)return-1;continue}if(isNaN(d[1]))return isNaN(u)?-1:1;if(u>a)return 1;if(a>u)return-1}return t.length-s.length}const Bn={alphanumeric:Ei,alphanumericCaseSensitive:Ii,text:Ai,textCaseSensitive:ki,datetime:Pi,basic:Vi},Di={getInitialState:e=>({sorting:[],...e}),getDefaultColumnDef:()=>({sortingFn:"auto",sortUndefined:1}),getDefaultOptions:e=>({onSortingChange:ut("sorting",e),isMultiSortEvent:n=>n.shiftKey}),createColumn:(e,n)=>{e.getAutoSortingFn=()=>{const t=n.getFilteredRowModel().flatRows.slice(10);let s=!1;for(const o of t){const i=o==null?void 0:o.getValue(e.id);if(Object.prototype.toString.call(i)==="[object Date]")return Bn.datetime;if(typeof i=="string"&&(s=!0,i.split(ps).length>1))return Bn.alphanumeric}return s?Bn.text:Bn.basic},e.getAutoSortDir=()=>{const t=n.getFilteredRowModel().flatRows[0];return typeof(t==null?void 0:t.getValue(e.id))=="string"?"asc":"desc"},e.getSortingFn=()=>{var t,s;if(!e)throw new Error;return Rr(e.columnDef.sortingFn)?e.columnDef.sortingFn:e.columnDef.sortingFn==="auto"?e.getAutoSortingFn():(t=(s=n.options.sortingFns)==null?void 0:s[e.columnDef.sortingFn])!=null?t:Bn[e.columnDef.sortingFn]},e.toggleSorting=(t,s)=>{const o=e.getNextSortingOrder(),i=typeof t<"u"&&t!==null;n.setSorting(u=>{const a=u==null?void 0:u.find(f=>f.id===e.id),d=u==null?void 0:u.findIndex(f=>f.id===e.id);let m=[],g,y=i?t:o==="desc";if(u!=null&&u.length&&e.getCanMultiSort()&&s?a?g="toggle":g="add":u!=null&&u.length&&d!==u.length-1?g="replace":a?g="toggle":g="replace",g==="toggle"&&(i||o||(g="remove")),g==="add"){var h;m=[...u,{id:e.id,desc:y}],m.splice(0,m.length-((h=n.options.maxMultiSortColCount)!=null?h:Number.MAX_SAFE_INTEGER))}else g==="toggle"?m=u.map(f=>f.id===e.id?{...f,desc:y}:f):g==="remove"?m=u.filter(f=>f.id!==e.id):m=[{id:e.id,desc:y}];return m})},e.getFirstSortDir=()=>{var t,s;return((t=(s=e.columnDef.sortDescFirst)!=null?s:n.options.sortDescFirst)!=null?t:e.getAutoSortDir()==="desc")?"desc":"asc"},e.getNextSortingOrder=t=>{var s,o;const i=e.getFirstSortDir(),u=e.getIsSorted();return u?u!==i&&((s=n.options.enableSortingRemoval)==null||s)&&(!(t&&(o=n.options.enableMultiRemove)!=null)||o)?!1:u==="desc"?"asc":"desc":i},e.getCanSort=()=>{var t,s;return((t=e.columnDef.enableSorting)!=null?t:!0)&&((s=n.options.enableSorting)!=null?s:!0)&&!!e.accessorFn},e.getCanMultiSort=()=>{var t,s;return(t=(s=e.columnDef.enableMultiSort)!=null?s:n.options.enableMultiSort)!=null?t:!!e.accessorFn},e.getIsSorted=()=>{var t;const s=(t=n.getState().sorting)==null?void 0:t.find(o=>o.id===e.id);return s?s.desc?"desc":"asc":!1},e.getSortIndex=()=>{var t,s;return(t=(s=n.getState().sorting)==null?void 0:s.findIndex(o=>o.id===e.id))!=null?t:-1},e.clearSorting=()=>{n.setSorting(t=>t!=null&&t.length?t.filter(s=>s.id!==e.id):[])},e.getToggleSortingHandler=()=>{const t=e.getCanSort();return s=>{t&&(s.persist==null||s.persist(),e.toggleSorting==null||e.toggleSorting(void 0,e.getCanMultiSort()?n.options.isMultiSortEvent==null?void 0:n.options.isMultiSortEvent(s):!1))}}},createTable:e=>{e.setSorting=n=>e.options.onSortingChange==null?void 0:e.options.onSortingChange(n),e.resetSorting=n=>{var t,s;e.setSorting(n?[]:(t=(s=e.initialState)==null?void 0:s.sorting)!=null?t:[])},e.getPreSortedRowModel=()=>e.getGroupedRowModel(),e.getSortedRowModel=()=>(!e._getSortedRowModel&&e.options.getSortedRowModel&&(e._getSortedRowModel=e.options.getSortedRowModel(e)),e.options.manualSorting||!e._getSortedRowModel?e.getPreSortedRowModel():e._getSortedRowModel())}},Oi=[si,Ci,vi,bi,ai,ii,Ni,ji,Di,xi,Mi,Fi,Ri,$i,wi];function Ti(e){var n,t;const s=[...Oi,...(n=e._features)!=null?n:[]];let o={_features:s};const i=o._features.reduce((h,f)=>Object.assign(h,f.getDefaultOptions==null?void 0:f.getDefaultOptions(o)),{}),u=h=>o.options.mergeOptions?o.options.mergeOptions(i,h):{...i,...h};let d={...{},...(t=e.initialState)!=null?t:{}};o._features.forEach(h=>{var f;d=(f=h.getInitialState==null?void 0:h.getInitialState(d))!=null?f:d});const m=[];let g=!1;const y={_features:s,options:{...i,...e},initialState:d,_queue:h=>{m.push(h),g||(g=!0,Promise.resolve().then(()=>{for(;m.length;)m.shift()();g=!1}).catch(f=>setTimeout(()=>{throw f})))},reset:()=>{o.setState(o.initialState)},setOptions:h=>{const f=Wt(h,o.options);o.options=u(f)},getState:()=>o.options.state,setState:h=>{o.options.onStateChange==null||o.options.onStateChange(h)},_getRowId:(h,f,_)=>{var C;return(C=o.options.getRowId==null?void 0:o.options.getRowId(h,f,_))!=null?C:`${_?[_.id,f].join("."):f}`},getCoreRowModel:()=>(o._getCoreRowModel||(o._getCoreRowModel=o.options.getCoreRowModel(o)),o._getCoreRowModel()),getRowModel:()=>o.getPaginationRowModel(),getRow:(h,f)=>{let _=(f?o.getPrePaginationRowModel():o.getRowModel()).rowsById[h];if(!_&&(_=o.getCoreRowModel().rowsById[h],!_))throw new Error;return _},_getDefaultColumnDef:te(()=>[o.options.defaultColumn],h=>{var f;return h=(f=h)!=null?f:{},{header:_=>{const C=_.header.column.columnDef;return C.accessorKey?C.accessorKey:C.accessorFn?C.id:null},cell:_=>{var C,w;return(C=(w=_.renderValue())==null||w.toString==null?void 0:w.toString())!=null?C:null},...o._features.reduce((_,C)=>Object.assign(_,C.getDefaultColumnDef==null?void 0:C.getDefaultColumnDef()),{}),...h}},ne(e,"debugColumns")),_getColumnDefs:()=>o.options.columns,getAllColumns:te(()=>[o._getColumnDefs()],h=>{const f=function(_,C,w){return w===void 0&&(w=0),_.map(v=>{const S=ri(o,v,w,C),b=v;return S.columns=b.columns?f(b.columns,S,w+1):[],S})};return f(h)},ne(e,"debugColumns")),getAllFlatColumns:te(()=>[o.getAllColumns()],h=>h.flatMap(f=>f.getFlatColumns()),ne(e,"debugColumns")),_getAllFlatColumnsById:te(()=>[o.getAllFlatColumns()],h=>h.reduce((f,_)=>(f[_.id]=_,f),{}),ne(e,"debugColumns")),getAllLeafColumns:te(()=>[o.getAllColumns(),o._getOrderColumnsFn()],(h,f)=>{let _=h.flatMap(C=>C.getLeafColumns());return f(_)},ne(e,"debugColumns")),getColumn:h=>o._getAllFlatColumnsById()[h]};Object.assign(o,y);for(let h=0;h<o._features.length;h++){const f=o._features[h];f==null||f.createTable==null||f.createTable(o)}return o}function Js(){return e=>te(()=>[e.options.data],n=>{const t={rows:[],flatRows:[],rowsById:{}},s=function(o,i,u){i===void 0&&(i=0);const a=[];for(let m=0;m<o.length;m++){const g=oi(e,e._getRowId(o[m],m,u),o[m],m,i,void 0,u==null?void 0:u.id);if(t.flatRows.push(g),t.rowsById[g.id]=g,a.push(g),e.options.getSubRows){var d;g.originalSubRows=e.options.getSubRows(o[m],m),(d=g.originalSubRows)!=null&&d.length&&(g.subRows=s(g.originalSubRows,i+1,g))}}return a};return t.rows=s(n),t},ne(e.options,"debugTable","getRowModel",()=>e._autoResetPageIndex()))}function Li(e){const n=[],t=s=>{var o;n.push(s),(o=s.subRows)!=null&&o.length&&s.getIsExpanded()&&s.subRows.forEach(t)};return e.rows.forEach(t),{rows:n,flatRows:e.flatRows,rowsById:e.rowsById}}function eo(e){return n=>te(()=>[n.getState().pagination,n.getPrePaginationRowModel(),n.options.paginateExpandedRows?void 0:n.getState().expanded],(t,s)=>{if(!s.rows.length)return s;const{pageSize:o,pageIndex:i}=t;let{rows:u,flatRows:a,rowsById:d}=s;const m=o*i,g=m+o;u=u.slice(m,g);let y;n.options.paginateExpandedRows?y={rows:u,flatRows:a,rowsById:d}:y=Li({rows:u,flatRows:a,rowsById:d}),y.flatRows=[];const h=f=>{y.flatRows.push(f),f.subRows.length&&f.subRows.forEach(h)};return y.rows.forEach(h),y},ne(n.options,"debugTable"))}function to(){return e=>te(()=>[e.getState().sorting,e.getPreSortedRowModel()],(n,t)=>{if(!t.rows.length||!(n!=null&&n.length))return t;const s=e.getState().sorting,o=[],i=s.filter(d=>{var m;return(m=e.getColumn(d.id))==null?void 0:m.getCanSort()}),u={};i.forEach(d=>{const m=e.getColumn(d.id);m&&(u[d.id]={sortUndefined:m.columnDef.sortUndefined,invertSorting:m.columnDef.invertSorting,sortingFn:m.getSortingFn()})});const a=d=>{const m=d.map(g=>({...g}));return m.sort((g,y)=>{for(let f=0;f<i.length;f+=1){var h;const _=i[f],C=u[_.id],w=C.sortUndefined,v=(h=_==null?void 0:_.desc)!=null?h:!1;let S=0;if(w){const b=g.getValue(_.id),j=y.getValue(_.id),k=b===void 0,R=j===void 0;if(k||R){if(w==="first")return k?-1:1;if(w==="last")return k?1:-1;S=k&&R?0:k?w:-w}}if(S===0&&(S=C.sortingFn(g,y,_.id)),S!==0)return v&&(S*=-1),C.invertSorting&&(S*=-1),S}return g.index-y.index}),m.forEach(g=>{var y;o.push(g),(y=g.subRows)!=null&&y.length&&(g.subRows=a(g.subRows))}),m};return{rows:a(t.rows),flatRows:o,rowsById:t.rowsById}},ne(e.options,"debugTable","getSortedRowModel",()=>e._autoResetPageIndex()))}/**
   * react-table
   *
   * Copyright (c) TanStack
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE.md file in the root directory of this source tree.
   *
   * @license MIT
   */function no(e,n){return e?zi(e)?p.createElement(e,n):e:null}function zi(e){return Hi(e)||typeof e=="function"||Gi(e)}function Hi(e){return typeof e=="function"&&(()=>{const n=Object.getPrototypeOf(e);return n.prototype&&n.prototype.isReactComponent})()}function Gi(e){return typeof e=="object"&&typeof e.$$typeof=="symbol"&&["react.memo","react.forward_ref"].includes(e.$$typeof.description)}function ro(e){const n={state:{},onStateChange:()=>{},renderFallbackValue:null,...e},[t]=p.useState(()=>({current:Ti(n)})),[s,o]=p.useState(()=>t.current.initialState);return t.current.setOptions(i=>({...i,...e,state:{...s,...e.state},onStateChange:u=>{o(u),e.onStateChange==null||e.onStateChange(u)}})),t.current}function Co({nodes:e,edges:n,onNodesChange:t,onEdgesChange:s,onBlur:o,editable:i=!1}){const[u,a]=p.useState("nodes"),[d,m]=p.useState(e),[g,y]=p.useState(n),h=p.useRef(new Map),f=p.useRef(new Map);p.useEffect(()=>{m([...e]),y([...n]),h.current.clear(),f.current.clear()},[e,n]);const _=p.useMemo(()=>{if(e.length===0)return[];const b=new Set;e.forEach(R=>{Object.keys(R).forEach(U=>{U==="_totalIncoming"||U==="_totalOutgoing"||b.add(U)})});const j=Array.from(b);return[...j.includes("id")?["id"]:[],...j.includes("label")?["label"]:[],...j.filter(R=>R!=="id"&&R!=="label")].map(R=>({header:R.charAt(0).toUpperCase()+R.slice(1).replace(/_/g," "),accessorKey:R,cell:U=>{var H;const O=U.getValue();if(i&&R!=="id"){const K=U.row.original.id,ue=d.findIndex(le=>le.id===K);if(ue===-1)return r.jsx("span",{children:"-"});const E=((H=d[ue])==null?void 0:H[R])??O,re=`${K}-${R}`;return r.jsx(os,{id:re,type:typeof E=="number"?"number":"text",initialValue:E==null?"":String(E),isNumber:typeof E=="number",onBlur:le=>{const be=[...d],de=typeof E=="number"?parseFloat(le)||0:le;be[ue]={...be[ue],[R]:de},m(be),t==null||t(be),o==null||o()}},re)}return O==null?"-":typeof O=="number"?O.toLocaleString():String(O)}}))},[e,i]),C=p.useMemo(()=>{if(n.length===0)return[];const b=new Set;n.forEach(R=>{Object.keys(R).forEach(U=>b.add(U))});const j=Array.from(b);return[...j.includes("source")?["source"]:[],...j.includes("target")?["target"]:[],...j.includes("value")?["value"]:[],...j.filter(R=>R!=="source"&&R!=="target"&&R!=="value")].map(R=>({header:R.charAt(0).toUpperCase()+R.slice(1).replace(/_/g," "),accessorKey:R,cell:U=>{var H,ie;const O=U.getValue();if(i&&R!=="source"&&R!=="target"){const K=U.row.original,ue=g.findIndex(le=>le.source===K.source&&le.target===K.target&&le.value===K.value);if(ue===-1){const le=g.findIndex(Ne=>Ne.source===K.source&&Ne.target===K.target);if(le===-1)return r.jsx("span",{children:"-"});const be=((H=g[le])==null?void 0:H[R])??O,de=`${K.source}-${K.target}-${R}-fallback`;return r.jsx(os,{id:de,type:typeof be=="number"?"number":"text",initialValue:be==null?"":String(be),isNumber:typeof be=="number",onBlur:Ne=>{const Ee=[...g],$=typeof be=="number"?parseFloat(Ne)||0:Ne;Ee[le]={...Ee[le],[R]:$},y(Ee),s==null||s(Ee),o==null||o()}},de)}const E=((ie=g[ue])==null?void 0:ie[R])??O,re=`${K.source}-${K.target}-${R}`;return r.jsx(os,{id:re,type:typeof E=="number"?"number":"text",initialValue:E==null?"":String(E),isNumber:typeof E=="number",onBlur:le=>{const be=[...g],de=typeof E=="number"?parseFloat(le)||0:le;be[ue]={...be[ue],[R]:de},y(be),s==null||s(be),o==null||o()}},re)}return O==null?"-":typeof O=="number"?O.toLocaleString():String(O)}}))},[n,i]),w=ro({data:i?d:e,columns:_,getCoreRowModel:Js(),getSortedRowModel:to(),getPaginationRowModel:eo(),initialState:{pagination:{pageSize:25}}}),v=ro({data:i?g:n,columns:C,getCoreRowModel:Js(),getSortedRowModel:to(),getPaginationRowModel:eo(),initialState:{pagination:{pageSize:25}}}),S=u==="nodes"?w:v;return r.jsxs("div",{className:"h-full w-full flex flex-col",style:{height:"100%",maxHeight:"100%"},children:[r.jsxs("div",{className:"flex border-b mb-4 flex-shrink-0",children:[r.jsxs("button",{onClick:()=>a("nodes"),className:`px-4 py-2 font-medium text-sm transition-colors ${u==="nodes"?"border-b-2 border-blue-600 text-blue-600":"text-gray-600 hover:text-gray-900"}`,children:["Nodes (",e.length,")"]}),r.jsxs("button",{onClick:()=>a("edges"),className:`px-4 py-2 font-medium text-sm transition-colors ${u==="edges"?"border-b-2 border-blue-600 text-blue-600":"text-gray-600 hover:text-gray-900"}`,children:["Edges (",n.length,")"]})]}),r.jsx("div",{className:"flex-1 flex flex-col min-h-0 overflow-hidden",children:r.jsxs("div",{className:"overflow-auto flex-1 min-h-0",children:[r.jsxs("table",{className:"min-w-full text-sm",children:[r.jsx("thead",{className:"bg-gray-50 border-b sticky top-0 z-10",children:S.getHeaderGroups().map(b=>r.jsx("tr",{children:b.headers.map(j=>r.jsx("th",{className:"px-4 py-2 text-left font-semibold text-gray-700 bg-gray-50",children:j.isPlaceholder?null:r.jsxs("div",{className:j.column.getCanSort()?"cursor-pointer select-none hover:text-blue-600":"",onClick:j.column.getToggleSortingHandler(),children:[no(j.column.columnDef.header,j.getContext()),{asc:" ↑",desc:" ↓"}[j.column.getIsSorted()]??null]})},j.id))},b.id))}),r.jsx("tbody",{className:"divide-y divide-gray-200 bg-white",children:S.getRowModel().rows.map(b=>r.jsx("tr",{className:"hover:bg-gray-50",children:b.getVisibleCells().map(j=>r.jsx("td",{className:"px-4 py-2",children:no(j.column.columnDef.cell,j.getContext())},j.id))},b.id))})]}),S.getRowModel().rows.length===0&&r.jsxs("div",{className:"text-center text-gray-500 py-8",children:["No ",u," to display"]})]})}),r.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-t border-gray-200 bg-white flex-shrink-0",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("span",{className:"text-sm text-gray-700",children:"Show"}),r.jsx("select",{value:S.getState().pagination.pageSize,onChange:b=>{S.setPageSize(Number(b.target.value))},className:"border border-gray-300 rounded px-2 py-1 text-sm",children:[10,25,50,100].map(b=>r.jsx("option",{value:b,children:b},b))}),r.jsx("span",{className:"text-sm text-gray-700",children:"entries"})]}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsxs("span",{className:"text-sm text-gray-700",children:["Page ",S.getState().pagination.pageIndex+1," of"," ",S.getPageCount()]}),r.jsxs("div",{className:"flex gap-1",children:[r.jsx("button",{onClick:()=>S.setPageIndex(0),disabled:!S.getCanPreviousPage(),className:"px-2 py-1 text-sm border border-gray-300 rounded disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-50",children:"<<"}),r.jsx("button",{onClick:()=>S.previousPage(),disabled:!S.getCanPreviousPage(),className:"px-2 py-1 text-sm border border-gray-300 rounded disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-50",children:"<"}),r.jsx("button",{onClick:()=>S.nextPage(),disabled:!S.getCanNextPage(),className:"px-2 py-1 text-sm border border-gray-300 rounded disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-50",children:">"}),r.jsx("button",{onClick:()=>S.setPageIndex(S.getPageCount()-1),disabled:!S.getCanNextPage(),className:"px-2 py-1 text-sm border border-gray-300 rounded disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-50",children:">>"})]})]})]})]})}function os({id:e,type:n,initialValue:t,onBlur:s}){const o=p.useRef(null),[i,u]=p.useState(t);return p.useEffect(()=>{o.current&&document.activeElement!==o.current&&u(t)},[t]),r.jsx("input",{ref:o,id:e,type:n,value:i,onChange:a=>{u(a.target.value)},onBlur:a=>{s(a.target.value)},className:"w-full px-2 py-1 border border-gray-300 rounded text-sm focus:outline-none focus:ring-2 focus:ring-blue-500",autoComplete:"off"})}function Bi({dataset:e,onClose:n,onSave:t,onDelete:s,onDuplicate:o}){const[i,u]=p.useState(e.name),[a,d]=p.useState(e.notes||""),[m,g]=p.useState(!1),[y,h]=p.useState(!1),[f,_]=p.useState(!1),[C,w]=p.useState("info"),[v,S]=p.useState(null),b=e.snapshots[0]||{timestamp:e.timeRange.start,nodes:[],edges:[]};p.useEffect(()=>{u(e.name),d(e.notes||""),S(null)},[e]);async function j(){g(!0);try{const O={...e,name:i.trim(),notes:a.trim()||void 0};if(v){O.snapshots=v.snapshots;const H=O.snapshots[0]||b;O.metadata=ln(H)}await t(O),n()}catch(O){console.error("Save error:",O),alert("Failed to save dataset: "+(O instanceof Error?O.message:"Unknown error"))}finally{g(!1)}}async function k(){h(!0);try{await s(),n()}catch(O){console.error("Delete error:",O),alert("Failed to delete dataset: "+(O instanceof Error?O.message:"Unknown error"))}finally{h(!1),_(!1)}}function R(O,H){const ie={...b,nodes:O,edges:H};S({...e,snapshots:[ie]})}const U=i!==e.name||a!==(e.notes||"")||v!==null;return r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:r.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-6xl w-full mx-4 max-h-[90vh] flex flex-col",children:[r.jsxs("div",{className:"p-6 border-b flex items-center justify-between",children:[r.jsx("h2",{className:"text-2xl font-bold",children:"Edit Dataset"}),r.jsx("button",{onClick:n,type:"button",className:"text-gray-400 hover:text-gray-600 text-2xl cursor-pointer transition-colors",children:"×"})]}),r.jsxs("div",{className:"border-b flex",children:[r.jsx("button",{onClick:()=>w("info"),type:"button",className:`px-6 py-3 font-medium cursor-pointer transition-colors ${C==="info"?"border-b-2 border-blue-600 text-blue-600":"text-gray-600 hover:text-gray-900"}`,children:"Information"}),r.jsxs("button",{onClick:()=>w("data"),type:"button",className:`px-6 py-3 font-medium cursor-pointer transition-colors ${C==="data"?"border-b-2 border-blue-600 text-blue-600":"text-gray-600 hover:text-gray-900"}`,children:["Data (",b.nodes.length," nodes, ",b.edges.length," edges)"]})]}),r.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:C==="info"?r.jsxs("div",{className:"space-y-6 max-w-2xl",children:[r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Dataset Name ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsx("input",{type:"text",value:i,onChange:O=>u(O.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Enter a name for this dataset"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Notes"}),r.jsx("textarea",{value:a,onChange:O=>d(O.target.value),rows:5,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Add any notes about this dataset..."})]}),r.jsxs("div",{className:"bg-gray-50 p-4 rounded",children:[r.jsx("h3",{className:"font-medium text-gray-700 mb-2",children:"Dataset Information"}),r.jsxs("div",{className:"text-sm text-gray-600 space-y-1",children:[r.jsxs("div",{children:[r.jsx("span",{className:"font-medium",children:"Type:"})," ",e.type.toUpperCase()]}),r.jsxs("div",{children:[r.jsx("span",{className:"font-medium",children:"Time Range:"})," ",e.timeRange.start,e.timeRange.end!==e.timeRange.start?` – ${e.timeRange.end}`:""]}),r.jsxs("div",{children:[r.jsx("span",{className:"font-medium",children:"Snapshots:"})," ",e.snapshots.length]}),e.filename&&r.jsxs("div",{children:[r.jsx("span",{className:"font-medium",children:"Original File:"})," ",e.filename]}),r.jsxs("div",{children:[r.jsx("span",{className:"font-medium",children:"Created:"})," ",new Date(e.createdAt).toLocaleDateString()]})]})]}),r.jsxs("div",{className:"border-t pt-4 space-y-3",children:[r.jsx("button",{onClick:o,type:"button",className:"w-full px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50 cursor-pointer transition-colors",children:"Duplicate Dataset"}),r.jsx("button",{onClick:()=>_(!0),type:"button",className:"w-full px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 cursor-pointer transition-colors",children:"Delete Dataset"})]})]}):r.jsx("div",{className:"h-full",children:r.jsx(Ui,{nodes:b.nodes,edges:b.edges,onUpdate:R})})}),r.jsxs("div",{className:"p-6 border-t flex justify-end gap-3",children:[r.jsx("button",{onClick:n,type:"button",disabled:m||y,className:"px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50 disabled:opacity-50 cursor-pointer transition-colors",children:"Cancel"}),r.jsx("button",{onClick:j,type:"button",disabled:m||y||!U&&C==="info"||!i.trim(),className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed cursor-pointer transition-colors",children:m?"Saving...":v?"Save All Changes":"Save Changes"})]}),f&&r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-60",children:r.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md mx-4",children:[r.jsx("h3",{className:"text-lg font-bold mb-2",children:"Delete Dataset?"}),r.jsxs("p",{className:"text-gray-600 mb-4",children:['Are you sure you want to delete "',e.name,'"? This action cannot be undone.']}),r.jsxs("div",{className:"flex justify-end gap-3",children:[r.jsx("button",{onClick:()=>_(!1),type:"button",disabled:y,className:"px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50 cursor-pointer transition-colors",children:"Cancel"}),r.jsx("button",{onClick:k,type:"button",disabled:y,className:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 disabled:opacity-50 cursor-pointer transition-colors",children:y?"Deleting...":"Delete"})]})]})})]})})}function Ui({nodes:e,edges:n,onUpdate:t}){const[s,o]=p.useState(e),[i,u]=p.useState(n);p.useEffect(()=>{o([...e]),u([...n])},[e,n]);const a=p.useRef(s),d=p.useRef(i);p.useEffect(()=>{a.current=s,d.current=i},[s,i]);const m=p.useCallback(f=>{o(f),a.current=f},[]),g=p.useCallback(f=>{u(f),d.current=f},[]),y=p.useRef(!1),h=p.useCallback(()=>{y.current&&(t(a.current,d.current),y.current=!1)},[t]);return r.jsx("div",{className:"h-full",children:r.jsx(Co,{nodes:s,edges:i,onNodesChange:f=>{m(f),y.current=!0},onEdgesChange:f=>{g(f),y.current=!0},onBlur:h,editable:!0})})}class Gt extends p.Component{constructor(n){super(n),this.state={hasError:!1,error:null}}static getDerivedStateFromError(n){return{hasError:!0,error:n}}componentDidCatch(n,t){var s,o;console.error("ErrorBoundary caught an error:",n,t),(o=(s=this.props).onError)==null||o.call(s,n,t)}render(){var n;return this.state.hasError?this.props.fallback?this.props.fallback:r.jsxs("div",{className:"p-4 bg-red-50 border border-red-200 rounded-md",children:[r.jsx("h3",{className:"text-lg font-semibold text-red-800 mb-2",children:"Something went wrong"}),r.jsx("p",{className:"text-sm text-red-700 mb-2",children:((n=this.state.error)==null?void 0:n.message)||"An error occurred"}),r.jsx("button",{onClick:()=>this.setState({hasError:!1,error:null}),className:"px-3 py-1 bg-red-600 text-white text-sm rounded hover:bg-red-700 cursor-pointer transition-colors",children:"Try again"})]}):this.props.children}}function Wi({selectedId:e,onSelect:n,onRefresh:t}){const[s,o]=p.useState([]),[i,u]=p.useState(!1),[a,d]=p.useState(null),[m,g]=p.useState(!1),[y,h]=p.useState(null),f=p.useRef(null);p.useEffect(()=>{_()},[]);async function _(){const k=await Ya();o(k)}async function C(k,R){try{const O=`${k.type||"csv"}-${Date.now()}`,H={...k,id:O,snapshots:R.snapshots,metadata:R.metadata,createdAt:Date.now()};await Bt(H),await _(),u(!1),h(null),n(O)}catch(U){throw console.error("Import error:",U),U}finally{f.current&&(f.current.value="")}}async function w(k,R){R.stopPropagation();const U=await Ut(k);U&&d(U)}async function v(k){await Bt(k),await _(),e===k.id&&(t==null||t())}async function S(){a&&(await ds(a.id),await _(),e===a.id&&n(""),d(null))}async function b(){if(!a)return;const k=await Xa(a.id);await _(),d(null),n(k.id)}async function j(){await Za(),await _(),g(!1),n(""),window.location.reload()}return r.jsxs("aside",{className:"h-full overflow-y-auto flex flex-col",children:[r.jsxs("div",{className:"p-4 border-b",children:[r.jsx("h2",{className:"text-lg font-bold",children:"Datasets"}),r.jsx("p",{className:"text-xs text-gray-500",children:"Stored in your browser"}),r.jsx("button",{onClick:()=>u(!0),className:"mt-3 w-full px-3 py-2 bg-blue-600 text-white text-sm rounded hover:bg-blue-700",children:"Import Dataset"}),r.jsx("input",{ref:f,type:"file",accept:".csv,.gexf",multiple:!0,className:"hidden"}),i&&r.jsx(Gt,{fallback:r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:r.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md mx-4",children:[r.jsx("h3",{className:"text-lg font-bold text-red-800 mb-2",children:"Import Panel Error"}),r.jsx("p",{className:"text-gray-600 mb-4",children:"The import panel encountered an error."}),r.jsx("button",{onClick:()=>u(!1),className:"px-4 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-700 cursor-pointer transition-colors",children:"Close"})]})}),children:r.jsx(Ja,{onClose:()=>{u(!1),h(null),f.current&&(f.current.value="")},onImport:C,fileInputRef:f,onFilesSelected:h,existingFile:y})})]}),r.jsxs("ul",{className:"divide-y flex-1 overflow-y-auto",children:[s.map(k=>r.jsx("li",{children:r.jsxs("div",{className:`flex items-center group ${e===k.id?"bg-blue-50":""}`,children:[r.jsxs("button",{className:"flex-1 text-left p-3 hover:bg-gray-50",onClick:()=>n(k.id),children:[r.jsx("div",{className:"flex items-center justify-between",children:r.jsxs("div",{children:[r.jsx("div",{className:"font-medium",children:k.name}),r.jsxs("div",{className:"text-xs text-gray-500",children:[k.type.toUpperCase()," · ",k.timeRange.start,k.timeRange.end!==k.timeRange.start?`–${k.timeRange.end}`:""]})]})}),k.notes&&r.jsx("div",{className:"text-xs text-gray-600 mt-1 line-clamp-2",children:k.notes})]}),r.jsx("button",{onClick:R=>w(k.id,R),className:"px-2 py-1 text-gray-400 hover:text-blue-600 hover:bg-gray-100 rounded transition-all mr-2 cursor-pointer",title:"Edit dataset",type:"button",children:r.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})})})]})},k.id)),s.length===0&&r.jsx("li",{className:"p-3 text-sm text-gray-500",children:"No datasets yet"})]}),r.jsxs("div",{className:"p-4 border-t",children:[r.jsx("button",{onClick:()=>g(!0),type:"button",className:"w-full px-3 py-2 bg-red-600 text-white text-sm rounded hover:bg-red-700 cursor-pointer transition-colors",children:"Reset All Data"}),r.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"Delete all datasets and reload defaults"})]}),a&&r.jsx(Gt,{fallback:r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:r.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md mx-4",children:[r.jsx("h3",{className:"text-lg font-bold text-red-800 mb-2",children:"Edit Panel Error"}),r.jsx("p",{className:"text-gray-600 mb-4",children:"The edit panel encountered an error."}),r.jsx("button",{onClick:()=>d(null),className:"px-4 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-700 cursor-pointer transition-colors",children:"Close"})]})}),children:r.jsx(Bi,{dataset:a,onClose:()=>d(null),onSave:v,onDelete:S,onDuplicate:b})}),m&&r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-60",children:r.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md mx-4",children:[r.jsx("h3",{className:"text-lg font-bold mb-2",children:"Reset All Data?"}),r.jsx("p",{className:"text-gray-600 mb-4",children:"This will delete all datasets and reload the default test data. This action cannot be undone."}),r.jsxs("div",{className:"flex justify-end gap-3",children:[r.jsx("button",{onClick:()=>g(!1),type:"button",className:"px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50 cursor-pointer transition-colors",children:"Cancel"}),r.jsx("button",{onClick:j,type:"button",className:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 cursor-pointer transition-colors",children:"Reset All Data"})]})]})})]})}function qi({nodes:e,edges:n,width:t=1200,height:s=800}){const o=p.useRef(null),[i,u]=p.useState(null),[a,d]=p.useState(null);return p.useEffect(()=>{var Ne,Ee;if(!o.current||n.length===0||e.length===0){o.current&&De(o.current).selectAll("*").remove();return}De(o.current).selectAll("*").remove();const m=new Map;e.forEach($=>{m.set($.id,{id:$.id,label:$.label||$.id,outgoing:0,incoming:0})}),n.forEach($=>{const q=m.get($.source),Ie=m.get($.target);q&&(q.outgoing+=$.value),Ie&&(Ie.incoming+=$.value)});const g=Array.from(m.values()).filter($=>$.outgoing>0||$.incoming>0);if(g.length===0){De(o.current).append("text").attr("x",t/2).attr("y",s/2).attr("text-anchor","middle").attr("font-size","14px").attr("fill","#666").text("No active nodes with flows");return}g.sort(($,q)=>q.outgoing+q.incoming-($.outgoing+$.incoming));const y=50,h=t-50,f=20,_=15,C=2,w=5,v=g.reduce(($,q)=>$+q.outgoing,0),S=g.reduce(($,q)=>$+q.incoming,0),b=Math.max(s-2*f,400);let j=f;g.forEach($=>{const q=v>0?Math.max(w,$.outgoing/v*b):Math.max(w,b/g.length);j+=q+C});let k=f;g.forEach($=>{const q=S>0?Math.max(w,$.incoming/S*b):Math.max(w,b/g.length);k+=q+C});const R=Math.max(s,Math.max(j,k)+100),U=R-2*f,O=De(o.current).attr("width",t).attr("height",R).style("font","12px sans-serif");let H=f;const ie=g.map(($,q)=>{const Ie=v>0?Math.max(w,$.outgoing/v*U):Math.max(w,U/g.length),ge=H;return H+=Ie+C,{node:$,x:y,y:ge,height:Math.max(w,Ie-C),side:"left",index:q}});H=f;const K=g.map(($,q)=>{const Ie=S>0?Math.max(w,$.incoming/S*U):Math.max(w,U/g.length),ge=H;return H+=Ie+C,{node:$,x:h,y:ge,height:Math.max(w,Ie-C),side:"right",index:q}});let ue=[];i&&a&&(a==="left"?ue=n.filter($=>$.source===i&&$.source!==$.target):ue=n.filter($=>$.target===i&&$.source!==$.target));const E=lo(mo);if(ue.length>0){const $=ue.map(L=>{const Te=ie.find(Qe=>Qe.node.id===L.source),J=K.find(Qe=>Qe.node.id===L.target);if(!Te||!J)return null;const Be=Te.y+Te.height/2,Me=J.y+J.height/2;return{edge:L,sourceX:Te.x+_,sourceY:Be,targetX:J.x,targetY:Me,value:L.value,leftIndex:Te.index,rightIndex:J.index}}).filter(L=>L!==null),q=Math.max(...$.map(L=>L.value),1),Ie=2,ge=20,Ze=O.append("g").attr("class","links");$.forEach(L=>{const Te=Ie+L.value/q*(ge-Ie),J=`gradient-${L.leftIndex}-${L.rightIndex}`,Be=O.append("defs").append("linearGradient").attr("id",J).attr("gradientUnits","userSpaceOnUse").attr("x1",L.sourceX).attr("x2",L.targetX).attr("y1",L.sourceY).attr("y2",L.targetY);Be.append("stop").attr("offset","0%").attr("stop-color",E(String(L.leftIndex))).attr("stop-opacity",.6),Be.append("stop").attr("offset","100%").attr("stop-color",E(String(L.rightIndex))).attr("stop-opacity",.6);const Me=ys(),Qe=(L.sourceX+L.targetX)/2;Me.moveTo(L.sourceX,L.sourceY),Me.bezierCurveTo(Qe,L.sourceY,Qe,L.targetY,L.targetX,L.targetY),Ze.append("path").attr("d",Me.toString()).attr("stroke",`url(#${J})`).attr("stroke-width",Te).attr("fill","none").attr("stroke-opacity",.6).style("cursor","pointer").on("mouseover",function(Ae){De(this).attr("stroke-opacity",1).attr("stroke-width",Te+2),De("body").append("div").attr("class","tooltip").style("position","absolute").style("background","rgba(0, 0, 0, 0.8)").style("color","white").style("padding","8px").style("border-radius","4px").style("pointer-events","none").style("opacity",0).html(`${L.edge.source} → ${L.edge.target}<br/>${L.value.toLocaleString()}`).style("opacity",1)}).on("mousemove",function(Ae){De(".tooltip").style("left",`${Ae.pageX+10}px`).style("top",`${Ae.pageY-10}px`)}).on("mouseout",function(){De(this).attr("stroke-opacity",.6).attr("stroke-width",Te),De(".tooltip").remove()})})}const le=O.append("g").attr("class","left-nodes").selectAll("g.node").data(ie).join("g").attr("class","node").attr("transform",$=>`translate(${$.x}, ${$.y})`).style("cursor","pointer").on("click",function($,q){$.stopPropagation(),i===q.node.id&&a==="left"?(u(null),d(null)):(u(q.node.id),d("left"))});le.append("rect").attr("width",_).attr("height",$=>$.height).attr("fill",($,q)=>E(String(q))).attr("stroke",($,q)=>un(E(String(q))).darker().formatHex()).attr("stroke-width",$=>i===$.node.id&&a==="left"?3:1).attr("opacity",$=>i&&a==="left"&&i!==$.node.id?.3:1).on("mouseover",function($,q){De(this).attr("fill",un(E(String(q.index))).brighter(.5).formatHex())}).on("mouseout",function($,q){De(this).attr("fill",E(String(q.index)))}),le.append("text").attr("x",_+6).attr("y",$=>$.height/2).attr("dy","0.35em").attr("text-anchor","start").text($=>`${$.node.label} (${$.node.outgoing.toLocaleString()})`).style("font-size","11px").style("font-weight","500").style("fill","#333").attr("opacity",$=>i&&a==="left"&&i!==$.node.id?.3:1);const de=O.append("g").attr("class","right-nodes").selectAll("g.node").data(K).join("g").attr("class","node").attr("transform",$=>`translate(${$.x}, ${$.y})`).style("cursor","pointer").on("click",function($,q){$.stopPropagation(),i===q.node.id&&a==="right"?(u(null),d(null)):(u(q.node.id),d("right"))});de.append("rect").attr("x",-_).attr("width",_).attr("height",$=>$.height).attr("fill",($,q)=>E(String(q))).attr("stroke",($,q)=>un(E(String(q))).darker().formatHex()).attr("stroke-width",$=>i===$.node.id&&a==="right"?3:1).attr("opacity",$=>i&&a==="right"&&i!==$.node.id?.3:1).on("mouseover",function($,q){De(this).attr("fill",un(E(String(q.index))).brighter(.5).formatHex())}).on("mouseout",function($,q){De(this).attr("fill",E(String(q.index)))}),de.append("text").attr("x",-_-6).attr("y",$=>$.height/2).attr("dy","0.35em").attr("text-anchor","end").text($=>`${$.node.label} (${$.node.incoming.toLocaleString()})`).style("font-size","11px").style("font-weight","500").style("fill","#333").attr("opacity",$=>i&&a==="right"&&i!==$.node.id?.3:1),i?O.append("text").attr("x",t/2).attr("y",20).attr("text-anchor","middle").attr("font-size","14px").attr("fill","#333").text(a==="left"?`Showing outgoing flows from ${(Ne=ie.find($=>$.node.id===i))==null?void 0:Ne.node.label}`:`Showing incoming flows to ${(Ee=K.find($=>$.node.id===i))==null?void 0:Ee.node.label}`):O.append("text").attr("x",t/2).attr("y",20).attr("text-anchor","middle").attr("font-size","14px").attr("fill","#666").text("Click a node to see its connections"),O.append("text").attr("x",y+_/2).attr("y",R-10).attr("text-anchor","middle").attr("font-size","12px").attr("font-weight","bold").attr("fill","#333").text("Outgoing"),O.append("text").attr("x",h-_/2).attr("y",R-10).attr("text-anchor","middle").attr("font-size","12px").attr("font-weight","bold").attr("fill","#333").text("Incoming"),O.on("click",function($){($.target===o.current||$.target.tagName==="svg")&&(u(null),d(null))})},[e,n,t,s,i,a]),r.jsxs("div",{className:"w-full h-full flex flex-col min-h-0",children:[r.jsxs("div",{className:"text-center text-xs text-gray-500 mb-2 flex-shrink-0",children:["Interaction design inspired by"," ",r.jsx("a",{href:"https://peoplemov.in/#f_AF",target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-800 underline",children:"peoplemov.in by Carlo Zapponi"})]}),r.jsx("div",{className:"flex-1 overflow-auto min-h-0",children:r.jsx("svg",{ref:o,className:"border border-gray-200 rounded bg-white"})})]})}function Ki(e,n){const t=e.length,s=new Map;e.forEach((u,a)=>{s.set(u.id,a)});const o=Array(t).fill(null).map(()=>Array(t).fill(0));n.forEach(u=>{const a=s.get(u.source),d=s.get(u.target);a!==void 0&&d!==void 0&&(o[a][d]+=u.value)});const i=e.map(u=>u.label||u.id);return{matrix:o,labels:i,nodes:e}}function so(e,n,t){return!t||t==="all"?e:e.filter(s=>{const o=s[n];return Array.isArray(o)?o.includes(t):o===t})}function Yi(e,n){const t=new Set;return e.forEach(s=>{const o=s[n];o!=null&&(Array.isArray(o)?o.forEach(i=>t.add(i)):t.add(o))}),Array.from(t).sort((s,o)=>typeof s=="number"&&typeof o=="number"?s-o:String(s).localeCompare(String(o)))}function Xi({nodes:e,edges:n,width:t=1e3,height:s=800}){const o=p.useRef(null);return p.useEffect(()=>{if(!o.current||n.length===0||e.length===0){o.current&&De(o.current).selectAll("*").remove();return}De(o.current).selectAll("*").remove();const i=Ki(e,n),u=De(o.current).attr("width","100%").attr("height","100%").attr("viewBox",`0 0 ${t} ${s}`).attr("preserveAspectRatio","xMidYMid meet"),a=Math.min(t,s)*.5-40,d=a-20,m=ko().scaleExtent([.1,4]).on("zoom",function(S){C.attr("transform",S.transform.toString())});u.call(m);const g=u.append("g").attr("class","reset-button").style("cursor","pointer").attr("transform",`translate(${t-120}, 10)`).on("click",function(){u.transition().duration(750).call(m.transform,Po)});g.append("rect").attr("width",110).attr("height",30).attr("rx",4).attr("fill","white").attr("stroke","#ccc").attr("stroke-width",1),g.append("text").attr("x",55).attr("y",20).attr("text-anchor","middle").attr("font-size","12px").attr("fill","#333").text("Reset View");const h=ta().padAngle(.05).sortSubgroups(Jo)(i.matrix),f=ga().radius(d),_=lo(mo),C=u.append("g").attr("class","zoom-group"),w=C.append("g").attr("transform",`translate(${t/2}, ${s/2})`),v=w.append("g").selectAll("g").data(h.groups).join("g");v.append("path").attr("fill",S=>_(String(S.index))).attr("stroke",S=>un(_(String(S.index))).darker().formatHex()).attr("d",Ca().innerRadius(d).outerRadius(a)).on("mouseover",function(S,b){De(this).attr("fill",un(_(String(b.index))).brighter(1).formatHex()),w.selectAll("path.chord").style("opacity",j=>j.source.index===b.index||j.target.index===b.index?1:.2)}).on("mouseout",function(){De(this).attr("fill",S=>_(String(S.index))),w.selectAll("path.chord").style("opacity",1)}),v.append("text").attr("dy",".35em").attr("transform",S=>`
        rotate(${(S.startAngle+S.endAngle)/2*180/Math.PI-90})
        translate(${a+10})
        ${(S.startAngle+S.endAngle)/2>Math.PI?"rotate(180)":""}
      `).attr("text-anchor",S=>(S.startAngle+S.endAngle)/2>Math.PI?"end":"start").text(S=>i.labels[S.index]).style("font-size","12px").style("font-weight","500"),w.append("g").attr("fill-opacity",.67).selectAll("path").data(h).join("path").attr("class","chord").attr("d",S=>f(S)??"").attr("fill",S=>_(String(S.source.index))).attr("stroke",S=>un(_(String(S.source.index))).darker().formatHex()).style("stroke-width","1px").on("mouseover",function(S,b){De(this).attr("fill-opacity",1).style("stroke-width","2px"),De("body").append("div").attr("class","tooltip").style("position","absolute").style("background","rgba(0, 0, 0, 0.8)").style("color","white").style("padding","8px").style("border-radius","4px").style("pointer-events","none").style("opacity",0).style("transition","opacity 0.2s").html(`${i.labels[b.source.index]} → ${i.labels[b.target.index]}: ${b.source.value.toLocaleString()}`).style("opacity",1)}).on("mousemove",function(S){De(".tooltip").style("left",`${S.pageX+10}px`).style("top",`${S.pageY-10}px`)}).on("mouseout",function(){De(this).attr("fill-opacity",.67).style("stroke-width","1px"),De(".tooltip").remove()})},[e,n,t,s]),r.jsx("div",{className:"w-full h-full",children:r.jsx("svg",{ref:o,className:"border border-gray-200 rounded bg-white"})})}const Zi=200,Qi=600,Ji=384,oo=4;function el({isCollapsed:e,onToggle:n,onResize:t,children:s,title:o="Settings",bottomContent:i}){const[u,a]=p.useState(Ji),[d,m]=p.useState(!1),g=p.useRef(null),y=p.useRef(null);return p.useEffect(()=>{if(!d)return;const h=_=>{var C;if(!e&&((C=g.current)==null?void 0:C.getBoundingClientRect())){const v=Math.max(Zi,Math.min(Qi,window.innerWidth-_.clientX));a(v),t==null||t(v)}},f=()=>{m(!1)};return document.addEventListener("mousemove",h),document.addEventListener("mouseup",f),()=>{document.removeEventListener("mousemove",h),document.removeEventListener("mouseup",f)}},[d,e,t]),r.jsxs("div",{ref:g,className:"bg-white border-l border-gray-200 flex flex-col transition-all duration-300  overflow-hidden relative",style:{minHeight:"100vh",width:e?`${oo}px`:`${u}px`},children:[e&&r.jsxs(r.Fragment,{children:[r.jsx("div",{onClick:n,className:"w-full h-full bg-gray-100 hover:bg-blue-400 cursor-pointer transition-colors",style:{width:`${oo}px`},title:"Click to expand settings"}),r.jsx("button",{onClick:n,className:"fixed bottom-4 right-4 z-50 p-3 bg-blue-600 hover:bg-blue-700 text-white rounded-full shadow-lg cursor-pointer transition-all hover:scale-110 flex items-center justify-center",style:{width:"48px",height:"48px"},title:"Open visualization settings","aria-label":"Open visualization settings",children:r.jsx(zs,{className:"w-5 h-5"})})]}),!e&&r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:s}),i&&r.jsx("div",{className:"flex-shrink-0 border-t border-gray-200 bg-white",children:i}),r.jsxs("button",{onClick:n,className:"w-full flex items-center justify-between p-2 border-t border-gray-200 flex-shrink-0 bg-gray-50 hover:bg-gray-100 transition-colors cursor-pointer","aria-label":"Collapse settings",children:[r.jsxs("div",{className:"flex items-center gap-2 flex-1",children:[r.jsx(zs,{className:"w-4 h-4 text-gray-600"}),r.jsx("span",{className:"text-sm font-medium text-gray-700",children:o})]}),r.jsx(Vo,{className:"w-4 h-4 text-gray-600 flex-shrink-0"})]}),r.jsx("div",{ref:y,onMouseDown:h=>{h.preventDefault(),m(!0)},className:"absolute top-0 left-0 w-1 h-full cursor-col-resize hover:bg-blue-400 bg-gray-300 transition-colors z-10",style:{touchAction:"none"},children:r.jsx("div",{className:"absolute top-1/2 left-0 transform -translate-y-1/2 -translate-x-0.5",children:r.jsx(Do,{className:"w-3 h-6 text-gray-500"})})})]})]})}const No=["Alabama","Alaska","Arizona","Arkansas","California","Colorado","Connecticut","Delaware","District of Columbia","Florida","Georgia","Hawaii","Idaho","Illinois","Indiana","Iowa","Kansas","Kentucky","Louisiana","Maine","Maryland","Massachusetts","Michigan","Minnesota","Mississippi","Missouri","Montana","Nebraska","Nevada","New Hampshire","New Jersey","New Mexico","New York","North Carolina","North Dakota","Ohio","Oklahoma","Oregon","Pennsylvania","Rhode Island","South Carolina","South Dakota","Tennessee","Texas","Utah","Vermont","Virginia","Washington","West Virginia","Wisconsin","Wyoming"],tl=new Set(No),nl=No.length,ao=qo.reduce((e,n)=>(e[n]=n===2020?"ACS 1-year state-to-state migration flows for 2020 were not released by the Census Bureau due to pandemic-related data quality concerns.":"State-to-state migration data is unavailable for this year in the ACS 1-year series.",e),{});function rn({title:e,subtitle:n,children:t,defaultOpen:s=!1,onReset:o}){const[i,u]=p.useState(s);return r.jsxs("div",{className:"border border-gray-200 rounded-md",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("button",{onClick:()=>u(!i),className:"flex-1 flex items-center justify-between p-3 hover:bg-gray-50 transition-colors text-left",children:[r.jsxs("div",{className:"flex-1",children:[r.jsx("div",{className:"font-semibold text-sm",children:e}),n&&r.jsx("div",{className:"text-xs text-gray-600 mt-0.5",children:n})]}),i?r.jsx(Zo,{className:"w-4 h-4 text-gray-600 flex-shrink-0"}):r.jsx(Yo,{className:"w-4 h-4 text-gray-600 flex-shrink-0"})]}),o&&r.jsx("button",{type:"button",onClick:a=>{a.stopPropagation(),o()},className:"pr-3 text-[11px] font-medium text-blue-600 hover:text-blue-800 transition-colors",children:"Reset"})]}),i&&r.jsx("div",{className:"p-3 pt-0 border-t border-gray-200",children:t})]})}const io=an(["kriskogram","table","sankey","chord"]);function Rn(e){if(!e.length)return{mean:0,median:0};const n=[...e].sort((u,a)=>u-a),t=Math.floor(n.length/2),s=n.length%2!==0?n[t]:(n[t-1]+n[t])/2;return{mean:e.reduce((u,a)=>u+a,0)/e.length,median:s}}const zt=e=>{const n=e!==void 0?pt().default(e):pt().optional();return $e(t=>{if(t==null||t==="")return e;const s=typeof t=="string"?parseFloat(t):Number(t);return Number.isNaN(s)?e:s},n)},Ht=e=>$e(n=>{if(typeof n=="boolean")return n;if(typeof n=="string"){if(n.toLowerCase()==="true")return!0;if(n.toLowerCase()==="false")return!1}return e},Bo().default(e));function sn(e,n){return $e(t=>{if(typeof t=="string"){const s=t.toLowerCase(),o=e.find(i=>i.toLowerCase()===s);if(o)return o}return n},an(e).default(n))}function rl(e){return $e(n=>typeof n=="string"&&n.trim()!==""?n:e,dn().default(e))}const Un=()=>$e(e=>e==null||e===""?null:typeof e=="string"?e:null,dn().nullable().default(null)),sl=()=>$e(e=>Array.isArray(e)?e.map(n=>n==null?null:String(n)).filter(n=>!!(n&&n.trim())):typeof e=="string"?e.trim()===""?[]:e.split(",").map(n=>n.trim()).filter(n=>n.length>0):[],Go(dn()).default([])),as=e=>$e(n=>{if(typeof n=="string"){const t=n.trim().toLowerCase();if(/^#([0-9a-f]{3}|[0-9a-f]{6})$/.test(t))return t.length===4?`#${t[1]}${t[1]}${t[2]}${t[2]}${t[3]}${t[3]}`:t}return e},dn().default(e));Ho({dataset:dn().optional(),view:$e(e=>typeof e=="string"&&io.safeParse(e).success?e:"kriskogram",io.default("kriskogram")),year:zt(void 0),minThreshold:zt(0),maxThreshold:zt(2e5),maxEdges:zt(500),edgeWeightScale:$e(e=>{if(typeof e!="string")return"linear";const n=e.toLowerCase();return["linear","sqrt","log"].includes(n)?n:"linear"},an(["linear","sqrt","log"]).default("linear")),edgeWidthMultiplier:$e(e=>{if(e==null||e==="")return 1;const n=typeof e=="string"?parseFloat(e):Number(e);return Number.isNaN(n)?1:Math.max(.1,Math.min(10,n))},pt().min(.1).max(10).default(1)),egoNodeId:$e(e=>e==null||e===""||e==="null"?null:typeof e=="string"?e:void 0,dn().nullable().optional()),egoNeighborSteps:$e(e=>{if(e==null||e==="")return 1;const n=typeof e=="string"?parseInt(e,10):Number(e);return Number.isNaN(n)||n<1?1:Math.max(1,Math.round(n))},pt().min(1).default(1)),egoStepColoring:Ht(!1),edgeType:$e(e=>e==="null"||e===""?null:typeof e=="string"?e:void 0,dn().nullable().optional()),showAllNodes:Ht(!1),temporalOverlay:Ht(!1),temporalOverlayEdgeStyle:$e(e=>{if(typeof e=="string"){const n=e.toLowerCase();if(["segmented","filled","outline"].includes(n))return n}return"filled"},an(["segmented","filled","outline"]).default("filled")),temporalOverlayNodeStyle:$e(e=>{if(typeof e=="string"){const n=e.toLowerCase();if(["filled","outline"].includes(n))return n}return"filled"},an(["filled","outline"]).default("filled")),temporalOverlayYearsPast:$e(e=>{if(e==null||e==="")return 1;const n=typeof e=="string"?parseInt(e,10):Number(e);return Number.isNaN(n)||n<0?0:Math.max(0,Math.round(n))},pt().min(0).default(1)),temporalOverlayYearsFuture:$e(e=>{if(e==null||e==="")return 1;const n=typeof e=="string"?parseInt(e,10):Number(e);return Number.isNaN(n)||n<0?0:Math.max(0,Math.round(n))},pt().min(0).default(1)),temporalOverlayColorPast:as("#fc8d59"),temporalOverlayColorMid:as("#ffffbf"),temporalOverlayColorFuture:as("#91bfdb"),temporalOverlayCurrentBlack:Ht(!0),nodeOrderMode:rl("alphabetical"),arcOpacity:$e(e=>{if(e==null||e==="")return .85;const n=typeof e=="string"?parseFloat(e):Number(e);return Number.isNaN(n)?.85:Math.max(0,Math.min(1,n))},pt().min(0).max(1).default(.85)),edgeWidthMode:sn(["fixed","weight"],"weight"),edgeColorAdvanced:Ht(!1),edgeColorHue:sn(["direction","region","division","attribute","single"],"direction"),edgeColorHueAttribute:Un(),edgeColorIntensity:sn(["constant","weight","attribute"],"weight"),edgeColorIntensityAttribute:Un(),edgeColorIntensityConst:$e(e=>{if(e==null||e==="")return .6;const n=typeof e=="string"?parseFloat(e):Number(e);return Number.isNaN(n)?.6:Math.max(0,Math.min(1,n))},pt().min(0).max(1).default(.6)),edgeColorInterGrayscale:Ht(!0),intraFilter:sn(["none","region","division","interRegion","interDivision"],"none"),baseEdgeWidth:$e(e=>{if(e==null||e==="")return 2;const n=typeof e=="string"?parseFloat(e):Number(e);return Number.isNaN(n)?2:Math.max(.5,Math.min(12,n))},pt().min(.5).max(12).default(2)),nodeColorMode:sn(["single","attribute","visible_outgoing","visible_incoming","year_outgoing","year_incoming","net_year","outgoing","incoming","self_year"],"single"),nodeColorAttribute:Un(),nodeSizeMode:sn(["fixed","attribute","visible_outgoing","visible_incoming","year_outgoing","year_incoming","net_visible","net_year","outgoing","incoming","self_year"],"fixed"),nodeSizeAttribute:Un(),nodeSizeWeightScale:$e(e=>{if(typeof e!="string")return"linear";const n=e.toLowerCase();return["linear","sqrt","log"].includes(n)?n:"linear"},an(["linear","sqrt","log"]).default("linear")),nodeSizeMultiplier:$e(e=>{if(e==null||e==="")return 1;const n=typeof e=="string"?parseFloat(e):Number(e);return Number.isNaN(n)?1:Math.max(.1,Math.min(10,n))},pt().min(.1).max(10).default(1)),interactionMode:sn(["pan","lens"],"pan"),lensRadius:$e(e=>{if(e==null||e==="")return 80;const n=typeof e=="string"?parseFloat(e):Number(e);return Number.isNaN(n)?80:Math.max(20,Math.min(300,n))},pt().min(20).max(300).default(80)),edgeSegmentLength:zt(8),edgeSegmentGap:zt(4),edgeSegmentAnimate:Ht(!1),edgeSegmentOffset:zt(15),edgeSegmentSpeed:zt(1),edgeSegmentScaleByWeight:Ht(!1),edgeSegmentCap:$e(e=>{if(typeof e=="string"){const n=e.toLowerCase();if(["round","butt"].includes(n))return n}return"round"},an(["round","butt"]).default("round")),edgeOutlineGap:$e(e=>{if(e==null||e==="")return 3;const n=typeof e=="string"?parseFloat(e):Number(e);return Number.isNaN(n)?3:Math.max(.5,n)},pt().min(.5).default(3)),nodeFilterAttribute:Un(),nodeFilterValues:sl()});function gl(){const e=Oo({from:"/explorer"}),n=To(),{leftSidebarCollapsed:t,leftSidebarWidth:s,setSidebarContent:o}=Lo(),[i,u]=p.useState(e.dataset),[a,d]=p.useState(void 0),[m,g]=p.useState(e.year),[y,h]=p.useState(!1),[f,_]=p.useState(null),[C,w]=p.useState(0),[v,S]=p.useState(e.minThreshold??0),[b,j]=p.useState(e.maxThreshold??2e5),[k,R]=p.useState(e.maxEdges??500),[U,O]=p.useState(e.edgeType??null),[H,ie]=p.useState(e.view),[K,ue]=p.useState(e.showAllNodes??!1),[E,re]=p.useState(e.egoNodeId??null),[le,be]=p.useState(e.egoNeighborSteps??1),[de,Ne]=p.useState(e.egoStepColoring??!1),[Ee,$]=p.useState(e.edgeWeightScale??"linear"),[q,Ie]=p.useState(Math.max(.1,e.edgeWidthMultiplier??1)),[ge,Ze]=p.useState(e.temporalOverlay??!1),[L,Te]=p.useState(e.temporalOverlayEdgeStyle??"filled"),[J,Be]=p.useState(e.temporalOverlayNodeStyle??"filled"),[Me,Qe]=p.useState(e.edgeSegmentLength??8),[Ae,cn]=p.useState(e.edgeSegmentGap??4),[dt,Yn]=p.useState(e.edgeSegmentAnimate??!1),[Je,Xn]=p.useState(e.edgeSegmentOffset??15),[A,T]=p.useState(Math.max(.1,e.edgeSegmentSpeed??1)),[Z,Se]=p.useState(e.edgeSegmentScaleByWeight??!1),[se,ye]=p.useState(e.edgeSegmentCap??"round"),[fe,xt]=p.useState(Math.max(.5,e.edgeOutlineGap??3)),[et,Et]=p.useState(e.temporalOverlayYearsPast??1),[je,Le]=p.useState(e.temporalOverlayYearsFuture??1),[tt,Zn]=p.useState(Mr(e.temporalOverlayColorPast,"#fc8d59")),[nt,Qn]=p.useState(Mr(e.temporalOverlayColorMid,"#ffffbf")),[rt,Jn]=p.useState(Mr(e.temporalOverlayColorFuture,"#91bfdb")),[Kt,ws]=p.useState(e.temporalOverlayCurrentBlack??!0),[_s,En]=p.useState(tt),[Cs,In]=p.useState(nt),[Ns,An]=p.useState(rt),[qe,$r]=p.useState(e.nodeFilterAttribute??null),[yt,Yt]=p.useState(e.nodeFilterValues??[]),Er=p.useRef(null),[gn,jo]=p.useState(!1),[er,Mo]=p.useState(384),[mn,js]=p.useState({width:typeof window<"u"?window.innerWidth:1200,height:typeof window<"u"?window.innerHeight:800});p.useEffect(()=>(o(r.jsx(Gt,{fallback:r.jsxs("div",{className:"p-4",children:[r.jsx("h2",{className:"text-lg font-bold text-red-800 mb-2",children:"Dataset Sidebar Error"}),r.jsx("p",{className:"text-sm text-red-700",children:"The dataset sidebar encountered an error."})]}),children:r.jsx(Wi,{selectedId:i,onSelect:l=>{u(l),D({dataset:l})},onRefresh:()=>w(l=>l+1)})})),()=>{o(null)}),[i,C]),p.useEffect(()=>{if(typeof window>"u")return;const l=()=>{js({width:window.innerWidth,height:window.innerHeight})};return l(),window.addEventListener("resize",l),()=>window.removeEventListener("resize",l)},[]),p.useEffect(()=>{typeof window<"u"&&setTimeout(()=>{js({width:window.innerWidth,height:window.innerHeight})},100)},[t,gn,s,er]);const[tr,Ms]=p.useState(e.nodeOrderMode??"alphabetical"),[Ir,Fs]=p.useState(e.arcOpacity??.85),[fn,Ar]=p.useState(e.edgeWidthMode??"weight"),[pn,Rs]=p.useState(e.edgeColorAdvanced??!1),[ke,Xt]=p.useState(e.edgeColorHue??"direction"),[Zt,nr]=p.useState(e.edgeColorHueAttribute??null),[Mt,kr]=p.useState(e.edgeColorIntensity??"weight"),[hn,rr]=p.useState(e.edgeColorIntensityAttribute??null),[sr,Pr]=p.useState(e.edgeColorIntensityConst??.6),[or,$s]=p.useState(e.edgeColorInterGrayscale??!0),[ct,Es]=p.useState(e.intraFilter??"none"),[Qt,Is]=p.useState(e.baseEdgeWidth??2),[ar,As]=p.useState(e.nodeColorMode??"single"),[Jt,Vr]=p.useState(e.nodeColorAttribute??null),[St,ks]=p.useState(e.nodeSizeMode??"fixed"),[gt,Dr]=p.useState(e.nodeSizeAttribute??null),[ir,Ps]=p.useState(e.nodeSizeWeightScale??"linear"),[xn,Vs]=p.useState(Math.max(.1,e.nodeSizeMultiplier??1)),[Or,Tr]=p.useState(e.interactionMode??"pan"),[Fo,Ro]=p.useState(e.lensRadius??80),[al,$o]=p.useState({x:0,y:0}),D=p.useMemo(()=>l=>{n({to:"/explorer",search:c=>({view:c.view??"kriskogram",...c,...l}),replace:!0})},[n]),lr=p.useMemo(()=>{var l,c;return((c=(l=a==null?void 0:a.metadata)==null?void 0:l.hasCategoricalProperties)==null?void 0:c.nodes)??[]},[a]);p.useEffect(()=>{a&&qe&&(lr.includes(qe)||($r(null),Yt([]),D({nodeFilterAttribute:null,nodeFilterValues:[]})))},[a,lr,qe,D]);const Eo=p.useMemo(()=>a&&a.timeRange.start!==a.timeRange.end,[a]);p.useMemo(()=>{var M,ee;if(!a)return 0;const l=(M=a.timeRange)==null?void 0:M.start,c=(ee=a.timeRange)==null?void 0:ee.end;return typeof l!="number"||typeof c!="number"?0:Math.max(0,c-l)},[a]);const Ft=p.useRef(!0);p.useEffect(()=>{Qa().catch(()=>{}),ol().then(l=>{const c=e.dataset||l;c&&(u(c),!e.dataset&&Ft.current&&D({dataset:c})),Ft.current=!1}).catch(l=>_(l instanceof Error?l.message:"Failed to preload datasets"))},[]),p.useEffect(()=>{if(!i){d(void 0);return}h(!0),_(null),Ut(i).then(l=>{if(d(l),l){const{start:c,end:M}=l.timeRange??{};g(ee=>{const B=X=>typeof X=="number"&&typeof c=="number"&&typeof M=="number"&&X>=c&&X<=M;return B(ee)?ee:B(e.year)?e.year:typeof c=="number"?c:ee??c??void 0})}}).catch(l=>_(l instanceof Error?l.message:"Failed to load dataset")).finally(()=>h(!1))},[i,C,e.year]);const we=p.useMemo(()=>{if(!(!a||m===void 0))return a.snapshots.find(l=>(typeof l.timestamp=="string"?parseInt(l.timestamp,10):l.timestamp)===m)},[a,m]),kn=p.useMemo(()=>{if(!we||!qe)return[];const l=new Set;return we.nodes.forEach(c=>{const M=c==null?void 0:c[qe];M!=null&&M!==""&&l.add(String(M))}),Array.from(l).sort((c,M)=>c.localeCompare(M))},[we,qe]);p.useEffect(()=>{if(!qe||!we||yt.length===0)return;const l=yt.filter(c=>kn.includes(c));l.length!==yt.length&&(Yt(l),D({nodeFilterValues:l}))},[qe,yt,kn,we,D]),p.useMemo(()=>{if(!a)return new Map;const l=new Map;return a.snapshots.forEach(c=>{const M=typeof c.timestamp=="string"?parseInt(c.timestamp,10):c.timestamp;Number.isFinite(M)&&l.set(M,c)}),l},[a]);const Fe=p.useMemo(()=>{if(!a)return null;let l=1/0,c=-1/0,M=0,ee=0;const B=[];if(a.snapshots.forEach(he=>{const _e=Array.isArray(he==null?void 0:he.edges)?he.edges:[];let Pe=0;_e.forEach(ze=>{if(ze!=null&&ze.source&&ze.source===ze.target)return;const xe=Number(ze==null?void 0:ze.value);Number.isFinite(xe)&&(Pe+=1,xe<l&&(l=xe),xe>c&&(c=xe),ee+=1,B.push(xe))}),Pe>M&&(M=Pe)}),l===1/0||c===-1/0)return{min:0,max:0,maxEdgesCount:M,mean:0,median:0};const{mean:X,median:W}=Rn(B);return{min:l,max:c,maxEdgesCount:M,mean:ee>0?X:0,median:ee>0?W:0}},[a]),Ke=p.useMemo(()=>{if(!a)return null;let l=1/0,c=-1/0,M=0;const ee=[];if(a.snapshots.forEach(W=>{const he=new Map,_e=new Map;(Array.isArray(W==null?void 0:W.edges)?W.edges:[]).forEach(xe=>{const Ge=_e.get(xe.source)||0;_e.set(xe.source,Ge+xe.value);const Ue=he.get(xe.target)||0;he.set(xe.target,Ue+xe.value)}),(Array.isArray(W==null?void 0:W.nodes)?W.nodes:[]).forEach(xe=>{const Ge=(he.get(xe.id)||0)-(_e.get(xe.id)||0);Ge<l&&(l=Ge),Ge>c&&(c=Ge);const Ue=Math.abs(Ge);Ue>M&&(M=Ue),ee.push(Ue)})}),l===1/0||c===-1/0)return{min:0,max:0,maxAbs:0,meanAbs:0,medianAbs:0};const{mean:B,median:X}=Rn(ee);return{min:l,max:c,maxAbs:M,meanAbs:B,medianAbs:X}},[a]),Re=p.useMemo(()=>{if(!a)return null;let l=0,c=0;const M=[],ee=[];a.snapshots.forEach(W=>{const he=new Map,_e=new Map;(Array.isArray(W==null?void 0:W.edges)?W.edges:[]).forEach(xe=>{const Ge=_e.get(xe.source)||0;_e.set(xe.source,Ge+xe.value);const Ue=he.get(xe.target)||0;he.set(xe.target,Ue+xe.value)}),(Array.isArray(W==null?void 0:W.nodes)?W.nodes:[]).forEach(xe=>{const Ge=he.get(xe.id)||0,Ue=_e.get(xe.id)||0;Ge>l&&(l=Ge),Ue>c&&(c=Ue),M.push(Ge),ee.push(Ue)})});const B=Rn(M),X=Rn(ee);return{maxIncoming:l,maxOutgoing:c,meanIncoming:M.length>0?B.mean:0,meanOutgoing:ee.length>0?X.mean:0,medianIncoming:M.length>0?B.median:0,medianOutgoing:ee.length>0?X.median:0}},[a]),at=p.useMemo(()=>{if(!a)return null;let l=0;const c=[];a.snapshots.forEach(ee=>{const B=Array.isArray(ee==null?void 0:ee.edges)?ee.edges:[],X=new Map;B.forEach(W=>{if(W!=null&&W.source&&W.source===W.target){const he=Number(W.value);if(!Number.isFinite(he)||he<=0)return;const _e=X.get(W.source)||0;X.set(W.source,_e+he)}}),X.forEach(W=>{W>l&&(l=W),c.push(W)})});const M=Rn(c);return{max:l,mean:c.length>0?M.mean:0,median:c.length>0?M.median:0}},[a]),Ds=p.useMemo(()=>{var ee;if(!(a!=null&&a.metadata))return new Map;const l=((ee=a.metadata.hasNumericProperties)==null?void 0:ee.nodes)??[];if(!l.length)return new Map;const c=new Map;l.forEach(B=>c.set(B,[])),a.snapshots.forEach(B=>{(Array.isArray(B==null?void 0:B.nodes)?B.nodes:[]).forEach(W=>{l.forEach(he=>{var Pe;const _e=W==null?void 0:W[he];typeof _e=="number"&&Number.isFinite(_e)&&((Pe=c.get(he))==null||Pe.push(_e))})})});const M=new Map;return c.forEach((B,X)=>{if(!B.length)return;const W=Math.min(...B),he=Math.max(...B),{mean:_e,median:Pe}=Rn(B);M.set(X,{min:W,max:he,mean:_e,median:Pe})}),M},[a]);p.useEffect(()=>{if(!Fe)return;const{min:l,max:c,maxEdgesCount:M}=Fe;if(!Number.isFinite(l)||!Number.isFinite(c))return;const ee=(_e,Pe,ze)=>ze<Pe||!Number.isFinite(_e)||_e<Pe?Pe:_e>ze?ze:_e,B=ee(v,l,c);let X=ee(b,l,c);X<B&&(X=B);const W=Math.max(1,M),he=Math.max(1,Math.min(k,W));B!==v&&S(B),X!==b&&j(X),he!==k&&R(he)},[Fe,v,b,k]);const wt=p.useMemo(()=>{if(!we||!(a!=null&&a.metadata))return null;const c=["migration_type","type","category","edge_type"].find(ee=>{var B,X;return((B=a.metadata)==null?void 0:B.edgeProperties.includes(ee))||((X=a.metadata)==null?void 0:X.hasCategoricalProperties.edges.includes(ee))});if(!c)return null;const M=Yi(we.edges,c);return{property:c,values:M.map(ee=>String(ee))}},[we,a]);p.useEffect(()=>{O(null)},[i]),p.useEffect(()=>{we&&E&&(we.nodes.some(c=>c.id===E)||(re(null),de&&Ne(!1),D({egoNodeId:null,egoStepColoring:!1})))},[we,E,de,D]);const Y=p.useMemo(()=>{if(!a||!we)return{nodes:[],edges:[],baseEdges:[],overlayEdges:[],egoStepMax:0,overlayMeta:{hasPast:!1,hasFuture:!1,maxDelta:0}};const l=typeof m=="number"?m:null,c=!!(qe&&yt.length>0),M=new Set(yt.map(N=>String(N))),ee=we.nodes,B=c?ee.filter(N=>{const z=N==null?void 0:N[qe];if(z==null)return!1;const G=String(z);return M.has(G)}):ee,X=new Set(B.map(N=>N.id));if(X.size===0)return{nodes:[],baseEdges:[],edges:[],currentEdgeCount:0,egoStepMax:0,temporalOverlay:null};const W=Math.max(0,Math.round(et)),he=Math.max(0,Math.round(je)),_e=N=>{const z=new Set,G=new Map,ae=new Map;let ve=0;if(!(H==="kriskogram"&&E))return N.forEach((Oe,lt)=>z.add(lt)),{allowedEdges:z,edgeSteps:G,nodeSteps:ae,maxStep:ve};const pe=Math.max(1,Math.round(le));let Ve=new Set([E]);ae.set(E,0);const Ct=new Set(Ve);for(let Oe=1;Oe<=pe&&Ve.size>0;Oe+=1){const lt=new Set;N.forEach((me,Mn)=>{const x=me==null?void 0:me.source,F=me==null?void 0:me.target;if(!(!x||!F)&&(Ve.has(x)||Ve.has(F))){z.add(Mn);const P=G.get(Mn);(P===void 0||Oe<P)&&G.set(Mn,Oe);const I=V=>{const Q=ae.get(V);(Q===void 0||Oe<Q)&&ae.set(V,Oe),Ct.has(V)||(Ct.add(V),lt.add(V))};I(x),I(F)}}),Ve=lt}return ae.forEach(Oe=>{Oe>ve&&(ve=Oe)}),ae.has(E)||ae.set(E,0),{allowedEdges:z,edgeSteps:G,nodeSteps:ae,maxStep:ve}},Pe=N=>{const z=typeof N=="string"?N.trim().toLowerCase():"";return/^#([0-9a-f]{3}|[0-9a-f]{6})$/.test(z)?z.length===4?`#${z[1]}${z[1]}${z[2]}${z[2]}${z[3]}${z[3]}`:z:"#000000"},ze=Pe(tt),xe=Pe(nt),Ge=Pe(rt),Ue=Kt?"#000000":xe,Vn=N=>{const z=Pe(N).slice(1),G=parseInt(z,16);return Number.isNaN(G)||z.length!==6?{r:0,g:0,b:0}:{r:G>>16&255,g:G>>8&255,b:G&255}},bn=N=>Math.max(0,Math.min(255,Math.round(N))).toString(16).padStart(2,"0"),cr=(N,z,G)=>`#${bn(N)}${bn(z)}${bn(G)}`,Sn=(N,z,G)=>{const ae=Math.max(0,Math.min(1,G)),ve=Vn(N),pe=Vn(z),Ve=ve.r+(pe.r-ve.r)*ae,Ct=ve.g+(pe.g-ve.g)*ae,Oe=ve.b+(pe.b-ve.b)*ae;return cr(Ve,Ct,Oe)},en=N=>{if(N===0)return Ue;if(N<0){if(W===0)return xe;const ae=1-Math.max(0,Math.min(1,Math.abs(N)/Math.max(W,1)));return Sn(ze,xe,ae)}if(he===0)return xe;const z=Math.max(0,Math.min(1,N/Math.max(he,1)));return Sn(xe,Ge,z)},Dn=new Map,On=new Map,wn=new Map;we.edges.forEach(N=>{if(!X.has(N.source)||!X.has(N.target))return;const z=On.get(N.source)||0;On.set(N.source,z+N.value);const G=Dn.get(N.target)||0;if(Dn.set(N.target,G+N.value),N.source===N.target){const ae=wn.get(N.source)||0;wn.set(N.source,ae+N.value)}});const gr=(N,z)=>{if(ct==="none")return N;const G=new Map(z.map(ae=>[ae.id,ae]));return N.filter(ae=>{const ve=G.get(ae.source),pe=G.get(ae.target);return!ve||!pe?!1:ct==="region"?ve.region&&pe.region&&ve.region===pe.region:ct==="division"?ve.division&&pe.division&&ve.division===pe.division:ct==="interRegion"?ve.region&&pe.region&&ve.region!==pe.region:ct==="interDivision"?ve.division&&pe.division&&ve.division!==pe.division:!0})};let it=so(we.edges,(wt==null?void 0:wt.property)||"",U);it=it.filter(N=>X.has(N.source)&&X.has(N.target)),it=gr(it,B),it=it.filter(N=>(N==null?void 0:N.source)!==(N==null?void 0:N.target));const kt=it.filter(N=>N.value>=v&&N.value<=b).sort((N,z)=>z.value-N.value).slice(0,k),Tn=kt.map((N,z)=>({edge:N,idx:z})),{allowedEdges:mr,edgeSteps:tn,maxStep:_n}=_e(kt);let _t=Tn;mr.size!==Tn.length&&(_t=Tn.filter(({idx:N})=>mr.has(N)));let Ce=_n;const fr=L,pr=L==="segmented"?`${Math.max(1,Me)} ${Math.max(.5,Ae)}`:null,hr=L==="segmented"?Math.max(0,Je):0,xr=L==="segmented"?se:"round",Pt=_t.map(({edge:N,idx:z})=>{const G=tn.get(z),ae={...N,__isOverlay:!1,__displayYear:l,__temporalDelta:0,_overlayType:void 0,_overlayYear:l,__overlayStyle:fr,__overlayDash:pr,__overlayDashOffset:hr,__overlayLineCap:xr,__segmentInitialGap:L==="segmented"?Math.max(0,Je):0,__segmentSpeed:Math.max(.1,A),__segmentScaleByWeight:L==="segmented"&&Z,__segmentCycle:L==="segmented"?Math.max(1,Me+Ae):0,__segmentAnimate:L==="segmented"&&dt,__outlineGap:fe};return G!==void 0&&(ae._egoStep=G),ae}),ft=new Set;Pt.forEach(N=>{ft.add(N.source),ft.add(N.target)}),E&&ft.add(E);const Ln=new Map,zn=new Map;Pt.forEach(N=>{const z=zn.get(N.source)||0;zn.set(N.source,z+N.value);const G=Ln.get(N.target)||0;Ln.set(N.target,G+N.value)});const st=[],Vt=new Map,Dt=new Map;let Rt=0,yr=!1,Hn=!1;const Gn=new Map;if(a&&a.snapshots.forEach(N=>{const z=typeof N.timestamp=="string"?parseInt(N.timestamp,10):N.timestamp;Number.isFinite(z)&&Gn.set(z,N)}),ge&&a&&typeof m=="number"&&a.timeRange.start!==a.timeRange.end){const N=z=>{if(z===0||z<0&&W===0||z>0&&he===0)return;const G=m+z,ae=Gn.get(G);if(!ae)return;const ve=Array.isArray(ae.edges)?ae.edges:[];let pe=null;if(c&&(pe=new Set(ae.nodes.filter(I=>{const V=I==null?void 0:I[qe];return V==null?!1:M.has(String(V))}).map(I=>I.id)),pe.size===0))return;let Ve=so(ve,(wt==null?void 0:wt.property)||"",U);if(ct!=="none"){const I=new Map(ae.nodes.map(V=>[V.id,V]));ct==="region"?Ve=Ve.filter(V=>{const Q=I.get(V.source),oe=I.get(V.target);return Q&&oe&&Q.region&&oe.region&&Q.region===oe.region}):ct==="division"?Ve=Ve.filter(V=>{const Q=I.get(V.source),oe=I.get(V.target);return Q&&oe&&Q.division&&oe.division&&Q.division===oe.division}):ct==="interRegion"?Ve=Ve.filter(V=>{const Q=I.get(V.source),oe=I.get(V.target);return Q&&oe&&Q.region&&oe.region&&Q.region!==oe.region}):ct==="interDivision"&&(Ve=Ve.filter(V=>{const Q=I.get(V.source),oe=I.get(V.target);return Q&&oe&&Q.division&&oe.division&&Q.division!==oe.division}))}pe&&(Ve=Ve.filter(I=>pe.has(I.source)&&pe.has(I.target)));const Ct=L==="segmented"?`${Math.max(1,Me)} ${Math.max(.5,Ae)}`:null,Oe=L==="segmented"?Math.max(0,Je):0,lt=L==="segmented"?se:"round",me=Ve.filter(I=>I.value>=v&&I.value<=b).sort((I,V)=>V.value-I.value).slice(0,k),{allowedEdges:Mn,edgeSteps:x,maxStep:F}=_e(me);F>Ce&&(Ce=F),me.map((I,V)=>({...I,_overlayType:z<0?"past":"future",_overlayYear:G,__isOverlay:!0,__displayYear:G,__temporalDelta:z,__overlayStyle:L,__overlayDash:Ct,__overlayDashOffset:Oe,__overlayLineCap:lt,__segmentInitialGap:L==="segmented"?Math.max(0,Je):0,__segmentCycle:L==="segmented"?Math.max(1,Me+Ae):0,__segmentAnimate:L==="segmented"&&dt,__segmentSpeed:Math.max(.1,A),__segmentScaleByWeight:L==="segmented"&&Z,__outlineGap:fe,_egoStep:(()=>{const Q=x.get(V);if(Q!==void 0)return Math.max(1,Q)})()})).filter((I,V)=>Mn.has(V)).forEach(I=>{if(st.push(I),I._overlayType==="past"){yr=!0;const V=Vt.get(I.source)||0;Vt.set(I.source,V+I.value);const Q=Vt.get(I.target)||0;Vt.set(I.target,Q+I.value)}else{Hn=!0;const V=Dt.get(I.source)||0;Dt.set(I.source,V+I.value);const Q=Dt.get(I.target)||0;Dt.set(I.target,Q+I.value)}})};for(let z=-W;z<0;z+=1)N(z);for(let z=1;z<=he;z+=1)N(z)}st.length>0&&st.forEach(N=>{ft.add(N.source),ft.add(N.target)});const Nn=(H==="kriskogram"&&K?B:B.filter(N=>ft.has(N.id))).map(N=>{const z=Ln.get(N.id)||0,G=zn.get(N.id)||0,ae=Dn.get(N.id)||0,ve=On.get(N.id)||0,pe=z-G,Ve=ae-ve,Ct=wn.get(N.id)||0,Oe=Vt.get(N.id)||0,lt=Dt.get(N.id)||0,me=lt-Oe;return Math.abs(me)>Rt&&(Rt=Math.abs(me)),{...N,_totalIncoming:z,_totalOutgoing:G,total_incoming_visible:z,total_outgoing_visible:G,total_incoming_year:ae,total_outgoing_year:ve,net_flow_visible:pe,net_flow_year:Ve,self_flow_year:Ct,temporal_overlay_past_total:Oe,temporal_overlay_future_total:lt,temporal_overlay_delta:me,_overlayPastTotal:Oe,_overlayFutureTotal:lt,_overlayDelta:me}});ge?Nn.forEach(N=>{const z=N._overlayDelta??N.temporal_overlay_delta??0,G=Rt>0?Math.max(0,Math.min(1,Math.abs(z)/Rt)):0;N._overlayStrokeWidth=z===0?2:1.5+G*3,N._overlayStrokeColor=en(z)}):Nn.forEach(N=>{N._overlayStrokeWidth=2,N._overlayStrokeColor="#fff"});const jn=ge?{hasPast:yr,hasFuture:Hn,nodeDeltaAbsMax:Rt,style:L,edgeSegmentLength:Me,edgeSegmentGap:Ae,edgeSegmentOffset:Je,edgeSegmentSpeed:A,edgeSegmentScaleByWeight:Z,edgeSegmentCap:se,edgeSegmentAnimate:dt,edgeOutlineGap:fe,yearsPast:W,yearsFuture:he,colorCurrent:Ue,colorPast:ze,colorMid:xe,colorFuture:Ge,useBlackForCurrent:Kt,legendEntries:(()=>{const N=[],z=G=>{if(typeof m=="number"){const ve=m+G;if(G===0)return`${ve} (current)`;const pe=Math.abs(G)===1?"year":"years";return G<0?`${ve} (${Math.abs(G)} ${pe} past)`:`${ve} (${G} ${pe} future)`}if(G===0)return"Current year";const ae=Math.abs(G)===1?"year":"years";return G<0?`${Math.abs(G)} ${ae} past`:`${G} ${ae} future`};N.push({label:z(0),color:Ue,delta:0});for(let G=-W;G<0;G+=1)N.push({label:z(G),color:en(G),delta:G});for(let G=1;G<=he;G+=1)N.push({label:z(G),color:en(G),delta:G});return N})()}:null,Ur=ge&&st.length>0?[...Pt,...st]:Pt;return{nodes:Nn,baseEdges:Pt,edges:Ur,currentEdgeCount:Pt.length,egoStepMax:Ce,temporalOverlay:jn}},[we,v,b,k,U,wt,ct,K,H,E,le,Ee,ge,L,J,et,je,tt,nt,rt,Kt,Me,Ae,Je,A,Z,se,dt,fe,qe,yt,a]),mt=p.useMemo(()=>{if(!we)return null;const l=we.edges.length,c=we.nodes.length,M=we.edges.reduce((X,W)=>X+W.value,0),ee=l>0?M/l:0,B=l>0?Math.max(...we.edges.map(X=>X.value)):0;return{totalNodes:c,totalEdges:l,visibleNodes:Y.nodes.length,visibleEdges:Y.currentEdgeCount??Y.edges.filter(X=>!X._overlayType).length,avgValue:ee,maxValue:B}},[we,Y]),vt=(Fe==null?void 0:Fe.min)??0,Pn=(Fe==null?void 0:Fe.max)??(mt==null?void 0:mt.maxValue)??vt,yn=Math.max(vt,Pn),Io=Math.max(yn,1),Os=Math.max(1,Math.floor(Io/1e3)),Lr=(Fe==null?void 0:Fe.maxEdgesCount)??(mt==null?void 0:mt.totalEdges)??0,zr=Math.max(500,Lr),Hr=p.useMemo(()=>{if(!Y||Y.currentEdgeCount===0)return;const l=Y.edges.filter(c=>!c._overlayType);if(l.length!==0)return Math.min(...l.map(c=>c.value))},[Y]),It=p.useMemo(()=>Y.nodes.some(l=>l&&l.region),[Y]),At=p.useMemo(()=>Y.nodes.some(l=>l&&l.division),[Y]);p.useEffect(()=>{!It&&ke==="region"&&Xt("direction"),!At&&ke==="division"&&Xt("direction")},[It,At,ke]);const Gr=p.useMemo(()=>{if(!Y||Y.currentEdgeCount===0)return;const l=Y.edges.filter(c=>!c._overlayType);if(l.length!==0)return Math.max(...l.map(c=>c.value))},[Y]);p.useEffect(()=>{H==="kriskogram"&&Y.nodes.length>0&&Er.current&&Er.current.updateData(Y.nodes,Y.edges)},[Y,H]);const Ao=l=>{g(l),Ft.current||D({year:l})};p.useEffect(()=>{Ft.current||D({minThreshold:v,maxThreshold:b,maxEdges:k})},[v,b,k]),p.useEffect(()=>{Ft.current||D({view:H})},[H]),p.useEffect(()=>{Ft.current||D({edgeType:U})},[U]),p.useEffect(()=>{!Ft.current&&i&&D({dataset:i})},[i]),p.useEffect(()=>{Ft.current},[]),p.useEffect(()=>{we&&E&&(we.nodes.some(c=>c.id===E)||(re(null),de&&Ne(!1),D({egoNodeId:null,egoStepColoring:!1})))},[we,E,de,D]),p.useEffect(()=>{if(!a)return;const l=a.timeRange&&typeof a.timeRange.start=="number"&&typeof a.timeRange.end=="number"&&a.timeRange.start!==a.timeRange.end;(!l||!(typeof m=="number"&&l))&&ge&&(Ze(!1),D({temporalOverlay:!1,temporalOverlayEdgeStyle:L,temporalOverlayNodeStyle:J,temporalOverlayCurrentBlack:Kt,temporalOverlayYearsPast:et,temporalOverlayYearsFuture:je,temporalOverlayColorPast:tt,temporalOverlayColorMid:nt,temporalOverlayColorFuture:rt,edgeSegmentLength:Me,edgeSegmentGap:Ae,edgeSegmentOffset:Je,edgeSegmentCap:se,edgeSegmentAnimate:dt,edgeOutlineGap:fe}))},[a,m,ge,L,J,et,je,tt,nt,rt,Me,Ae,Je,se,dt,fe,D]),p.useEffect(()=>{Ft.current||D({temporalOverlay:ge,temporalOverlayYearsPast:et,temporalOverlayYearsFuture:je,temporalOverlayColorPast:tt,temporalOverlayColorMid:nt,temporalOverlayColorFuture:rt,temporalOverlayEdgeStyle:L,temporalOverlayNodeStyle:J,edgeSegmentLength:Me,edgeSegmentGap:Ae,edgeSegmentOffset:Je,edgeSegmentCap:se,edgeSegmentAnimate:dt,edgeOutlineGap:fe})},[ge,et,je,tt,nt,rt,L,J,Me,Ae,Je,se,dt,fe,D]),p.useEffect(()=>{En(tt)},[tt]),p.useEffect(()=>{In(nt)},[nt]),p.useEffect(()=>{An(rt)},[rt]);const ur=(l,c,M,ee,B)=>{const X=Mr(l,c);M(X),ee(X),D({[B]:X})},vn=(l,c,M,ee,B)=>{const X=l.trim();if(!/^#([0-9a-fA-F]{3}|[0-9a-fA-F]{6})$/.test(X)){ee(c);return}ur(X,c,M,ee,B)},[dr,Ts]=p.useState("picker"),Br=p.useMemo(()=>{const l={nodeOrder:x=>x.label||x.id,nodeColor:()=>"#2563eb",nodeRadius:()=>6,edgeWidth:()=>Qt,edgeColor:()=>"#1f77b4",nodeStroke:()=>({color:"#fff",width:2})};if(Y.nodes.length===0||Y.baseEdges.length===0)return{accessors:l,legendItems:[]};const c=Y.baseEdges.map(x=>x.value),M=c.length>0?Math.min(...c):0,ee=c.length>0?Math.max(...c):1,B=(Fe==null?void 0:Fe.min)??M,X=(Fe==null?void 0:Fe.max)??ee,W=Math.max(X-B,0),he=x=>{if(!Number.isFinite(x)||W<=0)return 0;const P=Math.min(Math.max(x,B),X)-B;switch(Ee){case"sqrt":{const I=Math.sqrt(W);return I<=0?0:Math.max(0,Math.min(1,Math.sqrt(P)/I))}case"log":{const I=Math.log10(W+1);return!Number.isFinite(I)||I<=0?0:Math.max(0,Math.min(1,Math.log10(P+1)/I))}case"linear":default:return W<=0?0:Math.max(0,Math.min(1,P/W))}},_e=x=>{if(W<=0)return B;const F=Math.max(0,Math.min(1,x));switch(Ee){case"sqrt":return B+Math.pow(F,2)*W;case"log":{const P=Math.log10(W+1);if(!Number.isFinite(P)||P<=0)return B;const I=Math.pow(10,F*P)-1;return B+I}case"linear":default:return B+F*W}},Pe=(Fe==null?void 0:Fe.mean)??(B+X)/2,ze=(Fe==null?void 0:Fe.median)??_e(.5),xe=Y.nodes.map(x=>x.total_outgoing_visible||x._totalOutgoing||0),Ge=Y.nodes.map(x=>x.total_incoming_visible||x._totalIncoming||0),Ue=Y.nodes.map(x=>x.total_outgoing_year||0),Vn=Y.nodes.map(x=>x.total_incoming_year||0),bn=Y.nodes.map(x=>x.net_flow_visible||0),cr=Y.nodes.map(x=>x.net_flow_year||0),Sn=xe.length>0?Math.max(...xe):1,en=Ge.length>0?Math.max(...Ge):1,Dn=Ue.length>0?Math.max(...Ue):1,On=Vn.length>0?Math.max(...Vn):1,wn=bn.length>0?Math.max(...bn.map(x=>Math.abs(x))):1,gr=cr.length>0?Math.max(...cr.map(x=>Math.abs(x))):1,it=(Re==null?void 0:Re.maxOutgoing)??Dn,kt=(Re==null?void 0:Re.maxIncoming)??On,Tn=(Ke==null?void 0:Ke.min)??-gr,mr=(Ke==null?void 0:Ke.max)??gr,tn=Math.max(Math.abs(Tn),Math.abs(mr))||1,_n=(at==null?void 0:at.max)??0,_t=["#3b82f6","#f59e0b","#ef4444","#10b981","#8b5cf6","#ec4899","#14b8a6","#f97316"],Ce=Y.temporalOverlay,fr=!!Ce,pr=(Ce==null?void 0:Ce.nodeDeltaAbsMax)??0,hr=Math.max(0,(Ce==null?void 0:Ce.yearsPast)??0),xr=Math.max(0,(Ce==null?void 0:Ce.yearsFuture)??0),Pt=(Ce==null?void 0:Ce.colorPast)??tt,ft=(Ce==null?void 0:Ce.colorMid)??nt,Ln=(Ce==null?void 0:Ce.colorFuture)??rt,zn=(Ce==null?void 0:Ce.colorCurrent)??(Kt?"#000000":ft),st=x=>{const F=typeof x=="string"?x.trim().toLowerCase():"";return/^#([0-9a-f]{3}|[0-9a-f]{6})$/.test(F)?F.length===4?`#${F[1]}${F[1]}${F[2]}${F[2]}${F[3]}${F[3]}`:F:"#000000"},Vt=st(zn),Dt=x=>{const F=st(x).slice(1),P=parseInt(F,16);return Number.isNaN(P)||F.length!==6?{r:0,g:0,b:0}:{r:P>>16&255,g:P>>8&255,b:P&255}},Rt=x=>Math.max(0,Math.min(255,Math.round(x))).toString(16).padStart(2,"0"),yr=(x,F,P)=>`#${Rt(x)}${Rt(F)}${Rt(P)}`,Hn=(x,F,P)=>{const I=Math.max(0,Math.min(1,P)),V=Dt(x),Q=Dt(F),oe=V.r+(Q.r-V.r)*I,We=V.g+(Q.g-V.g)*I,ce=V.b+(Q.b-V.b)*I;return yr(oe,We,ce)},Gn=x=>{if(x===0)return Vt;if(x<0){if(hr===0)return st(ft);const I=1-Math.max(0,Math.min(1,Math.abs(x)/Math.max(hr,1)));return Hn(st(Pt),st(ft),I)}if(xr===0)return st(ft);const F=Math.max(0,Math.min(1,x/Math.max(xr,1)));return Hn(st(ft),st(Ln),F)},vr=!!(E&&de&&(Y.egoStepMax??0)>0),Cn=Y.egoStepMax??0,Nn=x=>{if(Cn<=1)return"hsl(210, 80%, 55%)";const F=Math.max(1,Math.min(x,Cn)),P=Cn<=1?0:(F-1)/(Cn-1),I=210-P*150,V=60-P*20;return`hsl(${Math.round(I)}, 80%, ${Math.round(V)}%)`},jn=(x,F)=>{const P=Array.from(new Set(Y.nodes.map(V=>V[x]).filter(V=>V!=null))),I=new Map;return P.forEach((V,Q)=>{I.set(V,_t[Q%_t.length])}),I.get(F)||_t[0]},Ur=x=>{const F=Math.max(0,Math.min(1,x));switch(ir){case"sqrt":return Math.sqrt(F);case"log":{if(F<=0)return 0;const P=Math.log10(F*9+1),I=Math.log10(10);return I>0?Math.min(1,P/I):F}case"linear":default:return F}},N=x=>{const P=3+Math.max(0,Math.min(1,Ur(x)))*9;return Math.max(1,P*xn)},z=x=>{switch(St){case"fixed":return Math.max(1,6*xn);case"visible_outgoing":case"outgoing":return N(Sn>0?(x.total_outgoing_visible||x._totalOutgoing||0)/Sn:0);case"visible_incoming":case"incoming":return N(en>0?(x.total_incoming_visible||x._totalIncoming||0)/en:0);case"year_outgoing":return N(it>0?(x.total_outgoing_year||0)/it:0);case"year_incoming":return N(kt>0?(x.total_incoming_year||0)/kt:0);case"net_visible":{const F=Math.abs(x.net_flow_visible||0),P=wn>0?wn:1;return N(F/P)}case"net_year":{const F=Math.abs(x.net_flow_year||0),P=tn>0?tn:1;return N(F/P)}case"self_year":{const F=_n>0?(x.self_flow_year||0)/_n:0;return N(F)}case"attribute":{if(!gt||typeof x[gt]!="number")return 6;const F=Y.nodes.map(oe=>oe[gt]).filter(oe=>typeof oe=="number");if(F.length===0)return 6;const P=Math.min(...F),V=Math.max(...F)-P||1,Q=(x[gt]-P)/V;return N(Q)}default:return 6}},G=L,ae=(x,F)=>{if(F==="outline")return Math.max(2.5,Qt);if(fn==="weight"){const P=he(x),I=F==="segmented"?.5+P*12:.5+P*15;return Math.max(.25,I*q)}return F==="segmented"?Math.max(Qt,2):Qt},ve={nodeOrder:x=>{if(tr==="alphabetical")return x.label||x.id;const F=x[tr];return F==null?`ZZZ_${x.label||x.id}`:typeof F=="number"?`${String(1e6-F).padStart(10,"0")}_${x.label||x.id}`:`${String(F)}_${x.label||x.id}`},nodeColor:x=>{var Q;const F=(oe,We)=>!Number.isFinite(oe)||We<=0?0:Math.max(0,Math.min(1,oe/We)),P=(oe,We,ce)=>{const Nt=85-Math.max(0,Math.min(1,ce))*45;return`hsl(${oe}, ${We}%, ${Nt}%)`},I=oe=>{if(!Number.isFinite(oe)||tn<=0)return"#6b7280";if(Math.abs(oe)<1e-6)return"#9ca3af";const ce=85-Math.max(0,Math.min(1,Math.abs(oe)/tn))*45;return oe>=0?`hsl(0, 75%, ${ce}%)`:`hsl(210, 75%, ${ce}%)`};let V="#2563eb";switch(ar){case"single":V="#2563eb";break;case"outgoing":case"visible_outgoing":V=P(24,85,F(x.total_outgoing_visible||x._totalOutgoing||0,Sn));break;case"incoming":case"visible_incoming":V=P(160,70,F(x.total_incoming_visible||x._totalIncoming||0,en));break;case"year_outgoing":V=P(24,85,F(x.total_outgoing_year||0,it));break;case"year_incoming":V=P(160,70,F(x.total_incoming_year||0,kt));break;case"net_year":V=I(x.net_flow_year||0);break;case"self_year":{const oe=_n>0?(x.self_flow_year||0)/_n:0;V=P(280,70,oe);break}case"attribute":{if(!Jt){V="#2563eb";break}const oe=x[Jt];if(oe==null){V="#9ca3af";break}if((Q=a==null?void 0:a.metadata)!=null&&Q.hasNumericProperties.nodes.includes(Jt)){const We=Y.nodes.map(Tt=>Tt[Jt]).filter(Tt=>typeof Tt=="number");if(We.length===0){V="#2563eb";break}const ce=Math.min(...We),Nt=Math.max(...We)-ce||1,Ot=(Number(oe)-ce)/Nt;V=`hsl(${120-Math.max(0,Math.min(1,Ot))*120}, 70%, 50%)`;break}V=jn(Jt,oe);break}default:V="#2563eb";break}return x.__baseFillColor=V,V},nodeRadius:z,edgeWidth:x=>{const F=x.__overlayStyle??G;return ae(x.value,F)},edgeColor:(x,F)=>{var oe,We;const P=x==null?void 0:x.__temporalDelta;if(fr)return typeof P=="number"?Gn(P):Vt;if(vr){const ce=(x==null?void 0:x._egoStep)??0;if(ce>0)return Nn(ce)}if(!pn){if(ke==="direction")return F?"#1f77b4":"#d62728";if(ke==="single"){if(Mt==="weight"){const He=80-he(x.value)*55;return`hsl(210, 70%, ${Math.round(He)}%)`}return"#2563eb"}}let I="#2563eb";if(ke==="direction")I=F?"#1f77b4":"#d62728";else if(ke==="region"){const ce=Y.nodes.find(He=>He.id===x.source);I=ce!=null&&ce.region?jn("region",ce.region):"#2563eb"}else if(ke==="division"){const ce=Y.nodes.find(He=>He.id===x.source);I=ce!=null&&ce.division?jn("division",ce.division):"#2563eb"}else if(ke==="attribute"&&Zt){const ce=x[Zt];if(ce!=null)if((oe=a==null?void 0:a.metadata)!=null&&oe.hasNumericProperties.edges.includes(Zt)){const He=Y.baseEdges.map(Wr=>Wr[Zt]).filter(Wr=>typeof Wr=="number"),Nt=Math.min(...He),br=Math.max(...He)-Nt||1;I=`hsl(${120-(Number(ce)-Nt)/br*120}, 70%, 50%)`}else I=jn(Zt,ce)}let V=.6;if(Mt==="weight")V=Math.max(0,Math.min(1,he(x.value)));else if(Mt==="attribute"&&hn){const ce=x[hn];if(ce!=null&&((We=a==null?void 0:a.metadata)!=null&&We.hasNumericProperties.edges.includes(hn))){const He=Y.baseEdges.map(Tt=>Tt[hn]).filter(Tt=>typeof Tt=="number"),Nt=Math.min(...He),br=Math.max(...He)-Nt||1;V=Math.max(0,Math.min(1,(Number(ce)-Nt)/br))}}else Mt==="constant"&&(V=Math.max(0,Math.min(1,sr)));if(or&&(ke==="region"||ke==="division")){const ce=Y.nodes.find(Ot=>Ot.id===x.source),He=Y.nodes.find(Ot=>Ot.id===x.target);if(!(ke==="region"?(ce==null?void 0:ce.region)&&ce.region===(He==null?void 0:He.region):(ce==null?void 0:ce.division)&&ce.division===(He==null?void 0:He.division)))return`hsl(0, 0%, ${80-V*50}%)`}const Q=80-V*55;return ke==="direction"?`hsl(${F?0:200}, 70%, ${Math.round(Q)}%)`:ke==="single"?`hsl(210, 70%, ${Math.round(Q)}%)`:I},nodeStroke:x=>{const F=x.temporal_overlay_delta??0,P=x.__baseFillColor??"#2563eb";if(!fr||pr<=0)return{color:J==="outline"?P:"#fff",width:J==="outline"?2.5:2};const I=Math.min(1,Math.abs(F)/Math.max(pr,1));if(J==="outline"){const Q=2.5+(F===0?0:I*1.5);return{color:P,width:Q}}const V=2+(F===0?0:I*2);return{color:Gn(F),width:V}}},pe=[],Ve=Ce&&Array.isArray(Ce.legendEntries)?Ce.legendEntries.slice().sort((x,F)=>(x.delta??0)-(F.delta??0)):[];if(Ve.length>0&&pe.push({type:"temporalOverlay",title:"Edge color (temporal)",entries:Ve}),!vr&&ke==="direction"&&pe.push({type:"direction",title:"Edge color (direction)",labels:{above:"Above baseline (clockwise)",below:"Below baseline (counter)"},colors:{above:"#d62728",below:"#1f77b4"}}),vr){const x=Array.from({length:Cn},(F,P)=>{const I=P+1;return{step:I,color:Nn(I)}});pe.push({type:"egoSteps",entries:x})}else if(pn){if(ke==="region"&&It){const F=Array.from(new Set(Y.nodes.map(P=>P.region).filter(Boolean))).slice(0,10).map((P,I)=>({label:P,color:_t[I%_t.length]}));pe.push({type:"categorical",title:"Edge color (region)",entries:F,interNote:or?"Inter edges: grayscale by intensity":void 0})}else if(ke==="division"&&At){const F=Array.from(new Set(Y.nodes.map(P=>P.division).filter(Boolean))).slice(0,10).map((P,I)=>({label:P,color:_t[I%_t.length]}));pe.push({type:"categorical",title:"Edge color (division)",entries:F,interNote:or?"Inter edges: grayscale by intensity":void 0})}}else if(ke!=="direction"){if(ke==="single"&&Mt==="weight"){const F=[0,.5,1].map(P=>{const I=_e(P),Q=80-he(I)*55;return{value:I,color:`hsl(210, 70%, ${Math.round(Q)}%)`,width:ae(I,G),fraction:P}});pe.push({type:"weight",color:"#1f77b4",scale:Ee,min:B,max:X,samples:F})}}if(Y.baseEdges.length>0){const x=new Set;if(fn==="weight"){const F=[],P=(I,V,Q)=>{if(!Number.isFinite(V))return;const oe=ae(V,G),We=`${I}:${Math.round(V)}`;x.has(We)||(x.add(We),F.push({label:I,value:V,width:oe,fraction:Q}))};P("Minimum",B,0),Number.isFinite(Pe)&&P("Mean",Pe),Number.isFinite(ze)?P("Median",ze):P("Median",_e(.5),.5),P("Maximum",X,1),pe.push({type:"edgeWidth",mode:"weight",scale:Ee,multiplier:q,min:B,max:X,samples:F})}else{const F=ae(X,G);pe.push({type:"edgeWidth",mode:"fixed",baseWidth:F,samples:[{label:"Fixed",value:X,width:F}]})}}const Ct=()=>{switch(St){case"fixed":return"Fixed radius";case"visible_outgoing":case"outgoing":return"Visible outgoing flow";case"visible_incoming":case"incoming":return"Visible incoming flow";case"year_outgoing":return"Year outgoing flow";case"year_incoming":return"Year incoming flow";case"net_visible":return"Visible net flow";case"net_year":return"Year net flow";case"self_year":return"Self flow (year)";case"attribute":return gt?`Attribute: ${gt}`:"Attribute value";default:return String(St).replace(/_/g," ")}},Oe=[],lt=new Set,me=(x,F,P)=>{if(!Number.isFinite(F)||!Number.isFinite(P)||P<=0)return;const I=Math.max(0,Math.min(1,F/P)),V=`${x}:${Math.round(F)}`;lt.has(V)||(lt.add(V),Oe.push({label:x,radius:N(I),value:F}))};return(()=>{switch(St){case"fixed":{const x=Math.max(1,6*xn);Oe.push({label:"Fixed radius",radius:x,value:x});return}case"visible_outgoing":case"outgoing":case"year_outgoing":{const x=(Re==null?void 0:Re.maxOutgoing)??it??0,F=(Re==null?void 0:Re.meanOutgoing)??x/2,P=(Re==null?void 0:Re.medianOutgoing)??x/2;me("Minimum",0,x||1),me("Mean",F,x||1),me("Median",P,x||1),me("Maximum",x,x||1);return}case"visible_incoming":case"incoming":case"year_incoming":{const x=(Re==null?void 0:Re.maxIncoming)??kt??0,F=(Re==null?void 0:Re.meanIncoming)??x/2,P=(Re==null?void 0:Re.medianIncoming)??x/2;me("Minimum",0,x||1),me("Mean",F,x||1),me("Median",P,x||1),me("Maximum",x,x||1);return}case"net_visible":case"net_year":{const x=(Ke==null?void 0:Ke.maxAbs)??tn??0,F=(Ke==null?void 0:Ke.meanAbs)??x/2,P=(Ke==null?void 0:Ke.medianAbs)??x/2;me("Minimum",0,x||1),me("Mean",F,x||1),me("Median",P,x||1),me("Maximum",x,x||1);return}case"self_year":{const x=(at==null?void 0:at.max)??0,F=(at==null?void 0:at.mean)??x/2,P=(at==null?void 0:at.median)??x/2;me("Minimum",0,x||1),me("Mean",F,x||1),me("Median",P,x||1),me("Maximum",x,x||1);return}case"attribute":{if(!gt)return;const x=Ds.get(gt);if(!x)return;const{min:F,max:P,mean:I,median:V}=x,Q=P||1;me("Minimum",F,Q),me("Mean",I,Q),me("Median",V,Q),me("Maximum",P,Q);return}default:{const x=Math.max(it,kt,1);me("Minimum",0,x),me("Mean",x/2,x),me("Median",x/2,x),me("Maximum",x,x)}}})(),pe.push({type:"nodeSize",mode:Ct(),scale:St==="fixed"?void 0:ir,multiplier:St==="fixed"?void 0:xn,note:St==="attribute"&&gt?`Using numeric attribute "${gt}"`:void 0,entries:Oe}),{accessors:ve,legendItems:pe}},[Y,Qt,a,Fe,Re,Ke,at,pn,ke,Zt,or,Mt,hn,sr,fn,q,Ee,E,de,At,It,Jt,ar,tr,gt,St,xn,ir,Ds,rt,nt,tt,Kt,L,ge,J,et,je]);return r.jsx(Gt,{fallback:r.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center",children:r.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-8 max-w-lg mx-4",children:[r.jsx("h2",{className:"text-2xl font-bold text-red-800 mb-4",children:"Explorer Error"}),r.jsx("p",{className:"text-gray-700 mb-4",children:"The explorer page encountered an error. Please refresh the page."}),r.jsx("button",{onClick:()=>window.location.reload(),className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 cursor-pointer transition-colors",children:"Reload Page"})]})}),children:r.jsxs("div",{className:"flex flex-1 h-full overflow-hidden",children:[r.jsxs("main",{className:"flex-1 flex flex-col overflow-hidden h-full relative",children:[y&&r.jsx("div",{className:"p-4 bg-yellow-50 text-yellow-800",children:"Loading…"}),f&&r.jsx("div",{className:"p-4 bg-red-50 text-red-600",children:f}),a?r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"flex-1 flex flex-col overflow-hidden bg-white",children:r.jsx("div",{className:`flex-1 overflow-hidden ${H==="table"?"":"p-4"}`,children:Y.nodes.length>0&&Y.baseEdges.length>0?r.jsxs(r.Fragment,{children:[H==="kriskogram"&&r.jsx(Gt,{fallback:r.jsxs("div",{className:"p-4 bg-red-50 border border-red-200 rounded-md",children:[r.jsx("h3",{className:"text-lg font-semibold text-red-800 mb-2",children:"Kriskogram Error"}),r.jsx("p",{className:"text-sm text-red-700",children:"The Kriskogram visualization encountered an error."})]}),children:r.jsx("div",{className:"w-full h-full",children:r.jsx(zo,{ref:Er,nodes:Y.nodes,edges:Y.edges,width:Math.max(800,mn.width-(t?64:s)-(gn?4:er)-40),height:Math.max(600,mn.height-80),margin:{top:60,right:40,bottom:60,left:40},arcOpacity:Ir,title:a.name,accessors:Br.accessors,legend:Br.legendItems.length>0?Br.legendItems:void 0})})}),H==="table"&&r.jsx(Gt,{fallback:r.jsxs("div",{className:"p-4 bg-red-50 border border-red-200 rounded-md",children:[r.jsx("h3",{className:"text-lg font-semibold text-red-800 mb-2",children:"Table View Error"}),r.jsx("p",{className:"text-sm text-red-700",children:"The table view encountered an error."})]}),children:r.jsx("div",{className:"h-full w-full flex flex-col min-h-0",children:r.jsx(Co,{nodes:Y.nodes,edges:Y.baseEdges})})}),H==="sankey"&&r.jsx(Gt,{fallback:r.jsxs("div",{className:"p-4 bg-red-50 border border-red-200 rounded-md",children:[r.jsx("h3",{className:"text-lg font-semibold text-red-800 mb-2",children:"Sankey Diagram Error"}),r.jsx("p",{className:"text-sm text-red-700",children:"The Sankey diagram encountered an error."})]}),children:r.jsx("div",{className:"h-full min-h-0",children:r.jsx(qi,{nodes:Y.nodes,edges:Y.baseEdges,width:Math.max(800,mn.width-(t?64:s)-(gn?4:er)-40),height:Math.max(600,mn.height-80)})})}),H==="chord"&&r.jsx(Gt,{fallback:r.jsxs("div",{className:"p-4 bg-red-50 border border-red-200 rounded-md",children:[r.jsx("h3",{className:"text-lg font-semibold text-red-800 mb-2",children:"Chord Diagram Error"}),r.jsx("p",{className:"text-sm text-red-700",children:"The chord diagram encountered an error."})]}),children:r.jsx(Xi,{nodes:Y.nodes,edges:Y.baseEdges,width:Math.max(800,mn.width-(t?64:s)-(gn?4:er)-40),height:Math.max(600,mn.height-80)})})]}):we?r.jsxs("div",{className:"text-center text-gray-500 py-8",children:["No data meets the current threshold range (",v.toLocaleString()," - ",b.toLocaleString(),"). Try adjusting the filters."]}):r.jsx("div",{className:"px-6 py-8 text-center text-gray-600 space-y-3",children:typeof m=="number"&&ao[m]?r.jsxs(r.Fragment,{children:[r.jsxs("p",{className:"text-lg font-semibold text-gray-700",children:["No state-to-state migration snapshot for ",m]}),r.jsx("p",{className:"text-sm leading-relaxed",children:ao[m]})]}):r.jsx("p",{children:"No snapshot to display."})})})}),H==="kriskogram"&&r.jsxs("div",{className:"absolute bottom-4 right-4 flex items-center gap-2 bg-white/90 backdrop-blur px-3 py-2 rounded shadow border border-gray-200",children:[r.jsx("label",{className:"text-xs font-medium text-gray-700",children:"Mode:"}),r.jsx("button",{type:"button",onClick:()=>{Tr("pan"),D({interactionMode:"pan"})},className:["text-xs px-2 py-1 rounded border",Or==="pan"?"bg-blue-600 text-white border-blue-600":"bg-white text-gray-700 border-gray-300"].join(" "),children:"Pan"}),r.jsx("button",{type:"button",onClick:()=>{Tr("lens"),D({interactionMode:"lens"})},className:["text-xs px-2 py-1 rounded border",Or==="lens"?"bg-blue-600 text-white border-blue-600":"bg-white text-gray-700 border-gray-300"].join(" "),children:"Edge Lens"}),Or==="lens"&&r.jsxs("span",{className:"text-[10px] text-gray-600",children:["Wheel: radius (",Fo,"px)"]})]})]}):r.jsx("div",{className:"flex-1 flex items-center justify-center text-gray-500",children:r.jsxs("div",{className:"text-center",children:[r.jsx("p",{className:"text-lg mb-2",children:"No dataset selected"}),r.jsx("p",{className:"text-sm",children:"Select a dataset from the sidebar to begin exploring"})]})})]}),a&&r.jsx(el,{isCollapsed:gn,onToggle:()=>jo(!gn),onResize:Mo,title:"Visualization Settings",bottomContent:r.jsxs("div",{className:"p-3",children:[r.jsx("label",{className:"text-xs font-medium text-gray-600 block mb-2",children:"Visualization Type"}),r.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[r.jsx("button",{onClick:()=>{ie("kriskogram"),D({view:"kriskogram"})},className:`px-3 py-2.5 rounded text-sm font-medium transition-colors ${H==="kriskogram"?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"Kriskogram"}),r.jsx("button",{onClick:()=>{ie("table"),D({view:"table"})},className:`px-3 py-2.5 rounded text-sm font-medium transition-colors ${H==="table"?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"Table"}),r.jsx("button",{onClick:()=>{ie("sankey"),D({view:"sankey"})},className:`px-3 py-2.5 rounded text-sm font-medium transition-colors ${H==="sankey"?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"Sankey"}),r.jsx("button",{onClick:()=>{ie("chord"),D({view:"chord"})},className:`px-3 py-2.5 rounded text-sm font-medium transition-colors ${H==="chord"?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"Chord"})]})]}),children:r.jsxs("div",{className:"space-y-4",children:[r.jsxs(rn,{title:a.name,defaultOpen:!0,subtitle:`${a.type.toUpperCase()} · ${a.timeRange.start}${a.timeRange.end!==a.timeRange.start?`–${a.timeRange.end}`:""}`,children:[a.notes&&r.jsx("div",{className:"text-xs text-gray-600 mt-2 whitespace-pre-wrap",children:a.notes}),!a.notes&&r.jsx("div",{className:"text-xs text-gray-500 italic mt-2",children:"No description available"})]}),mt&&r.jsxs("div",{className:"p-3 bg-gray-50 rounded grid grid-cols-2 gap-3 text-sm",children:[r.jsxs("div",{children:[r.jsx("div",{className:"text-xs text-gray-600",children:"Nodes"}),r.jsxs("div",{className:"text-lg font-bold",children:[mt.visibleNodes,"/",mt.totalNodes]})]}),r.jsxs("div",{children:[r.jsx("div",{className:"text-xs text-gray-600",children:"Edges"}),r.jsxs("div",{className:"text-lg font-bold",children:[mt.visibleEdges.toLocaleString(),"/",mt.totalEdges.toLocaleString()]})]})]}),r.jsx(rn,{title:"General Settings",defaultOpen:!0,onReset:()=>{const l=Math.max(1,Lr);O(null),Es("none"),$r(null),Yt([]),S(vt),j(Pn),R(l),D({edgeType:null,intraFilter:"none",nodeFilterAttribute:null,nodeFilterValues:[],minThreshold:vt,maxThreshold:Pn,maxEdges:l})},children:r.jsxs("div",{className:"space-y-4",children:[Eo&&m!==void 0&&r.jsxs("div",{className:"space-y-2",children:[r.jsxs("label",{className:"text-sm font-medium",children:["Year: ",m]}),r.jsx("input",{type:"range",min:a.timeRange.start,max:a.timeRange.end,value:m,onChange:l=>Ao(parseInt(l.target.value)),className:"w-full"})]}),wt&&r.jsxs("div",{className:"space-y-2",children:[r.jsxs("label",{className:"text-sm font-medium",children:["Edge Type (",wt.property,")"]}),r.jsxs("select",{value:U||"all",onChange:l=>{const c=l.target.value==="all"?null:l.target.value;O(c),D({edgeType:c})},className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[r.jsx("option",{value:"all",children:"All Types"}),wt.values.map(l=>r.jsx("option",{value:l,children:l},l))]})]}),(It||At)&&r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-sm font-medium",children:"Edge Scope"}),r.jsxs("select",{value:ct,onChange:l=>{const c=l.target.value;Es(c),D({intraFilter:c})},className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[r.jsx("option",{value:"none",children:"All"}),It&&r.jsx("option",{value:"region",children:"Intra Region"}),At&&r.jsx("option",{value:"division",children:"Intra Division"}),It&&r.jsx("option",{value:"interRegion",children:"Inter Region"}),At&&r.jsx("option",{value:"interDivision",children:"Inter Division"})]})]}),lr.length>0&&r.jsxs("div",{className:"space-y-2",children:[r.jsx("label",{className:"text-sm font-medium",children:"Node Filter"}),r.jsxs("select",{value:qe??"",onChange:l=>{const c=l.target.value||null;$r(c),Yt([]),D({nodeFilterAttribute:c,nodeFilterValues:[]})},className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[r.jsx("option",{value:"",children:"All nodes"}),lr.map(l=>r.jsx("option",{value:l,children:l},l))]}),qe&&(kn.length>0?r.jsxs("div",{className:"space-y-2",children:[r.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-600",children:[r.jsx("button",{type:"button",className:"rounded px-2 py-1 hover:bg-gray-100",onClick:()=>{const l=[...kn];Yt(l),D({nodeFilterValues:l})},children:"Select all"}),r.jsx("button",{type:"button",className:"rounded px-2 py-1 hover:bg-gray-100",onClick:()=>{Yt([]),D({nodeFilterValues:[]})},children:"Clear"})]}),r.jsx("div",{className:"max-h-48 overflow-y-auto rounded-md border border-gray-200 divide-y divide-gray-100",children:kn.map(l=>{const c=yt.includes(l);return r.jsxs("label",{className:"flex items-center gap-2 px-3 py-2 text-sm cursor-pointer hover:bg-gray-50",children:[r.jsx("input",{type:"checkbox",className:"h-3.5 w-3.5",checked:c,onChange:M=>{const ee=M.target.checked?Array.from(new Set([...yt,l])).sort((B,X)=>B.localeCompare(X)):yt.filter(B=>B!==l);Yt(ee),D({nodeFilterValues:ee})}}),r.jsx("span",{children:l})]},l)})}),yt.length===0&&r.jsxs("p",{className:"text-xs text-gray-500",children:["No specific values selected. All nodes for ",qe," remain visible."]})]}):r.jsxs("p",{className:"text-xs text-gray-500 italic",children:["No values available for ",qe," in this snapshot."]}))]}),we&&mt&&r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("label",{className:"text-sm font-medium flex items-center gap-2",children:[r.jsxs("span",{children:["Min: ",v.toLocaleString()]}),Hr!==void 0&&Hr>v&&r.jsxs("span",{className:"text-xs text-gray-400",children:["(actual ",Hr.toLocaleString(),")"]})]}),(()=>{const l=Math.max(1,Lr),c=v>vt||b<Pn||k<l;return r.jsx("button",{onClick:()=>{S(vt),j(Pn),R(l)},disabled:!c,type:"button",className:`text-xs transition-colors ${c?"text-blue-600 hover:text-blue-800":"text-gray-400 cursor-not-allowed"}`,children:"Show All"})})()]}),r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("input",{type:"range",min:vt,max:yn||1,step:Os,value:v,onChange:l=>{const c=parseInt(l.target.value),M=Math.min(c,b);S(M),D({minThreshold:M})},className:"w-full"}),r.jsx("input",{type:"number",min:vt,max:yn||1,value:v,onChange:l=>{const c=Number.parseInt(l.target.value);if(Number.isNaN(c))return;const M=Math.max(vt,Math.min(c,b));S(M),D({minThreshold:M})},className:"w-24 px-2 py-1 text-sm border border-gray-300 rounded-md"})]})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsxs("label",{className:"text-sm font-medium flex items-center gap-2",children:[r.jsxs("span",{children:["Max: ",b.toLocaleString()]}),Gr!==void 0&&Gr<b&&r.jsxs("span",{className:"text-xs text-gray-400",children:["(actual ",Gr.toLocaleString(),")"]})]}),r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("input",{type:"range",min:vt,max:yn||1,step:Os,value:b,onChange:l=>{const c=parseInt(l.target.value),M=Math.max(c,v);j(M),D({maxThreshold:M})},className:"w-full"}),r.jsx("input",{type:"number",min:vt,max:yn||1,value:b,onChange:l=>{const c=Number.parseInt(l.target.value);if(Number.isNaN(c))return;const M=Math.min(yn||1,Math.max(c,v));j(M),D({maxThreshold:M})},className:"w-24 px-2 py-1 text-sm border border-gray-300 rounded-md"})]})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsxs("label",{className:"text-sm font-medium",children:["Max Edges: ",k]}),r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("input",{type:"range",min:10,max:zr,step:10,value:k,onChange:l=>{const c=parseInt(l.target.value);R(c),D({maxEdges:c})},className:"w-full"}),r.jsx("input",{type:"number",min:1,max:zr,value:k,onChange:l=>{const c=Number.parseInt(l.target.value);if(Number.isNaN(c))return;const M=Math.max(1,Math.min(c,zr));R(M),D({maxEdges:M})},className:"w-24 px-2 py-1 text-sm border border-gray-300 rounded-md"})]}),r.jsxs("p",{className:"text-xs text-gray-600 italic",children:["After filtering by thresholds and edge type, edges are sorted by value (highest first) and the top ",k," edges are displayed."]})]})]})]})}),H==="kriskogram"&&r.jsx(rn,{title:"Kriskogram Settings",defaultOpen:!0,onReset:()=>{ue(!1),Ms("alphabetical"),Fs(.85),Ar("weight"),Ie(1),Is(2),As("single"),Vr(null),ks("fixed"),Dr(null),Ps("linear"),Vs(1),Rs(!1),Xt("direction"),nr(null),$s(!0),kr("weight"),rr(null),Pr(.6),Tr("pan"),Ro(80),$o({x:0,y:0}),re(null),be(1),Ne(!1),$("linear"),Ze(!1),Te("filled"),Be("filled"),Et(1),Le(1),Zn("#fc8d59"),Qn("#ffffbf"),Jn("#91bfdb"),ws(!0),Qe(8),cn(4),Xn(15),T(1),Se(!1),ye("round"),Yn(!1),xt(3),D({showAllNodes:!1,nodeOrderMode:"alphabetical",arcOpacity:.85,edgeWidthMode:"weight",edgeWidthMultiplier:1,baseEdgeWidth:2,nodeColorMode:"single",nodeColorAttribute:null,nodeSizeMode:"fixed",nodeSizeAttribute:null,nodeSizeWeightScale:"linear",nodeSizeMultiplier:1,edgeColorAdvanced:!1,edgeColorHue:"direction",edgeColorHueAttribute:null,edgeColorInterGrayscale:!0,edgeColorIntensity:"weight",edgeColorIntensityAttribute:null,edgeColorIntensityConst:.6,interactionMode:"pan",lensRadius:80,egoNodeId:null,egoNeighborSteps:1,egoStepColoring:!1,temporalOverlay:!1,temporalOverlayYearsPast:1,temporalOverlayYearsFuture:1,temporalOverlayColorPast:"#fc8d59",temporalOverlayColorMid:"#ffffbf",temporalOverlayColorFuture:"#91bfdb",temporalOverlayCurrentBlack:!0,edgeSegmentLength:8,edgeSegmentGap:4,edgeSegmentOffset:15,edgeSegmentSpeed:1,edgeSegmentScaleByWeight:!1,edgeSegmentCap:"round",edgeSegmentAnimate:!1,edgeWeightScale:"linear",edgeOutlineGap:3})},children:a!=null&&a.metadata?r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{className:"flex items-center justify-between p-2 bg-gray-50 rounded border border-gray-200",children:[r.jsxs("div",{children:[r.jsx("label",{htmlFor:"kriskogram-show-all-nodes",className:"text-sm font-medium text-gray-700",children:"Always show all nodes"}),r.jsx("p",{className:"text-xs text-gray-500",children:"Keeps every location visible even if its edges fall outside the filters."})]}),r.jsx("input",{id:"kriskogram-show-all-nodes",type:"checkbox",className:"w-4 h-4",checked:K,onChange:l=>{const c=l.target.checked;ue(c),D({showAllNodes:c})}})]}),r.jsxs("div",{className:"space-y-3 border border-gray-200 rounded-md p-3",children:[r.jsx("div",{className:"text-xs font-semibold text-gray-600 uppercase tracking-wide",children:"Ego Focus"}),r.jsxs("div",{children:[r.jsx("label",{htmlFor:"kriskogram-ego-node",className:"text-xs font-medium text-gray-700",children:"Ego focus (optional)"}),r.jsxs("select",{id:"kriskogram-ego-node",value:E??"",onChange:l=>{const c=l.target.value,M=c===""?null:c;M===null?(re(null),de&&Ne(!1),D({egoNodeId:null,egoStepColoring:!1})):(re(M),D({egoNodeId:M}))},className:"mt-1 w-full px-2 py-1.5 text-xs border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[r.jsx("option",{value:"",children:"No ego focus (show all eligible edges)"}),((we==null?void 0:we.nodes)??[]).map(l=>r.jsx("option",{value:l.id,children:l.label||l.id},l.id))]}),r.jsx("p",{className:"mt-1 text-[11px] text-gray-500",children:"Limit the visualization to flows centered on a selected node."})]}),r.jsxs("div",{children:[r.jsx("label",{htmlFor:"kriskogram-ego-steps",className:"text-xs font-medium text-gray-700",children:"Neighbor steps"}),r.jsxs("div",{className:"mt-1 flex items-center gap-2",children:[r.jsx("input",{id:"kriskogram-ego-steps",type:"number",min:1,max:10,value:le,disabled:!E,onChange:l=>{const c=Number.parseInt(l.target.value,10);if(Number.isNaN(c))return;const M=Math.max(1,Math.min(c,10));be(M),D({egoNeighborSteps:M})},className:"w-20 px-2 py-1 text-xs border border-gray-300 rounded-md disabled:bg-gray-100 disabled:text-gray-500"}),r.jsx("span",{className:"text-[11px] text-gray-500",children:"How many hops from the ego node to include (based on currently visible edges)."})]})]}),r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("label",{htmlFor:"kriskogram-ego-step-coloring",className:"text-xs font-medium text-gray-700",children:"Color edges by neighbor step"}),r.jsx("p",{className:"text-[11px] text-gray-500",children:"Apply a step-based gradient for ego flows and show it in the legend."})]}),r.jsx("input",{id:"kriskogram-ego-step-coloring",type:"checkbox",className:"w-4 h-4",disabled:!E,checked:de&&!!E,onChange:l=>{const c=l.target.checked&&!!E;Ne(c),D({egoStepColoring:c})}})]}),r.jsx("p",{className:"text-[11px] text-gray-500",children:"Edge and node styling options are available in the sections below."})]}),r.jsxs("div",{className:"space-y-3 border border-gray-200 rounded-md p-3",children:[r.jsx("div",{className:"text-xs font-semibold text-gray-600 uppercase tracking-wide",children:"Temporal Overlay"}),r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("label",{className:"text-xs font-medium text-gray-700",htmlFor:"kriskogram-temporal-overlay",children:"Show neighboring years"}),r.jsx("p",{className:"text-[11px] text-gray-500",children:"Overlay edges from nearby years to compare past and future flows."})]}),r.jsx("input",{id:"kriskogram-temporal-overlay",type:"checkbox",className:"w-4 h-4",disabled:!a||a.timeRange.start===a.timeRange.end||typeof m!="number",checked:ge&&(a==null?void 0:a.timeRange.start)!==(a==null?void 0:a.timeRange.end),onChange:l=>{const c=l.target.checked;Ze(c),D({temporalOverlay:c})}})]}),r.jsxs("div",{children:[r.jsx("label",{className:"text-xs font-medium text-gray-700",htmlFor:"kriskogram-temporal-overlay-years",children:"Neighbor years"}),r.jsxs("div",{className:"mt-1 grid grid-cols-1 sm:grid-cols-2 gap-2",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("span",{className:"text-[11px] text-gray-600 whitespace-nowrap",children:"Years before"}),r.jsx("input",{type:"number",min:0,max:10,value:et,disabled:!ge,onChange:l=>{const c=Number.parseInt(l.target.value,10);if(Number.isNaN(c))return;const M=Math.max(0,Math.min(c,10));Et(M),D({temporalOverlayYearsPast:M})},className:"w-20 px-2 py-1 text-xs border border-gray-300 rounded-md disabled:bg-gray-100 disabled:text-gray-500"})]}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("span",{className:"text-[11px] text-gray-600 whitespace-nowrap",children:"Years after"}),r.jsx("input",{type:"number",min:0,max:10,value:je,disabled:!ge,onChange:l=>{const c=Number.parseInt(l.target.value,10);if(Number.isNaN(c))return;const M=Math.max(0,Math.min(c,10));Le(M),D({temporalOverlayYearsFuture:M})},className:"w-20 px-2 py-1 text-xs border border-gray-300 rounded-md disabled:bg-gray-100 disabled:text-gray-500"})]})]}),r.jsx("p",{className:"mt-1 text-[11px] text-gray-500",children:"Control how many past and future snapshots appear alongside the current year."}),(!a||a.timeRange.start===a.timeRange.end)&&r.jsx("p",{className:"mt-2 text-[11px] text-gray-400 italic",children:"Temporal overlay is unavailable because this dataset has a single year."})]})]}),r.jsxs("div",{className:"space-y-3 border border-gray-200 rounded-md p-3",children:[r.jsx("div",{className:"text-xs font-semibold text-gray-600 uppercase tracking-wide",children:"Node"}),r.jsxs("div",{className:"space-y-2",children:[r.jsx("label",{className:"text-xs font-medium text-gray-700",children:"Node Ordering"}),r.jsxs("select",{value:tr,onChange:l=>{const c=l.target.value;Ms(c),D({nodeOrderMode:c})},className:"w-full px-2 py-1.5 text-xs border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[r.jsx("option",{value:"alphabetical",children:"Alphabetical"}),a.metadata.hasCategoricalProperties.nodes.map(l=>r.jsxs("option",{value:l,children:["By ",l]},l)),a.metadata.hasNumericProperties.nodes.map(l=>r.jsxs("option",{value:l,children:["By ",l]},l))]})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx("label",{className:"text-xs font-medium text-gray-700",children:"Node Color"}),r.jsxs("select",{value:ar,onChange:l=>{const c=l.target.value;As(c);const M={nodeColorMode:c};c!=="attribute"&&(Vr(null),M.nodeColorAttribute=null),D(M)},className:"w-full px-2 py-1.5 text-xs border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[r.jsx("option",{value:"single",children:"Single Color"}),r.jsx("option",{value:"visible_outgoing",children:"Visible Outgoing Flow"}),r.jsx("option",{value:"visible_incoming",children:"Visible Incoming Flow"}),r.jsx("option",{value:"year_outgoing",children:"Year Outgoing Flow"}),r.jsx("option",{value:"year_incoming",children:"Year Incoming Flow"}),r.jsx("option",{value:"net_year",children:"Net Flow (year)"}),r.jsx("option",{value:"self_year",children:"Self Flow (year)"}),r.jsx("option",{value:"attribute",children:"By Attribute"})]}),ar==="attribute"&&r.jsxs("select",{value:Jt||"",onChange:l=>{const c=l.target.value||null;Vr(c),D({nodeColorAttribute:c})},className:"w-full px-2 py-1.5 text-xs border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[r.jsx("option",{value:"",children:"Select..."}),a.metadata.hasCategoricalProperties.nodes.map(l=>r.jsx("option",{value:l,children:l},l)),a.metadata.hasNumericProperties.nodes.map(l=>r.jsx("option",{value:l,children:l},l))]})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx("label",{className:"text-xs font-medium text-gray-700",children:"Node Size"}),r.jsxs("select",{value:St,onChange:l=>{const c=l.target.value;ks(c);const M={nodeSizeMode:c};c!=="attribute"&&(Dr(null),M.nodeSizeAttribute=null),D(M)},className:"w-full px-2 py-1.5 text-xs border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[r.jsx("option",{value:"fixed",children:"Fixed"}),r.jsx("option",{value:"visible_outgoing",children:"Visible Outgoing Flow"}),r.jsx("option",{value:"visible_incoming",children:"Visible Incoming Flow"}),r.jsx("option",{value:"year_outgoing",children:"Year Outgoing Flow"}),r.jsx("option",{value:"year_incoming",children:"Year Incoming Flow"}),r.jsx("option",{value:"net_visible",children:"Net Flow (visible)"}),r.jsx("option",{value:"net_year",children:"Net Flow (year)"}),r.jsx("option",{value:"self_year",children:"Self Flow (year)"}),r.jsx("option",{value:"attribute",children:"By Attribute"})]}),St==="attribute"&&r.jsxs("select",{value:gt||"",onChange:l=>{const c=l.target.value||null;Dr(c),D({nodeSizeAttribute:c})},className:"w-full px-2 py-1.5 text-xs border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[r.jsx("option",{value:"",children:"Select..."}),a.metadata.hasNumericProperties.nodes.map(l=>r.jsx("option",{value:l,children:l},l))]}),r.jsxs("div",{className:"mt-2 border border-gray-200 rounded-md p-2 bg-gray-50",children:[r.jsx("div",{className:"text-[11px] font-semibold text-gray-600 uppercase tracking-wide",children:"Weight"}),r.jsxs("div",{className:"mt-2 grid grid-cols-1 sm:grid-cols-2 gap-2 text-xs",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-[11px] font-medium text-gray-600",children:"Scaling"}),r.jsxs("select",{value:ir,onChange:l=>{const c=l.target.value;Ps(c),D({nodeSizeWeightScale:c})},className:"mt-1 w-full px-2 py-1.5 text-xs border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[r.jsx("option",{value:"linear",children:"Linear"}),r.jsx("option",{value:"sqrt",children:"Square root"}),r.jsx("option",{value:"log",children:"Logarithmic"})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-[11px] font-medium text-gray-600",children:"Multiplier"}),r.jsx("input",{type:"number",min:.1,max:10,step:.1,value:xn,onChange:l=>{const c=Number.parseFloat(l.target.value);if(Number.isNaN(c))return;const M=Math.max(.1,Math.min(10,c));Vs(M),D({nodeSizeMultiplier:M})},className:"mt-1 w-full px-2 py-1 text-xs border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]}),r.jsx("p",{className:"mt-2 text-[10px] text-gray-500",children:"Apply curve scaling and an overall multiplier to flow-based node sizes."})]})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx("label",{className:"text-xs font-medium text-gray-700",htmlFor:"kriskogram-node-styling",children:"Node styling"}),r.jsx("p",{className:"text-[11px] text-gray-500",children:"Control how nodes are rendered. Outline mode hides the fill and emphasizes the stroke."}),r.jsxs("select",{id:"kriskogram-node-styling",value:J,onChange:l=>{const c=l.target.value;Be(c),D({temporalOverlayNodeStyle:c})},className:"w-full px-2 py-1.5 text-xs border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[r.jsx("option",{value:"filled",children:"Filled nodes"}),r.jsx("option",{value:"outline",children:"Outline only"})]})]})]}),r.jsxs("div",{className:"space-y-3 border border-gray-200 rounded-md p-3",children:[r.jsx("div",{className:"text-xs font-semibold text-gray-600 uppercase tracking-wide",children:"Edge"}),r.jsxs("div",{className:"space-y-2",children:[r.jsxs("label",{className:"text-xs font-medium text-gray-700",children:["Arc Opacity: ",Math.round(Ir*100),"%"]}),r.jsx("input",{type:"range",min:0,max:1,step:.05,value:Ir,onChange:l=>{const c=Number.parseFloat(l.target.value);Number.isNaN(c)||(Fs(c),D({arcOpacity:c}))},className:"w-full"})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx("label",{className:"text-xs font-medium text-gray-700",children:"Edge Width"}),r.jsxs("div",{className:"flex items-center gap-3 text-xs",children:[r.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[r.jsx("input",{type:"radio",name:"edgeWidthMode",value:"weight",checked:fn==="weight",onChange:()=>{Ar("weight"),D({edgeWidthMode:"weight"})},className:"w-3.5 h-3.5"}),r.jsx("span",{children:"By Weight"})]}),r.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[r.jsx("input",{type:"radio",name:"edgeWidthMode",value:"fixed",checked:fn==="fixed",onChange:()=>{Ar("fixed"),D({edgeWidthMode:"fixed"})},className:"w-3.5 h-3.5"}),r.jsx("span",{children:"Fixed"})]})]}),fn==="fixed"&&r.jsxs("div",{className:"mt-2",children:[r.jsxs("label",{className:"text-xs font-medium text-gray-700",children:["Base Edge Width: ",Qt.toFixed(1),"px"]}),r.jsx("input",{type:"range",min:.5,max:8,step:.1,value:Qt,onChange:l=>{const c=Number.parseFloat(l.target.value);Number.isNaN(c)||(Is(c),D({baseEdgeWidth:c}))},className:"w-full"})]}),r.jsxs("div",{className:"mt-2 border border-gray-200 rounded-md p-2 bg-gray-50",children:[r.jsx("div",{className:"text-[11px] font-semibold text-gray-600 uppercase tracking-wide",children:"Weight"}),r.jsxs("div",{className:"mt-2 grid grid-cols-1 sm:grid-cols-2 gap-2 text-xs",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-[11px] font-medium text-gray-600",children:"Scaling"}),r.jsxs("select",{value:Ee,onChange:l=>{const c=l.target.value;$(c),D({edgeWeightScale:c})},className:"mt-1 w-full px-2 py-1.5 text-xs border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[r.jsx("option",{value:"linear",children:"Linear (use raw weight differences)"}),r.jsx("option",{value:"sqrt",children:"Square root (compress extremes)"}),r.jsx("option",{value:"log",children:"Logarithmic (highlight small flows)"})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-[11px] font-medium text-gray-600",children:"Multiplier"}),r.jsx("input",{type:"number",min:.1,max:10,step:.1,value:q,onChange:l=>{const c=Number.parseFloat(l.target.value);if(Number.isNaN(c))return;const M=Math.max(.1,Math.min(10,c));Ie(M),D({edgeWidthMultiplier:M})},className:"mt-1 w-full px-2 py-1 text-xs border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]}),r.jsx("p",{className:"mt-2 text-[10px] text-gray-500",children:"Scaling also shapes weight-based color intensity; the multiplier only stretches rendered edge widths."})]})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx("label",{className:"text-xs font-medium text-gray-700",htmlFor:"kriskogram-edge-style",children:"Line styling"}),r.jsx("p",{className:"text-[11px] text-gray-500",children:"Choose how edges are drawn. Segmented uses dashed arcs; outline shows a thin perimeter."}),r.jsxs("select",{id:"kriskogram-edge-style",value:L,onChange:l=>{const c=l.target.value;Te(c),D({temporalOverlayEdgeStyle:c})},className:"w-full px-2 py-1.5 text-xs border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[r.jsx("option",{value:"filled",children:"Filled (solid weight)"}),r.jsx("option",{value:"segmented",children:"Segmented (dashed)"}),r.jsx("option",{value:"outline",children:"Outline only"})]}),L==="segmented"&&r.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-3 text-xs mt-2",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-[11px] font-medium text-gray-600",children:"Dash length (px)"}),r.jsx("input",{type:"number",min:1,step:.5,value:Me,onChange:l=>{const c=Number.parseFloat(l.target.value);if(Number.isNaN(c))return;const M=Math.max(1,c);Qe(M),D({edgeSegmentLength:M})},className:"mt-1 w-full px-2 py-1 text-xs border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-[11px] font-medium text-gray-600",children:"Gap length (px)"}),r.jsx("input",{type:"number",min:.5,step:.5,value:Ae,onChange:l=>{const c=Number.parseFloat(l.target.value);if(Number.isNaN(c))return;const M=Math.max(.5,c);cn(M),D({edgeSegmentGap:M})},className:"mt-1 w-full px-2 py-1 text-xs border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-[11px] font-medium text-gray-600",children:"Initial gap (px)"}),r.jsx("input",{type:"number",min:0,step:.5,value:Je,onChange:l=>{const c=Number.parseFloat(l.target.value);if(Number.isNaN(c))return;const M=Math.max(0,c);Xn(M),D({edgeSegmentOffset:M})},className:"mt-1 w-full px-2 py-1 text-xs border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]}),L==="segmented"&&r.jsxs("div",{className:"mt-2 space-y-2",children:[r.jsxs("div",{children:[r.jsx("label",{className:"text-[11px] font-medium text-gray-600",htmlFor:"kriskogram-edge-cap",children:"Segment cap style"}),r.jsxs("select",{id:"kriskogram-edge-cap",value:se,onChange:l=>{const c=l.target.value;ye(c),D({edgeSegmentCap:c})},className:"mt-1 w-full px-2 py-1.5 text-xs border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[r.jsx("option",{value:"round",children:"Rounded segment ends"}),r.jsx("option",{value:"butt",children:"Sharp segment ends"})]})]}),r.jsxs("label",{className:"flex items-center justify-between text-[11px] font-medium text-gray-600",children:[r.jsx("span",{children:"Animate flow"}),r.jsx("input",{type:"checkbox",className:"w-3.5 h-3.5",checked:dt,onChange:l=>{const c=l.target.checked;Yn(c),D({edgeSegmentAnimate:c})}})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-[11px] font-medium text-gray-600",children:"Animation speed multiplier"}),r.jsx("input",{type:"number",min:.1,step:.1,value:A,onChange:l=>{const c=Number.parseFloat(l.target.value);if(Number.isNaN(c))return;const M=Math.max(.1,c);T(M),D({edgeSegmentSpeed:M})},className:"mt-1 w-full px-2 py-1 text-xs border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"}),r.jsx("p",{className:"mt-1 text-[10px] text-gray-500",children:"Higher values move dashes faster. 1.0 matches the legacy speed."})]}),r.jsxs("label",{className:"flex items-center justify-between text-[11px] font-medium text-gray-600",children:[r.jsx("span",{children:"Multiply speed by flow weight"}),r.jsx("input",{type:"checkbox",className:"w-3.5 h-3.5",checked:Z,onChange:l=>{const c=l.target.checked;Se(c),D({edgeSegmentScaleByWeight:c})}})]})]}),r.jsxs("div",{className:"mt-3 space-y-3",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-[11px] font-medium text-gray-600",children:"Temporal overlay colors"}),r.jsx("p",{className:"mt-1 text-[10px] text-gray-500",children:"Choose the palette for past, midpoint, and future overlay arcs. Switch the input format in Interface Settings."})]}),r.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-3 text-xs",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsx("span",{className:"block text-[11px] font-medium text-gray-600",children:"Past"}),dr==="picker"?r.jsx("input",{type:"color",value:tt,disabled:!ge,onChange:l=>ur(l.target.value,"#fc8d59",Zn,En,"temporalOverlayColorPast"),className:`h-8 w-full cursor-pointer ${ge?"":"opacity-60 cursor-not-allowed"}`}):r.jsx("input",{type:"text",value:_s,disabled:!ge,onChange:l=>En(l.target.value),onBlur:l=>vn(l.target.value,tt,Zn,En,"temporalOverlayColorPast"),onKeyDown:l=>{l.key==="Enter"&&vn(_s,tt,Zn,En,"temporalOverlayColorPast")},placeholder:"#fc8d59",className:"w-full rounded border border-gray-300 px-2 py-1 text-xs font-mono disabled:bg-gray-100 disabled:text-gray-500"})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("span",{className:"block text-[11px] font-medium text-gray-600",children:"Midpoint"}),dr==="picker"?r.jsx("input",{type:"color",value:nt,disabled:!ge,onChange:l=>ur(l.target.value,"#ffffbf",Qn,In,"temporalOverlayColorMid"),className:`h-8 w-full cursor-pointer ${ge?"":"opacity-60 cursor-not-allowed"}`}):r.jsx("input",{type:"text",value:Cs,disabled:!ge,onChange:l=>In(l.target.value),onBlur:l=>vn(l.target.value,nt,Qn,In,"temporalOverlayColorMid"),onKeyDown:l=>{l.key==="Enter"&&vn(Cs,nt,Qn,In,"temporalOverlayColorMid")},placeholder:"#ffffbf",className:"w-full rounded border border-gray-300 px-2 py-1 text-xs font-mono disabled:bg-gray-100 disabled:text-gray-500"})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("span",{className:"block text-[11px] font-medium text-gray-600",children:"Future"}),dr==="picker"?r.jsx("input",{type:"color",value:rt,disabled:!ge,onChange:l=>ur(l.target.value,"#91bfdb",Jn,An,"temporalOverlayColorFuture"),className:`h-8 w-full cursor-pointer ${ge?"":"opacity-60 cursor-not-allowed"}`}):r.jsx("input",{type:"text",value:Ns,disabled:!ge,onChange:l=>An(l.target.value),onBlur:l=>vn(l.target.value,rt,Jn,An,"temporalOverlayColorFuture"),onKeyDown:l=>{l.key==="Enter"&&vn(Ns,rt,Jn,An,"temporalOverlayColorFuture")},placeholder:"#91bfdb",className:"w-full rounded border border-gray-300 px-2 py-1 text-xs font-mono disabled:bg-gray-100 disabled:text-gray-500"})]})]}),r.jsxs("div",{className:"flex items-center justify-between p-2 bg-gray-50 border border-gray-200 rounded",children:[r.jsxs("div",{children:[r.jsx("label",{className:"text-xs font-medium text-gray-700",children:"Current year color"}),r.jsx("p",{className:"text-[11px] text-gray-500",children:"Use the default black or reuse the midpoint color for the current year arcs."})]}),r.jsxs("select",{value:Kt?"default":"midpoint",onChange:l=>{const c=l.target.value!=="midpoint";ws(c),D({temporalOverlayCurrentBlack:c})},disabled:!ge,className:"px-2 py-1 text-xs border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 disabled:bg-gray-100 disabled:text-gray-500",children:[r.jsx("option",{value:"default",children:"Default (black)"}),r.jsx("option",{value:"midpoint",children:"Use midpoint color"})]})]})]}),L==="outline"&&r.jsxs("div",{className:"mt-2 grid grid-cols-1 sm:grid-cols-2 gap-3 text-xs",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-[11px] font-medium text-gray-600",children:"Outline thickness (px)"}),r.jsx("input",{type:"range",min:.5,max:12,step:.5,value:fe,onChange:l=>{const c=Number.parseFloat(l.target.value);if(Number.isNaN(c))return;const M=Math.max(.5,c);xt(M),D({edgeOutlineGap:M})},className:"mt-1 w-full"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-[11px] font-medium text-gray-600",children:"Precise value"}),r.jsx("input",{type:"number",min:.5,step:.5,value:fe,onChange:l=>{const c=Number.parseFloat(l.target.value);if(Number.isNaN(c))return;const M=Math.max(.5,c);xt(M),D({edgeOutlineGap:M})},className:"mt-1 w-full px-2 py-1 text-xs border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("label",{className:"text-xs font-medium text-gray-700",children:"Edge Color"}),E&&de&&r.jsx("span",{className:"text-[11px] text-gray-400",children:"(disabled by neighbor step coloring)"})]}),r.jsxs("label",{className:"flex items-center gap-1 text-[11px] text-gray-600 cursor-pointer",children:[r.jsx("input",{type:"checkbox",className:"w-3.5 h-3.5",disabled:!!(E&&de),checked:pn,onChange:l=>{const c=l.target.checked;E&&de||(Rs(c),D({edgeColorAdvanced:c}),c||(Xt("direction"),nr(null),$s(!0),kr("weight"),rr(null),Pr(.6),D({edgeColorHue:"direction",edgeColorHueAttribute:null,edgeColorInterGrayscale:!0,edgeColorIntensity:"weight",edgeColorIntensityAttribute:null,edgeColorIntensityConst:.6})))}}),"Advanced"]})]}),!pn&&!(E&&de)&&r.jsxs("div",{className:"flex flex-col gap-1.5 text-xs",children:[r.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[r.jsx("input",{type:"radio",name:"edgeColorHueSimple",value:"direction",checked:ke==="direction",onChange:()=>{Xt("direction"),D({edgeColorHue:"direction"})},className:"w-3.5 h-3.5"}),r.jsx("span",{children:"By Direction (Above/Below)"})]}),r.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[r.jsx("input",{type:"radio",name:"edgeColorHueSimple",value:"single",checked:ke==="single",onChange:()=>{Xt("single"),D({edgeColorHue:"single"})},className:"w-3.5 h-3.5"}),r.jsx("span",{children:"Single Color"})]})]}),pn&&!(E&&de)&&r.jsxs("div",{className:"mt-2 space-y-3 border border-gray-200 rounded-md p-3 bg-gray-50/60",children:[r.jsxs("div",{children:[r.jsx("label",{className:"text-xs font-medium text-gray-700",children:"Hue Source"}),r.jsxs("select",{value:ke,onChange:l=>{const c=l.target.value;Xt(c),D({edgeColorHue:c}),c!=="attribute"&&(nr(null),D({edgeColorHueAttribute:null}))},className:"mt-1 w-full px-2 py-1.5 text-xs border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[r.jsx("option",{value:"direction",children:"Direction (Above/Below)"}),r.jsx("option",{value:"single",children:"Single"}),r.jsx("option",{value:"region",disabled:!It,children:"Region"}),r.jsx("option",{value:"division",disabled:!At,children:"Division"}),r.jsx("option",{value:"attribute",children:"Attribute"})]}),ke==="attribute"&&(a==null?void 0:a.metadata)&&r.jsxs("div",{className:"mt-2",children:[r.jsx("label",{className:"text-xs text-gray-600",children:"Hue Attribute"}),r.jsxs("select",{className:"w-full px-2 py-1.5 text-xs border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",value:Zt||"",onChange:l=>{const c=l.target.value||null;nr(c),D({edgeColorHueAttribute:c})},children:[r.jsx("option",{value:"",children:"Select attribute…"}),a.metadata.hasCategoricalProperties.edges.concat(a.metadata.hasNumericProperties.edges).map(l=>r.jsx("option",{value:l,children:l},l))]})]})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-gray-700",children:"Intensity Source"}),r.jsxs("select",{value:Mt,onChange:l=>{const c=l.target.value;kr(c),D({edgeColorIntensity:c}),c!=="attribute"&&(rr(null),D({edgeColorIntensityAttribute:null}))},className:"w-full px-2 py-1.5 text-xs border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[r.jsx("option",{value:"weight",children:"Weight"}),r.jsx("option",{value:"constant",children:"Constant"}),r.jsx("option",{value:"attribute",children:"Attribute"})]}),Mt==="constant"&&r.jsxs("div",{className:"mt-2",children:[r.jsxs("label",{className:"text-xs text-gray-600",children:["Constant Intensity: ",(sr*100).toFixed(0),"%"]}),r.jsx("input",{type:"range",min:0,max:1,step:.01,value:sr,onChange:l=>{const c=Number.parseFloat(l.target.value);Number.isNaN(c)||(Pr(c),D({edgeColorIntensityConst:c}))},className:"w-full"})]}),Mt==="attribute"&&(a==null?void 0:a.metadata)&&r.jsxs("div",{className:"mt-2",children:[r.jsx("label",{className:"text-xs text-gray-600",children:"Intensity Attribute"}),r.jsxs("select",{className:"w-full px-2 py-1.5 text-xs border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",value:hn||"",onChange:l=>{const c=l.target.value||null;rr(c),D({edgeColorIntensityAttribute:c})},children:[r.jsx("option",{value:"",children:"Select attribute…"}),a.metadata.hasNumericProperties.edges.map(l=>r.jsx("option",{value:l,children:l},l))]})]})]})]})]})]})]}):r.jsx("div",{className:"text-xs text-gray-500 italic",children:"No dataset metadata available"})}),H==="table"&&r.jsx(rn,{title:"Table Settings",defaultOpen:!1,children:r.jsx("div",{className:"text-xs text-gray-500 italic",children:"Settings to be added"})}),H==="sankey"&&r.jsx(rn,{title:"Sankey Settings",defaultOpen:!1,children:r.jsx("div",{className:"text-xs text-gray-500 italic",children:"Settings to be added"})}),H==="chord"&&r.jsx(rn,{title:"Chord Settings",defaultOpen:!1,children:r.jsx("div",{className:"text-xs text-gray-500 italic",children:"Settings to be added"})}),r.jsx(rn,{title:"Interface Settings",defaultOpen:!1,onReset:()=>{Ts("picker")},children:r.jsx("div",{className:"space-y-4",children:r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-medium text-gray-700",children:"Color input format"}),r.jsxs("select",{value:dr,onChange:l=>{const c=l.target.value==="hex"?"hex":"picker";Ts(c)},className:"mt-1 w-full px-2 py-1.5 text-xs border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[r.jsx("option",{value:"picker",children:"Color picker"}),r.jsx("option",{value:"hex",children:"Hex input"})]}),r.jsx("p",{className:"mt-1 text-[10px] text-gray-500",children:"Choose whether temporal overlay colors are edited with the native color picker or by typing hex codes."})]})})})]})})]})})}async function ol(){const e="csv-usa-pre-2020",n="csv-usa-post-2020",t="csv-2021",s="gexf-sample",o="swiss-2016";let i=await Ut(e),u=await Ut(n);const a=w=>w?w.snapshots.every(v=>{const S=new Set(v.nodes.map(b=>b.label));if(S.size!==nl)return!1;for(const b of S)if(!tl.has(b))return!1;return!0}):!1;(i?!a(i):!1)&&(await ds(e).catch(()=>{}),i=void 0),(u?!a(u):!1)&&(await ds(n).catch(()=>{}),u=void 0);let g=!!i,y=!!u;const h=await Ut(t),f=await Ut(s),_=await Ut(o),C=async w=>{const v=[];for(const S of w)try{const b=new URL(Object.assign({"../data/StateToStateMigrationUSCSV/state_to_state_migration_table_2022_t13_updated_2024_06_27_2022.csv":Na,"../data/StateToStateMigrationUSCSV/state_to_state_migration_table_2023_t13_2023.csv":ja,"../data/StateToStateMigrationUSCSV/state_to_state_migrations_table_2005_2005.csv":Ma,"../data/StateToStateMigrationUSCSV/state_to_state_migrations_table_2005_2007_2005-2007.csv":Fa,"../data/StateToStateMigrationUSCSV/state_to_state_migrations_table_2005_2009_2005-2009.csv":Ra,"../data/StateToStateMigrationUSCSV/state_to_state_migrations_table_2006_2006.csv":$a,"../data/StateToStateMigrationUSCSV/state_to_state_migrations_table_2006_2008_2006-2008.csv":Ea,"../data/StateToStateMigrationUSCSV/state_to_state_migrations_table_2007_2007.csv":Ia,"../data/StateToStateMigrationUSCSV/state_to_state_migrations_table_2007_2009_2007-2009.csv":Aa,"../data/StateToStateMigrationUSCSV/state_to_state_migrations_table_2008_2008.csv":ka,"../data/StateToStateMigrationUSCSV/state_to_state_migrations_table_2009_2009.csv":Pa,"../data/StateToStateMigrationUSCSV/state_to_state_migrations_table_2010_2010.csv":Va,"../data/StateToStateMigrationUSCSV/state_to_state_migrations_table_2011_2011.csv":Da,"../data/StateToStateMigrationUSCSV/state_to_state_migrations_table_2012_2012.csv":Oa,"../data/StateToStateMigrationUSCSV/state_to_state_migrations_table_2013_2013.csv":Ta,"../data/StateToStateMigrationUSCSV/state_to_state_migrations_table_2014_2014.csv":La,"../data/StateToStateMigrationUSCSV/state_to_state_migrations_table_2015_2015.csv":za,"../data/StateToStateMigrationUSCSV/state_to_state_migrations_table_2016_2016.csv":Ha,"../data/StateToStateMigrationUSCSV/state_to_state_migrations_table_2017_2017.csv":Ga,"../data/StateToStateMigrationUSCSV/state_to_state_migrations_table_2018_2018.csv":Ba,"../data/StateToStateMigrationUSCSV/state_to_state_migrations_table_2019_2019.csv":Ua,"../data/StateToStateMigrationUSCSV/state_to_state_migrations_table_2021_2021.csv":Wa})[`../data/StateToStateMigrationUSCSV/${S.filename}`],import.meta.url),j=await Sr(b.toString()),k=is(j);v.push({timestamp:S.year,nodes:k.nodes,edges:k.edges})}catch(b){console.warn(`⚠️ Failed to load snapshot for ${S.filename}:`,b)}return v.sort((S,b)=>{const j=typeof S.timestamp=="string"?Number.parseInt(S.timestamp,10):S.timestamp,k=typeof b.timestamp=="string"?Number.parseInt(b.timestamp,10):b.timestamp;return j-k}),v};if(!i){const w=Ls.filter(S=>S.year<=2019),v=await C(w);if(v.length>0){const S=v[0],b=v[v.length-1],j=ln(S),k={id:e,name:"US State-to-State Migration (2005-2019)",notes:"Tidy ACS 1-year state-to-state migration flows from 2005 through 2019. The Census Bureau did not release 2020 1-year migration flows, so the series stops before the pandemic.",type:"csv",timeRange:{start:typeof S.timestamp=="string"?Number.parseInt(S.timestamp,10):S.timestamp,end:typeof b.timestamp=="string"?Number.parseInt(b.timestamp,10):b.timestamp},snapshots:v,metadata:j,createdAt:Date.now()};await Bt(k),g=!0}}if(!u){const w=Ls.filter(S=>S.year>=2021),v=await C(w);if(v.length>0){const S=v[0],b=v[v.length-1],j=ln(S),k={id:n,name:"US State-to-State Migration (2021-2023)",notes:"Post-2020 ACS 1-year state-to-state migration flows. The 2022 release includes revised Connecticut flows per Census errata guidance.",type:"csv",timeRange:{start:typeof S.timestamp=="string"?Number.parseInt(S.timestamp,10):S.timestamp,end:typeof b.timestamp=="string"?Number.parseInt(b.timestamp,10):b.timestamp},snapshots:v,metadata:j,createdAt:Date.now()};await Bt(k),y=!0}}if(!h){const w=new URL("/INF358_Project_Kriskogram/assets/State_to_State_Migrations_Table_2021-N7RTh5uH.csv",import.meta.url),v=await Sr(w.toString()),S=is(v),b={timestamp:2021,nodes:S.nodes,edges:S.edges},j=ln(b),k={id:t,name:"US State-to-State Migration (2021)",notes:"Real U.S. Census Bureau data showing migration flows between all 50 states from the American Community Survey 1-Year Estimates.",type:"csv",timeRange:{start:2021,end:2021},snapshots:[b],metadata:j,createdAt:Date.now()};await Bt(k)}if(!f){const w=new URL("/INF358_Project_Kriskogram/assets/sample-migration-data-Dify6Mt1.gexf",import.meta.url),v=await Wo(w.toString()),S=uo(v),b=S.length>0?ln(S[0]):void 0,j={id:s,name:"Sample Migration (GEXF)",notes:"AI-generated sample network dataset in GEXF format demonstrating temporal migration patterns with multiple time slices. This example dataset includes economic, geographic, and migration type attributes for demonstration purposes.",type:"gexf",timeRange:v.timeRange,snapshots:S,metadata:b,createdAt:Date.now()};await Bt(j)}if(!_){const w="/INF358_Project_Kriskogram/",v=`${w}data/Swiss_Relocations_2016_locations.csv`,S=`${w}data/Swiss_Relocations_2016_flows.csv`,b=await Sr(v),j=await Sr(S),k=fo({nodesFile:{content:b,idField:"id",labelField:"name"},edgesFile:{content:j,sourceField:"origin",targetField:"dest",valueField:"count"}}),R={timestamp:2016,nodes:k.nodes,edges:k.edges},U=ln(R),O={id:o,name:"Swiss Relocations (2016)",notes:"Relocations between Swiss cantons in 2016. This dataset contains 521,510 trips and uses a two-file CSV format with separate files for locations (cantons) and flows (relocations). Created by Ilya Boyandin.",type:"csv-two-file",timeRange:{start:2016,end:2016},snapshots:[R],metadata:U,createdAt:Date.now()};await Bt(O)}if(g)return e;if(y)return n;if(h)return t}function Mr(e,n){if(typeof e=="string"){const t=e.trim().toLowerCase();if(/^#([0-9a-f]{3}|[0-9a-f]{6})$/.test(t))return t.length===4?`#${t[1]}${t[1]}${t[2]}${t[2]}${t[3]}${t[3]}`:t}return n}export{gl as component};
