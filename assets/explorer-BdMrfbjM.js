import{c as An,r as y,j as r,s as _e,o as ps,a as jt,z as zs,i as Hs,C as Os,G as Gs,u as Us,b as Bs,d as qs,K as Ws,e as hs,f as Ks,p as _t,g as cn,n as Cn,h as Ys}from"./main-qFgti-j7.js";import{p as jn,l as qt}from"./csv-parser-BH7H656y.js";import{p as Xs,g as xs,l as Zs}from"./gexf-parser-ChiJebeW.js";import{S as Qs,a as Kn}from"./stateMigrationFiles-CyfipyKt.js";/**
 * @license lucide-react v0.476.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Js=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],er=An("ChevronDown",Js);/**
 * @license lucide-react v0.476.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tr=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],nr=An("ChevronUp",tr);/**
 * @license lucide-react v0.476.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sr=[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],Yn=An("Settings",sr);function rr(e,s){return e==null||s==null?NaN:s<e?-1:s>e?1:s>=e?0:NaN}var Xn=Math.abs,dn=Math.cos,gn=Math.sin,vs=Math.PI,Wt=vs/2,Zn=vs*2,Qn=Math.max,fn=1e-12;function Jn(e,s){return Array.from({length:s-e},(t,n)=>e+n)}function or(e){return function(s,t){return e(s.source.value+s.target.value,t.source.value+t.target.value)}}function ir(){return ar(!1)}function ar(e,s){var t=0,n=null,o=null,i=null;function l(a){var u=a.length,d=new Array(u),c=Jn(0,u),p=new Array(u*u),m=new Array(u),f=0,w;a=Float64Array.from({length:u*u},(S,b)=>a[b/u|0][b%u]);for(let S=0;S<u;++S){let b=0;for(let h=0;h<u;++h)b+=a[S*u+h]+e*a[h*u+S];f+=d[S]=b}f=Qn(0,Zn-t*u)/f,w=f?t:Zn/u;{let S=0;n&&c.sort((b,h)=>n(d[b],d[h]));for(const b of c){const h=S;{const v=Jn(0,u).filter(x=>a[b*u+x]||a[x*u+b]);o&&v.sort((x,_)=>o(a[b*u+x],a[b*u+_]));for(const x of v){let _;if(b<x?(_=p[b*u+x]||(p[b*u+x]={source:null,target:null}),_.source={index:b,startAngle:S,endAngle:S+=a[b*u+x]*f,value:a[b*u+x]}):(_=p[x*u+b]||(p[x*u+b]={source:null,target:null}),_.target={index:b,startAngle:S,endAngle:S+=a[b*u+x]*f,value:a[b*u+x]},b===x&&(_.source=_.target)),_.source&&_.target&&_.source.value<_.target.value){const N=_.source;_.source=_.target,_.target=N}}m[b]={index:b,startAngle:h,endAngle:S,value:d[b]}}S+=w}}return p=Object.values(p),p.groups=m,i?p.sort(i):p}return l.padAngle=function(a){return arguments.length?(t=Qn(0,a),l):t},l.sortGroups=function(a){return arguments.length?(n=a,l):n},l.sortSubgroups=function(a){return arguments.length?(o=a,l):o},l.sortChords=function(a){return arguments.length?(a==null?i=null:(i=or(a))._=a,l):i&&i._},l}const Nn=Math.PI,Rn=2*Nn,St=1e-6,lr=Rn-St;function ys(e){this._+=e[0];for(let s=1,t=e.length;s<t;++s)this._+=arguments[s]+e[s]}function ur(e){let s=Math.floor(e);if(!(s>=0))throw new Error(`invalid digits: ${e}`);if(s>15)return ys;const t=10**s;return function(n){this._+=n[0];for(let o=1,i=n.length;o<i;++o)this._+=Math.round(arguments[o]*t)/t+n[o]}}class Vn{constructor(s){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=s==null?ys:ur(s)}moveTo(s,t){this._append`M${this._x0=this._x1=+s},${this._y0=this._y1=+t}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(s,t){this._append`L${this._x1=+s},${this._y1=+t}`}quadraticCurveTo(s,t,n,o){this._append`Q${+s},${+t},${this._x1=+n},${this._y1=+o}`}bezierCurveTo(s,t,n,o,i,l){this._append`C${+s},${+t},${+n},${+o},${this._x1=+i},${this._y1=+l}`}arcTo(s,t,n,o,i){if(s=+s,t=+t,n=+n,o=+o,i=+i,i<0)throw new Error(`negative radius: ${i}`);let l=this._x1,a=this._y1,u=n-s,d=o-t,c=l-s,p=a-t,m=c*c+p*p;if(this._x1===null)this._append`M${this._x1=s},${this._y1=t}`;else if(m>St)if(!(Math.abs(p*u-d*c)>St)||!i)this._append`L${this._x1=s},${this._y1=t}`;else{let f=n-l,w=o-a,S=u*u+d*d,b=f*f+w*w,h=Math.sqrt(S),v=Math.sqrt(m),x=i*Math.tan((Nn-Math.acos((S+m-b)/(2*h*v)))/2),_=x/v,N=x/h;Math.abs(_-1)>St&&this._append`L${s+_*c},${t+_*p}`,this._append`A${i},${i},0,0,${+(p*f>c*w)},${this._x1=s+N*u},${this._y1=t+N*d}`}}arc(s,t,n,o,i,l){if(s=+s,t=+t,n=+n,l=!!l,n<0)throw new Error(`negative radius: ${n}`);let a=n*Math.cos(o),u=n*Math.sin(o),d=s+a,c=t+u,p=1^l,m=l?o-i:i-o;this._x1===null?this._append`M${d},${c}`:(Math.abs(this._x1-d)>St||Math.abs(this._y1-c)>St)&&this._append`L${d},${c}`,n&&(m<0&&(m=m%Rn+Rn),m>lr?this._append`A${n},${n},0,1,${p},${s-a},${t-u}A${n},${n},0,1,${p},${this._x1=d},${this._y1=c}`:m>St&&this._append`A${n},${n},0,${+(m>=Nn)},${p},${this._x1=s+n*Math.cos(i)},${this._y1=t+n*Math.sin(i)}`)}rect(s,t,n,o){this._append`M${this._x0=this._x1=+s},${this._y0=this._y1=+t}h${n=+n}v${+o}h${-n}Z`}toString(){return this._}}function kn(){return new Vn}kn.prototype=Vn.prototype;var cr=Array.prototype.slice;function Et(e){return function(){return e}}function dr(e){return e.source}function gr(e){return e.target}function es(e){return e.radius}function fr(e){return e.startAngle}function mr(e){return e.endAngle}function pr(){return 0}function hr(e){var s=dr,t=gr,n=es,o=es,i=fr,l=mr,a=pr,u=null;function d(){var c,p=s.apply(this,arguments),m=t.apply(this,arguments),f=a.apply(this,arguments)/2,w=cr.call(arguments),S=+n.apply(this,(w[0]=p,w)),b=i.apply(this,w)-Wt,h=l.apply(this,w)-Wt,v=+o.apply(this,(w[0]=m,w)),x=i.apply(this,w)-Wt,_=l.apply(this,w)-Wt;if(u||(u=c=kn()),f>fn&&(Xn(h-b)>f*2+fn?h>b?(b+=f,h-=f):(b-=f,h+=f):b=h=(b+h)/2,Xn(_-x)>f*2+fn?_>x?(x+=f,_-=f):(x-=f,_+=f):x=_=(x+_)/2),u.moveTo(S*dn(b),S*gn(b)),u.arc(0,0,S,b,h),(b!==x||h!==_)&&(u.quadraticCurveTo(0,0,v*dn(x),v*gn(x)),u.arc(0,0,v,x,_)),u.quadraticCurveTo(0,0,S*dn(b),S*gn(b)),u.closePath(),c)return u=null,c+""||null}return d.radius=function(c){return arguments.length?(n=o=typeof c=="function"?c:Et(+c),d):n},d.sourceRadius=function(c){return arguments.length?(n=typeof c=="function"?c:Et(+c),d):n},d.targetRadius=function(c){return arguments.length?(o=typeof c=="function"?c:Et(+c),d):o},d.startAngle=function(c){return arguments.length?(i=typeof c=="function"?c:Et(+c),d):i},d.endAngle=function(c){return arguments.length?(l=typeof c=="function"?c:Et(+c),d):l},d.padAngle=function(c){return arguments.length?(a=typeof c=="function"?c:Et(+c),d):a},d.source=function(c){return arguments.length?(s=c,d):s},d.target=function(c){return arguments.length?(t=c,d):t},d.context=function(c){return arguments.length?(u=c??null,d):u},d}function xr(){return hr()}function vr(e){for(var s=e.length/6|0,t=new Array(s),n=0;n<s;)t[n]="#"+e.slice(n*6,++n*6);return t}const bs=vr("1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf");function ct(e){return function(){return e}}const ts=Math.abs,Te=Math.atan2,wt=Math.cos,yr=Math.max,mn=Math.min,rt=Math.sin,At=Math.sqrt,Oe=1e-12,Tt=Math.PI,Jt=Tt/2,br=2*Tt;function wr(e){return e>1?0:e<-1?Tt:Math.acos(e)}function ns(e){return e>=1?Jt:e<=-1?-Jt:Math.asin(e)}function Sr(e){let s=3;return e.digits=function(t){if(!arguments.length)return s;if(t==null)s=null;else{const n=Math.floor(t);if(!(n>=0))throw new RangeError(`invalid digits: ${t}`);s=n}return e},()=>new Vn(s)}function _r(e){return e.innerRadius}function Cr(e){return e.outerRadius}function jr(e){return e.startAngle}function Nr(e){return e.endAngle}function Rr(e){return e&&e.padAngle}function Mr(e,s,t,n,o,i,l,a){var u=t-e,d=n-s,c=l-o,p=a-i,m=p*u-c*d;if(!(m*m<Oe))return m=(c*(s-i)-p*(e-o))/m,[e+m*u,s+m*d]}function Kt(e,s,t,n,o,i,l){var a=e-t,u=s-n,d=(l?i:-i)/At(a*a+u*u),c=d*u,p=-d*a,m=e+c,f=s+p,w=t+c,S=n+p,b=(m+w)/2,h=(f+S)/2,v=w-m,x=S-f,_=v*v+x*x,N=o-i,j=m*S-w*f,k=(x<0?-1:1)*At(yr(0,N*N*_-j*j)),I=(j*x-v*k)/_,P=(-j*v-x*k)/_,W=(j*x+v*k)/_,D=(-j*v+x*k)/_,Q=I-b,F=P-h,B=W-b,K=D-h;return Q*Q+F*F>B*B+K*K&&(I=W,P=D),{cx:I,cy:P,x01:-c,y01:-p,x11:I*(o/N-1),y11:P*(o/N-1)}}function Fr(){var e=_r,s=Cr,t=ct(0),n=null,o=jr,i=Nr,l=Rr,a=null,u=Sr(d);function d(){var c,p,m=+e.apply(this,arguments),f=+s.apply(this,arguments),w=o.apply(this,arguments)-Jt,S=i.apply(this,arguments)-Jt,b=ts(S-w),h=S>w;if(a||(a=c=u()),f<m&&(p=f,f=m,m=p),!(f>Oe))a.moveTo(0,0);else if(b>br-Oe)a.moveTo(f*wt(w),f*rt(w)),a.arc(0,0,f,w,S,!h),m>Oe&&(a.moveTo(m*wt(S),m*rt(S)),a.arc(0,0,m,S,w,h));else{var v=w,x=S,_=w,N=S,j=b,k=b,I=l.apply(this,arguments)/2,P=I>Oe&&(n?+n.apply(this,arguments):At(m*m+f*f)),W=mn(ts(f-m)/2,+t.apply(this,arguments)),D=W,Q=W,F,B;if(P>Oe){var K=ns(P/m*rt(I)),ue=ns(P/f*rt(I));(j-=K*2)>Oe?(K*=h?1:-1,_+=K,N-=K):(j=0,_=N=(w+S)/2),(k-=ue*2)>Oe?(ue*=h?1:-1,v+=ue,x-=ue):(k=0,v=x=(w+S)/2)}var re=f*wt(v),ye=f*rt(v),Fe=m*wt(N),C=m*rt(N);if(W>Oe){var L=f*wt(x),pe=f*rt(x),Ee=m*wt(_),Pe=m*rt(_),U;if(b<Tt)if(U=Mr(re,ye,Ee,Pe,L,pe,Fe,C)){var Ce=re-U[0],Y=ye-U[1],$e=L-U[0],Ve=pe-U[1],Ie=1/rt(wr((Ce*$e+Y*Ve)/(At(Ce*Ce+Y*Y)*At($e*$e+Ve*Ve)))/2),ke=At(U[0]*U[0]+U[1]*U[1]);D=mn(W,(m-ke)/(Ie-1)),Q=mn(W,(f-ke)/(Ie+1))}else D=Q=0}k>Oe?Q>Oe?(F=Kt(Ee,Pe,re,ye,f,Q,h),B=Kt(L,pe,Fe,C,f,Q,h),a.moveTo(F.cx+F.x01,F.cy+F.y01),Q<W?a.arc(F.cx,F.cy,Q,Te(F.y01,F.x01),Te(B.y01,B.x01),!h):(a.arc(F.cx,F.cy,Q,Te(F.y01,F.x01),Te(F.y11,F.x11),!h),a.arc(0,0,f,Te(F.cy+F.y11,F.cx+F.x11),Te(B.cy+B.y11,B.cx+B.x11),!h),a.arc(B.cx,B.cy,Q,Te(B.y11,B.x11),Te(B.y01,B.x01),!h))):(a.moveTo(re,ye),a.arc(0,0,f,v,x,!h)):a.moveTo(re,ye),!(m>Oe)||!(j>Oe)?a.lineTo(Fe,C):D>Oe?(F=Kt(Fe,C,L,pe,m,-D,h),B=Kt(re,ye,Ee,Pe,m,-D,h),a.lineTo(F.cx+F.x01,F.cy+F.y01),D<W?a.arc(F.cx,F.cy,D,Te(F.y01,F.x01),Te(B.y01,B.x01),!h):(a.arc(F.cx,F.cy,D,Te(F.y01,F.x01),Te(F.y11,F.x11),!h),a.arc(0,0,m,Te(F.cy+F.y11,F.cx+F.x11),Te(B.cy+B.y11,B.cx+B.x11),h),a.arc(B.cx,B.cy,D,Te(B.y11,B.x11),Te(B.y01,B.x01),!h))):a.arc(0,0,m,N,_,h)}if(a.closePath(),c)return a=null,c+""||null}return d.centroid=function(){var c=(+e.apply(this,arguments)+ +s.apply(this,arguments))/2,p=(+o.apply(this,arguments)+ +i.apply(this,arguments))/2-Tt/2;return[wt(p)*c,rt(p)*c]},d.innerRadius=function(c){return arguments.length?(e=typeof c=="function"?c:ct(+c),d):e},d.outerRadius=function(c){return arguments.length?(s=typeof c=="function"?c:ct(+c),d):s},d.cornerRadius=function(c){return arguments.length?(t=typeof c=="function"?c:ct(+c),d):t},d.padRadius=function(c){return arguments.length?(n=c==null?null:typeof c=="function"?c:ct(+c),d):n},d.startAngle=function(c){return arguments.length?(o=typeof c=="function"?c:ct(+c),d):o},d.endAngle=function(c){return arguments.length?(i=typeof c=="function"?c:ct(+c),d):i},d.padAngle=function(c){return arguments.length?(l=typeof c=="function"?c:ct(+c),d):l},d.context=function(c){return arguments.length?(a=c??null,d):a},d}const $r="/INF358_Project_Kriskogram/assets/state_to_state_migration_table_2022_t13_updated_2024_06_27_2022-D7hzY5-5.csv",Ir="/INF358_Project_Kriskogram/assets/state_to_state_migration_table_2023_t13_2023-Da-tSzHC.csv",Er="/INF358_Project_Kriskogram/assets/state_to_state_migrations_table_2005_2005-5D0dAV6T.csv",Pr="/INF358_Project_Kriskogram/assets/state_to_state_migrations_table_2005_2007_2005-2007-C2gBOjzD.csv",Ar="/INF358_Project_Kriskogram/assets/state_to_state_migrations_table_2005_2009_2005-2009-oSLcshdC.csv",Vr="/INF358_Project_Kriskogram/assets/state_to_state_migrations_table_2006_2006-C-EFanec.csv",kr="/INF358_Project_Kriskogram/assets/state_to_state_migrations_table_2006_2008_2006-2008-Cp1NRBpc.csv",Dr="/INF358_Project_Kriskogram/assets/state_to_state_migrations_table_2007_2007-BXoQRRMn.csv",Lr="/INF358_Project_Kriskogram/assets/state_to_state_migrations_table_2007_2009_2007-2009-Qdd3KwND.csv",Tr="/INF358_Project_Kriskogram/assets/state_to_state_migrations_table_2008_2008--00JWAqc.csv",zr="/INF358_Project_Kriskogram/assets/state_to_state_migrations_table_2009_2009-5yGj8NCd.csv",Hr="/INF358_Project_Kriskogram/assets/state_to_state_migrations_table_2010_2010-CSB90FrU.csv",Or="/INF358_Project_Kriskogram/assets/state_to_state_migrations_table_2011_2011-BzRnLs5h.csv",Gr="/INF358_Project_Kriskogram/assets/state_to_state_migrations_table_2012_2012-DrbWwk1R.csv",Ur="/INF358_Project_Kriskogram/assets/state_to_state_migrations_table_2013_2013-CTsYcw-F.csv",Br="/INF358_Project_Kriskogram/assets/state_to_state_migrations_table_2014_2014-D8ze7hKk.csv",qr="/INF358_Project_Kriskogram/assets/state_to_state_migrations_table_2015_2015-Sg6Ir2qO.csv",Wr="/INF358_Project_Kriskogram/assets/state_to_state_migrations_table_2016_2016-C26kP0Bk.csv",Kr="/INF358_Project_Kriskogram/assets/state_to_state_migrations_table_2017_2017-BNMbL_en.csv",Yr="/INF358_Project_Kriskogram/assets/state_to_state_migrations_table_2018_2018-DTnLPVgj.csv",Xr="/INF358_Project_Kriskogram/assets/state_to_state_migrations_table_2019_2019-Bd1nphS1.csv",Zr="/INF358_Project_Kriskogram/assets/State_to_State_Migrations_Table_2021-N7RTh5uH.csv";function Ct(e){const s=new Set,t=new Set,n=new Set,o=new Set,i=new Set,l=new Set;return e.nodes.forEach(a=>{Object.keys(a).forEach(u=>{if(u!=="id"&&u!=="label"){s.add(u);const d=a[u];typeof d=="number"?n.add(u):typeof d=="string"&&i.add(u)}})}),e.edges.forEach(a=>{Object.keys(a).forEach(u=>{if(u!=="source"&&u!=="target"&&u!=="value"){t.add(u);const d=a[u];typeof d=="number"?o.add(u):typeof d=="string"&&l.add(u)}})}),{nodeProperties:Array.from(s),edgeProperties:Array.from(t),hasNumericProperties:{nodes:Array.from(n),edges:Array.from(o)},hasCategoricalProperties:{nodes:Array.from(i),edges:Array.from(l)}}}const Qr="kriskogram-db",Jr=1,Qe="datasets";function zt(){return new Promise((e,s)=>{const t=indexedDB.open(Qr,Jr);t.onupgradeneeded=()=>{const n=t.result;n.objectStoreNames.contains(Qe)||n.createObjectStore(Qe,{keyPath:"id"})},t.onsuccess=()=>e(t.result),t.onerror=()=>s(t.error)})}async function gt(e){const s=await zt();return new Promise((t,n)=>{const o=s.transaction(Qe,"readwrite");o.objectStore(Qe).put(e),o.oncomplete=()=>t(),o.onerror=()=>n(o.error),o.onabort=()=>n(o.error)})}async function ft(e){const s=await zt();return new Promise((t,n)=>{const l=s.transaction(Qe,"readonly").objectStore(Qe).get(e);l.onsuccess=()=>t(l.result),l.onerror=()=>n(l.error)})}async function eo(){const e=await zt();return new Promise((s,t)=>{const i=e.transaction(Qe,"readonly").objectStore(Qe).getAll();i.onsuccess=()=>s(i.result||[]),i.onerror=()=>t(i.error)})}async function Mn(e){const s=await zt();return new Promise((t,n)=>{const o=s.transaction(Qe,"readwrite");o.objectStore(Qe).delete(e),o.oncomplete=()=>t(),o.onerror=()=>n(o.error)})}async function to(e){const s=await ft(e);if(!s)throw new Error(`Dataset ${e} not found`);const t={...s,id:`${s.type}-${Date.now()}`,name:`${s.name} (Copy)`,createdAt:Date.now()};return await gt(t),t}async function no(){const e=await zt();return new Promise((s,t)=>{const n=e.transaction(Qe,"readwrite");n.objectStore(Qe).clear(),n.oncomplete=()=>s(),n.onerror=()=>t(n.error)})}async function so(){if("storage"in navigator&&"persist"in navigator.storage)try{return await navigator.storage.persist()}catch{return!1}return!1}function ss(e){const s=[];let t="",n=!1;for(let o=0;o<e.length;o++){const i=e[o];i==='"'?n=!n:i===","&&!n?(s.push(t),t=""):t+=i}return s.push(t),s}function rs(e){const s=e.trim().split(`
`).filter(o=>o.trim());if(s.length===0)throw new Error("CSV file is empty");const t=ss(s[0]).map(o=>o.trim()),n=s.slice(1).map(ss);return{headers:t,rows:n}}function pn(e){const s=e.replace(/[",]/g,"").trim(),t=Number.parseFloat(s);return Number.isNaN(t)?s:t}function ws(e){var N;const{headers:s,rows:t}=rs(e.nodesFile.content),n=s.map(j=>j.toLowerCase().trim()),o=e.nodesFile.idField.toLowerCase().trim(),i=((N=e.nodesFile.labelField)==null?void 0:N.toLowerCase().trim())||o,l=n.indexOf(o),a=e.nodesFile.labelField?n.indexOf(i):l;if(l===-1)throw new Error(`ID field "${e.nodesFile.idField}" not found in nodes file. Available fields: ${s.join(", ")}`);const u=t.map(j=>{const k={id:String(j[l]||"").trim(),label:a>=0?String(j[a]||"").trim():String(j[l]||"").trim()},I=s[l],P=e.nodesFile.labelField?s[a]:I;return s.forEach((W,D)=>{var Q;if(W!==I&&W!==P){const F=((Q=j[D])==null?void 0:Q.trim())||"";k[W]=pn(F)}}),k}).filter(j=>j.id),d=new Map(u.map(j=>[j.id,j])),{headers:c,rows:p}=rs(e.edgesFile.content),m=c.map(j=>j.toLowerCase().trim()),f=e.edgesFile.sourceField.toLowerCase().trim(),w=e.edgesFile.targetField.toLowerCase().trim(),S=e.edgesFile.valueField.toLowerCase().trim(),b=m.indexOf(f),h=m.indexOf(w),v=m.indexOf(S);if(b===-1)throw new Error(`Source field "${e.edgesFile.sourceField}" not found in edges file. Available fields: ${c.join(", ")}`);if(h===-1)throw new Error(`Target field "${e.edgesFile.targetField}" not found in edges file. Available fields: ${c.join(", ")}`);if(v===-1)throw new Error(`Value field "${e.edgesFile.valueField}" not found in edges file. Available fields: ${c.join(", ")}`);const x=p.map(j=>{const k=String(j[b]||"").trim(),I=String(j[h]||"").trim(),P=String(j[v]||"").trim(),W=pn(P);if(!k||!I||typeof W!="number"||W<=0)return null;(!d.has(k)||!d.has(I))&&console.warn(`Edge references missing node: ${k} -> ${I}`);const D={source:k,target:I,value:W},Q=c[b],F=c[h],B=c[v];return c.forEach((K,ue)=>{var re;if(K!==Q&&K!==F&&K!==B){const ye=((re=j[ue])==null?void 0:re.trim())||"";D[K]=pn(ye)}}),D}).filter(j=>j!==null&&d.has(j.source)&&d.has(j.target)),_=new Set;return x.forEach(j=>{_.add(j.source),_.add(j.target)}),_.forEach(j=>{d.has(j)||u.push({id:j,label:j})}),{nodes:u,edges:x}}function ro({onClose:e,onImport:s,fileInputRef:t,onFilesSelected:n,existingFile:o}){const[i,l]=y.useState(""),[a,u]=y.useState(""),[d,c]=y.useState(!1),[p,m]=y.useState({}),[f,w]=y.useState(!1),[S,b]=y.useState(null),[h,v]=y.useState([]),[x,_]=y.useState([]),[N,j]=y.useState(null),k=y.useRef(null),I=y.useRef(null),[P,W]=y.useState(null),[D,Q]=y.useState(null),[F,B]=y.useState([]),[K,ue]=y.useState([]),[re,ye]=y.useState(""),[Fe,C]=y.useState(""),[L,pe]=y.useState(""),[Ee,Pe]=y.useState(""),[U,Ce]=y.useState(""),[Y,$e]=y.useState(null);function Ve(R){let $=R.replace(/\.(csv|gexf)$/i,"");return $=$.replace(/([a-z])([A-Z])/g,"$1 $2").replace(/[_-]/g," ").replace(/[^a-zA-Z0-9\s]/g," ").replace(/\s+/g," ").trim(),$.split(" ").map(H=>H.charAt(0).toUpperCase()+H.slice(1).toLowerCase()).join(" ")}y.useEffect(()=>{var R;if(o!=null&&o.parsedData){$e(o.parsedData);const $=((R=o.files[0])==null?void 0:R.name)||"";l(Ve($)),u(o.files.map(H=>H.name).join(", "))}},[o]),y.useEffect(()=>{var R;if(!o&&h.length>0){if(!i||i===Ve(((R=h[0])==null?void 0:R.name)||"")){const $=h[0].name;l(Ve($))}a||u(h.map($=>$.name).join(", "))}},[h]);function Ie(R){const $=[];let H="",oe=!1;for(let X=0;X<R.length;X++){const ie=R[X];ie==='"'?oe=!oe:ie===","&&!oe?($.push(H),H=""):H+=ie}return $.push(H),$}function ke(R){const $=R.trim().split(`
`);if($.length===0)return[];const H=$[0];return Ie(H).map(oe=>oe.trim().replace(/^"|"$/g,""))}async function ot(R){const $=Array.from(R.target.files||[]);if($.length===0)return;v($);const H=await Promise.all($.map(X=>X.text()));_(H);const oe=$[0].name.toLowerCase();if(oe.endsWith(".gexf")){j("gexf"),b("single");try{const X=Xs(H[0]),ie=xs(X);$e({nodes:ie.length>0?ie[0].nodes:[],edges:ie.length>0?ie[0].edges:[],timeRange:X.timeRange}),l($[0].name.replace(".gexf",""))}catch(X){m({general:X instanceof Error?X.message:"Failed to parse GEXF"})}}else if(oe.endsWith(".csv")){if(j("csv"),$.length===1){b("single");try{const X=jn(H[0]);$e({nodes:X.nodes,edges:X.edges,timeRange:{start:2021,end:2021}}),l($[0].name.replace(".csv",""))}catch{b("two-file");const ie=ke(H[0]);B(ie),ue(ie),W(0);const de=ie.find(je=>je.toLowerCase()==="id"||je.toLowerCase()==="node"||je.toLowerCase()==="name"),Ke=ie.find(je=>je.toLowerCase()==="source"||je.toLowerCase()==="origin"||je.toLowerCase()==="from"),it=ie.find(je=>je.toLowerCase()==="target"||je.toLowerCase()==="dest"||je.toLowerCase()==="destination"||je.toLowerCase()==="to"),Ge=ie.find(je=>je.toLowerCase()==="value"||je.toLowerCase()==="count"||je.toLowerCase()==="weight");de&&ye(de),Ke&&pe(Ke),it&&Pe(it),Ge&&Ce(Ge),m({general:"Could not parse as state migration format. Please select which file contains nodes and which contains edges."})}}else if($.length===2){b("two-file");const X=ke(H[0]),ie=ke(H[1]);B(X),ue(ie),W(0),Q(1);const de=X.find(Se=>Se.toLowerCase()==="id"),Ke=X.find(Se=>Se.toLowerCase()==="name"||Se.toLowerCase()==="label");de&&ye(de),Ke&&C(Ke);const it=ie.find(Se=>Se.toLowerCase()==="source"||Se.toLowerCase()==="origin"||Se.toLowerCase()==="from"),Ge=ie.find(Se=>Se.toLowerCase()==="target"||Se.toLowerCase()==="dest"||Se.toLowerCase()==="destination"||Se.toLowerCase()==="to"),je=ie.find(Se=>Se.toLowerCase()==="value"||Se.toLowerCase()==="count"||Se.toLowerCase()==="weight");it&&pe(it),Ge&&Pe(Ge),je&&Ce(je),Vt()}}t.current&&(t.current.value="")}function Vt(){if(P===null||D===null||!re||!L||!Ee||!U){m({general:"Please select all required fields"}),$e(null);return}try{const R=ws({nodesFile:{content:x[P],idField:re,labelField:Fe||re},edgesFile:{content:x[D],sourceField:L,targetField:Ee,valueField:U}});$e({nodes:R.nodes,edges:R.edges,timeRange:{start:2016,end:2016}}),m({})}catch(R){m({general:R instanceof Error?R.message:"Failed to parse two-file CSV"}),$e(null)}}y.useEffect(()=>{S==="two-file"&&P!==null&&D!==null&&Vt()},[re,Fe,L,Ee,U,P,D]);function ge(){const R={},$=[];if(i.trim()||(R.name="Dataset name is required"),S==="two-file"&&(P===null&&(R.nodesFile="Please select which file contains nodes"),D===null&&(R.edgesFile="Please select which file contains edges"),P!==null&&!re&&(R.nodeIdField="Please select the ID field for nodes"),D!==null&&!L&&(R.edgeSourceField="Please select the source field for edges"),D!==null&&!Ee&&(R.edgeTargetField="Please select the target field for edges"),D!==null&&!U&&(R.edgeValueField="Please select the value field for edges")),!Y)return R.general="Data parsing failed - please check file format and field selections",R;Y.nodes.length===0&&$.push("No nodes found in dataset"),Y.edges.length===0&&$.push("No edges found in dataset");const H=new Set(Y.nodes.map(X=>X.id));H.size!==Y.nodes.length&&$.push(`${Y.nodes.length-H.size} duplicate node IDs found`);const oe=Y.edges.filter(X=>!H.has(X.source)||!H.has(X.target));return oe.length>0&&$.push(`${oe.length} edges reference non-existent nodes`),$.length>0&&(R.summary=$.join("; ")),R}function nt(){p.name&&k.current?(k.current.scrollIntoView({behavior:"smooth",block:"center"}),k.current.focus()):p.summary&&I.current&&I.current.scrollIntoView({behavior:"smooth",block:"center"})}async function lt(){const R=ge();if(m(R),Object.keys(R).filter(H=>H!=="summary").length>0||!Y){setTimeout(()=>nt(),100);return}c(!0);try{const H=Y.timeRange||{start:2021,end:2021},oe={timestamp:H.start,nodes:Y.nodes,edges:Y.edges},X=Ct(oe),ie=[oe],de={name:i.trim(),filename:h.map(Ke=>Ke.name).join(", "),notes:a.trim()||void 0,type:S==="two-file"?"csv":N||"csv",timeRange:H,snapshots:ie,metadata:X};await s(de,{nodes:Y.nodes,edges:Y.edges,snapshots:ie,metadata:X})}catch(H){console.error("Import error:",H),m({general:H instanceof Error?H.message:"Failed to import dataset"}),c(!1),setTimeout(()=>nt(),100)}}return r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:r.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-4xl w-full mx-4 max-h-[90vh] flex flex-col",children:[r.jsxs("div",{className:"p-6 border-b flex items-center justify-between",children:[r.jsx("h2",{className:"text-2xl font-bold",children:"Import Dataset"}),r.jsx("button",{onClick:e,className:"text-gray-400 hover:text-gray-600 text-2xl",children:"×"})]}),r.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:r.jsxs("div",{className:"space-y-6",children:[!S&&r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Select Files ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsxs("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-6 text-center",children:[r.jsx("button",{onClick:()=>{var R;return(R=t.current)==null?void 0:R.click()},className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700",children:"Choose Files"}),r.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"Select 1 file (GEXF or CSV) or 2 files (CSV nodes + CSV edges)"}),r.jsx("input",{ref:t,type:"file",accept:".csv,.gexf",multiple:!0,onChange:ot,className:"hidden"})]})]}),h.length>0&&r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Selected Files"}),r.jsxs("div",{className:"space-y-2",children:[h.map((R,$)=>r.jsxs("div",{className:"flex items-center justify-between bg-gray-50 p-3 rounded",children:[r.jsx("span",{className:"text-sm",children:R.name}),r.jsx("button",{onClick:()=>{const H=[...h];H.splice($,1),v(H);const oe=[...x];oe.splice($,1),_(oe),S==="two-file"&&(P===$&&W(null),D===$&&Q(null),P&&P>$&&W(P-1),D&&D>$&&Q(D-1))},className:"text-red-600 text-sm hover:text-red-800",children:"Remove"})]},$)),r.jsx("button",{type:"button",onClick:()=>{const R=document.createElement("input");R.type="file",R.accept=".csv,.gexf",R.multiple=!0,R.onchange=async $=>{const H=$.target,oe=Array.from(H.files||[]);if(oe.length>0){const X=await Promise.all(oe.map(de=>de.text()));v([...h,...oe]),_([...x,...X]);const ie=[...h,...oe];ie.length===2&&ie.every(de=>de.name.toLowerCase().endsWith(".csv"))&&(b("two-file"),j("csv"))}},R.click()},className:"text-sm text-blue-600 hover:text-blue-800",children:"+ Add More Files"})]})]}),S==="two-file"&&h.length>0&&r.jsxs("div",{className:"border-t pt-4 space-y-4","data-file-select":!0,children:[r.jsx("h3",{className:"font-semibold",children:"Map Files and Fields"}),r.jsxs("div",{"data-field-select":!0,children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Nodes File (Locations) ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsxs("select",{value:P??"",onChange:R=>{const $=parseInt(R.target.value);W($);const H=ke(x[$]);B(H);const oe=H.find(X=>X.toLowerCase()==="id");if(oe&&ye(oe),p.nodesFile){const X={...p};delete X.nodesFile,m(X)}},className:`w-full px-3 py-2 border rounded-md ${p.nodesFile?"border-red-500":"border-gray-300"}`,children:[r.jsx("option",{value:"",children:"Select file..."}),h.map((R,$)=>r.jsx("option",{value:$,children:R.name},$))]}),p.nodesFile&&r.jsx("p",{className:"mt-1 text-sm text-red-600",children:p.nodesFile}),P!==null&&F.length>0&&r.jsxs("div",{className:"mt-2 space-y-2",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"ID Field *"}),r.jsxs("select",{value:re,onChange:R=>{if(ye(R.target.value),p.nodeIdField){const $={...p};delete $.nodeIdField,m($)}},className:`w-full px-2 py-1 border rounded text-sm ${p.nodeIdField?"border-red-500":"border-gray-300"}`,children:[r.jsx("option",{value:"",children:"Select field..."}),F.map(R=>r.jsx("option",{value:R,children:R},R))]}),p.nodeIdField&&r.jsx("p",{className:"mt-1 text-xs text-red-600",children:p.nodeIdField})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"Label Field (optional)"}),r.jsxs("select",{value:Fe,onChange:R=>C(R.target.value),className:"w-full px-2 py-1 border border-gray-300 rounded text-sm",children:[r.jsx("option",{value:"",children:"Use ID field"}),F.map(R=>r.jsx("option",{value:R,children:R},R))]})]})]})]}),r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Edges File (Flows) ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsxs("select",{value:D??"",onChange:R=>{const $=parseInt(R.target.value);Q($);const H=ke(x[$]);ue(H);const oe=H.find(de=>de.toLowerCase()==="source"||de.toLowerCase()==="origin"||de.toLowerCase()==="from"),X=H.find(de=>de.toLowerCase()==="target"||de.toLowerCase()==="dest"||de.toLowerCase()==="to"),ie=H.find(de=>de.toLowerCase()==="value"||de.toLowerCase()==="count"||de.toLowerCase()==="weight");if(oe&&pe(oe),X&&Pe(X),ie&&Ce(ie),p.edgesFile){const de={...p};delete de.edgesFile,m(de)}},className:`w-full px-3 py-2 border rounded-md ${p.edgesFile?"border-red-500":"border-gray-300"}`,children:[r.jsx("option",{value:"",children:"Select file..."}),h.map((R,$)=>r.jsx("option",{value:$,children:R.name},$))]}),p.edgesFile&&r.jsx("p",{className:"mt-1 text-sm text-red-600",children:p.edgesFile}),D!==null&&K.length>0&&r.jsxs("div",{className:"mt-2 space-y-2",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"Source Field *"}),r.jsxs("select",{value:L,onChange:R=>{if(pe(R.target.value),p.edgeSourceField){const $={...p};delete $.edgeSourceField,m($)}},className:`w-full px-2 py-1 border rounded text-sm ${p.edgeSourceField?"border-red-500":"border-gray-300"}`,children:[r.jsx("option",{value:"",children:"Select field..."}),K.map(R=>r.jsx("option",{value:R,children:R},R))]}),p.edgeSourceField&&r.jsx("p",{className:"mt-1 text-xs text-red-600",children:p.edgeSourceField})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"Target Field *"}),r.jsxs("select",{value:Ee,onChange:R=>{if(Pe(R.target.value),p.edgeTargetField){const $={...p};delete $.edgeTargetField,m($)}},className:`w-full px-2 py-1 border rounded text-sm ${p.edgeTargetField?"border-red-500":"border-gray-300"}`,children:[r.jsx("option",{value:"",children:"Select field..."}),K.map(R=>r.jsx("option",{value:R,children:R},R))]}),p.edgeTargetField&&r.jsx("p",{className:"mt-1 text-xs text-red-600",children:p.edgeTargetField})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"Value Field *"}),r.jsxs("select",{value:U,onChange:R=>{if(Ce(R.target.value),p.edgeValueField){const $={...p};delete $.edgeValueField,m($)}},className:`w-full px-2 py-1 border rounded text-sm ${p.edgeValueField?"border-red-500":"border-gray-300"}`,children:[r.jsx("option",{value:"",children:"Select field..."}),K.map(R=>r.jsx("option",{value:R,children:R},R))]}),p.edgeValueField&&r.jsx("p",{className:"mt-1 text-xs text-red-600",children:p.edgeValueField})]})]})]})]}),r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Dataset Name ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsx("input",{ref:k,type:"text",value:i,onChange:R=>{if(l(R.target.value),p.name){const $={...p};delete $.name,m($)}},className:`w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 ${p.name?"border-red-500 focus:ring-red-500":"border-gray-300 focus:ring-blue-500"}`,placeholder:"Enter a name for this dataset"}),p.name&&r.jsx("p",{className:"mt-1 text-sm text-red-600",children:p.name})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Notes (optional)"}),r.jsx("textarea",{value:a,onChange:R=>u(R.target.value),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Add any notes about this dataset..."})]}),p.general&&r.jsxs("div",{className:"bg-red-50 border border-red-200 rounded p-3",children:[r.jsx("h4",{className:"font-semibold text-red-800 mb-2",children:"Error:"}),r.jsx("p",{className:"text-sm text-red-700",children:p.general})]}),Y&&r.jsxs("div",{ref:I,className:"bg-blue-50 border border-blue-200 rounded p-3",children:[r.jsx("h4",{className:"font-semibold text-blue-800 mb-2",children:"Data Summary"}),r.jsxs("div",{className:"text-sm text-blue-700 space-y-1",children:[r.jsxs("div",{children:[r.jsx("span",{className:"font-medium",children:"Nodes:"})," ",Y.nodes.length]}),r.jsxs("div",{children:[r.jsx("span",{className:"font-medium",children:"Edges:"})," ",Y.edges.length]}),Y.timeRange&&r.jsxs("div",{children:[r.jsx("span",{className:"font-medium",children:"Time Range:"})," ",Y.timeRange.start,Y.timeRange.end!==Y.timeRange.start?` – ${Y.timeRange.end}`:""]}),Y.nodes.length>0&&r.jsxs("div",{className:"mt-2 text-xs",children:[r.jsx("span",{className:"font-medium",children:"Sample node properties:"})," ",Object.keys(Y.nodes[0]).slice(0,5).join(", "),Object.keys(Y.nodes[0]).length>5&&"..."]}),p.summary&&r.jsxs("div",{className:"mt-2 pt-2 border-t border-blue-300",children:[r.jsx("span",{className:"font-medium text-orange-700",children:"Warnings:"})," ",r.jsx("span",{className:"text-orange-600",children:p.summary})]})]})]})]})}),r.jsxs("div",{className:"p-6 border-t flex justify-end gap-3",children:[r.jsx("button",{onClick:e,type:"button",disabled:d,className:"px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50 disabled:opacity-50 cursor-pointer transition-colors",children:"Cancel"}),r.jsx("button",{onClick:lt,type:"button",disabled:d||(Object.keys(p).filter($=>$!=="summary").length>0||!Y),className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed cursor-pointer transition-colors",children:d?"Importing...":"Import Dataset"})]})]})})}/**
   * table-core
   *
   * Copyright (c) TanStack
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE.md file in the root directory of this source tree.
   *
   * @license MIT
   */function mt(e,s){return typeof e=="function"?e(s):e}function We(e,s){return t=>{s.setState(n=>({...n,[e]:mt(t,n[e])}))}}function en(e){return e instanceof Function}function oo(e){return Array.isArray(e)&&e.every(s=>typeof s=="number")}function io(e,s){const t=[],n=o=>{o.forEach(i=>{t.push(i);const l=s(i);l!=null&&l.length&&n(l)})};return n(e),t}function O(e,s,t){let n=[],o;return i=>{let l;t.key&&t.debug&&(l=Date.now());const a=e(i);if(!(a.length!==n.length||a.some((c,p)=>n[p]!==c)))return o;n=a;let d;if(t.key&&t.debug&&(d=Date.now()),o=s(...a),t==null||t.onChange==null||t.onChange(o),t.key&&t.debug&&t!=null&&t.debug()){const c=Math.round((Date.now()-l)*100)/100,p=Math.round((Date.now()-d)*100)/100,m=p/16,f=(w,S)=>{for(w=String(w);w.length<S;)w=" "+w;return w};console.info(`%c⏱ ${f(p,5)} /${f(c,5)} ms`,`
            font-size: .6rem;
            font-weight: bold;
            color: hsl(${Math.max(0,Math.min(120-120*m,120))}deg 100% 31%);`,t==null?void 0:t.key)}return o}}function G(e,s,t,n){return{debug:()=>{var o;return(o=e==null?void 0:e.debugAll)!=null?o:e[s]},key:!1,onChange:n}}function ao(e,s,t,n){const o=()=>{var l;return(l=i.getValue())!=null?l:e.options.renderFallbackValue},i={id:`${s.id}_${t.id}`,row:s,column:t,getValue:()=>s.getValue(n),renderValue:o,getContext:O(()=>[e,t,s,i],(l,a,u,d)=>({table:l,column:a,row:u,cell:d,getValue:d.getValue,renderValue:d.renderValue}),G(e.options,"debugCells"))};return e._features.forEach(l=>{l.createCell==null||l.createCell(i,t,s,e)},{}),i}function lo(e,s,t,n){var o,i;const a={...e._getDefaultColumnDef(),...s},u=a.accessorKey;let d=(o=(i=a.id)!=null?i:u?typeof String.prototype.replaceAll=="function"?u.replaceAll(".","_"):u.replace(/\./g,"_"):void 0)!=null?o:typeof a.header=="string"?a.header:void 0,c;if(a.accessorFn?c=a.accessorFn:u&&(u.includes(".")?c=m=>{let f=m;for(const S of u.split(".")){var w;f=(w=f)==null?void 0:w[S]}return f}:c=m=>m[a.accessorKey]),!d)throw new Error;let p={id:`${String(d)}`,accessorFn:c,parent:n,depth:t,columnDef:a,columns:[],getFlatColumns:O(()=>[!0],()=>{var m;return[p,...(m=p.columns)==null?void 0:m.flatMap(f=>f.getFlatColumns())]},G(e.options,"debugColumns")),getLeafColumns:O(()=>[e._getOrderColumnsFn()],m=>{var f;if((f=p.columns)!=null&&f.length){let w=p.columns.flatMap(S=>S.getLeafColumns());return m(w)}return[p]},G(e.options,"debugColumns"))};for(const m of e._features)m.createColumn==null||m.createColumn(p,e);return p}const ze="debugHeaders";function os(e,s,t){var n;let i={id:(n=t.id)!=null?n:s.id,column:s,index:t.index,isPlaceholder:!!t.isPlaceholder,placeholderId:t.placeholderId,depth:t.depth,subHeaders:[],colSpan:0,rowSpan:0,headerGroup:null,getLeafHeaders:()=>{const l=[],a=u=>{u.subHeaders&&u.subHeaders.length&&u.subHeaders.map(a),l.push(u)};return a(i),l},getContext:()=>({table:e,header:i,column:s})};return e._features.forEach(l=>{l.createHeader==null||l.createHeader(i,e)}),i}const uo={createTable:e=>{e.getHeaderGroups=O(()=>[e.getAllColumns(),e.getVisibleLeafColumns(),e.getState().columnPinning.left,e.getState().columnPinning.right],(s,t,n,o)=>{var i,l;const a=(i=n==null?void 0:n.map(p=>t.find(m=>m.id===p)).filter(Boolean))!=null?i:[],u=(l=o==null?void 0:o.map(p=>t.find(m=>m.id===p)).filter(Boolean))!=null?l:[],d=t.filter(p=>!(n!=null&&n.includes(p.id))&&!(o!=null&&o.includes(p.id)));return Yt(s,[...a,...d,...u],e)},G(e.options,ze)),e.getCenterHeaderGroups=O(()=>[e.getAllColumns(),e.getVisibleLeafColumns(),e.getState().columnPinning.left,e.getState().columnPinning.right],(s,t,n,o)=>(t=t.filter(i=>!(n!=null&&n.includes(i.id))&&!(o!=null&&o.includes(i.id))),Yt(s,t,e,"center")),G(e.options,ze)),e.getLeftHeaderGroups=O(()=>[e.getAllColumns(),e.getVisibleLeafColumns(),e.getState().columnPinning.left],(s,t,n)=>{var o;const i=(o=n==null?void 0:n.map(l=>t.find(a=>a.id===l)).filter(Boolean))!=null?o:[];return Yt(s,i,e,"left")},G(e.options,ze)),e.getRightHeaderGroups=O(()=>[e.getAllColumns(),e.getVisibleLeafColumns(),e.getState().columnPinning.right],(s,t,n)=>{var o;const i=(o=n==null?void 0:n.map(l=>t.find(a=>a.id===l)).filter(Boolean))!=null?o:[];return Yt(s,i,e,"right")},G(e.options,ze)),e.getFooterGroups=O(()=>[e.getHeaderGroups()],s=>[...s].reverse(),G(e.options,ze)),e.getLeftFooterGroups=O(()=>[e.getLeftHeaderGroups()],s=>[...s].reverse(),G(e.options,ze)),e.getCenterFooterGroups=O(()=>[e.getCenterHeaderGroups()],s=>[...s].reverse(),G(e.options,ze)),e.getRightFooterGroups=O(()=>[e.getRightHeaderGroups()],s=>[...s].reverse(),G(e.options,ze)),e.getFlatHeaders=O(()=>[e.getHeaderGroups()],s=>s.map(t=>t.headers).flat(),G(e.options,ze)),e.getLeftFlatHeaders=O(()=>[e.getLeftHeaderGroups()],s=>s.map(t=>t.headers).flat(),G(e.options,ze)),e.getCenterFlatHeaders=O(()=>[e.getCenterHeaderGroups()],s=>s.map(t=>t.headers).flat(),G(e.options,ze)),e.getRightFlatHeaders=O(()=>[e.getRightHeaderGroups()],s=>s.map(t=>t.headers).flat(),G(e.options,ze)),e.getCenterLeafHeaders=O(()=>[e.getCenterFlatHeaders()],s=>s.filter(t=>{var n;return!((n=t.subHeaders)!=null&&n.length)}),G(e.options,ze)),e.getLeftLeafHeaders=O(()=>[e.getLeftFlatHeaders()],s=>s.filter(t=>{var n;return!((n=t.subHeaders)!=null&&n.length)}),G(e.options,ze)),e.getRightLeafHeaders=O(()=>[e.getRightFlatHeaders()],s=>s.filter(t=>{var n;return!((n=t.subHeaders)!=null&&n.length)}),G(e.options,ze)),e.getLeafHeaders=O(()=>[e.getLeftHeaderGroups(),e.getCenterHeaderGroups(),e.getRightHeaderGroups()],(s,t,n)=>{var o,i,l,a,u,d;return[...(o=(i=s[0])==null?void 0:i.headers)!=null?o:[],...(l=(a=t[0])==null?void 0:a.headers)!=null?l:[],...(u=(d=n[0])==null?void 0:d.headers)!=null?u:[]].map(c=>c.getLeafHeaders()).flat()},G(e.options,ze))}};function Yt(e,s,t,n){var o,i;let l=0;const a=function(m,f){f===void 0&&(f=1),l=Math.max(l,f),m.filter(w=>w.getIsVisible()).forEach(w=>{var S;(S=w.columns)!=null&&S.length&&a(w.columns,f+1)},0)};a(e);let u=[];const d=(m,f)=>{const w={depth:f,id:[n,`${f}`].filter(Boolean).join("_"),headers:[]},S=[];m.forEach(b=>{const h=[...S].reverse()[0],v=b.column.depth===w.depth;let x,_=!1;if(v&&b.column.parent?x=b.column.parent:(x=b.column,_=!0),h&&(h==null?void 0:h.column)===x)h.subHeaders.push(b);else{const N=os(t,x,{id:[n,f,x.id,b==null?void 0:b.id].filter(Boolean).join("_"),isPlaceholder:_,placeholderId:_?`${S.filter(j=>j.column===x).length}`:void 0,depth:f,index:S.length});N.subHeaders.push(b),S.push(N)}w.headers.push(b),b.headerGroup=w}),u.push(w),f>0&&d(S,f-1)},c=s.map((m,f)=>os(t,m,{depth:l,index:f}));d(c,l-1),u.reverse();const p=m=>m.filter(w=>w.column.getIsVisible()).map(w=>{let S=0,b=0,h=[0];w.subHeaders&&w.subHeaders.length?(h=[],p(w.subHeaders).forEach(x=>{let{colSpan:_,rowSpan:N}=x;S+=_,h.push(N)})):S=1;const v=Math.min(...h);return b=b+v,w.colSpan=S,w.rowSpan=b,{colSpan:S,rowSpan:b}});return p((o=(i=u[0])==null?void 0:i.headers)!=null?o:[]),u}const co=(e,s,t,n,o,i,l)=>{let a={id:s,index:n,original:t,depth:o,parentId:l,_valuesCache:{},_uniqueValuesCache:{},getValue:u=>{if(a._valuesCache.hasOwnProperty(u))return a._valuesCache[u];const d=e.getColumn(u);if(d!=null&&d.accessorFn)return a._valuesCache[u]=d.accessorFn(a.original,n),a._valuesCache[u]},getUniqueValues:u=>{if(a._uniqueValuesCache.hasOwnProperty(u))return a._uniqueValuesCache[u];const d=e.getColumn(u);if(d!=null&&d.accessorFn)return d.columnDef.getUniqueValues?(a._uniqueValuesCache[u]=d.columnDef.getUniqueValues(a.original,n),a._uniqueValuesCache[u]):(a._uniqueValuesCache[u]=[a.getValue(u)],a._uniqueValuesCache[u])},renderValue:u=>{var d;return(d=a.getValue(u))!=null?d:e.options.renderFallbackValue},subRows:[],getLeafRows:()=>io(a.subRows,u=>u.subRows),getParentRow:()=>a.parentId?e.getRow(a.parentId,!0):void 0,getParentRows:()=>{let u=[],d=a;for(;;){const c=d.getParentRow();if(!c)break;u.push(c),d=c}return u.reverse()},getAllCells:O(()=>[e.getAllLeafColumns()],u=>u.map(d=>ao(e,a,d,d.id)),G(e.options,"debugRows")),_getAllCellsByColumnId:O(()=>[a.getAllCells()],u=>u.reduce((d,c)=>(d[c.column.id]=c,d),{}),G(e.options,"debugRows"))};for(let u=0;u<e._features.length;u++){const d=e._features[u];d==null||d.createRow==null||d.createRow(a,e)}return a},go={createColumn:(e,s)=>{e._getFacetedRowModel=s.options.getFacetedRowModel&&s.options.getFacetedRowModel(s,e.id),e.getFacetedRowModel=()=>e._getFacetedRowModel?e._getFacetedRowModel():s.getPreFilteredRowModel(),e._getFacetedUniqueValues=s.options.getFacetedUniqueValues&&s.options.getFacetedUniqueValues(s,e.id),e.getFacetedUniqueValues=()=>e._getFacetedUniqueValues?e._getFacetedUniqueValues():new Map,e._getFacetedMinMaxValues=s.options.getFacetedMinMaxValues&&s.options.getFacetedMinMaxValues(s,e.id),e.getFacetedMinMaxValues=()=>{if(e._getFacetedMinMaxValues)return e._getFacetedMinMaxValues()}}},Ss=(e,s,t)=>{var n,o;const i=t==null||(n=t.toString())==null?void 0:n.toLowerCase();return!!(!((o=e.getValue(s))==null||(o=o.toString())==null||(o=o.toLowerCase())==null)&&o.includes(i))};Ss.autoRemove=e=>tt(e);const _s=(e,s,t)=>{var n;return!!(!((n=e.getValue(s))==null||(n=n.toString())==null)&&n.includes(t))};_s.autoRemove=e=>tt(e);const Cs=(e,s,t)=>{var n;return((n=e.getValue(s))==null||(n=n.toString())==null?void 0:n.toLowerCase())===(t==null?void 0:t.toLowerCase())};Cs.autoRemove=e=>tt(e);const js=(e,s,t)=>{var n;return(n=e.getValue(s))==null?void 0:n.includes(t)};js.autoRemove=e=>tt(e);const Ns=(e,s,t)=>!t.some(n=>{var o;return!((o=e.getValue(s))!=null&&o.includes(n))});Ns.autoRemove=e=>tt(e)||!(e!=null&&e.length);const Rs=(e,s,t)=>t.some(n=>{var o;return(o=e.getValue(s))==null?void 0:o.includes(n)});Rs.autoRemove=e=>tt(e)||!(e!=null&&e.length);const Ms=(e,s,t)=>e.getValue(s)===t;Ms.autoRemove=e=>tt(e);const Fs=(e,s,t)=>e.getValue(s)==t;Fs.autoRemove=e=>tt(e);const Dn=(e,s,t)=>{let[n,o]=t;const i=e.getValue(s);return i>=n&&i<=o};Dn.resolveFilterValue=e=>{let[s,t]=e,n=typeof s!="number"?parseFloat(s):s,o=typeof t!="number"?parseFloat(t):t,i=s===null||Number.isNaN(n)?-1/0:n,l=t===null||Number.isNaN(o)?1/0:o;if(i>l){const a=i;i=l,l=a}return[i,l]};Dn.autoRemove=e=>tt(e)||tt(e[0])&&tt(e[1]);const at={includesString:Ss,includesStringSensitive:_s,equalsString:Cs,arrIncludes:js,arrIncludesAll:Ns,arrIncludesSome:Rs,equals:Ms,weakEquals:Fs,inNumberRange:Dn};function tt(e){return e==null||e===""}const fo={getDefaultColumnDef:()=>({filterFn:"auto"}),getInitialState:e=>({columnFilters:[],...e}),getDefaultOptions:e=>({onColumnFiltersChange:We("columnFilters",e),filterFromLeafRows:!1,maxLeafRowFilterDepth:100}),createColumn:(e,s)=>{e.getAutoFilterFn=()=>{const t=s.getCoreRowModel().flatRows[0],n=t==null?void 0:t.getValue(e.id);return typeof n=="string"?at.includesString:typeof n=="number"?at.inNumberRange:typeof n=="boolean"||n!==null&&typeof n=="object"?at.equals:Array.isArray(n)?at.arrIncludes:at.weakEquals},e.getFilterFn=()=>{var t,n;return en(e.columnDef.filterFn)?e.columnDef.filterFn:e.columnDef.filterFn==="auto"?e.getAutoFilterFn():(t=(n=s.options.filterFns)==null?void 0:n[e.columnDef.filterFn])!=null?t:at[e.columnDef.filterFn]},e.getCanFilter=()=>{var t,n,o;return((t=e.columnDef.enableColumnFilter)!=null?t:!0)&&((n=s.options.enableColumnFilters)!=null?n:!0)&&((o=s.options.enableFilters)!=null?o:!0)&&!!e.accessorFn},e.getIsFiltered=()=>e.getFilterIndex()>-1,e.getFilterValue=()=>{var t;return(t=s.getState().columnFilters)==null||(t=t.find(n=>n.id===e.id))==null?void 0:t.value},e.getFilterIndex=()=>{var t,n;return(t=(n=s.getState().columnFilters)==null?void 0:n.findIndex(o=>o.id===e.id))!=null?t:-1},e.setFilterValue=t=>{s.setColumnFilters(n=>{const o=e.getFilterFn(),i=n==null?void 0:n.find(c=>c.id===e.id),l=mt(t,i?i.value:void 0);if(is(o,l,e)){var a;return(a=n==null?void 0:n.filter(c=>c.id!==e.id))!=null?a:[]}const u={id:e.id,value:l};if(i){var d;return(d=n==null?void 0:n.map(c=>c.id===e.id?u:c))!=null?d:[]}return n!=null&&n.length?[...n,u]:[u]})}},createRow:(e,s)=>{e.columnFilters={},e.columnFiltersMeta={}},createTable:e=>{e.setColumnFilters=s=>{const t=e.getAllLeafColumns(),n=o=>{var i;return(i=mt(s,o))==null?void 0:i.filter(l=>{const a=t.find(u=>u.id===l.id);if(a){const u=a.getFilterFn();if(is(u,l.value,a))return!1}return!0})};e.options.onColumnFiltersChange==null||e.options.onColumnFiltersChange(n)},e.resetColumnFilters=s=>{var t,n;e.setColumnFilters(s?[]:(t=(n=e.initialState)==null?void 0:n.columnFilters)!=null?t:[])},e.getPreFilteredRowModel=()=>e.getCoreRowModel(),e.getFilteredRowModel=()=>(!e._getFilteredRowModel&&e.options.getFilteredRowModel&&(e._getFilteredRowModel=e.options.getFilteredRowModel(e)),e.options.manualFiltering||!e._getFilteredRowModel?e.getPreFilteredRowModel():e._getFilteredRowModel())}};function is(e,s,t){return(e&&e.autoRemove?e.autoRemove(s,t):!1)||typeof s>"u"||typeof s=="string"&&!s}const mo=(e,s,t)=>t.reduce((n,o)=>{const i=o.getValue(e);return n+(typeof i=="number"?i:0)},0),po=(e,s,t)=>{let n;return t.forEach(o=>{const i=o.getValue(e);i!=null&&(n>i||n===void 0&&i>=i)&&(n=i)}),n},ho=(e,s,t)=>{let n;return t.forEach(o=>{const i=o.getValue(e);i!=null&&(n<i||n===void 0&&i>=i)&&(n=i)}),n},xo=(e,s,t)=>{let n,o;return t.forEach(i=>{const l=i.getValue(e);l!=null&&(n===void 0?l>=l&&(n=o=l):(n>l&&(n=l),o<l&&(o=l)))}),[n,o]},vo=(e,s)=>{let t=0,n=0;if(s.forEach(o=>{let i=o.getValue(e);i!=null&&(i=+i)>=i&&(++t,n+=i)}),t)return n/t},yo=(e,s)=>{if(!s.length)return;const t=s.map(i=>i.getValue(e));if(!oo(t))return;if(t.length===1)return t[0];const n=Math.floor(t.length/2),o=t.sort((i,l)=>i-l);return t.length%2!==0?o[n]:(o[n-1]+o[n])/2},bo=(e,s)=>Array.from(new Set(s.map(t=>t.getValue(e))).values()),wo=(e,s)=>new Set(s.map(t=>t.getValue(e))).size,So=(e,s)=>s.length,hn={sum:mo,min:po,max:ho,extent:xo,mean:vo,median:yo,unique:bo,uniqueCount:wo,count:So},_o={getDefaultColumnDef:()=>({aggregatedCell:e=>{var s,t;return(s=(t=e.getValue())==null||t.toString==null?void 0:t.toString())!=null?s:null},aggregationFn:"auto"}),getInitialState:e=>({grouping:[],...e}),getDefaultOptions:e=>({onGroupingChange:We("grouping",e),groupedColumnMode:"reorder"}),createColumn:(e,s)=>{e.toggleGrouping=()=>{s.setGrouping(t=>t!=null&&t.includes(e.id)?t.filter(n=>n!==e.id):[...t??[],e.id])},e.getCanGroup=()=>{var t,n;return((t=e.columnDef.enableGrouping)!=null?t:!0)&&((n=s.options.enableGrouping)!=null?n:!0)&&(!!e.accessorFn||!!e.columnDef.getGroupingValue)},e.getIsGrouped=()=>{var t;return(t=s.getState().grouping)==null?void 0:t.includes(e.id)},e.getGroupedIndex=()=>{var t;return(t=s.getState().grouping)==null?void 0:t.indexOf(e.id)},e.getToggleGroupingHandler=()=>{const t=e.getCanGroup();return()=>{t&&e.toggleGrouping()}},e.getAutoAggregationFn=()=>{const t=s.getCoreRowModel().flatRows[0],n=t==null?void 0:t.getValue(e.id);if(typeof n=="number")return hn.sum;if(Object.prototype.toString.call(n)==="[object Date]")return hn.extent},e.getAggregationFn=()=>{var t,n;if(!e)throw new Error;return en(e.columnDef.aggregationFn)?e.columnDef.aggregationFn:e.columnDef.aggregationFn==="auto"?e.getAutoAggregationFn():(t=(n=s.options.aggregationFns)==null?void 0:n[e.columnDef.aggregationFn])!=null?t:hn[e.columnDef.aggregationFn]}},createTable:e=>{e.setGrouping=s=>e.options.onGroupingChange==null?void 0:e.options.onGroupingChange(s),e.resetGrouping=s=>{var t,n;e.setGrouping(s?[]:(t=(n=e.initialState)==null?void 0:n.grouping)!=null?t:[])},e.getPreGroupedRowModel=()=>e.getFilteredRowModel(),e.getGroupedRowModel=()=>(!e._getGroupedRowModel&&e.options.getGroupedRowModel&&(e._getGroupedRowModel=e.options.getGroupedRowModel(e)),e.options.manualGrouping||!e._getGroupedRowModel?e.getPreGroupedRowModel():e._getGroupedRowModel())},createRow:(e,s)=>{e.getIsGrouped=()=>!!e.groupingColumnId,e.getGroupingValue=t=>{if(e._groupingValuesCache.hasOwnProperty(t))return e._groupingValuesCache[t];const n=s.getColumn(t);return n!=null&&n.columnDef.getGroupingValue?(e._groupingValuesCache[t]=n.columnDef.getGroupingValue(e.original),e._groupingValuesCache[t]):e.getValue(t)},e._groupingValuesCache={}},createCell:(e,s,t,n)=>{e.getIsGrouped=()=>s.getIsGrouped()&&s.id===t.groupingColumnId,e.getIsPlaceholder=()=>!e.getIsGrouped()&&s.getIsGrouped(),e.getIsAggregated=()=>{var o;return!e.getIsGrouped()&&!e.getIsPlaceholder()&&!!((o=t.subRows)!=null&&o.length)}}};function Co(e,s,t){if(!(s!=null&&s.length)||!t)return e;const n=e.filter(i=>!s.includes(i.id));return t==="remove"?n:[...s.map(i=>e.find(l=>l.id===i)).filter(Boolean),...n]}const jo={getInitialState:e=>({columnOrder:[],...e}),getDefaultOptions:e=>({onColumnOrderChange:We("columnOrder",e)}),createColumn:(e,s)=>{e.getIndex=O(t=>[Lt(s,t)],t=>t.findIndex(n=>n.id===e.id),G(s.options,"debugColumns")),e.getIsFirstColumn=t=>{var n;return((n=Lt(s,t)[0])==null?void 0:n.id)===e.id},e.getIsLastColumn=t=>{var n;const o=Lt(s,t);return((n=o[o.length-1])==null?void 0:n.id)===e.id}},createTable:e=>{e.setColumnOrder=s=>e.options.onColumnOrderChange==null?void 0:e.options.onColumnOrderChange(s),e.resetColumnOrder=s=>{var t;e.setColumnOrder(s?[]:(t=e.initialState.columnOrder)!=null?t:[])},e._getOrderColumnsFn=O(()=>[e.getState().columnOrder,e.getState().grouping,e.options.groupedColumnMode],(s,t,n)=>o=>{let i=[];if(!(s!=null&&s.length))i=o;else{const l=[...s],a=[...o];for(;a.length&&l.length;){const u=l.shift(),d=a.findIndex(c=>c.id===u);d>-1&&i.push(a.splice(d,1)[0])}i=[...i,...a]}return Co(i,t,n)},G(e.options,"debugTable"))}},xn=()=>({left:[],right:[]}),No={getInitialState:e=>({columnPinning:xn(),...e}),getDefaultOptions:e=>({onColumnPinningChange:We("columnPinning",e)}),createColumn:(e,s)=>{e.pin=t=>{const n=e.getLeafColumns().map(o=>o.id).filter(Boolean);s.setColumnPinning(o=>{var i,l;if(t==="right"){var a,u;return{left:((a=o==null?void 0:o.left)!=null?a:[]).filter(p=>!(n!=null&&n.includes(p))),right:[...((u=o==null?void 0:o.right)!=null?u:[]).filter(p=>!(n!=null&&n.includes(p))),...n]}}if(t==="left"){var d,c;return{left:[...((d=o==null?void 0:o.left)!=null?d:[]).filter(p=>!(n!=null&&n.includes(p))),...n],right:((c=o==null?void 0:o.right)!=null?c:[]).filter(p=>!(n!=null&&n.includes(p)))}}return{left:((i=o==null?void 0:o.left)!=null?i:[]).filter(p=>!(n!=null&&n.includes(p))),right:((l=o==null?void 0:o.right)!=null?l:[]).filter(p=>!(n!=null&&n.includes(p)))}})},e.getCanPin=()=>e.getLeafColumns().some(n=>{var o,i,l;return((o=n.columnDef.enablePinning)!=null?o:!0)&&((i=(l=s.options.enableColumnPinning)!=null?l:s.options.enablePinning)!=null?i:!0)}),e.getIsPinned=()=>{const t=e.getLeafColumns().map(a=>a.id),{left:n,right:o}=s.getState().columnPinning,i=t.some(a=>n==null?void 0:n.includes(a)),l=t.some(a=>o==null?void 0:o.includes(a));return i?"left":l?"right":!1},e.getPinnedIndex=()=>{var t,n;const o=e.getIsPinned();return o?(t=(n=s.getState().columnPinning)==null||(n=n[o])==null?void 0:n.indexOf(e.id))!=null?t:-1:0}},createRow:(e,s)=>{e.getCenterVisibleCells=O(()=>[e._getAllVisibleCells(),s.getState().columnPinning.left,s.getState().columnPinning.right],(t,n,o)=>{const i=[...n??[],...o??[]];return t.filter(l=>!i.includes(l.column.id))},G(s.options,"debugRows")),e.getLeftVisibleCells=O(()=>[e._getAllVisibleCells(),s.getState().columnPinning.left],(t,n)=>(n??[]).map(i=>t.find(l=>l.column.id===i)).filter(Boolean).map(i=>({...i,position:"left"})),G(s.options,"debugRows")),e.getRightVisibleCells=O(()=>[e._getAllVisibleCells(),s.getState().columnPinning.right],(t,n)=>(n??[]).map(i=>t.find(l=>l.column.id===i)).filter(Boolean).map(i=>({...i,position:"right"})),G(s.options,"debugRows"))},createTable:e=>{e.setColumnPinning=s=>e.options.onColumnPinningChange==null?void 0:e.options.onColumnPinningChange(s),e.resetColumnPinning=s=>{var t,n;return e.setColumnPinning(s?xn():(t=(n=e.initialState)==null?void 0:n.columnPinning)!=null?t:xn())},e.getIsSomeColumnsPinned=s=>{var t;const n=e.getState().columnPinning;if(!s){var o,i;return!!((o=n.left)!=null&&o.length||(i=n.right)!=null&&i.length)}return!!((t=n[s])!=null&&t.length)},e.getLeftLeafColumns=O(()=>[e.getAllLeafColumns(),e.getState().columnPinning.left],(s,t)=>(t??[]).map(n=>s.find(o=>o.id===n)).filter(Boolean),G(e.options,"debugColumns")),e.getRightLeafColumns=O(()=>[e.getAllLeafColumns(),e.getState().columnPinning.right],(s,t)=>(t??[]).map(n=>s.find(o=>o.id===n)).filter(Boolean),G(e.options,"debugColumns")),e.getCenterLeafColumns=O(()=>[e.getAllLeafColumns(),e.getState().columnPinning.left,e.getState().columnPinning.right],(s,t,n)=>{const o=[...t??[],...n??[]];return s.filter(i=>!o.includes(i.id))},G(e.options,"debugColumns"))}};function Ro(e){return e||(typeof document<"u"?document:null)}const Xt={size:150,minSize:20,maxSize:Number.MAX_SAFE_INTEGER},vn=()=>({startOffset:null,startSize:null,deltaOffset:null,deltaPercentage:null,isResizingColumn:!1,columnSizingStart:[]}),Mo={getDefaultColumnDef:()=>Xt,getInitialState:e=>({columnSizing:{},columnSizingInfo:vn(),...e}),getDefaultOptions:e=>({columnResizeMode:"onEnd",columnResizeDirection:"ltr",onColumnSizingChange:We("columnSizing",e),onColumnSizingInfoChange:We("columnSizingInfo",e)}),createColumn:(e,s)=>{e.getSize=()=>{var t,n,o;const i=s.getState().columnSizing[e.id];return Math.min(Math.max((t=e.columnDef.minSize)!=null?t:Xt.minSize,(n=i??e.columnDef.size)!=null?n:Xt.size),(o=e.columnDef.maxSize)!=null?o:Xt.maxSize)},e.getStart=O(t=>[t,Lt(s,t),s.getState().columnSizing],(t,n)=>n.slice(0,e.getIndex(t)).reduce((o,i)=>o+i.getSize(),0),G(s.options,"debugColumns")),e.getAfter=O(t=>[t,Lt(s,t),s.getState().columnSizing],(t,n)=>n.slice(e.getIndex(t)+1).reduce((o,i)=>o+i.getSize(),0),G(s.options,"debugColumns")),e.resetSize=()=>{s.setColumnSizing(t=>{let{[e.id]:n,...o}=t;return o})},e.getCanResize=()=>{var t,n;return((t=e.columnDef.enableResizing)!=null?t:!0)&&((n=s.options.enableColumnResizing)!=null?n:!0)},e.getIsResizing=()=>s.getState().columnSizingInfo.isResizingColumn===e.id},createHeader:(e,s)=>{e.getSize=()=>{let t=0;const n=o=>{if(o.subHeaders.length)o.subHeaders.forEach(n);else{var i;t+=(i=o.column.getSize())!=null?i:0}};return n(e),t},e.getStart=()=>{if(e.index>0){const t=e.headerGroup.headers[e.index-1];return t.getStart()+t.getSize()}return 0},e.getResizeHandler=t=>{const n=s.getColumn(e.column.id),o=n==null?void 0:n.getCanResize();return i=>{if(!n||!o||(i.persist==null||i.persist(),yn(i)&&i.touches&&i.touches.length>1))return;const l=e.getSize(),a=e?e.getLeafHeaders().map(h=>[h.column.id,h.column.getSize()]):[[n.id,n.getSize()]],u=yn(i)?Math.round(i.touches[0].clientX):i.clientX,d={},c=(h,v)=>{typeof v=="number"&&(s.setColumnSizingInfo(x=>{var _,N;const j=s.options.columnResizeDirection==="rtl"?-1:1,k=(v-((_=x==null?void 0:x.startOffset)!=null?_:0))*j,I=Math.max(k/((N=x==null?void 0:x.startSize)!=null?N:0),-.999999);return x.columnSizingStart.forEach(P=>{let[W,D]=P;d[W]=Math.round(Math.max(D+D*I,0)*100)/100}),{...x,deltaOffset:k,deltaPercentage:I}}),(s.options.columnResizeMode==="onChange"||h==="end")&&s.setColumnSizing(x=>({...x,...d})))},p=h=>c("move",h),m=h=>{c("end",h),s.setColumnSizingInfo(v=>({...v,isResizingColumn:!1,startOffset:null,startSize:null,deltaOffset:null,deltaPercentage:null,columnSizingStart:[]}))},f=Ro(t),w={moveHandler:h=>p(h.clientX),upHandler:h=>{f==null||f.removeEventListener("mousemove",w.moveHandler),f==null||f.removeEventListener("mouseup",w.upHandler),m(h.clientX)}},S={moveHandler:h=>(h.cancelable&&(h.preventDefault(),h.stopPropagation()),p(h.touches[0].clientX),!1),upHandler:h=>{var v;f==null||f.removeEventListener("touchmove",S.moveHandler),f==null||f.removeEventListener("touchend",S.upHandler),h.cancelable&&(h.preventDefault(),h.stopPropagation()),m((v=h.touches[0])==null?void 0:v.clientX)}},b=Fo()?{passive:!1}:!1;yn(i)?(f==null||f.addEventListener("touchmove",S.moveHandler,b),f==null||f.addEventListener("touchend",S.upHandler,b)):(f==null||f.addEventListener("mousemove",w.moveHandler,b),f==null||f.addEventListener("mouseup",w.upHandler,b)),s.setColumnSizingInfo(h=>({...h,startOffset:u,startSize:l,deltaOffset:0,deltaPercentage:0,columnSizingStart:a,isResizingColumn:n.id}))}}},createTable:e=>{e.setColumnSizing=s=>e.options.onColumnSizingChange==null?void 0:e.options.onColumnSizingChange(s),e.setColumnSizingInfo=s=>e.options.onColumnSizingInfoChange==null?void 0:e.options.onColumnSizingInfoChange(s),e.resetColumnSizing=s=>{var t;e.setColumnSizing(s?{}:(t=e.initialState.columnSizing)!=null?t:{})},e.resetHeaderSizeInfo=s=>{var t;e.setColumnSizingInfo(s?vn():(t=e.initialState.columnSizingInfo)!=null?t:vn())},e.getTotalSize=()=>{var s,t;return(s=(t=e.getHeaderGroups()[0])==null?void 0:t.headers.reduce((n,o)=>n+o.getSize(),0))!=null?s:0},e.getLeftTotalSize=()=>{var s,t;return(s=(t=e.getLeftHeaderGroups()[0])==null?void 0:t.headers.reduce((n,o)=>n+o.getSize(),0))!=null?s:0},e.getCenterTotalSize=()=>{var s,t;return(s=(t=e.getCenterHeaderGroups()[0])==null?void 0:t.headers.reduce((n,o)=>n+o.getSize(),0))!=null?s:0},e.getRightTotalSize=()=>{var s,t;return(s=(t=e.getRightHeaderGroups()[0])==null?void 0:t.headers.reduce((n,o)=>n+o.getSize(),0))!=null?s:0}}};let Zt=null;function Fo(){if(typeof Zt=="boolean")return Zt;let e=!1;try{const s={get passive(){return e=!0,!1}},t=()=>{};window.addEventListener("test",t,s),window.removeEventListener("test",t)}catch{e=!1}return Zt=e,Zt}function yn(e){return e.type==="touchstart"}const $o={getInitialState:e=>({columnVisibility:{},...e}),getDefaultOptions:e=>({onColumnVisibilityChange:We("columnVisibility",e)}),createColumn:(e,s)=>{e.toggleVisibility=t=>{e.getCanHide()&&s.setColumnVisibility(n=>({...n,[e.id]:t??!e.getIsVisible()}))},e.getIsVisible=()=>{var t,n;const o=e.columns;return(t=o.length?o.some(i=>i.getIsVisible()):(n=s.getState().columnVisibility)==null?void 0:n[e.id])!=null?t:!0},e.getCanHide=()=>{var t,n;return((t=e.columnDef.enableHiding)!=null?t:!0)&&((n=s.options.enableHiding)!=null?n:!0)},e.getToggleVisibilityHandler=()=>t=>{e.toggleVisibility==null||e.toggleVisibility(t.target.checked)}},createRow:(e,s)=>{e._getAllVisibleCells=O(()=>[e.getAllCells(),s.getState().columnVisibility],t=>t.filter(n=>n.column.getIsVisible()),G(s.options,"debugRows")),e.getVisibleCells=O(()=>[e.getLeftVisibleCells(),e.getCenterVisibleCells(),e.getRightVisibleCells()],(t,n,o)=>[...t,...n,...o],G(s.options,"debugRows"))},createTable:e=>{const s=(t,n)=>O(()=>[n(),n().filter(o=>o.getIsVisible()).map(o=>o.id).join("_")],o=>o.filter(i=>i.getIsVisible==null?void 0:i.getIsVisible()),G(e.options,"debugColumns"));e.getVisibleFlatColumns=s("getVisibleFlatColumns",()=>e.getAllFlatColumns()),e.getVisibleLeafColumns=s("getVisibleLeafColumns",()=>e.getAllLeafColumns()),e.getLeftVisibleLeafColumns=s("getLeftVisibleLeafColumns",()=>e.getLeftLeafColumns()),e.getRightVisibleLeafColumns=s("getRightVisibleLeafColumns",()=>e.getRightLeafColumns()),e.getCenterVisibleLeafColumns=s("getCenterVisibleLeafColumns",()=>e.getCenterLeafColumns()),e.setColumnVisibility=t=>e.options.onColumnVisibilityChange==null?void 0:e.options.onColumnVisibilityChange(t),e.resetColumnVisibility=t=>{var n;e.setColumnVisibility(t?{}:(n=e.initialState.columnVisibility)!=null?n:{})},e.toggleAllColumnsVisible=t=>{var n;t=(n=t)!=null?n:!e.getIsAllColumnsVisible(),e.setColumnVisibility(e.getAllLeafColumns().reduce((o,i)=>({...o,[i.id]:t||!(i.getCanHide!=null&&i.getCanHide())}),{}))},e.getIsAllColumnsVisible=()=>!e.getAllLeafColumns().some(t=>!(t.getIsVisible!=null&&t.getIsVisible())),e.getIsSomeColumnsVisible=()=>e.getAllLeafColumns().some(t=>t.getIsVisible==null?void 0:t.getIsVisible()),e.getToggleAllColumnsVisibilityHandler=()=>t=>{var n;e.toggleAllColumnsVisible((n=t.target)==null?void 0:n.checked)}}};function Lt(e,s){return s?s==="center"?e.getCenterVisibleLeafColumns():s==="left"?e.getLeftVisibleLeafColumns():e.getRightVisibleLeafColumns():e.getVisibleLeafColumns()}const Io={createTable:e=>{e._getGlobalFacetedRowModel=e.options.getFacetedRowModel&&e.options.getFacetedRowModel(e,"__global__"),e.getGlobalFacetedRowModel=()=>e.options.manualFiltering||!e._getGlobalFacetedRowModel?e.getPreFilteredRowModel():e._getGlobalFacetedRowModel(),e._getGlobalFacetedUniqueValues=e.options.getFacetedUniqueValues&&e.options.getFacetedUniqueValues(e,"__global__"),e.getGlobalFacetedUniqueValues=()=>e._getGlobalFacetedUniqueValues?e._getGlobalFacetedUniqueValues():new Map,e._getGlobalFacetedMinMaxValues=e.options.getFacetedMinMaxValues&&e.options.getFacetedMinMaxValues(e,"__global__"),e.getGlobalFacetedMinMaxValues=()=>{if(e._getGlobalFacetedMinMaxValues)return e._getGlobalFacetedMinMaxValues()}}},Eo={getInitialState:e=>({globalFilter:void 0,...e}),getDefaultOptions:e=>({onGlobalFilterChange:We("globalFilter",e),globalFilterFn:"auto",getColumnCanGlobalFilter:s=>{var t;const n=(t=e.getCoreRowModel().flatRows[0])==null||(t=t._getAllCellsByColumnId()[s.id])==null?void 0:t.getValue();return typeof n=="string"||typeof n=="number"}}),createColumn:(e,s)=>{e.getCanGlobalFilter=()=>{var t,n,o,i;return((t=e.columnDef.enableGlobalFilter)!=null?t:!0)&&((n=s.options.enableGlobalFilter)!=null?n:!0)&&((o=s.options.enableFilters)!=null?o:!0)&&((i=s.options.getColumnCanGlobalFilter==null?void 0:s.options.getColumnCanGlobalFilter(e))!=null?i:!0)&&!!e.accessorFn}},createTable:e=>{e.getGlobalAutoFilterFn=()=>at.includesString,e.getGlobalFilterFn=()=>{var s,t;const{globalFilterFn:n}=e.options;return en(n)?n:n==="auto"?e.getGlobalAutoFilterFn():(s=(t=e.options.filterFns)==null?void 0:t[n])!=null?s:at[n]},e.setGlobalFilter=s=>{e.options.onGlobalFilterChange==null||e.options.onGlobalFilterChange(s)},e.resetGlobalFilter=s=>{e.setGlobalFilter(s?void 0:e.initialState.globalFilter)}}},Po={getInitialState:e=>({expanded:{},...e}),getDefaultOptions:e=>({onExpandedChange:We("expanded",e),paginateExpandedRows:!0}),createTable:e=>{let s=!1,t=!1;e._autoResetExpanded=()=>{var n,o;if(!s){e._queue(()=>{s=!0});return}if((n=(o=e.options.autoResetAll)!=null?o:e.options.autoResetExpanded)!=null?n:!e.options.manualExpanding){if(t)return;t=!0,e._queue(()=>{e.resetExpanded(),t=!1})}},e.setExpanded=n=>e.options.onExpandedChange==null?void 0:e.options.onExpandedChange(n),e.toggleAllRowsExpanded=n=>{n??!e.getIsAllRowsExpanded()?e.setExpanded(!0):e.setExpanded({})},e.resetExpanded=n=>{var o,i;e.setExpanded(n?{}:(o=(i=e.initialState)==null?void 0:i.expanded)!=null?o:{})},e.getCanSomeRowsExpand=()=>e.getPrePaginationRowModel().flatRows.some(n=>n.getCanExpand()),e.getToggleAllRowsExpandedHandler=()=>n=>{n.persist==null||n.persist(),e.toggleAllRowsExpanded()},e.getIsSomeRowsExpanded=()=>{const n=e.getState().expanded;return n===!0||Object.values(n).some(Boolean)},e.getIsAllRowsExpanded=()=>{const n=e.getState().expanded;return typeof n=="boolean"?n===!0:!(!Object.keys(n).length||e.getRowModel().flatRows.some(o=>!o.getIsExpanded()))},e.getExpandedDepth=()=>{let n=0;return(e.getState().expanded===!0?Object.keys(e.getRowModel().rowsById):Object.keys(e.getState().expanded)).forEach(i=>{const l=i.split(".");n=Math.max(n,l.length)}),n},e.getPreExpandedRowModel=()=>e.getSortedRowModel(),e.getExpandedRowModel=()=>(!e._getExpandedRowModel&&e.options.getExpandedRowModel&&(e._getExpandedRowModel=e.options.getExpandedRowModel(e)),e.options.manualExpanding||!e._getExpandedRowModel?e.getPreExpandedRowModel():e._getExpandedRowModel())},createRow:(e,s)=>{e.toggleExpanded=t=>{s.setExpanded(n=>{var o;const i=n===!0?!0:!!(n!=null&&n[e.id]);let l={};if(n===!0?Object.keys(s.getRowModel().rowsById).forEach(a=>{l[a]=!0}):l=n,t=(o=t)!=null?o:!i,!i&&t)return{...l,[e.id]:!0};if(i&&!t){const{[e.id]:a,...u}=l;return u}return n})},e.getIsExpanded=()=>{var t;const n=s.getState().expanded;return!!((t=s.options.getIsRowExpanded==null?void 0:s.options.getIsRowExpanded(e))!=null?t:n===!0||n!=null&&n[e.id])},e.getCanExpand=()=>{var t,n,o;return(t=s.options.getRowCanExpand==null?void 0:s.options.getRowCanExpand(e))!=null?t:((n=s.options.enableExpanding)!=null?n:!0)&&!!((o=e.subRows)!=null&&o.length)},e.getIsAllParentsExpanded=()=>{let t=!0,n=e;for(;t&&n.parentId;)n=s.getRow(n.parentId,!0),t=n.getIsExpanded();return t},e.getToggleExpandedHandler=()=>{const t=e.getCanExpand();return()=>{t&&e.toggleExpanded()}}}},Fn=0,$n=10,bn=()=>({pageIndex:Fn,pageSize:$n}),Ao={getInitialState:e=>({...e,pagination:{...bn(),...e==null?void 0:e.pagination}}),getDefaultOptions:e=>({onPaginationChange:We("pagination",e)}),createTable:e=>{let s=!1,t=!1;e._autoResetPageIndex=()=>{var n,o;if(!s){e._queue(()=>{s=!0});return}if((n=(o=e.options.autoResetAll)!=null?o:e.options.autoResetPageIndex)!=null?n:!e.options.manualPagination){if(t)return;t=!0,e._queue(()=>{e.resetPageIndex(),t=!1})}},e.setPagination=n=>{const o=i=>mt(n,i);return e.options.onPaginationChange==null?void 0:e.options.onPaginationChange(o)},e.resetPagination=n=>{var o;e.setPagination(n?bn():(o=e.initialState.pagination)!=null?o:bn())},e.setPageIndex=n=>{e.setPagination(o=>{let i=mt(n,o.pageIndex);const l=typeof e.options.pageCount>"u"||e.options.pageCount===-1?Number.MAX_SAFE_INTEGER:e.options.pageCount-1;return i=Math.max(0,Math.min(i,l)),{...o,pageIndex:i}})},e.resetPageIndex=n=>{var o,i;e.setPageIndex(n?Fn:(o=(i=e.initialState)==null||(i=i.pagination)==null?void 0:i.pageIndex)!=null?o:Fn)},e.resetPageSize=n=>{var o,i;e.setPageSize(n?$n:(o=(i=e.initialState)==null||(i=i.pagination)==null?void 0:i.pageSize)!=null?o:$n)},e.setPageSize=n=>{e.setPagination(o=>{const i=Math.max(1,mt(n,o.pageSize)),l=o.pageSize*o.pageIndex,a=Math.floor(l/i);return{...o,pageIndex:a,pageSize:i}})},e.setPageCount=n=>e.setPagination(o=>{var i;let l=mt(n,(i=e.options.pageCount)!=null?i:-1);return typeof l=="number"&&(l=Math.max(-1,l)),{...o,pageCount:l}}),e.getPageOptions=O(()=>[e.getPageCount()],n=>{let o=[];return n&&n>0&&(o=[...new Array(n)].fill(null).map((i,l)=>l)),o},G(e.options,"debugTable")),e.getCanPreviousPage=()=>e.getState().pagination.pageIndex>0,e.getCanNextPage=()=>{const{pageIndex:n}=e.getState().pagination,o=e.getPageCount();return o===-1?!0:o===0?!1:n<o-1},e.previousPage=()=>e.setPageIndex(n=>n-1),e.nextPage=()=>e.setPageIndex(n=>n+1),e.firstPage=()=>e.setPageIndex(0),e.lastPage=()=>e.setPageIndex(e.getPageCount()-1),e.getPrePaginationRowModel=()=>e.getExpandedRowModel(),e.getPaginationRowModel=()=>(!e._getPaginationRowModel&&e.options.getPaginationRowModel&&(e._getPaginationRowModel=e.options.getPaginationRowModel(e)),e.options.manualPagination||!e._getPaginationRowModel?e.getPrePaginationRowModel():e._getPaginationRowModel()),e.getPageCount=()=>{var n;return(n=e.options.pageCount)!=null?n:Math.ceil(e.getRowCount()/e.getState().pagination.pageSize)},e.getRowCount=()=>{var n;return(n=e.options.rowCount)!=null?n:e.getPrePaginationRowModel().rows.length}}},wn=()=>({top:[],bottom:[]}),Vo={getInitialState:e=>({rowPinning:wn(),...e}),getDefaultOptions:e=>({onRowPinningChange:We("rowPinning",e)}),createRow:(e,s)=>{e.pin=(t,n,o)=>{const i=n?e.getLeafRows().map(u=>{let{id:d}=u;return d}):[],l=o?e.getParentRows().map(u=>{let{id:d}=u;return d}):[],a=new Set([...l,e.id,...i]);s.setRowPinning(u=>{var d,c;if(t==="bottom"){var p,m;return{top:((p=u==null?void 0:u.top)!=null?p:[]).filter(S=>!(a!=null&&a.has(S))),bottom:[...((m=u==null?void 0:u.bottom)!=null?m:[]).filter(S=>!(a!=null&&a.has(S))),...Array.from(a)]}}if(t==="top"){var f,w;return{top:[...((f=u==null?void 0:u.top)!=null?f:[]).filter(S=>!(a!=null&&a.has(S))),...Array.from(a)],bottom:((w=u==null?void 0:u.bottom)!=null?w:[]).filter(S=>!(a!=null&&a.has(S)))}}return{top:((d=u==null?void 0:u.top)!=null?d:[]).filter(S=>!(a!=null&&a.has(S))),bottom:((c=u==null?void 0:u.bottom)!=null?c:[]).filter(S=>!(a!=null&&a.has(S)))}})},e.getCanPin=()=>{var t;const{enableRowPinning:n,enablePinning:o}=s.options;return typeof n=="function"?n(e):(t=n??o)!=null?t:!0},e.getIsPinned=()=>{const t=[e.id],{top:n,bottom:o}=s.getState().rowPinning,i=t.some(a=>n==null?void 0:n.includes(a)),l=t.some(a=>o==null?void 0:o.includes(a));return i?"top":l?"bottom":!1},e.getPinnedIndex=()=>{var t,n;const o=e.getIsPinned();if(!o)return-1;const i=(t=o==="top"?s.getTopRows():s.getBottomRows())==null?void 0:t.map(l=>{let{id:a}=l;return a});return(n=i==null?void 0:i.indexOf(e.id))!=null?n:-1}},createTable:e=>{e.setRowPinning=s=>e.options.onRowPinningChange==null?void 0:e.options.onRowPinningChange(s),e.resetRowPinning=s=>{var t,n;return e.setRowPinning(s?wn():(t=(n=e.initialState)==null?void 0:n.rowPinning)!=null?t:wn())},e.getIsSomeRowsPinned=s=>{var t;const n=e.getState().rowPinning;if(!s){var o,i;return!!((o=n.top)!=null&&o.length||(i=n.bottom)!=null&&i.length)}return!!((t=n[s])!=null&&t.length)},e._getPinnedRows=(s,t,n)=>{var o;return((o=e.options.keepPinnedRows)==null||o?(t??[]).map(l=>{const a=e.getRow(l,!0);return a.getIsAllParentsExpanded()?a:null}):(t??[]).map(l=>s.find(a=>a.id===l))).filter(Boolean).map(l=>({...l,position:n}))},e.getTopRows=O(()=>[e.getRowModel().rows,e.getState().rowPinning.top],(s,t)=>e._getPinnedRows(s,t,"top"),G(e.options,"debugRows")),e.getBottomRows=O(()=>[e.getRowModel().rows,e.getState().rowPinning.bottom],(s,t)=>e._getPinnedRows(s,t,"bottom"),G(e.options,"debugRows")),e.getCenterRows=O(()=>[e.getRowModel().rows,e.getState().rowPinning.top,e.getState().rowPinning.bottom],(s,t,n)=>{const o=new Set([...t??[],...n??[]]);return s.filter(i=>!o.has(i.id))},G(e.options,"debugRows"))}},ko={getInitialState:e=>({rowSelection:{},...e}),getDefaultOptions:e=>({onRowSelectionChange:We("rowSelection",e),enableRowSelection:!0,enableMultiRowSelection:!0,enableSubRowSelection:!0}),createTable:e=>{e.setRowSelection=s=>e.options.onRowSelectionChange==null?void 0:e.options.onRowSelectionChange(s),e.resetRowSelection=s=>{var t;return e.setRowSelection(s?{}:(t=e.initialState.rowSelection)!=null?t:{})},e.toggleAllRowsSelected=s=>{e.setRowSelection(t=>{s=typeof s<"u"?s:!e.getIsAllRowsSelected();const n={...t},o=e.getPreGroupedRowModel().flatRows;return s?o.forEach(i=>{i.getCanSelect()&&(n[i.id]=!0)}):o.forEach(i=>{delete n[i.id]}),n})},e.toggleAllPageRowsSelected=s=>e.setRowSelection(t=>{const n=typeof s<"u"?s:!e.getIsAllPageRowsSelected(),o={...t};return e.getRowModel().rows.forEach(i=>{In(o,i.id,n,!0,e)}),o}),e.getPreSelectedRowModel=()=>e.getCoreRowModel(),e.getSelectedRowModel=O(()=>[e.getState().rowSelection,e.getCoreRowModel()],(s,t)=>Object.keys(s).length?Sn(e,t):{rows:[],flatRows:[],rowsById:{}},G(e.options,"debugTable")),e.getFilteredSelectedRowModel=O(()=>[e.getState().rowSelection,e.getFilteredRowModel()],(s,t)=>Object.keys(s).length?Sn(e,t):{rows:[],flatRows:[],rowsById:{}},G(e.options,"debugTable")),e.getGroupedSelectedRowModel=O(()=>[e.getState().rowSelection,e.getSortedRowModel()],(s,t)=>Object.keys(s).length?Sn(e,t):{rows:[],flatRows:[],rowsById:{}},G(e.options,"debugTable")),e.getIsAllRowsSelected=()=>{const s=e.getFilteredRowModel().flatRows,{rowSelection:t}=e.getState();let n=!!(s.length&&Object.keys(t).length);return n&&s.some(o=>o.getCanSelect()&&!t[o.id])&&(n=!1),n},e.getIsAllPageRowsSelected=()=>{const s=e.getPaginationRowModel().flatRows.filter(o=>o.getCanSelect()),{rowSelection:t}=e.getState();let n=!!s.length;return n&&s.some(o=>!t[o.id])&&(n=!1),n},e.getIsSomeRowsSelected=()=>{var s;const t=Object.keys((s=e.getState().rowSelection)!=null?s:{}).length;return t>0&&t<e.getFilteredRowModel().flatRows.length},e.getIsSomePageRowsSelected=()=>{const s=e.getPaginationRowModel().flatRows;return e.getIsAllPageRowsSelected()?!1:s.filter(t=>t.getCanSelect()).some(t=>t.getIsSelected()||t.getIsSomeSelected())},e.getToggleAllRowsSelectedHandler=()=>s=>{e.toggleAllRowsSelected(s.target.checked)},e.getToggleAllPageRowsSelectedHandler=()=>s=>{e.toggleAllPageRowsSelected(s.target.checked)}},createRow:(e,s)=>{e.toggleSelected=(t,n)=>{const o=e.getIsSelected();s.setRowSelection(i=>{var l;if(t=typeof t<"u"?t:!o,e.getCanSelect()&&o===t)return i;const a={...i};return In(a,e.id,t,(l=n==null?void 0:n.selectChildren)!=null?l:!0,s),a})},e.getIsSelected=()=>{const{rowSelection:t}=s.getState();return Ln(e,t)},e.getIsSomeSelected=()=>{const{rowSelection:t}=s.getState();return En(e,t)==="some"},e.getIsAllSubRowsSelected=()=>{const{rowSelection:t}=s.getState();return En(e,t)==="all"},e.getCanSelect=()=>{var t;return typeof s.options.enableRowSelection=="function"?s.options.enableRowSelection(e):(t=s.options.enableRowSelection)!=null?t:!0},e.getCanSelectSubRows=()=>{var t;return typeof s.options.enableSubRowSelection=="function"?s.options.enableSubRowSelection(e):(t=s.options.enableSubRowSelection)!=null?t:!0},e.getCanMultiSelect=()=>{var t;return typeof s.options.enableMultiRowSelection=="function"?s.options.enableMultiRowSelection(e):(t=s.options.enableMultiRowSelection)!=null?t:!0},e.getToggleSelectedHandler=()=>{const t=e.getCanSelect();return n=>{var o;t&&e.toggleSelected((o=n.target)==null?void 0:o.checked)}}}},In=(e,s,t,n,o)=>{var i;const l=o.getRow(s,!0);t?(l.getCanMultiSelect()||Object.keys(e).forEach(a=>delete e[a]),l.getCanSelect()&&(e[s]=!0)):delete e[s],n&&(i=l.subRows)!=null&&i.length&&l.getCanSelectSubRows()&&l.subRows.forEach(a=>In(e,a.id,t,n,o))};function Sn(e,s){const t=e.getState().rowSelection,n=[],o={},i=function(l,a){return l.map(u=>{var d;const c=Ln(u,t);if(c&&(n.push(u),o[u.id]=u),(d=u.subRows)!=null&&d.length&&(u={...u,subRows:i(u.subRows)}),c)return u}).filter(Boolean)};return{rows:i(s.rows),flatRows:n,rowsById:o}}function Ln(e,s){var t;return(t=s[e.id])!=null?t:!1}function En(e,s,t){var n;if(!((n=e.subRows)!=null&&n.length))return!1;let o=!0,i=!1;return e.subRows.forEach(l=>{if(!(i&&!o)&&(l.getCanSelect()&&(Ln(l,s)?i=!0:o=!1),l.subRows&&l.subRows.length)){const a=En(l,s);a==="all"?i=!0:(a==="some"&&(i=!0),o=!1)}}),o?"all":i?"some":!1}const Pn=/([0-9]+)/gm,Do=(e,s,t)=>$s(pt(e.getValue(t)).toLowerCase(),pt(s.getValue(t)).toLowerCase()),Lo=(e,s,t)=>$s(pt(e.getValue(t)),pt(s.getValue(t))),To=(e,s,t)=>Tn(pt(e.getValue(t)).toLowerCase(),pt(s.getValue(t)).toLowerCase()),zo=(e,s,t)=>Tn(pt(e.getValue(t)),pt(s.getValue(t))),Ho=(e,s,t)=>{const n=e.getValue(t),o=s.getValue(t);return n>o?1:n<o?-1:0},Oo=(e,s,t)=>Tn(e.getValue(t),s.getValue(t));function Tn(e,s){return e===s?0:e>s?1:-1}function pt(e){return typeof e=="number"?isNaN(e)||e===1/0||e===-1/0?"":String(e):typeof e=="string"?e:""}function $s(e,s){const t=e.split(Pn).filter(Boolean),n=s.split(Pn).filter(Boolean);for(;t.length&&n.length;){const o=t.shift(),i=n.shift(),l=parseInt(o,10),a=parseInt(i,10),u=[l,a].sort();if(isNaN(u[0])){if(o>i)return 1;if(i>o)return-1;continue}if(isNaN(u[1]))return isNaN(l)?-1:1;if(l>a)return 1;if(a>l)return-1}return t.length-n.length}const Dt={alphanumeric:Do,alphanumericCaseSensitive:Lo,text:To,textCaseSensitive:zo,datetime:Ho,basic:Oo},Go={getInitialState:e=>({sorting:[],...e}),getDefaultColumnDef:()=>({sortingFn:"auto",sortUndefined:1}),getDefaultOptions:e=>({onSortingChange:We("sorting",e),isMultiSortEvent:s=>s.shiftKey}),createColumn:(e,s)=>{e.getAutoSortingFn=()=>{const t=s.getFilteredRowModel().flatRows.slice(10);let n=!1;for(const o of t){const i=o==null?void 0:o.getValue(e.id);if(Object.prototype.toString.call(i)==="[object Date]")return Dt.datetime;if(typeof i=="string"&&(n=!0,i.split(Pn).length>1))return Dt.alphanumeric}return n?Dt.text:Dt.basic},e.getAutoSortDir=()=>{const t=s.getFilteredRowModel().flatRows[0];return typeof(t==null?void 0:t.getValue(e.id))=="string"?"asc":"desc"},e.getSortingFn=()=>{var t,n;if(!e)throw new Error;return en(e.columnDef.sortingFn)?e.columnDef.sortingFn:e.columnDef.sortingFn==="auto"?e.getAutoSortingFn():(t=(n=s.options.sortingFns)==null?void 0:n[e.columnDef.sortingFn])!=null?t:Dt[e.columnDef.sortingFn]},e.toggleSorting=(t,n)=>{const o=e.getNextSortingOrder(),i=typeof t<"u"&&t!==null;s.setSorting(l=>{const a=l==null?void 0:l.find(f=>f.id===e.id),u=l==null?void 0:l.findIndex(f=>f.id===e.id);let d=[],c,p=i?t:o==="desc";if(l!=null&&l.length&&e.getCanMultiSort()&&n?a?c="toggle":c="add":l!=null&&l.length&&u!==l.length-1?c="replace":a?c="toggle":c="replace",c==="toggle"&&(i||o||(c="remove")),c==="add"){var m;d=[...l,{id:e.id,desc:p}],d.splice(0,d.length-((m=s.options.maxMultiSortColCount)!=null?m:Number.MAX_SAFE_INTEGER))}else c==="toggle"?d=l.map(f=>f.id===e.id?{...f,desc:p}:f):c==="remove"?d=l.filter(f=>f.id!==e.id):d=[{id:e.id,desc:p}];return d})},e.getFirstSortDir=()=>{var t,n;return((t=(n=e.columnDef.sortDescFirst)!=null?n:s.options.sortDescFirst)!=null?t:e.getAutoSortDir()==="desc")?"desc":"asc"},e.getNextSortingOrder=t=>{var n,o;const i=e.getFirstSortDir(),l=e.getIsSorted();return l?l!==i&&((n=s.options.enableSortingRemoval)==null||n)&&(!(t&&(o=s.options.enableMultiRemove)!=null)||o)?!1:l==="desc"?"asc":"desc":i},e.getCanSort=()=>{var t,n;return((t=e.columnDef.enableSorting)!=null?t:!0)&&((n=s.options.enableSorting)!=null?n:!0)&&!!e.accessorFn},e.getCanMultiSort=()=>{var t,n;return(t=(n=e.columnDef.enableMultiSort)!=null?n:s.options.enableMultiSort)!=null?t:!!e.accessorFn},e.getIsSorted=()=>{var t;const n=(t=s.getState().sorting)==null?void 0:t.find(o=>o.id===e.id);return n?n.desc?"desc":"asc":!1},e.getSortIndex=()=>{var t,n;return(t=(n=s.getState().sorting)==null?void 0:n.findIndex(o=>o.id===e.id))!=null?t:-1},e.clearSorting=()=>{s.setSorting(t=>t!=null&&t.length?t.filter(n=>n.id!==e.id):[])},e.getToggleSortingHandler=()=>{const t=e.getCanSort();return n=>{t&&(n.persist==null||n.persist(),e.toggleSorting==null||e.toggleSorting(void 0,e.getCanMultiSort()?s.options.isMultiSortEvent==null?void 0:s.options.isMultiSortEvent(n):!1))}}},createTable:e=>{e.setSorting=s=>e.options.onSortingChange==null?void 0:e.options.onSortingChange(s),e.resetSorting=s=>{var t,n;e.setSorting(s?[]:(t=(n=e.initialState)==null?void 0:n.sorting)!=null?t:[])},e.getPreSortedRowModel=()=>e.getGroupedRowModel(),e.getSortedRowModel=()=>(!e._getSortedRowModel&&e.options.getSortedRowModel&&(e._getSortedRowModel=e.options.getSortedRowModel(e)),e.options.manualSorting||!e._getSortedRowModel?e.getPreSortedRowModel():e._getSortedRowModel())}},Uo=[uo,$o,jo,No,go,fo,Io,Eo,Go,_o,Po,Ao,Vo,ko,Mo];function Bo(e){var s,t;const n=[...Uo,...(s=e._features)!=null?s:[]];let o={_features:n};const i=o._features.reduce((m,f)=>Object.assign(m,f.getDefaultOptions==null?void 0:f.getDefaultOptions(o)),{}),l=m=>o.options.mergeOptions?o.options.mergeOptions(i,m):{...i,...m};let u={...{},...(t=e.initialState)!=null?t:{}};o._features.forEach(m=>{var f;u=(f=m.getInitialState==null?void 0:m.getInitialState(u))!=null?f:u});const d=[];let c=!1;const p={_features:n,options:{...i,...e},initialState:u,_queue:m=>{d.push(m),c||(c=!0,Promise.resolve().then(()=>{for(;d.length;)d.shift()();c=!1}).catch(f=>setTimeout(()=>{throw f})))},reset:()=>{o.setState(o.initialState)},setOptions:m=>{const f=mt(m,o.options);o.options=l(f)},getState:()=>o.options.state,setState:m=>{o.options.onStateChange==null||o.options.onStateChange(m)},_getRowId:(m,f,w)=>{var S;return(S=o.options.getRowId==null?void 0:o.options.getRowId(m,f,w))!=null?S:`${w?[w.id,f].join("."):f}`},getCoreRowModel:()=>(o._getCoreRowModel||(o._getCoreRowModel=o.options.getCoreRowModel(o)),o._getCoreRowModel()),getRowModel:()=>o.getPaginationRowModel(),getRow:(m,f)=>{let w=(f?o.getPrePaginationRowModel():o.getRowModel()).rowsById[m];if(!w&&(w=o.getCoreRowModel().rowsById[m],!w))throw new Error;return w},_getDefaultColumnDef:O(()=>[o.options.defaultColumn],m=>{var f;return m=(f=m)!=null?f:{},{header:w=>{const S=w.header.column.columnDef;return S.accessorKey?S.accessorKey:S.accessorFn?S.id:null},cell:w=>{var S,b;return(S=(b=w.renderValue())==null||b.toString==null?void 0:b.toString())!=null?S:null},...o._features.reduce((w,S)=>Object.assign(w,S.getDefaultColumnDef==null?void 0:S.getDefaultColumnDef()),{}),...m}},G(e,"debugColumns")),_getColumnDefs:()=>o.options.columns,getAllColumns:O(()=>[o._getColumnDefs()],m=>{const f=function(w,S,b){return b===void 0&&(b=0),w.map(h=>{const v=lo(o,h,b,S),x=h;return v.columns=x.columns?f(x.columns,v,b+1):[],v})};return f(m)},G(e,"debugColumns")),getAllFlatColumns:O(()=>[o.getAllColumns()],m=>m.flatMap(f=>f.getFlatColumns()),G(e,"debugColumns")),_getAllFlatColumnsById:O(()=>[o.getAllFlatColumns()],m=>m.reduce((f,w)=>(f[w.id]=w,f),{}),G(e,"debugColumns")),getAllLeafColumns:O(()=>[o.getAllColumns(),o._getOrderColumnsFn()],(m,f)=>{let w=m.flatMap(S=>S.getLeafColumns());return f(w)},G(e,"debugColumns")),getColumn:m=>o._getAllFlatColumnsById()[m]};Object.assign(o,p);for(let m=0;m<o._features.length;m++){const f=o._features[m];f==null||f.createTable==null||f.createTable(o)}return o}function as(){return e=>O(()=>[e.options.data],s=>{const t={rows:[],flatRows:[],rowsById:{}},n=function(o,i,l){i===void 0&&(i=0);const a=[];for(let d=0;d<o.length;d++){const c=co(e,e._getRowId(o[d],d,l),o[d],d,i,void 0,l==null?void 0:l.id);if(t.flatRows.push(c),t.rowsById[c.id]=c,a.push(c),e.options.getSubRows){var u;c.originalSubRows=e.options.getSubRows(o[d],d),(u=c.originalSubRows)!=null&&u.length&&(c.subRows=n(c.originalSubRows,i+1,c))}}return a};return t.rows=n(s),t},G(e.options,"debugTable","getRowModel",()=>e._autoResetPageIndex()))}function qo(e){const s=[],t=n=>{var o;s.push(n),(o=n.subRows)!=null&&o.length&&n.getIsExpanded()&&n.subRows.forEach(t)};return e.rows.forEach(t),{rows:s,flatRows:e.flatRows,rowsById:e.rowsById}}function ls(e){return s=>O(()=>[s.getState().pagination,s.getPrePaginationRowModel(),s.options.paginateExpandedRows?void 0:s.getState().expanded],(t,n)=>{if(!n.rows.length)return n;const{pageSize:o,pageIndex:i}=t;let{rows:l,flatRows:a,rowsById:u}=n;const d=o*i,c=d+o;l=l.slice(d,c);let p;s.options.paginateExpandedRows?p={rows:l,flatRows:a,rowsById:u}:p=qo({rows:l,flatRows:a,rowsById:u}),p.flatRows=[];const m=f=>{p.flatRows.push(f),f.subRows.length&&f.subRows.forEach(m)};return p.rows.forEach(m),p},G(s.options,"debugTable"))}function us(){return e=>O(()=>[e.getState().sorting,e.getPreSortedRowModel()],(s,t)=>{if(!t.rows.length||!(s!=null&&s.length))return t;const n=e.getState().sorting,o=[],i=n.filter(u=>{var d;return(d=e.getColumn(u.id))==null?void 0:d.getCanSort()}),l={};i.forEach(u=>{const d=e.getColumn(u.id);d&&(l[u.id]={sortUndefined:d.columnDef.sortUndefined,invertSorting:d.columnDef.invertSorting,sortingFn:d.getSortingFn()})});const a=u=>{const d=u.map(c=>({...c}));return d.sort((c,p)=>{for(let f=0;f<i.length;f+=1){var m;const w=i[f],S=l[w.id],b=S.sortUndefined,h=(m=w==null?void 0:w.desc)!=null?m:!1;let v=0;if(b){const x=c.getValue(w.id),_=p.getValue(w.id),N=x===void 0,j=_===void 0;if(N||j){if(b==="first")return N?-1:1;if(b==="last")return N?1:-1;v=N&&j?0:N?b:-b}}if(v===0&&(v=S.sortingFn(c,p,w.id)),v!==0)return h&&(v*=-1),S.invertSorting&&(v*=-1),v}return c.index-p.index}),d.forEach(c=>{var p;o.push(c),(p=c.subRows)!=null&&p.length&&(c.subRows=a(c.subRows))}),d};return{rows:a(t.rows),flatRows:o,rowsById:t.rowsById}},G(e.options,"debugTable","getSortedRowModel",()=>e._autoResetPageIndex()))}/**
   * react-table
   *
   * Copyright (c) TanStack
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE.md file in the root directory of this source tree.
   *
   * @license MIT
   */function cs(e,s){return e?Wo(e)?y.createElement(e,s):e:null}function Wo(e){return Ko(e)||typeof e=="function"||Yo(e)}function Ko(e){return typeof e=="function"&&(()=>{const s=Object.getPrototypeOf(e);return s.prototype&&s.prototype.isReactComponent})()}function Yo(e){return typeof e=="object"&&typeof e.$$typeof=="symbol"&&["react.memo","react.forward_ref"].includes(e.$$typeof.description)}function ds(e){const s={state:{},onStateChange:()=>{},renderFallbackValue:null,...e},[t]=y.useState(()=>({current:Bo(s)})),[n,o]=y.useState(()=>t.current.initialState);return t.current.setOptions(i=>({...i,...e,state:{...n,...e.state},onStateChange:l=>{o(l),e.onStateChange==null||e.onStateChange(l)}})),t.current}function Is({nodes:e,edges:s,onNodesChange:t,onEdgesChange:n,onBlur:o,editable:i=!1}){const[l,a]=y.useState("nodes"),[u,d]=y.useState(e),[c,p]=y.useState(s),m=y.useRef(new Map),f=y.useRef(new Map);y.useEffect(()=>{d([...e]),p([...s]),m.current.clear(),f.current.clear()},[e,s]);const w=y.useMemo(()=>{if(e.length===0)return[];const x=new Set;e.forEach(j=>{Object.keys(j).forEach(k=>{k==="_totalIncoming"||k==="_totalOutgoing"||x.add(k)})});const _=Array.from(x);return[..._.includes("id")?["id"]:[],..._.includes("label")?["label"]:[],..._.filter(j=>j!=="id"&&j!=="label")].map(j=>({header:j.charAt(0).toUpperCase()+j.slice(1).replace(/_/g," "),accessorKey:j,cell:k=>{var P;const I=k.getValue();if(i&&j!=="id"){const D=k.row.original.id,Q=u.findIndex(K=>K.id===D);if(Q===-1)return r.jsx("span",{children:"-"});const F=((P=u[Q])==null?void 0:P[j])??I,B=`${D}-${j}`;return r.jsx(_n,{id:B,type:typeof F=="number"?"number":"text",initialValue:F==null?"":String(F),isNumber:typeof F=="number",onBlur:K=>{const ue=[...u],re=typeof F=="number"?parseFloat(K)||0:K;ue[Q]={...ue[Q],[j]:re},d(ue),t==null||t(ue),o==null||o()}},B)}return I==null?"-":typeof I=="number"?I.toLocaleString():String(I)}}))},[e,i]),S=y.useMemo(()=>{if(s.length===0)return[];const x=new Set;s.forEach(j=>{Object.keys(j).forEach(k=>x.add(k))});const _=Array.from(x);return[..._.includes("source")?["source"]:[],..._.includes("target")?["target"]:[],..._.includes("value")?["value"]:[],..._.filter(j=>j!=="source"&&j!=="target"&&j!=="value")].map(j=>({header:j.charAt(0).toUpperCase()+j.slice(1).replace(/_/g," "),accessorKey:j,cell:k=>{var P,W;const I=k.getValue();if(i&&j!=="source"&&j!=="target"){const D=k.row.original,Q=c.findIndex(K=>K.source===D.source&&K.target===D.target&&K.value===D.value);if(Q===-1){const K=c.findIndex(ye=>ye.source===D.source&&ye.target===D.target);if(K===-1)return r.jsx("span",{children:"-"});const ue=((P=c[K])==null?void 0:P[j])??I,re=`${D.source}-${D.target}-${j}-fallback`;return r.jsx(_n,{id:re,type:typeof ue=="number"?"number":"text",initialValue:ue==null?"":String(ue),isNumber:typeof ue=="number",onBlur:ye=>{const Fe=[...c],C=typeof ue=="number"?parseFloat(ye)||0:ye;Fe[K]={...Fe[K],[j]:C},p(Fe),n==null||n(Fe),o==null||o()}},re)}const F=((W=c[Q])==null?void 0:W[j])??I,B=`${D.source}-${D.target}-${j}`;return r.jsx(_n,{id:B,type:typeof F=="number"?"number":"text",initialValue:F==null?"":String(F),isNumber:typeof F=="number",onBlur:K=>{const ue=[...c],re=typeof F=="number"?parseFloat(K)||0:K;ue[Q]={...ue[Q],[j]:re},p(ue),n==null||n(ue),o==null||o()}},B)}return I==null?"-":typeof I=="number"?I.toLocaleString():String(I)}}))},[s,i]),b=ds({data:i?u:e,columns:w,getCoreRowModel:as(),getSortedRowModel:us(),getPaginationRowModel:ls(),initialState:{pagination:{pageSize:25}}}),h=ds({data:i?c:s,columns:S,getCoreRowModel:as(),getSortedRowModel:us(),getPaginationRowModel:ls(),initialState:{pagination:{pageSize:25}}}),v=l==="nodes"?b:h;return r.jsxs("div",{className:"h-full w-full flex flex-col",style:{height:"100%",maxHeight:"100%"},children:[r.jsxs("div",{className:"flex border-b mb-4 flex-shrink-0",children:[r.jsxs("button",{onClick:()=>a("nodes"),className:`px-4 py-2 font-medium text-sm transition-colors ${l==="nodes"?"border-b-2 border-blue-600 text-blue-600":"text-gray-600 hover:text-gray-900"}`,children:["Nodes (",e.length,")"]}),r.jsxs("button",{onClick:()=>a("edges"),className:`px-4 py-2 font-medium text-sm transition-colors ${l==="edges"?"border-b-2 border-blue-600 text-blue-600":"text-gray-600 hover:text-gray-900"}`,children:["Edges (",s.length,")"]})]}),r.jsx("div",{className:"flex-1 flex flex-col min-h-0 overflow-hidden",children:r.jsxs("div",{className:"overflow-auto flex-1 min-h-0",children:[r.jsxs("table",{className:"min-w-full text-sm",children:[r.jsx("thead",{className:"bg-gray-50 border-b sticky top-0 z-10",children:v.getHeaderGroups().map(x=>r.jsx("tr",{children:x.headers.map(_=>r.jsx("th",{className:"px-4 py-2 text-left font-semibold text-gray-700 bg-gray-50",children:_.isPlaceholder?null:r.jsxs("div",{className:_.column.getCanSort()?"cursor-pointer select-none hover:text-blue-600":"",onClick:_.column.getToggleSortingHandler(),children:[cs(_.column.columnDef.header,_.getContext()),{asc:" ↑",desc:" ↓"}[_.column.getIsSorted()]??null]})},_.id))},x.id))}),r.jsx("tbody",{className:"divide-y divide-gray-200 bg-white",children:v.getRowModel().rows.map(x=>r.jsx("tr",{className:"hover:bg-gray-50",children:x.getVisibleCells().map(_=>r.jsx("td",{className:"px-4 py-2",children:cs(_.column.columnDef.cell,_.getContext())},_.id))},x.id))})]}),v.getRowModel().rows.length===0&&r.jsxs("div",{className:"text-center text-gray-500 py-8",children:["No ",l," to display"]})]})}),r.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-t border-gray-200 bg-white flex-shrink-0",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("span",{className:"text-sm text-gray-700",children:"Show"}),r.jsx("select",{value:v.getState().pagination.pageSize,onChange:x=>{v.setPageSize(Number(x.target.value))},className:"border border-gray-300 rounded px-2 py-1 text-sm",children:[10,25,50,100].map(x=>r.jsx("option",{value:x,children:x},x))}),r.jsx("span",{className:"text-sm text-gray-700",children:"entries"})]}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsxs("span",{className:"text-sm text-gray-700",children:["Page ",v.getState().pagination.pageIndex+1," of"," ",v.getPageCount()]}),r.jsxs("div",{className:"flex gap-1",children:[r.jsx("button",{onClick:()=>v.setPageIndex(0),disabled:!v.getCanPreviousPage(),className:"px-2 py-1 text-sm border border-gray-300 rounded disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-50",children:"<<"}),r.jsx("button",{onClick:()=>v.previousPage(),disabled:!v.getCanPreviousPage(),className:"px-2 py-1 text-sm border border-gray-300 rounded disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-50",children:"<"}),r.jsx("button",{onClick:()=>v.nextPage(),disabled:!v.getCanNextPage(),className:"px-2 py-1 text-sm border border-gray-300 rounded disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-50",children:">"}),r.jsx("button",{onClick:()=>v.setPageIndex(v.getPageCount()-1),disabled:!v.getCanNextPage(),className:"px-2 py-1 text-sm border border-gray-300 rounded disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-50",children:">>"})]})]})]})]})}function _n({id:e,type:s,initialValue:t,onBlur:n}){const o=y.useRef(null),[i,l]=y.useState(t);return y.useEffect(()=>{o.current&&document.activeElement!==o.current&&l(t)},[t]),r.jsx("input",{ref:o,id:e,type:s,value:i,onChange:a=>{l(a.target.value)},onBlur:a=>{n(a.target.value)},className:"w-full px-2 py-1 border border-gray-300 rounded text-sm focus:outline-none focus:ring-2 focus:ring-blue-500",autoComplete:"off"})}function Xo({dataset:e,onClose:s,onSave:t,onDelete:n,onDuplicate:o}){const[i,l]=y.useState(e.name),[a,u]=y.useState(e.notes||""),[d,c]=y.useState(!1),[p,m]=y.useState(!1),[f,w]=y.useState(!1),[S,b]=y.useState("info"),[h,v]=y.useState(null),x=e.snapshots[0]||{timestamp:e.timeRange.start,nodes:[],edges:[]};y.useEffect(()=>{l(e.name),u(e.notes||""),v(null)},[e]);async function _(){c(!0);try{const I={...e,name:i.trim(),notes:a.trim()||void 0};if(h){I.snapshots=h.snapshots;const P=I.snapshots[0]||x;I.metadata=Ct(P)}await t(I),s()}catch(I){console.error("Save error:",I),alert("Failed to save dataset: "+(I instanceof Error?I.message:"Unknown error"))}finally{c(!1)}}async function N(){m(!0);try{await n(),s()}catch(I){console.error("Delete error:",I),alert("Failed to delete dataset: "+(I instanceof Error?I.message:"Unknown error"))}finally{m(!1),w(!1)}}function j(I,P){const W={...x,nodes:I,edges:P};v({...e,snapshots:[W]})}const k=i!==e.name||a!==(e.notes||"")||h!==null;return r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:r.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-6xl w-full mx-4 max-h-[90vh] flex flex-col",children:[r.jsxs("div",{className:"p-6 border-b flex items-center justify-between",children:[r.jsx("h2",{className:"text-2xl font-bold",children:"Edit Dataset"}),r.jsx("button",{onClick:s,type:"button",className:"text-gray-400 hover:text-gray-600 text-2xl cursor-pointer transition-colors",children:"×"})]}),r.jsxs("div",{className:"border-b flex",children:[r.jsx("button",{onClick:()=>b("info"),type:"button",className:`px-6 py-3 font-medium cursor-pointer transition-colors ${S==="info"?"border-b-2 border-blue-600 text-blue-600":"text-gray-600 hover:text-gray-900"}`,children:"Information"}),r.jsxs("button",{onClick:()=>b("data"),type:"button",className:`px-6 py-3 font-medium cursor-pointer transition-colors ${S==="data"?"border-b-2 border-blue-600 text-blue-600":"text-gray-600 hover:text-gray-900"}`,children:["Data (",x.nodes.length," nodes, ",x.edges.length," edges)"]})]}),r.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:S==="info"?r.jsxs("div",{className:"space-y-6 max-w-2xl",children:[r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Dataset Name ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsx("input",{type:"text",value:i,onChange:I=>l(I.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Enter a name for this dataset"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Notes"}),r.jsx("textarea",{value:a,onChange:I=>u(I.target.value),rows:5,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Add any notes about this dataset..."})]}),r.jsxs("div",{className:"bg-gray-50 p-4 rounded",children:[r.jsx("h3",{className:"font-medium text-gray-700 mb-2",children:"Dataset Information"}),r.jsxs("div",{className:"text-sm text-gray-600 space-y-1",children:[r.jsxs("div",{children:[r.jsx("span",{className:"font-medium",children:"Type:"})," ",e.type.toUpperCase()]}),r.jsxs("div",{children:[r.jsx("span",{className:"font-medium",children:"Time Range:"})," ",e.timeRange.start,e.timeRange.end!==e.timeRange.start?` – ${e.timeRange.end}`:""]}),r.jsxs("div",{children:[r.jsx("span",{className:"font-medium",children:"Snapshots:"})," ",e.snapshots.length]}),e.filename&&r.jsxs("div",{children:[r.jsx("span",{className:"font-medium",children:"Original File:"})," ",e.filename]}),r.jsxs("div",{children:[r.jsx("span",{className:"font-medium",children:"Created:"})," ",new Date(e.createdAt).toLocaleDateString()]})]})]}),r.jsxs("div",{className:"border-t pt-4 space-y-3",children:[r.jsx("button",{onClick:o,type:"button",className:"w-full px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50 cursor-pointer transition-colors",children:"Duplicate Dataset"}),r.jsx("button",{onClick:()=>w(!0),type:"button",className:"w-full px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 cursor-pointer transition-colors",children:"Delete Dataset"})]})]}):r.jsx("div",{className:"h-full",children:r.jsx(Zo,{nodes:x.nodes,edges:x.edges,onUpdate:j})})}),r.jsxs("div",{className:"p-6 border-t flex justify-end gap-3",children:[r.jsx("button",{onClick:s,type:"button",disabled:d||p,className:"px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50 disabled:opacity-50 cursor-pointer transition-colors",children:"Cancel"}),r.jsx("button",{onClick:_,type:"button",disabled:d||p||!k&&S==="info"||!i.trim(),className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed cursor-pointer transition-colors",children:d?"Saving...":h?"Save All Changes":"Save Changes"})]}),f&&r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-60",children:r.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md mx-4",children:[r.jsx("h3",{className:"text-lg font-bold mb-2",children:"Delete Dataset?"}),r.jsxs("p",{className:"text-gray-600 mb-4",children:['Are you sure you want to delete "',e.name,'"? This action cannot be undone.']}),r.jsxs("div",{className:"flex justify-end gap-3",children:[r.jsx("button",{onClick:()=>w(!1),type:"button",disabled:p,className:"px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50 cursor-pointer transition-colors",children:"Cancel"}),r.jsx("button",{onClick:N,type:"button",disabled:p,className:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 disabled:opacity-50 cursor-pointer transition-colors",children:p?"Deleting...":"Delete"})]})]})})]})})}function Zo({nodes:e,edges:s,onUpdate:t}){const[n,o]=y.useState(e),[i,l]=y.useState(s);y.useEffect(()=>{o([...e]),l([...s])},[e,s]);const a=y.useRef(n),u=y.useRef(i);y.useEffect(()=>{a.current=n,u.current=i},[n,i]);const d=y.useCallback(f=>{o(f),a.current=f},[]),c=y.useCallback(f=>{l(f),u.current=f},[]),p=y.useRef(!1),m=y.useCallback(()=>{p.current&&(t(a.current,u.current),p.current=!1)},[t]);return r.jsx("div",{className:"h-full",children:r.jsx(Is,{nodes:n,edges:i,onNodesChange:f=>{d(f),p.current=!0},onEdgesChange:f=>{c(f),p.current=!0},onBlur:m,editable:!0})})}class dt extends y.Component{constructor(s){super(s),this.state={hasError:!1,error:null}}static getDerivedStateFromError(s){return{hasError:!0,error:s}}componentDidCatch(s,t){var n,o;console.error("ErrorBoundary caught an error:",s,t),(o=(n=this.props).onError)==null||o.call(n,s,t)}render(){var s;return this.state.hasError?this.props.fallback?this.props.fallback:r.jsxs("div",{className:"p-4 bg-red-50 border border-red-200 rounded-md",children:[r.jsx("h3",{className:"text-lg font-semibold text-red-800 mb-2",children:"Something went wrong"}),r.jsx("p",{className:"text-sm text-red-700 mb-2",children:((s=this.state.error)==null?void 0:s.message)||"An error occurred"}),r.jsx("button",{onClick:()=>this.setState({hasError:!1,error:null}),className:"px-3 py-1 bg-red-600 text-white text-sm rounded hover:bg-red-700 cursor-pointer transition-colors",children:"Try again"})]}):this.props.children}}function Qo({selectedId:e,onSelect:s,onRefresh:t}){const[n,o]=y.useState([]),[i,l]=y.useState(!1),[a,u]=y.useState(null),[d,c]=y.useState(!1),[p,m]=y.useState(null),f=y.useRef(null);y.useEffect(()=>{w()},[]);async function w(){const N=await eo();o(N)}async function S(N,j){try{const I=`${N.type||"csv"}-${Date.now()}`,P={...N,id:I,snapshots:j.snapshots,metadata:j.metadata,createdAt:Date.now()};await gt(P),await w(),l(!1),m(null),s(I)}catch(k){throw console.error("Import error:",k),k}finally{f.current&&(f.current.value="")}}async function b(N,j){j.stopPropagation();const k=await ft(N);k&&u(k)}async function h(N){await gt(N),await w(),e===N.id&&(t==null||t())}async function v(){a&&(await Mn(a.id),await w(),e===a.id&&s(""),u(null))}async function x(){if(!a)return;const N=await to(a.id);await w(),u(null),s(N.id)}async function _(){await no(),await w(),c(!1),s(""),window.location.reload()}return r.jsxs("aside",{className:"h-full overflow-y-auto flex flex-col",children:[r.jsxs("div",{className:"p-4 border-b",children:[r.jsx("h2",{className:"text-lg font-bold",children:"Datasets"}),r.jsx("p",{className:"text-xs text-gray-500",children:"Stored in your browser"}),r.jsx("button",{onClick:()=>l(!0),className:"mt-3 w-full px-3 py-2 bg-blue-600 text-white text-sm rounded hover:bg-blue-700",children:"Import Dataset"}),r.jsx("input",{ref:f,type:"file",accept:".csv,.gexf",multiple:!0,className:"hidden"}),i&&r.jsx(dt,{fallback:r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:r.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md mx-4",children:[r.jsx("h3",{className:"text-lg font-bold text-red-800 mb-2",children:"Import Panel Error"}),r.jsx("p",{className:"text-gray-600 mb-4",children:"The import panel encountered an error."}),r.jsx("button",{onClick:()=>l(!1),className:"px-4 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-700 cursor-pointer transition-colors",children:"Close"})]})}),children:r.jsx(ro,{onClose:()=>{l(!1),m(null),f.current&&(f.current.value="")},onImport:S,fileInputRef:f,onFilesSelected:m,existingFile:p})})]}),r.jsxs("ul",{className:"divide-y flex-1 overflow-y-auto",children:[n.map(N=>r.jsx("li",{children:r.jsxs("div",{className:`flex items-center group ${e===N.id?"bg-blue-50":""}`,children:[r.jsxs("button",{className:"flex-1 text-left p-3 hover:bg-gray-50",onClick:()=>s(N.id),children:[r.jsx("div",{className:"flex items-center justify-between",children:r.jsxs("div",{children:[r.jsx("div",{className:"font-medium",children:N.name}),r.jsxs("div",{className:"text-xs text-gray-500",children:[N.type.toUpperCase()," · ",N.timeRange.start,N.timeRange.end!==N.timeRange.start?`–${N.timeRange.end}`:""]})]})}),N.notes&&r.jsx("div",{className:"text-xs text-gray-600 mt-1 line-clamp-2",children:N.notes})]}),r.jsx("button",{onClick:j=>b(N.id,j),className:"px-2 py-1 text-gray-400 hover:text-blue-600 hover:bg-gray-100 rounded transition-all mr-2 cursor-pointer",title:"Edit dataset",type:"button",children:r.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})})})]})},N.id)),n.length===0&&r.jsx("li",{className:"p-3 text-sm text-gray-500",children:"No datasets yet"})]}),r.jsxs("div",{className:"p-4 border-t",children:[r.jsx("button",{onClick:()=>c(!0),type:"button",className:"w-full px-3 py-2 bg-red-600 text-white text-sm rounded hover:bg-red-700 cursor-pointer transition-colors",children:"Reset All Data"}),r.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"Delete all datasets and reload defaults"})]}),a&&r.jsx(dt,{fallback:r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:r.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md mx-4",children:[r.jsx("h3",{className:"text-lg font-bold text-red-800 mb-2",children:"Edit Panel Error"}),r.jsx("p",{className:"text-gray-600 mb-4",children:"The edit panel encountered an error."}),r.jsx("button",{onClick:()=>u(null),className:"px-4 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-700 cursor-pointer transition-colors",children:"Close"})]})}),children:r.jsx(Xo,{dataset:a,onClose:()=>u(null),onSave:h,onDelete:v,onDuplicate:x})}),d&&r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-60",children:r.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md mx-4",children:[r.jsx("h3",{className:"text-lg font-bold mb-2",children:"Reset All Data?"}),r.jsx("p",{className:"text-gray-600 mb-4",children:"This will delete all datasets and reload the default test data. This action cannot be undone."}),r.jsxs("div",{className:"flex justify-end gap-3",children:[r.jsx("button",{onClick:()=>c(!1),type:"button",className:"px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50 cursor-pointer transition-colors",children:"Cancel"}),r.jsx("button",{onClick:_,type:"button",className:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 cursor-pointer transition-colors",children:"Reset All Data"})]})]})})]})}function Jo({nodes:e,edges:s,width:t=1200,height:n=800}){const o=y.useRef(null),[i,l]=y.useState(null),[a,u]=y.useState(null);return y.useEffect(()=>{var ye,Fe;if(!o.current||s.length===0||e.length===0){o.current&&_e(o.current).selectAll("*").remove();return}_e(o.current).selectAll("*").remove();const d=new Map;e.forEach(C=>{d.set(C.id,{id:C.id,label:C.label||C.id,outgoing:0,incoming:0})}),s.forEach(C=>{const L=d.get(C.source),pe=d.get(C.target);L&&(L.outgoing+=C.value),pe&&(pe.incoming+=C.value)});const c=Array.from(d.values()).filter(C=>C.outgoing>0||C.incoming>0);if(c.length===0){_e(o.current).append("text").attr("x",t/2).attr("y",n/2).attr("text-anchor","middle").attr("font-size","14px").attr("fill","#666").text("No active nodes with flows");return}c.sort((C,L)=>L.outgoing+L.incoming-(C.outgoing+C.incoming));const p=50,m=t-50,f=20,w=15,S=2,b=5,h=c.reduce((C,L)=>C+L.outgoing,0),v=c.reduce((C,L)=>C+L.incoming,0),x=Math.max(n-2*f,400);let _=f;c.forEach(C=>{const L=h>0?Math.max(b,C.outgoing/h*x):Math.max(b,x/c.length);_+=L+S});let N=f;c.forEach(C=>{const L=v>0?Math.max(b,C.incoming/v*x):Math.max(b,x/c.length);N+=L+S});const j=Math.max(n,Math.max(_,N)+100),k=j-2*f,I=_e(o.current).attr("width",t).attr("height",j).style("font","12px sans-serif");let P=f;const W=c.map((C,L)=>{const pe=h>0?Math.max(b,C.outgoing/h*k):Math.max(b,k/c.length),Ee=P;return P+=pe+S,{node:C,x:p,y:Ee,height:Math.max(b,pe-S),side:"left",index:L}});P=f;const D=c.map((C,L)=>{const pe=v>0?Math.max(b,C.incoming/v*k):Math.max(b,k/c.length),Ee=P;return P+=pe+S,{node:C,x:m,y:Ee,height:Math.max(b,pe-S),side:"right",index:L}});let Q=[];i&&a&&(a==="left"?Q=s.filter(C=>C.source===i&&C.source!==C.target):Q=s.filter(C=>C.target===i&&C.source!==C.target));const F=ps(bs);if(Q.length>0){const C=Q.map(U=>{const Ce=W.find(Ie=>Ie.node.id===U.source),Y=D.find(Ie=>Ie.node.id===U.target);if(!Ce||!Y)return null;const $e=Ce.y+Ce.height/2,Ve=Y.y+Y.height/2;return{edge:U,sourceX:Ce.x+w,sourceY:$e,targetX:Y.x,targetY:Ve,value:U.value,leftIndex:Ce.index,rightIndex:Y.index}}).filter(U=>U!==null),L=Math.max(...C.map(U=>U.value),1),pe=2,Ee=20,Pe=I.append("g").attr("class","links");C.forEach(U=>{const Ce=pe+U.value/L*(Ee-pe),Y=`gradient-${U.leftIndex}-${U.rightIndex}`,$e=I.append("defs").append("linearGradient").attr("id",Y).attr("gradientUnits","userSpaceOnUse").attr("x1",U.sourceX).attr("x2",U.targetX).attr("y1",U.sourceY).attr("y2",U.targetY);$e.append("stop").attr("offset","0%").attr("stop-color",F(String(U.leftIndex))).attr("stop-opacity",.6),$e.append("stop").attr("offset","100%").attr("stop-color",F(String(U.rightIndex))).attr("stop-opacity",.6);const Ve=kn(),Ie=(U.sourceX+U.targetX)/2;Ve.moveTo(U.sourceX,U.sourceY),Ve.bezierCurveTo(Ie,U.sourceY,Ie,U.targetY,U.targetX,U.targetY),Pe.append("path").attr("d",Ve.toString()).attr("stroke",`url(#${Y})`).attr("stroke-width",Ce).attr("fill","none").attr("stroke-opacity",.6).style("cursor","pointer").on("mouseover",function(ke){_e(this).attr("stroke-opacity",1).attr("stroke-width",Ce+2),_e("body").append("div").attr("class","tooltip").style("position","absolute").style("background","rgba(0, 0, 0, 0.8)").style("color","white").style("padding","8px").style("border-radius","4px").style("pointer-events","none").style("opacity",0).html(`${U.edge.source} → ${U.edge.target}<br/>${U.value.toLocaleString()}`).style("opacity",1)}).on("mousemove",function(ke){_e(".tooltip").style("left",`${ke.pageX+10}px`).style("top",`${ke.pageY-10}px`)}).on("mouseout",function(){_e(this).attr("stroke-opacity",.6).attr("stroke-width",Ce),_e(".tooltip").remove()})})}const K=I.append("g").attr("class","left-nodes").selectAll("g.node").data(W).join("g").attr("class","node").attr("transform",C=>`translate(${C.x}, ${C.y})`).style("cursor","pointer").on("click",function(C,L){C.stopPropagation(),i===L.node.id&&a==="left"?(l(null),u(null)):(l(L.node.id),u("left"))});K.append("rect").attr("width",w).attr("height",C=>C.height).attr("fill",(C,L)=>F(String(L))).attr("stroke",(C,L)=>jt(F(String(L))).darker().formatHex()).attr("stroke-width",C=>i===C.node.id&&a==="left"?3:1).attr("opacity",C=>i&&a==="left"&&i!==C.node.id?.3:1).on("mouseover",function(C,L){_e(this).attr("fill",jt(F(String(L.index))).brighter(.5).formatHex())}).on("mouseout",function(C,L){_e(this).attr("fill",F(String(L.index)))}),K.append("text").attr("x",w+6).attr("y",C=>C.height/2).attr("dy","0.35em").attr("text-anchor","start").text(C=>`${C.node.label} (${C.node.outgoing.toLocaleString()})`).style("font-size","11px").style("font-weight","500").style("fill","#333").attr("opacity",C=>i&&a==="left"&&i!==C.node.id?.3:1);const re=I.append("g").attr("class","right-nodes").selectAll("g.node").data(D).join("g").attr("class","node").attr("transform",C=>`translate(${C.x}, ${C.y})`).style("cursor","pointer").on("click",function(C,L){C.stopPropagation(),i===L.node.id&&a==="right"?(l(null),u(null)):(l(L.node.id),u("right"))});re.append("rect").attr("x",-w).attr("width",w).attr("height",C=>C.height).attr("fill",(C,L)=>F(String(L))).attr("stroke",(C,L)=>jt(F(String(L))).darker().formatHex()).attr("stroke-width",C=>i===C.node.id&&a==="right"?3:1).attr("opacity",C=>i&&a==="right"&&i!==C.node.id?.3:1).on("mouseover",function(C,L){_e(this).attr("fill",jt(F(String(L.index))).brighter(.5).formatHex())}).on("mouseout",function(C,L){_e(this).attr("fill",F(String(L.index)))}),re.append("text").attr("x",-w-6).attr("y",C=>C.height/2).attr("dy","0.35em").attr("text-anchor","end").text(C=>`${C.node.label} (${C.node.incoming.toLocaleString()})`).style("font-size","11px").style("font-weight","500").style("fill","#333").attr("opacity",C=>i&&a==="right"&&i!==C.node.id?.3:1),i?I.append("text").attr("x",t/2).attr("y",20).attr("text-anchor","middle").attr("font-size","14px").attr("fill","#333").text(a==="left"?`Showing outgoing flows from ${(ye=W.find(C=>C.node.id===i))==null?void 0:ye.node.label}`:`Showing incoming flows to ${(Fe=D.find(C=>C.node.id===i))==null?void 0:Fe.node.label}`):I.append("text").attr("x",t/2).attr("y",20).attr("text-anchor","middle").attr("font-size","14px").attr("fill","#666").text("Click a node to see its connections"),I.append("text").attr("x",p+w/2).attr("y",j-10).attr("text-anchor","middle").attr("font-size","12px").attr("font-weight","bold").attr("fill","#333").text("Outgoing"),I.append("text").attr("x",m-w/2).attr("y",j-10).attr("text-anchor","middle").attr("font-size","12px").attr("font-weight","bold").attr("fill","#333").text("Incoming"),I.on("click",function(C){(C.target===o.current||C.target.tagName==="svg")&&(l(null),u(null))})},[e,s,t,n,i,a]),r.jsxs("div",{className:"w-full h-full flex flex-col min-h-0",children:[r.jsxs("div",{className:"text-center text-xs text-gray-500 mb-2 flex-shrink-0",children:["Interaction design inspired by"," ",r.jsx("a",{href:"https://peoplemov.in/#f_AF",target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-800 underline",children:"peoplemov.in by Carlo Zapponi"})]}),r.jsx("div",{className:"flex-1 overflow-auto min-h-0",children:r.jsx("svg",{ref:o,className:"border border-gray-200 rounded bg-white"})})]})}function ei(e,s){const t=e.length,n=new Map;e.forEach((l,a)=>{n.set(l.id,a)});const o=Array(t).fill(null).map(()=>Array(t).fill(0));s.forEach(l=>{const a=n.get(l.source),u=n.get(l.target);a!==void 0&&u!==void 0&&(o[a][u]+=l.value)});const i=e.map(l=>l.label||l.id);return{matrix:o,labels:i,nodes:e}}function ti(e,s,t){return!t||t==="all"?e:e.filter(n=>{const o=n[s];return Array.isArray(o)?o.includes(t):o===t})}function ni(e,s){const t=new Set;return e.forEach(n=>{const o=n[s];o!=null&&(Array.isArray(o)?o.forEach(i=>t.add(i)):t.add(o))}),Array.from(t).sort((n,o)=>typeof n=="number"&&typeof o=="number"?n-o:String(n).localeCompare(String(o)))}function si({nodes:e,edges:s,width:t=1e3,height:n=800}){const o=y.useRef(null);return y.useEffect(()=>{if(!o.current||s.length===0||e.length===0){o.current&&_e(o.current).selectAll("*").remove();return}_e(o.current).selectAll("*").remove();const i=ei(e,s),l=_e(o.current).attr("width","100%").attr("height","100%").attr("viewBox",`0 0 ${t} ${n}`).attr("preserveAspectRatio","xMidYMid meet"),a=Math.min(t,n)*.5-40,u=a-20,d=zs().scaleExtent([.1,4]).on("zoom",function(v){S.attr("transform",v.transform.toString())});l.call(d);const c=l.append("g").attr("class","reset-button").style("cursor","pointer").attr("transform",`translate(${t-120}, 10)`).on("click",function(){l.transition().duration(750).call(d.transform,Hs)});c.append("rect").attr("width",110).attr("height",30).attr("rx",4).attr("fill","white").attr("stroke","#ccc").attr("stroke-width",1),c.append("text").attr("x",55).attr("y",20).attr("text-anchor","middle").attr("font-size","12px").attr("fill","#333").text("Reset View");const m=ir().padAngle(.05).sortSubgroups(rr)(i.matrix),f=xr().radius(u),w=ps(bs),S=l.append("g").attr("class","zoom-group"),b=S.append("g").attr("transform",`translate(${t/2}, ${n/2})`),h=b.append("g").selectAll("g").data(m.groups).join("g");h.append("path").attr("fill",v=>w(String(v.index))).attr("stroke",v=>jt(w(String(v.index))).darker().formatHex()).attr("d",Fr().innerRadius(u).outerRadius(a)).on("mouseover",function(v,x){_e(this).attr("fill",jt(w(String(x.index))).brighter(1).formatHex()),b.selectAll("path.chord").style("opacity",_=>_.source.index===x.index||_.target.index===x.index?1:.2)}).on("mouseout",function(){_e(this).attr("fill",v=>w(String(v.index))),b.selectAll("path.chord").style("opacity",1)}),h.append("text").attr("dy",".35em").attr("transform",v=>`
        rotate(${(v.startAngle+v.endAngle)/2*180/Math.PI-90})
        translate(${a+10})
        ${(v.startAngle+v.endAngle)/2>Math.PI?"rotate(180)":""}
      `).attr("text-anchor",v=>(v.startAngle+v.endAngle)/2>Math.PI?"end":"start").text(v=>i.labels[v.index]).style("font-size","12px").style("font-weight","500"),b.append("g").attr("fill-opacity",.67).selectAll("path").data(m).join("path").attr("class","chord").attr("d",v=>f(v)??"").attr("fill",v=>w(String(v.source.index))).attr("stroke",v=>jt(w(String(v.source.index))).darker().formatHex()).style("stroke-width","1px").on("mouseover",function(v,x){_e(this).attr("fill-opacity",1).style("stroke-width","2px"),_e("body").append("div").attr("class","tooltip").style("position","absolute").style("background","rgba(0, 0, 0, 0.8)").style("color","white").style("padding","8px").style("border-radius","4px").style("pointer-events","none").style("opacity",0).style("transition","opacity 0.2s").html(`${i.labels[x.source.index]} → ${i.labels[x.target.index]}: ${x.source.value.toLocaleString()}`).style("opacity",1)}).on("mousemove",function(v){_e(".tooltip").style("left",`${v.pageX+10}px`).style("top",`${v.pageY-10}px`)}).on("mouseout",function(){_e(this).attr("fill-opacity",.67).style("stroke-width","1px"),_e(".tooltip").remove()})},[e,s,t,n]),r.jsx("div",{className:"w-full h-full",children:r.jsx("svg",{ref:o,className:"border border-gray-200 rounded bg-white"})})}const ri=200,oi=600,ii=384,gs=4;function ai({isCollapsed:e,onToggle:s,onResize:t,children:n,title:o="Settings",bottomContent:i}){const[l,a]=y.useState(ii),[u,d]=y.useState(!1),c=y.useRef(null),p=y.useRef(null);return y.useEffect(()=>{if(!u)return;const m=w=>{var S;if(!e&&((S=c.current)==null?void 0:S.getBoundingClientRect())){const h=Math.max(ri,Math.min(oi,window.innerWidth-w.clientX));a(h),t==null||t(h)}},f=()=>{d(!1)};return document.addEventListener("mousemove",m),document.addEventListener("mouseup",f),()=>{document.removeEventListener("mousemove",m),document.removeEventListener("mouseup",f)}},[u,e,t]),r.jsxs("div",{ref:c,className:"bg-white border-l border-gray-200 flex flex-col transition-all duration-300  overflow-hidden relative",style:{minHeight:"100vh",width:e?`${gs}px`:`${l}px`},children:[e&&r.jsxs(r.Fragment,{children:[r.jsx("div",{onClick:s,className:"w-full h-full bg-gray-100 hover:bg-blue-400 cursor-pointer transition-colors",style:{width:`${gs}px`},title:"Click to expand settings"}),r.jsx("button",{onClick:s,className:"fixed bottom-4 right-4 z-50 p-3 bg-blue-600 hover:bg-blue-700 text-white rounded-full shadow-lg cursor-pointer transition-all hover:scale-110 flex items-center justify-center",style:{width:"48px",height:"48px"},title:"Open visualization settings","aria-label":"Open visualization settings",children:r.jsx(Yn,{className:"w-5 h-5"})})]}),!e&&r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:n}),i&&r.jsx("div",{className:"flex-shrink-0 border-t border-gray-200 bg-white",children:i}),r.jsxs("button",{onClick:s,className:"w-full flex items-center justify-between p-2 border-t border-gray-200 flex-shrink-0 bg-gray-50 hover:bg-gray-100 transition-colors cursor-pointer","aria-label":"Collapse settings",children:[r.jsxs("div",{className:"flex items-center gap-2 flex-1",children:[r.jsx(Yn,{className:"w-4 h-4 text-gray-600"}),r.jsx("span",{className:"text-sm font-medium text-gray-700",children:o})]}),r.jsx(Os,{className:"w-4 h-4 text-gray-600 flex-shrink-0"})]}),r.jsx("div",{ref:p,onMouseDown:m=>{m.preventDefault(),d(!0)},className:"absolute top-0 left-0 w-1 h-full cursor-col-resize hover:bg-blue-400 bg-gray-300 transition-colors z-10",style:{touchAction:"none"},children:r.jsx("div",{className:"absolute top-1/2 left-0 transform -translate-y-1/2 -translate-x-0.5",children:r.jsx(Gs,{className:"w-3 h-6 text-gray-500"})})})]})]})}const Es=["Alabama","Alaska","Arizona","Arkansas","California","Colorado","Connecticut","Delaware","District of Columbia","Florida","Georgia","Hawaii","Idaho","Illinois","Indiana","Iowa","Kansas","Kentucky","Louisiana","Maine","Maryland","Massachusetts","Michigan","Minnesota","Mississippi","Missouri","Montana","Nebraska","Nevada","New Hampshire","New Jersey","New Mexico","New York","North Carolina","North Dakota","Ohio","Oklahoma","Oregon","Pennsylvania","Rhode Island","South Carolina","South Dakota","Tennessee","Texas","Utah","Vermont","Virginia","Washington","West Virginia","Wisconsin","Wyoming"],li=new Set(Es),ui=Es.length,fs=Qs.reduce((e,s)=>(e[s]=s===2020?"ACS 1-year state-to-state migration flows for 2020 were not released by the Census Bureau due to pandemic-related data quality concerns.":"State-to-state migration data is unavailable for this year in the ACS 1-year series.",e),{});function Pt({title:e,subtitle:s,children:t,defaultOpen:n=!1,onReset:o}){const[i,l]=y.useState(n);return r.jsxs("div",{className:"border border-gray-200 rounded-md",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("button",{onClick:()=>l(!i),className:"flex-1 flex items-center justify-between p-3 hover:bg-gray-50 transition-colors text-left",children:[r.jsxs("div",{className:"flex-1",children:[r.jsx("div",{className:"font-semibold text-sm",children:e}),s&&r.jsx("div",{className:"text-xs text-gray-600 mt-0.5",children:s})]}),i?r.jsx(nr,{className:"w-4 h-4 text-gray-600 flex-shrink-0"}):r.jsx(er,{className:"w-4 h-4 text-gray-600 flex-shrink-0"})]}),o&&r.jsx("button",{type:"button",onClick:a=>{a.stopPropagation(),o()},className:"pr-3 text-[11px] font-medium text-blue-600 hover:text-blue-800 transition-colors",children:"Reset"})]}),i&&r.jsx("div",{className:"p-3 pt-0 border-t border-gray-200",children:t})]})}const ms=hs(["kriskogram","table","sankey","chord"]),Qt=e=>{const s=e!==void 0?Cn().default(e):Cn().optional();return _t(t=>{if(t==null||t==="")return e;const n=typeof t=="string"?parseFloat(t):Number(t);return Number.isNaN(n)?e:n},s)},ci=e=>_t(s=>{if(typeof s=="boolean")return s;if(typeof s=="string"){if(s.toLowerCase()==="true")return!0;if(s.toLowerCase()==="false")return!1}return e},Ys().default(e));Ks({dataset:cn().optional(),view:_t(e=>typeof e=="string"&&ms.safeParse(e).success?e:"kriskogram",ms.default("kriskogram")),year:Qt(void 0),minThreshold:Qt(0),maxThreshold:Qt(2e5),maxEdges:Qt(500),edgeWeightScale:_t(e=>{if(typeof e!="string")return"linear";const s=e.toLowerCase();return["linear","sqrt","log"].includes(s)?s:"linear"},hs(["linear","sqrt","log"]).default("linear")),egoNodeId:_t(e=>e==null||e===""||e==="null"?null:typeof e=="string"?e:void 0,cn().nullable().optional()),egoNeighborSteps:_t(e=>{if(e==null||e==="")return 1;const s=typeof e=="string"?parseInt(e,10):Number(e);return Number.isNaN(s)||s<1?1:Math.max(1,Math.round(s))},Cn().min(1).default(1)),edgeType:_t(e=>e==="null"||e===""?null:typeof e=="string"?e:void 0,cn().nullable().optional()),showAllNodes:ci(!1)});function hi(){const e=Us({from:"/explorer"}),s=Bs(),{leftSidebarCollapsed:t,leftSidebarWidth:n,setSidebarContent:o}=qs(),[i,l]=y.useState(e.dataset),[a,u]=y.useState(void 0),[d,c]=y.useState(e.year),[p,m]=y.useState(!1),[f,w]=y.useState(null),[S,b]=y.useState(0),[h,v]=y.useState(e.minThreshold??0),[x,_]=y.useState(e.maxThreshold??2e5),[N,j]=y.useState(e.maxEdges??500),[k,I]=y.useState(e.edgeType??null),[P,W]=y.useState(e.view),[D,Q]=y.useState(e.showAllNodes??!1),[F,B]=y.useState(e.egoNodeId??null),[K,ue]=y.useState(e.egoNeighborSteps??1),[re,ye]=y.useState(e.edgeWeightScale??"linear"),Fe=y.useRef(null),[C,L]=y.useState(!1),[pe,Ee]=y.useState(384),[Pe,U]=y.useState({width:typeof window<"u"?window.innerWidth:1200,height:typeof window<"u"?window.innerHeight:800});y.useEffect(()=>(o(r.jsx(dt,{fallback:r.jsxs("div",{className:"p-4",children:[r.jsx("h2",{className:"text-lg font-bold text-red-800 mb-2",children:"Dataset Sidebar Error"}),r.jsx("p",{className:"text-sm text-red-700",children:"The dataset sidebar encountered an error."})]}),children:r.jsx(Qo,{selectedId:i,onSelect:g=>{l(g),he({dataset:g})},onRefresh:()=>b(g=>g+1)})})),()=>{o(null)}),[i,S]),y.useEffect(()=>{if(typeof window>"u")return;const g=()=>{U({width:window.innerWidth,height:window.innerHeight})};return g(),window.addEventListener("resize",g),()=>window.removeEventListener("resize",g)},[]),y.useEffect(()=>{typeof window<"u"&&setTimeout(()=>{U({width:window.innerWidth,height:window.innerHeight})},100)},[t,C,n,pe]);const[Ce,Y]=y.useState("alphabetical"),[$e,Ve]=y.useState(.85),[Ie,ke]=y.useState("weight"),[ot,Vt]=y.useState(!1),[ge,nt]=y.useState("direction"),[lt,R]=y.useState(null),[$,H]=y.useState("weight"),[oe,X]=y.useState(null),[ie,de]=y.useState(.6),[Ke,it]=y.useState(!0),[Ge,je]=y.useState("none"),[Se,zn]=y.useState(2),[tn,Hn]=y.useState("single"),[Nt,On]=y.useState(null),[Ue,Gn]=y.useState("fixed"),[Ht,Un]=y.useState(null),[ut,Ot]=y.useState("pan"),[Gt,nn]=y.useState(80),[Bn,qn]=y.useState({x:0,y:0}),he=y.useMemo(()=>g=>{s({to:"/explorer",search:M=>({view:M.view??"kriskogram",...M,...g}),replace:!0})},[s]),Ps=y.useMemo(()=>a&&a.timeRange.start!==a.timeRange.end,[a]),ht=y.useRef(!0);y.useEffect(()=>{so().catch(()=>{}),di().then(g=>{const M=e.dataset||g;M&&(l(M),!e.dataset&&ht.current&&he({dataset:M})),ht.current=!1}).catch(g=>w(g instanceof Error?g.message:"Failed to preload datasets"))},[]),y.useEffect(()=>{if(!i){u(void 0);return}m(!0),w(null),ft(i).then(g=>{u(g),g&&(c(g.timeRange.start),v(0),j(500))}).catch(g=>w(g instanceof Error?g.message:"Failed to load dataset")).finally(()=>m(!1))},[i,S]);const be=y.useMemo(()=>{if(!(!a||d===void 0))return a.snapshots.find(g=>(typeof g.timestamp=="string"?parseInt(g.timestamp,10):g.timestamp)===d)},[a,d]),we=y.useMemo(()=>{if(!a)return null;let g=1/0,M=-1/0,V=0;return a.snapshots.forEach(T=>{const q=Array.isArray(T==null?void 0:T.edges)?T.edges:[];let Z=0;q.forEach(me=>{if(me!=null&&me.source&&me.source===me.target)return;const ee=Number(me==null?void 0:me.value);Number.isFinite(ee)&&(Z+=1,ee<g&&(g=ee),ee>M&&(M=ee))}),Z>V&&(V=Z)}),g===1/0||M===-1/0?{min:0,max:0,maxEdgesCount:V}:{min:g,max:M,maxEdgesCount:V}},[a]),Rt=y.useMemo(()=>{if(!a)return null;let g=1/0,M=-1/0;return a.snapshots.forEach(V=>{const T=new Map,q=new Map;(Array.isArray(V==null?void 0:V.edges)?V.edges:[]).forEach(ee=>{const se=q.get(ee.source)||0;q.set(ee.source,se+ee.value);const ce=T.get(ee.target)||0;T.set(ee.target,ce+ee.value)}),(Array.isArray(V==null?void 0:V.nodes)?V.nodes:[]).forEach(ee=>{const se=(T.get(ee.id)||0)-(q.get(ee.id)||0);se<g&&(g=se),se>M&&(M=se)})}),g===1/0||M===-1/0?{min:0,max:0}:{min:g,max:M}},[a]),Mt=y.useMemo(()=>{if(!a)return null;let g=0,M=0;return a.snapshots.forEach(V=>{const T=new Map,q=new Map;(Array.isArray(V==null?void 0:V.edges)?V.edges:[]).forEach(ee=>{const se=q.get(ee.source)||0;q.set(ee.source,se+ee.value);const ce=T.get(ee.target)||0;T.set(ee.target,ce+ee.value)}),(Array.isArray(V==null?void 0:V.nodes)?V.nodes:[]).forEach(ee=>{const se=T.get(ee.id)||0,ce=q.get(ee.id)||0;se>g&&(g=se),ce>M&&(M=ce)})}),{maxIncoming:g,maxOutgoing:M}},[a]),Ft=y.useMemo(()=>{if(!a)return null;let g=0;return a.snapshots.forEach(M=>{const V=Array.isArray(M==null?void 0:M.edges)?M.edges:[],T=new Map;V.forEach(q=>{if(q!=null&&q.source&&q.source===q.target){const Z=Number(q.value);if(!Number.isFinite(Z)||Z<=0)return;const me=T.get(q.source)||0;T.set(q.source,me+Z)}}),T.forEach(q=>{q>g&&(g=q)})}),{max:g}},[a]);y.useEffect(()=>{if(!we)return;const{min:g,max:M,maxEdgesCount:V}=we;if(!Number.isFinite(g)||!Number.isFinite(M))return;const T=(se,ce,Re)=>Re<ce||!Number.isFinite(se)||se<ce?ce:se>Re?Re:se,q=T(h,g,M);let Z=T(x,g,M);Z<q&&(Z=q);const me=Math.max(1,V),ee=Math.max(1,Math.min(N,me));q!==h&&v(q),Z!==x&&_(Z),ee!==N&&j(ee)},[we,h,x,N]);const xt=y.useMemo(()=>{if(!be||!(a!=null&&a.metadata))return null;const M=["migration_type","type","category","edge_type"].find(T=>{var q,Z;return((q=a.metadata)==null?void 0:q.edgeProperties.includes(T))||((Z=a.metadata)==null?void 0:Z.hasCategoricalProperties.edges.includes(T))});if(!M)return null;const V=ni(be.edges,M);return{property:M,values:V.map(T=>String(T))}},[be,a]);y.useEffect(()=>{I(null)},[i]),y.useEffect(()=>{be&&F&&(be.nodes.some(M=>M.id===F)||(B(null),he({egoNodeId:null})))},[be,F,he]);const z=y.useMemo(()=>{if(!be)return{nodes:[],edges:[]};const g=new Map,M=new Map,V=new Map;be.edges.forEach(E=>{const ae=M.get(E.source)||0;M.set(E.source,ae+E.value);const ne=g.get(E.target)||0;if(g.set(E.target,ne+E.value),E.source===E.target){const le=V.get(E.source)||0;V.set(E.source,le+E.value)}});let T=ti(be.edges,(xt==null?void 0:xt.property)||"",k);if(T=T.filter(E=>(E==null?void 0:E.source)!==(E==null?void 0:E.target)),Ge!=="none"){const E=new Map(be.nodes.map(ae=>[ae.id,ae]));Ge==="region"?T=T.filter(ae=>{const ne=E.get(ae.source),le=E.get(ae.target);return ne&&le&&ne.region&&le.region&&ne.region===le.region}):Ge==="division"?T=T.filter(ae=>{const ne=E.get(ae.source),le=E.get(ae.target);return ne&&le&&ne.division&&le.division&&ne.division===le.division}):Ge==="interRegion"?T=T.filter(ae=>{const ne=E.get(ae.source),le=E.get(ae.target);return ne&&le&&ne.region&&le.region&&ne.region!==le.region}):Ge==="interDivision"&&(T=T.filter(ae=>{const ne=E.get(ae.source),le=E.get(ae.target);return ne&&le&&ne.division&&le.division&&ne.division!==le.division}))}const q=T.filter(E=>E.value>=h&&E.value<=x).sort((E,ae)=>ae.value-E.value).slice(0,N);let Z=q;if(P==="kriskogram"&&F){const E=Math.max(1,Math.round(K)),ae=new Set;let ne=new Set;const le=new Set;ne.add(F),le.add(F);for(let Xe=1;Xe<=E&&ne.size>0;Xe+=1){const st=new Set;q.forEach((Be,bt)=>{(ne.has(Be.source)||ne.has(Be.target))&&(ae.add(bt),le.has(Be.source)||(le.add(Be.source),st.add(Be.source)),le.has(Be.target)||(le.add(Be.target),st.add(Be.target)))}),ne=st}Z=q.filter((Xe,st)=>ae.has(st))}const me=new Set;Z.forEach(E=>{me.add(E.source),me.add(E.target)}),F&&me.add(F);const ee=new Map,se=new Map;return Z.forEach(E=>{const ae=se.get(E.source)||0;se.set(E.source,ae+E.value);const ne=ee.get(E.target)||0;ee.set(E.target,ne+E.value)}),{nodes:(P==="kriskogram"&&D?be.nodes:be.nodes.filter(E=>me.has(E.id))).map(E=>{const ae=ee.get(E.id)||0,ne=se.get(E.id)||0,le=g.get(E.id)||0,Xe=M.get(E.id)||0,st=ae-ne,Be=le-Xe,bt=V.get(E.id)||0;return{...E,_totalIncoming:ae,_totalOutgoing:ne,total_incoming_visible:ae,total_outgoing_visible:ne,total_incoming_year:le,total_outgoing_year:Xe,net_flow_visible:st,net_flow_year:Be,self_flow_year:bt}}),edges:Z}},[be,h,x,N,k,xt,Ge,D,P,F,K,re]),Ye=y.useMemo(()=>{if(!be)return null;const g=be.edges.length,M=be.nodes.length,V=be.edges.reduce((Z,me)=>Z+me.value,0),T=g>0?V/g:0,q=g>0?Math.max(...be.edges.map(Z=>Z.value)):0;return{totalNodes:M,totalEdges:g,visibleNodes:z.nodes.length,visibleEdges:z.edges.length,avgValue:T,maxValue:q}},[be,z]),Je=(we==null?void 0:we.min)??0,kt=(we==null?void 0:we.max)??(Ye==null?void 0:Ye.maxValue)??Je,$t=Math.max(Je,kt),As=Math.max($t,1),Wn=Math.max(1,Math.floor(As/1e3)),sn=(we==null?void 0:we.maxEdgesCount)??(Ye==null?void 0:Ye.totalEdges)??0,rn=Math.max(500,sn),on=y.useMemo(()=>{if(!(!z||z.edges.length===0))return Math.min(...z.edges.map(g=>g.value))},[z]),vt=y.useMemo(()=>z.nodes.some(g=>g&&g.region),[z]),yt=y.useMemo(()=>z.nodes.some(g=>g&&g.division),[z]);y.useEffect(()=>{!vt&&ge==="region"&&nt("direction"),!yt&&ge==="division"&&nt("direction")},[vt,yt,ge]);const an=y.useMemo(()=>{if(!(!z||z.edges.length===0))return Math.max(...z.edges.map(g=>g.value))},[z]);y.useEffect(()=>{P==="kriskogram"&&z.nodes.length>0&&Fe.current&&Fe.current.updateData(z.nodes,z.edges)},[z,P]);const Vs=g=>{c(g),ht.current||he({year:g})};return y.useEffect(()=>{ht.current||he({minThreshold:h,maxThreshold:x,maxEdges:N})},[h,x,N]),y.useEffect(()=>{ht.current||he({view:P})},[P]),y.useEffect(()=>{ht.current||he({edgeType:k})},[k]),y.useEffect(()=>{!ht.current&&i&&he({dataset:i})},[i]),r.jsx(dt,{fallback:r.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center",children:r.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-8 max-w-lg mx-4",children:[r.jsx("h2",{className:"text-2xl font-bold text-red-800 mb-4",children:"Explorer Error"}),r.jsx("p",{className:"text-gray-700 mb-4",children:"The explorer page encountered an error. Please refresh the page."}),r.jsx("button",{onClick:()=>window.location.reload(),className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 cursor-pointer transition-colors",children:"Reload Page"})]})}),children:r.jsxs("div",{className:"flex flex-1 h-full overflow-hidden",children:[r.jsxs("main",{className:"flex-1 flex flex-col overflow-hidden h-full relative",children:[p&&r.jsx("div",{className:"p-4 bg-yellow-50 text-yellow-800",children:"Loading…"}),f&&r.jsx("div",{className:"p-4 bg-red-50 text-red-600",children:f}),a?r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"flex-1 flex flex-col overflow-hidden bg-white",children:r.jsx("div",{className:`flex-1 overflow-hidden ${P==="table"?"":"p-4"}`,children:z.nodes.length>0&&z.edges.length>0?r.jsxs(r.Fragment,{children:[P==="kriskogram"&&r.jsx(dt,{fallback:r.jsxs("div",{className:"p-4 bg-red-50 border border-red-200 rounded-md",children:[r.jsx("h3",{className:"text-lg font-semibold text-red-800 mb-2",children:"Kriskogram Error"}),r.jsx("p",{className:"text-sm text-red-700",children:"The Kriskogram visualization encountered an error."})]}),children:r.jsx("div",{className:"w-full h-full",children:r.jsx(Ws,{ref:Fe,nodes:z.nodes,edges:z.edges,width:Math.max(800,Pe.width-(t?64:n)-(C?4:pe)-40),height:Math.max(600,Pe.height-80),margin:{top:60,right:40,bottom:60,left:40},arcOpacity:$e,title:a.name,accessors:(()=>{const g=z.edges.map(A=>A.value),M=g.length>0?Math.min(...g):0,V=g.length>0?Math.max(...g):1,T=(we==null?void 0:we.min)??M,q=(we==null?void 0:we.max)??V,Z=Math.max(q-T,0),me=A=>{if(!Number.isFinite(A)||Z<=0)return 0;const Ae=Math.min(Math.max(A,T),q)-T;switch(re){case"sqrt":{const Ne=Math.sqrt(Z);return Ne<=0?0:Math.max(0,Math.min(1,Math.sqrt(Ae)/Ne))}case"log":{const Ne=Math.log10(Z+1);return!Number.isFinite(Ne)||Ne<=0?0:Math.max(0,Math.min(1,Math.log10(Ae+1)/Ne))}case"linear":default:{const Ne=Z;return Ne<=0?0:Math.max(0,Math.min(1,Ae/Ne))}}},ee=z.nodes.map(A=>A.total_outgoing_visible||A._totalOutgoing||0),se=z.nodes.map(A=>A.total_incoming_visible||A._totalIncoming||0),ce=z.nodes.map(A=>A.total_outgoing_year||0),Re=z.nodes.map(A=>A.total_incoming_year||0),xe=z.nodes.map(A=>A.net_flow_visible||0),E=z.nodes.map(A=>A.net_flow_year||0),ae=ee.length>0?Math.max(...ee):1,ne=se.length>0?Math.max(...se):1,le=ce.length>0?Math.max(...ce):1,Xe=Re.length>0?Math.max(...Re):1,st=xe.length>0?Math.max(...xe.map(A=>Math.abs(A))):1,Be=E.length>0?Math.max(...E.map(A=>Math.abs(A))):1,bt=(Mt==null?void 0:Mt.maxOutgoing)??le,ln=(Mt==null?void 0:Mt.maxIncoming)??Xe,ks=(Rt==null?void 0:Rt.min)??-Be,Ds=(Rt==null?void 0:Rt.max)??Be,Ut=Math.max(Math.abs(ks),Math.abs(Ds))||1,Ls=(A,Me,Ae)=>{const Ne=Array.from(new Set(z.nodes.map(te=>te[A]).filter(te=>te!=null))),De=new Map;return Ne.forEach((te,Le)=>{De.set(te,Ae[Le%Ae.length])}),De.get(Me)||Ae[0]},Ts=["#3b82f6","#f59e0b","#ef4444","#10b981","#8b5cf6","#ec4899","#14b8a6","#f97316"];return{nodeOrder:A=>{if(Ce==="alphabetical")return A.label||A.id;const Me=A[Ce];return Me==null?`ZZZ_${A.label||A.id}`:typeof Me=="number"?`${String(1e6-Me).padStart(10,"0")}_${A.label||A.id}`:`${String(Me)}_${A.label||A.id}`},nodeColor:A=>{var De;const Me=(te,Le)=>!Number.isFinite(te)||Le<=0?0:Math.max(0,Math.min(1,te/Le)),Ae=(te,Le,Ze)=>{const J=85-Math.max(0,Math.min(1,Ze))*45;return`hsl(${te}, ${Le}%, ${J}%)`},Ne=te=>{if(!Number.isFinite(te)||Ut<=0)return"#6b7280";if(Math.abs(te)<1e-6)return"#9ca3af";const Ze=85-Math.max(0,Math.min(1,Math.abs(te)/Ut))*45;return te>=0?`hsl(0, 75%, ${Ze}%)`:`hsl(210, 75%, ${Ze}%)`};switch(tn){case"single":return"#2563eb";case"outgoing":case"visible_outgoing":{const te=Me(A.total_outgoing_visible||A._totalOutgoing||0,ae);return Ae(24,85,te)}case"incoming":case"visible_incoming":{const te=Me(A.total_incoming_visible||A._totalIncoming||0,ne);return Ae(160,70,te)}case"year_outgoing":{const te=Me(A.total_outgoing_year||0,bt);return Ae(24,85,te)}case"year_incoming":{const te=Me(A.total_incoming_year||0,ln);return Ae(160,70,te)}case"net_year":return Ne(A.net_flow_year||0);case"self_year":{const te=Me(A.self_flow_year||0,(Ft==null?void 0:Ft.max)??0);return Ae(280,70,te)}case"attribute":{if(!Nt)return"#2563eb";const te=A[Nt];if(te==null)return"#9ca3af";if((De=a==null?void 0:a.metadata)!=null&&De.hasNumericProperties.nodes.includes(Nt)){const Le=z.nodes.map(fe=>fe[Nt]).filter(fe=>typeof fe=="number");if(Le.length===0)return"#2563eb";const Ze=Math.min(...Le),J=Math.max(...Le)-Ze||1,ve=(Number(te)-Ze)/J;return`hsl(${120-Math.max(0,Math.min(1,ve))*120}, 70%, 50%)`}return Ls(Nt,te,Ts)}default:return"#2563eb"}},nodeRadius:A=>{const Me=A.total_outgoing_visible||A._totalOutgoing||0,Ae=A.total_incoming_visible||A._totalIncoming||0,Ne=A.total_outgoing_year||0,De=A.total_incoming_year||0,te=Math.abs(A.net_flow_visible||0),Le=Math.abs(A.net_flow_year||0),Ze=A.self_flow_year||0,qe=J=>3+Math.max(0,Math.min(1,J))*9;if(Ue==="fixed")return 6;if(Ue==="visible_outgoing"||Ue==="outgoing")return qe(ae>0?Me/ae:0);if(Ue==="visible_incoming"||Ue==="incoming")return qe(ne>0?Ae/ne:0);if(Ue==="year_outgoing")return qe(bt>0?Ne/bt:0);if(Ue==="year_incoming")return qe(ln>0?De/ln:0);if(Ue==="net_visible"){const J=st>0?st:1;return qe(te/J)}if(Ue==="net_year"){const J=Ut>0?Ut:1;return qe(Le/J)}if(Ue==="attribute"&&Ht){const J=A[Ht];if(typeof J!="number")return 6;const ve=z.nodes.map(Bt=>Bt[Ht]).filter(Bt=>typeof Bt=="number");if(ve.length===0)return 6;const He=Math.min(...ve),et=Math.max(...ve)-He||1,It=(J-He)/et;return qe(It)}if(Ue==="self_year"){const J=(Ft==null?void 0:Ft.max)??0,ve=J>0?Ze/J:0;return qe(ve)}return 6},edgeWidth:A=>Ie==="weight"?.5+me(A.value)*15:Se,edgeColor:(A,Me)=>{var Ze,qe;const Ae=me(A.value),Ne=["#3b82f6","#f59e0b","#ef4444","#10b981","#8b5cf6","#ec4899","#14b8a6","#f97316"];if(!ot&&ge==="direction")return Me?"#1f77b4":"#d62728";let De="#2563eb";if(ge==="direction")De=Me?"#1f77b4":"#d62728";else if(ge==="region"){const J=z.nodes.find(fe=>fe.id===A.source),ve=Array.from(new Set(z.nodes.map(fe=>fe.region).filter(Boolean))),He=new Map(ve.map((fe,et)=>[fe,Ne[et%Ne.length]]));De=J&&J.region&&He.get(J.region)||"#2563eb"}else if(ge==="division"){const J=z.nodes.find(fe=>fe.id===A.source),ve=Array.from(new Set(z.nodes.map(fe=>fe.division).filter(Boolean))),He=new Map(ve.map((fe,et)=>[fe,Ne[et%Ne.length]]));De=J&&J.division&&He.get(J.division)||"#2563eb"}else if(ge==="attribute"&&lt){const J=A[lt];if(J!=null)if((Ze=a==null?void 0:a.metadata)!=null&&Ze.hasNumericProperties.edges.includes(lt)){const ve=z.edges.map(un=>un[lt]).filter(un=>typeof un=="number"),He=Math.min(...ve),et=Math.max(...ve)-He||1;De=`hsl(${120-(Number(J)-He)/et*120}, 70%, 50%)`}else{const ve=Array.from(new Set(z.edges.map(fe=>fe[lt]).filter(fe=>fe!=null)));De=new Map(ve.map((fe,et)=>[fe,Ne[et%Ne.length]])).get(J)||"#2563eb"}}else ge==="single"&&(De="#2563eb");let te=.6;if($==="weight")te=Math.max(0,Math.min(1,Ae));else if($==="attribute"&&oe){const J=A[oe];if(J!=null&&((qe=a==null?void 0:a.metadata)!=null&&qe.hasNumericProperties.edges.includes(oe))){const ve=z.edges.map(It=>It[oe]).filter(It=>typeof It=="number"),He=Math.min(...ve),et=Math.max(...ve)-He||1;te=Math.max(0,Math.min(1,(Number(J)-He)/et))}}else $==="constant"&&(te=Math.max(0,Math.min(1,ie)));if(Ke&&(ge==="region"||ge==="division")){const J=z.nodes.find(fe=>fe.id===A.source),ve=z.nodes.find(fe=>fe.id===A.target);if(!(ge==="region"?(J==null?void 0:J.region)&&J.region===(ve==null?void 0:ve.region):(J==null?void 0:J.division)&&J.division===(ve==null?void 0:ve.division)))return`hsl(0, 0%, ${80-te*50}%)`}const Le=80-te*55;return ge==="direction"?`hsl(${Me?0:200}, 70%, ${Math.round(Le)}%)`:ge==="single"?`hsl(210, 70%, ${Math.round(Le)}%)`:De}}})(),legend:(()=>{const g=z.edges.map(se=>se.value),M=g.length>0?Math.min(...g):0,V=g.length>0?Math.max(...g):1,T=(we==null?void 0:we.min)??M,q=(we==null?void 0:we.max)??V,Z=Math.max(q-T,0),me=se=>{if(!Number.isFinite(se)||Z<=0)return 0;const Re=Math.min(Math.max(se,T),q)-T;switch(re){case"sqrt":{const xe=Math.sqrt(Z);return xe<=0?0:Math.max(0,Math.min(1,Math.sqrt(Re)/xe))}case"log":{const xe=Math.log10(Z+1);return!Number.isFinite(xe)||xe<=0?0:Math.max(0,Math.min(1,Math.log10(Re+1)/xe))}case"linear":default:return Z<=0?0:Math.max(0,Math.min(1,Re/Z))}},ee=se=>{if(Z<=0)return T;const ce=Math.max(0,Math.min(1,se));switch(re){case"sqrt":return T+Math.pow(ce,2)*Z;case"log":{const Re=Math.log10(Z+1);if(!Number.isFinite(Re)||Re<=0)return T;const xe=Math.pow(10,ce*Re)-1;return T+xe}case"linear":default:return T+ce*Z}};if(ot){if(ge==="region"&&vt){const se=Array.from(new Set(z.nodes.map(xe=>xe.region).filter(Boolean))),ce=["#3b82f6","#f59e0b","#ef4444","#10b981","#8b5cf6","#ec4899","#14b8a6","#f97316"];return{type:"categorical",title:"Regions",entries:se.slice(0,10).map((xe,E)=>({label:xe,color:ce[E%ce.length]})),interNote:Ke?"Inter edges: grayscale by intensity":void 0}}if(ge==="division"&&yt){const se=Array.from(new Set(z.nodes.map(xe=>xe.division).filter(Boolean))),ce=["#3b82f6","#f59e0b","#ef4444","#10b981","#8b5cf6","#ec4899","#14b8a6","#f97316"];return{type:"categorical",title:"Divisions",entries:se.slice(0,10).map((xe,E)=>({label:xe,color:ce[E%ce.length]})),interNote:Ke?"Inter edges: grayscale by intensity":void 0}}if(ge==="single"&&$==="weight"){const ce=[0,.5,1].map(Re=>{const xe=ee(Re),E=me(xe),ne=80-E*55,le=`hsl(210, 70%, ${Math.round(ne)}%)`,Xe=Ie==="weight"?.5+E*15:Se;return{fraction:E,value:xe,color:le,width:Xe}});return{type:"weight",color:"#1f77b4",scale:re,min:T,max:q,samples:ce}}}else{if(ge==="direction")return{type:"direction"};if(ge==="single"&&$==="weight"){const ce=[0,.5,1].map(Re=>{const xe=ee(Re),E=me(xe),ne=80-E*55,le=`hsl(210, 70%, ${Math.round(ne)}%)`,Xe=Ie==="weight"?.5+E*15:Se;return{fraction:E,value:xe,color:le,width:Xe}});return{type:"weight",color:"#1f77b4",scale:re,min:T,max:q,samples:ce}}}})(),lens:{enabled:ut==="lens",x:Bn.x,y:Bn.y,radius:Gt},onMouseMoveInCanvas:g=>{ut==="lens"&&qn(g)},onWheelInCanvas:g=>{ut==="lens"&&nn(M=>Math.max(20,Math.min(300,M+(g>0?-10:10))))}})})}),P==="table"&&r.jsx(dt,{fallback:r.jsxs("div",{className:"p-4 bg-red-50 border border-red-200 rounded-md",children:[r.jsx("h3",{className:"text-lg font-semibold text-red-800 mb-2",children:"Table View Error"}),r.jsx("p",{className:"text-sm text-red-700",children:"The table view encountered an error."})]}),children:r.jsx("div",{className:"h-full w-full flex flex-col min-h-0",children:r.jsx(Is,{nodes:z.nodes,edges:z.edges})})}),P==="sankey"&&r.jsx(dt,{fallback:r.jsxs("div",{className:"p-4 bg-red-50 border border-red-200 rounded-md",children:[r.jsx("h3",{className:"text-lg font-semibold text-red-800 mb-2",children:"Sankey Diagram Error"}),r.jsx("p",{className:"text-sm text-red-700",children:"The Sankey diagram encountered an error."})]}),children:r.jsx("div",{className:"h-full min-h-0",children:r.jsx(Jo,{nodes:z.nodes,edges:z.edges,width:Math.max(800,Pe.width-(t?64:n)-(C?4:pe)-40),height:Math.max(600,Pe.height-80)})})}),P==="chord"&&r.jsx(dt,{fallback:r.jsxs("div",{className:"p-4 bg-red-50 border border-red-200 rounded-md",children:[r.jsx("h3",{className:"text-lg font-semibold text-red-800 mb-2",children:"Chord Diagram Error"}),r.jsx("p",{className:"text-sm text-red-700",children:"The chord diagram encountered an error."})]}),children:r.jsx(si,{nodes:z.nodes,edges:z.edges,width:Math.max(800,Pe.width-(t?64:n)-(C?4:pe)-40),height:Math.max(600,Pe.height-80)})})]}):be?r.jsxs("div",{className:"text-center text-gray-500 py-8",children:["No data meets the current threshold range (",h.toLocaleString()," - ",x.toLocaleString(),"). Try adjusting the filters."]}):r.jsx("div",{className:"px-6 py-8 text-center text-gray-600 space-y-3",children:typeof d=="number"&&fs[d]?r.jsxs(r.Fragment,{children:[r.jsxs("p",{className:"text-lg font-semibold text-gray-700",children:["No state-to-state migration snapshot for ",d]}),r.jsx("p",{className:"text-sm leading-relaxed",children:fs[d]})]}):r.jsx("p",{children:"No snapshot to display."})})})}),P==="kriskogram"&&r.jsxs("div",{className:"absolute bottom-4 right-4 flex items-center gap-2 bg-white/90 backdrop-blur px-3 py-2 rounded shadow border border-gray-200",children:[r.jsx("label",{className:"text-xs font-medium text-gray-700",children:"Mode:"}),r.jsx("button",{type:"button",onClick:()=>Ot("pan"),className:["text-xs px-2 py-1 rounded border",ut==="pan"?"bg-blue-600 text-white border-blue-600":"bg-white text-gray-700 border-gray-300"].join(" "),children:"Pan"}),r.jsx("button",{type:"button",onClick:()=>Ot("lens"),className:["text-xs px-2 py-1 rounded border",ut==="lens"?"bg-blue-600 text-white border-blue-600":"bg-white text-gray-700 border-gray-300"].join(" "),children:"Edge Lens"}),ut==="lens"&&r.jsxs("span",{className:"text-[10px] text-gray-600",children:["Wheel: radius (",Gt,"px)"]})]})]}):r.jsx("div",{className:"flex-1 flex items-center justify-center text-gray-500",children:r.jsxs("div",{className:"text-center",children:[r.jsx("p",{className:"text-lg mb-2",children:"No dataset selected"}),r.jsx("p",{className:"text-sm",children:"Select a dataset from the sidebar to begin exploring"})]})})]}),a&&r.jsx(ai,{isCollapsed:C,onToggle:()=>L(!C),onResize:Ee,title:"Visualization Settings",bottomContent:r.jsxs("div",{className:"p-3",children:[r.jsx("label",{className:"text-xs font-medium text-gray-600 block mb-2",children:"Visualization Type"}),r.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[r.jsx("button",{onClick:()=>{W("kriskogram"),he({view:"kriskogram"})},className:`px-3 py-2.5 rounded text-sm font-medium transition-colors ${P==="kriskogram"?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"Kriskogram"}),r.jsx("button",{onClick:()=>{W("table"),he({view:"table"})},className:`px-3 py-2.5 rounded text-sm font-medium transition-colors ${P==="table"?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"Table"}),r.jsx("button",{onClick:()=>{W("sankey"),he({view:"sankey"})},className:`px-3 py-2.5 rounded text-sm font-medium transition-colors ${P==="sankey"?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"Sankey"}),r.jsx("button",{onClick:()=>{W("chord"),he({view:"chord"})},className:`px-3 py-2.5 rounded text-sm font-medium transition-colors ${P==="chord"?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"Chord"})]})]}),children:r.jsxs("div",{className:"space-y-4",children:[r.jsxs(Pt,{title:a.name,defaultOpen:!0,subtitle:`${a.type.toUpperCase()} · ${a.timeRange.start}${a.timeRange.end!==a.timeRange.start?`–${a.timeRange.end}`:""}`,children:[a.notes&&r.jsx("div",{className:"text-xs text-gray-600 mt-2 whitespace-pre-wrap",children:a.notes}),!a.notes&&r.jsx("div",{className:"text-xs text-gray-500 italic mt-2",children:"No description available"})]}),Ye&&r.jsxs("div",{className:"p-3 bg-gray-50 rounded grid grid-cols-2 gap-3 text-sm",children:[r.jsxs("div",{children:[r.jsx("div",{className:"text-xs text-gray-600",children:"Nodes"}),r.jsxs("div",{className:"text-lg font-bold",children:[Ye.visibleNodes,"/",Ye.totalNodes]})]}),r.jsxs("div",{children:[r.jsx("div",{className:"text-xs text-gray-600",children:"Edges"}),r.jsxs("div",{className:"text-lg font-bold",children:[Ye.visibleEdges.toLocaleString(),"/",Ye.totalEdges.toLocaleString()]})]})]}),r.jsx(Pt,{title:"General Settings",defaultOpen:!0,onReset:()=>{const g=Math.max(1,sn);I(null),je("none"),v(Je),_(kt),j(g),he({edgeType:null,minThreshold:Je,maxThreshold:kt,maxEdges:g})},children:r.jsxs("div",{className:"space-y-4",children:[Ps&&d!==void 0&&r.jsxs("div",{className:"space-y-2",children:[r.jsxs("label",{className:"text-sm font-medium",children:["Year: ",d]}),r.jsx("input",{type:"range",min:a.timeRange.start,max:a.timeRange.end,value:d,onChange:g=>Vs(parseInt(g.target.value)),className:"w-full"})]}),xt&&r.jsxs("div",{className:"space-y-2",children:[r.jsxs("label",{className:"text-sm font-medium",children:["Edge Type (",xt.property,")"]}),r.jsxs("select",{value:k||"all",onChange:g=>{const M=g.target.value==="all"?null:g.target.value;I(M),he({edgeType:M})},className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[r.jsx("option",{value:"all",children:"All Types"}),xt.values.map(g=>r.jsx("option",{value:g,children:g},g))]})]}),(vt||yt)&&r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-sm font-medium",children:"Edge Scope"}),r.jsxs("select",{value:Ge,onChange:g=>je(g.target.value),className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[r.jsx("option",{value:"none",children:"All"}),vt&&r.jsx("option",{value:"region",children:"Intra Region"}),yt&&r.jsx("option",{value:"division",children:"Intra Division"}),vt&&r.jsx("option",{value:"interRegion",children:"Inter Region"}),yt&&r.jsx("option",{value:"interDivision",children:"Inter Division"})]})]}),be&&Ye&&r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("label",{className:"text-sm font-medium flex items-center gap-2",children:[r.jsxs("span",{children:["Min: ",h.toLocaleString()]}),on!==void 0&&on>h&&r.jsxs("span",{className:"text-xs text-gray-400",children:["(actual ",on.toLocaleString(),")"]})]}),(()=>{const g=Math.max(1,sn),M=h>Je||x<kt||N<g;return r.jsx("button",{onClick:()=>{v(Je),_(kt),j(g)},disabled:!M,type:"button",className:`text-xs transition-colors ${M?"text-blue-600 hover:text-blue-800":"text-gray-400 cursor-not-allowed"}`,children:"Show All"})})()]}),r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("input",{type:"range",min:Je,max:$t||1,step:Wn,value:h,onChange:g=>{const M=parseInt(g.target.value),V=Math.min(M,x);v(V),he({minThreshold:V})},className:"w-full"}),r.jsx("input",{type:"number",min:Je,max:$t||1,value:h,onChange:g=>{const M=Number.parseInt(g.target.value);if(Number.isNaN(M))return;const V=Math.max(Je,Math.min(M,x));v(V),he({minThreshold:V})},className:"w-24 px-2 py-1 text-sm border border-gray-300 rounded-md"})]})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsxs("label",{className:"text-sm font-medium flex items-center gap-2",children:[r.jsxs("span",{children:["Max: ",x.toLocaleString()]}),an!==void 0&&an<x&&r.jsxs("span",{className:"text-xs text-gray-400",children:["(actual ",an.toLocaleString(),")"]})]}),r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("input",{type:"range",min:Je,max:$t||1,step:Wn,value:x,onChange:g=>{const M=parseInt(g.target.value),V=Math.max(M,h);_(V),he({maxThreshold:V})},className:"w-full"}),r.jsx("input",{type:"number",min:Je,max:$t||1,value:x,onChange:g=>{const M=Number.parseInt(g.target.value);if(Number.isNaN(M))return;const V=Math.min($t||1,Math.max(M,h));_(V),he({maxThreshold:V})},className:"w-24 px-2 py-1 text-sm border border-gray-300 rounded-md"})]})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsxs("label",{className:"text-sm font-medium",children:["Max Edges: ",N]}),r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("input",{type:"range",min:10,max:rn,step:10,value:N,onChange:g=>{const M=parseInt(g.target.value);j(M),he({maxEdges:M})},className:"w-full"}),r.jsx("input",{type:"number",min:1,max:rn,value:N,onChange:g=>{const M=Number.parseInt(g.target.value);if(Number.isNaN(M))return;const V=Math.max(1,Math.min(M,rn));j(V),he({maxEdges:V})},className:"w-24 px-2 py-1 text-sm border border-gray-300 rounded-md"})]}),r.jsxs("p",{className:"text-xs text-gray-600 italic",children:["After filtering by thresholds and edge type, edges are sorted by value (highest first) and the top ",N," edges are displayed."]})]})]})]})}),P==="kriskogram"&&r.jsx(Pt,{title:"Kriskogram Settings",defaultOpen:!0,onReset:()=>{Q(!1),Y("alphabetical"),Ve(.85),ke("weight"),zn(2),Hn("single"),On(null),Gn("fixed"),Un(null),Vt(!1),nt("direction"),R(null),it(!0),H("weight"),X(null),de(.6),Ot("pan"),nn(80),qn({x:0,y:0}),B(null),ue(1),ye("linear"),he({showAllNodes:!1,egoNodeId:null,egoNeighborSteps:1,edgeWeightScale:"linear"})},children:a!=null&&a.metadata?r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{className:"flex items-center justify-between p-2 bg-gray-50 rounded border border-gray-200",children:[r.jsxs("div",{children:[r.jsx("label",{htmlFor:"kriskogram-show-all-nodes",className:"text-sm font-medium text-gray-700",children:"Always show all nodes"}),r.jsx("p",{className:"text-xs text-gray-500",children:"Keeps every location visible even if its edges fall outside the filters."})]}),r.jsx("input",{id:"kriskogram-show-all-nodes",type:"checkbox",className:"w-4 h-4",checked:D,onChange:g=>{const M=g.target.checked;Q(M),he({showAllNodes:M})}})]}),r.jsxs("div",{className:"space-y-3",children:[r.jsxs("div",{children:[r.jsx("label",{htmlFor:"kriskogram-ego-node",className:"text-xs font-medium text-gray-700",children:"Ego focus (optional)"}),r.jsxs("select",{id:"kriskogram-ego-node",value:F??"",onChange:g=>{const M=g.target.value,V=M===""?null:M;B(V),he({egoNodeId:V})},className:"mt-1 w-full px-2 py-1.5 text-xs border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[r.jsx("option",{value:"",children:"No ego focus (show all eligible edges)"}),((be==null?void 0:be.nodes)??[]).map(g=>r.jsx("option",{value:g.id,children:g.label||g.id},g.id))]}),r.jsx("p",{className:"mt-1 text-[11px] text-gray-500",children:"Limit the visualization to flows centered on a selected node."})]}),r.jsxs("div",{children:[r.jsx("label",{htmlFor:"kriskogram-ego-steps",className:"text-xs font-medium text-gray-700",children:"Neighbor steps"}),r.jsxs("div",{className:"mt-1 flex items-center gap-2",children:[r.jsx("input",{id:"kriskogram-ego-steps",type:"number",min:1,max:10,value:K,disabled:!F,onChange:g=>{const M=Number.parseInt(g.target.value,10);if(Number.isNaN(M))return;const V=Math.max(1,Math.min(M,10));ue(V),he({egoNeighborSteps:V})},className:"w-20 px-2 py-1 text-xs border border-gray-300 rounded-md disabled:bg-gray-100 disabled:text-gray-500"}),r.jsx("span",{className:"text-[11px] text-gray-500",children:"How many hops from the ego node to include (based on currently visible edges)."})]})]})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx("label",{className:"text-xs font-medium text-gray-700",children:"Node Ordering"}),r.jsxs("select",{value:Ce,onChange:g=>Y(g.target.value),className:"w-full px-2 py-1.5 text-xs border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[r.jsx("option",{value:"alphabetical",children:"Alphabetical"}),a.metadata.hasCategoricalProperties.nodes.map(g=>r.jsxs("option",{value:g,children:["By ",g]},g)),a.metadata.hasNumericProperties.nodes.map(g=>r.jsxs("option",{value:g,children:["By ",g]},g))]})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsxs("label",{className:"text-xs font-medium text-gray-700",children:["Arc Opacity: ",Math.round($e*100),"%"]}),r.jsx("input",{type:"range",min:0,max:1,step:.05,value:$e,onChange:g=>Ve(parseFloat(g.target.value)),className:"w-full"})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx("label",{className:"text-xs font-medium text-gray-700",children:"Edge Width"}),r.jsxs("div",{className:"flex items-center gap-3 text-xs",children:[r.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[r.jsx("input",{type:"radio",name:"edgeWidthMode",value:"weight",checked:Ie==="weight",onChange:()=>ke("weight"),className:"w-3.5 h-3.5"}),r.jsx("span",{children:"By Weight"})]}),r.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[r.jsx("input",{type:"radio",name:"edgeWidthMode",value:"fixed",checked:Ie==="fixed",onChange:()=>ke("fixed"),className:"w-3.5 h-3.5"}),r.jsx("span",{children:"Fixed"})]})]}),Ie==="fixed"&&r.jsxs("div",{className:"mt-2",children:[r.jsxs("label",{className:"text-xs font-medium text-gray-700",children:["Base Edge Width: ",Se.toFixed(1),"px"]}),r.jsx("input",{type:"range",min:.5,max:8,step:.1,value:Se,onChange:g=>zn(parseFloat(g.target.value)),className:"w-full"})]}),r.jsxs("div",{className:"mt-2 space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-gray-700",children:"Weight scaling"}),r.jsxs("select",{value:re,onChange:g=>{const M=g.target.value;ye(M),he({edgeWeightScale:M})},className:"w-full px-2 py-1.5 text-xs border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[r.jsx("option",{value:"linear",children:"Linear (use raw weight differences)"}),r.jsx("option",{value:"sqrt",children:"Square root (compress extremes)"}),r.jsx("option",{value:"log",children:"Logarithmic (highlight small flows)"})]}),r.jsx("p",{className:"text-[11px] text-gray-500",children:"Applies to both edge widths and weight-based color intensity."})]})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("label",{className:"text-xs font-medium text-gray-700",children:"Edge Color"}),r.jsxs("label",{className:"flex items-center gap-1 text-[11px] text-gray-600 cursor-pointer",children:[r.jsx("input",{type:"checkbox",className:"w-3.5 h-3.5",checked:ot,onChange:g=>{const M=g.target.checked;Vt(M),M||(nt("direction"),R(null),it(!0),H("weight"),X(null),de(.6))}}),"Advanced"]})]}),!ot&&r.jsxs("div",{className:"flex flex-col gap-1.5 text-xs",children:[r.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[r.jsx("input",{type:"radio",name:"edgeColorHueSimple",value:"direction",checked:ge==="direction",onChange:()=>nt("direction"),className:"w-3.5 h-3.5"}),r.jsx("span",{children:"By Direction (Above/Below)"})]}),r.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[r.jsx("input",{type:"radio",name:"edgeColorHueSimple",value:"weight",checked:$==="weight"&&ge==="single",onChange:()=>{nt("single"),H("weight")},className:"w-3.5 h-3.5"}),r.jsx("span",{children:"By Weight Intensity"})]})]}),ot&&r.jsxs("div",{className:"space-y-3 border border-gray-200 rounded-md p-3 bg-gray-50/60",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-gray-700",children:"Hue Source"}),r.jsxs("select",{value:ge,onChange:g=>{const M=g.target.value;nt(M)},className:"w-full px-2 py-1.5 text-xs border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[r.jsx("option",{value:"direction",children:"Direction (above/below)"}),r.jsx("option",{value:"region",disabled:!vt,children:"Region"}),r.jsx("option",{value:"division",disabled:!yt,children:"Division"}),r.jsx("option",{value:"attribute",children:"Attribute"}),r.jsx("option",{value:"single",children:"Single Color"})]}),ge==="attribute"&&(a==null?void 0:a.metadata)&&r.jsxs("div",{className:"mt-2",children:[r.jsx("label",{className:"text-xs text-gray-600",children:"Hue Attribute"}),r.jsxs("select",{className:"w-full px-2 py-1.5 text-xs border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",value:lt||"",onChange:g=>R(g.target.value||null),children:[r.jsx("option",{value:"",children:"Select attribute…"}),[...a.metadata.hasNumericProperties.edges,...a.metadata.hasCategoricalProperties.edges].filter((g,M,V)=>V.indexOf(g)===M).map(g=>r.jsx("option",{value:g,children:g},g))]})]}),(ge==="region"||ge==="division")&&r.jsxs("label",{className:"flex items-center gap-2 mt-2 text-[11px] text-gray-600 cursor-pointer",children:[r.jsx("input",{type:"checkbox",className:"w-3.5 h-3.5",checked:Ke,onChange:g=>it(g.target.checked)}),"Inter edges grayscale by intensity"]})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-medium text-gray-700",children:"Intensity Source"}),r.jsxs("select",{value:$,onChange:g=>H(g.target.value),className:"w-full px-2 py-1.5 text-xs border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[r.jsx("option",{value:"weight",children:"Weight"}),r.jsx("option",{value:"constant",children:"Constant"}),r.jsx("option",{value:"attribute",children:"Attribute"})]}),$==="constant"&&r.jsxs("div",{className:"mt-2",children:[r.jsxs("label",{className:"text-xs text-gray-600",children:["Constant Intensity: ",(ie*100).toFixed(0),"%"]}),r.jsx("input",{type:"range",min:0,max:1,step:.01,value:ie,onChange:g=>de(parseFloat(g.target.value)),className:"w-full"})]}),$==="attribute"&&(a==null?void 0:a.metadata)&&r.jsxs("div",{className:"mt-2",children:[r.jsx("label",{className:"text-xs text-gray-600",children:"Intensity Attribute"}),r.jsxs("select",{className:"w-full px-2 py-1.5 text-xs border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",value:oe||"",onChange:g=>X(g.target.value||null),children:[r.jsx("option",{value:"",children:"Select attribute…"}),a.metadata.hasNumericProperties.edges.map(g=>r.jsx("option",{value:g,children:g},g))]})]})]})]})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx("label",{className:"text-xs font-medium text-gray-700",children:"Node Color"}),r.jsxs("select",{value:tn,onChange:g=>Hn(g.target.value),className:"w-full px-2 py-1.5 text-xs border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[r.jsx("option",{value:"single",children:"Single Color"}),r.jsx("option",{value:"visible_outgoing",children:"Visible Outgoing Flow"}),r.jsx("option",{value:"visible_incoming",children:"Visible Incoming Flow"}),r.jsx("option",{value:"year_outgoing",children:"Year Outgoing Flow"}),r.jsx("option",{value:"year_incoming",children:"Year Incoming Flow"}),r.jsx("option",{value:"net_year",children:"Net Flow (year)"}),r.jsx("option",{value:"self_year",children:"Self Flow (year)"}),r.jsx("option",{value:"attribute",children:"By Attribute"})]}),tn==="attribute"&&r.jsxs("select",{value:Nt||"",onChange:g=>On(g.target.value||null),className:"w-full px-2 py-1.5 text-xs border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[r.jsx("option",{value:"",children:"Select..."}),a.metadata.hasCategoricalProperties.nodes.map(g=>r.jsx("option",{value:g,children:g},g)),a.metadata.hasNumericProperties.nodes.map(g=>r.jsx("option",{value:g,children:g},g))]})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx("label",{className:"text-xs font-medium text-gray-700",children:"Node Size"}),r.jsxs("select",{value:Ue,onChange:g=>Gn(g.target.value),className:"w-full px-2 py-1.5 text-xs border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[r.jsx("option",{value:"fixed",children:"Fixed"}),r.jsx("option",{value:"visible_outgoing",children:"Visible Outgoing Flow"}),r.jsx("option",{value:"visible_incoming",children:"Visible Incoming Flow"}),r.jsx("option",{value:"year_outgoing",children:"Year Outgoing Flow"}),r.jsx("option",{value:"year_incoming",children:"Year Incoming Flow"}),r.jsx("option",{value:"net_visible",children:"Net Flow (visible)"}),r.jsx("option",{value:"net_year",children:"Net Flow (year)"}),r.jsx("option",{value:"self_year",children:"Self Flow (year)"}),r.jsx("option",{value:"attribute",children:"By Attribute"})]}),Ue==="attribute"&&r.jsxs("select",{value:Ht||"",onChange:g=>Un(g.target.value||null),className:"w-full px-2 py-1.5 text-xs border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[r.jsx("option",{value:"",children:"Select..."}),a.metadata.hasNumericProperties.nodes.map(g=>r.jsx("option",{value:g,children:g},g))]})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx("label",{className:"text-xs font-medium text-gray-700",children:"Interaction Mode"}),r.jsxs("select",{value:ut,onChange:g=>Ot(g.target.value),className:"w-full px-2 py-1.5 text-xs border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[r.jsx("option",{value:"pan",children:"Pan"}),r.jsx("option",{value:"lens",children:"Edge Lens"})]}),ut==="lens"&&r.jsxs("div",{className:"space-y-1",children:[r.jsxs("label",{className:"text-[11px] text-gray-600",children:["Lens Radius: ",Gt,"px"]}),r.jsx("input",{type:"range",min:20,max:300,step:5,value:Gt,onChange:g=>nn(parseInt(g.target.value)),className:"w-full"}),r.jsx("p",{className:"text-[10px] text-gray-500",children:"Scroll over the visualization to adjust while lens mode is active."})]})]})]}):r.jsx("div",{className:"text-xs text-gray-500 italic",children:"No dataset metadata available"})}),P==="table"&&r.jsx(Pt,{title:"Table Settings",defaultOpen:!1,children:r.jsx("div",{className:"text-xs text-gray-500 italic",children:"Settings to be added"})}),P==="sankey"&&r.jsx(Pt,{title:"Sankey Settings",defaultOpen:!1,children:r.jsx("div",{className:"text-xs text-gray-500 italic",children:"Settings to be added"})}),P==="chord"&&r.jsx(Pt,{title:"Chord Settings",defaultOpen:!1,children:r.jsx("div",{className:"text-xs text-gray-500 italic",children:"Settings to be added"})})]})})]})})}async function di(){const e="csv-usa-pre-2020",s="csv-usa-post-2020",t="csv-2021",n="gexf-sample",o="swiss-2016";let i=await ft(e),l=await ft(s);const a=b=>b?b.snapshots.every(h=>{const v=new Set(h.nodes.map(x=>x.label));if(v.size!==ui)return!1;for(const x of v)if(!li.has(x))return!1;return!0}):!1;(i?!a(i):!1)&&(await Mn(e).catch(()=>{}),i=void 0),(l?!a(l):!1)&&(await Mn(s).catch(()=>{}),l=void 0);let c=!!i,p=!!l;const m=await ft(t),f=await ft(n),w=await ft(o),S=async b=>{const h=[];for(const v of b)try{const x=new URL(Object.assign({"../data/StateToStateMigrationUSCSV/state_to_state_migration_table_2022_t13_updated_2024_06_27_2022.csv":$r,"../data/StateToStateMigrationUSCSV/state_to_state_migration_table_2023_t13_2023.csv":Ir,"../data/StateToStateMigrationUSCSV/state_to_state_migrations_table_2005_2005.csv":Er,"../data/StateToStateMigrationUSCSV/state_to_state_migrations_table_2005_2007_2005-2007.csv":Pr,"../data/StateToStateMigrationUSCSV/state_to_state_migrations_table_2005_2009_2005-2009.csv":Ar,"../data/StateToStateMigrationUSCSV/state_to_state_migrations_table_2006_2006.csv":Vr,"../data/StateToStateMigrationUSCSV/state_to_state_migrations_table_2006_2008_2006-2008.csv":kr,"../data/StateToStateMigrationUSCSV/state_to_state_migrations_table_2007_2007.csv":Dr,"../data/StateToStateMigrationUSCSV/state_to_state_migrations_table_2007_2009_2007-2009.csv":Lr,"../data/StateToStateMigrationUSCSV/state_to_state_migrations_table_2008_2008.csv":Tr,"../data/StateToStateMigrationUSCSV/state_to_state_migrations_table_2009_2009.csv":zr,"../data/StateToStateMigrationUSCSV/state_to_state_migrations_table_2010_2010.csv":Hr,"../data/StateToStateMigrationUSCSV/state_to_state_migrations_table_2011_2011.csv":Or,"../data/StateToStateMigrationUSCSV/state_to_state_migrations_table_2012_2012.csv":Gr,"../data/StateToStateMigrationUSCSV/state_to_state_migrations_table_2013_2013.csv":Ur,"../data/StateToStateMigrationUSCSV/state_to_state_migrations_table_2014_2014.csv":Br,"../data/StateToStateMigrationUSCSV/state_to_state_migrations_table_2015_2015.csv":qr,"../data/StateToStateMigrationUSCSV/state_to_state_migrations_table_2016_2016.csv":Wr,"../data/StateToStateMigrationUSCSV/state_to_state_migrations_table_2017_2017.csv":Kr,"../data/StateToStateMigrationUSCSV/state_to_state_migrations_table_2018_2018.csv":Yr,"../data/StateToStateMigrationUSCSV/state_to_state_migrations_table_2019_2019.csv":Xr,"../data/StateToStateMigrationUSCSV/state_to_state_migrations_table_2021_2021.csv":Zr})[`../data/StateToStateMigrationUSCSV/${v.filename}`],import.meta.url),_=await qt(x.toString()),N=jn(_);h.push({timestamp:v.year,nodes:N.nodes,edges:N.edges})}catch(x){console.warn(`⚠️ Failed to load snapshot for ${v.filename}:`,x)}return h.sort((v,x)=>{const _=typeof v.timestamp=="string"?Number.parseInt(v.timestamp,10):v.timestamp,N=typeof x.timestamp=="string"?Number.parseInt(x.timestamp,10):x.timestamp;return _-N}),h};if(!i){const b=Kn.filter(v=>v.year<=2019),h=await S(b);if(h.length>0){const v=h[0],x=h[h.length-1],_=Ct(v),N={id:e,name:"US State-to-State Migration (2005-2019)",notes:"Tidy ACS 1-year state-to-state migration flows from 2005 through 2019. The Census Bureau did not release 2020 1-year migration flows, so the series stops before the pandemic.",type:"csv",timeRange:{start:typeof v.timestamp=="string"?Number.parseInt(v.timestamp,10):v.timestamp,end:typeof x.timestamp=="string"?Number.parseInt(x.timestamp,10):x.timestamp},snapshots:h,metadata:_,createdAt:Date.now()};await gt(N),c=!0}}if(!l){const b=Kn.filter(v=>v.year>=2021),h=await S(b);if(h.length>0){const v=h[0],x=h[h.length-1],_=Ct(v),N={id:s,name:"US State-to-State Migration (2021-2023)",notes:"Post-2020 ACS 1-year state-to-state migration flows. The 2022 release includes revised Connecticut flows per Census errata guidance.",type:"csv",timeRange:{start:typeof v.timestamp=="string"?Number.parseInt(v.timestamp,10):v.timestamp,end:typeof x.timestamp=="string"?Number.parseInt(x.timestamp,10):x.timestamp},snapshots:h,metadata:_,createdAt:Date.now()};await gt(N),p=!0}}if(!m){const b=new URL("/INF358_Project_Kriskogram/assets/State_to_State_Migrations_Table_2021-N7RTh5uH.csv",import.meta.url),h=await qt(b.toString()),v=jn(h),x={timestamp:2021,nodes:v.nodes,edges:v.edges},_=Ct(x),N={id:t,name:"US State-to-State Migration (2021)",notes:"Real U.S. Census Bureau data showing migration flows between all 50 states from the American Community Survey 1-Year Estimates.",type:"csv",timeRange:{start:2021,end:2021},snapshots:[x],metadata:_,createdAt:Date.now()};await gt(N)}if(!f){const b=new URL("/INF358_Project_Kriskogram/assets/sample-migration-data-Dify6Mt1.gexf",import.meta.url),h=await Zs(b.toString()),v=xs(h),x=v.length>0?Ct(v[0]):void 0,_={id:n,name:"Sample Migration (GEXF)",notes:"AI-generated sample network dataset in GEXF format demonstrating temporal migration patterns with multiple time slices. This example dataset includes economic, geographic, and migration type attributes for demonstration purposes.",type:"gexf",timeRange:h.timeRange,snapshots:v,metadata:x,createdAt:Date.now()};await gt(_)}if(!w){const b="/INF358_Project_Kriskogram/",h=`${b}data/Swiss_Relocations_2016_locations.csv`,v=`${b}data/Swiss_Relocations_2016_flows.csv`,x=await qt(h),_=await qt(v),N=ws({nodesFile:{content:x,idField:"id",labelField:"name"},edgesFile:{content:_,sourceField:"origin",targetField:"dest",valueField:"count"}}),j={timestamp:2016,nodes:N.nodes,edges:N.edges},k=Ct(j),I={id:o,name:"Swiss Relocations (2016)",notes:"Relocations between Swiss cantons in 2016. This dataset contains 521,510 trips and uses a two-file CSV format with separate files for locations (cantons) and flows (relocations). Created by Ilya Boyandin.",type:"csv-two-file",timeRange:{start:2016,end:2016},snapshots:[j],metadata:k,createdAt:Date.now()};await gt(I)}if(c)return e;if(p)return s;if(m)return t}export{hi as component};
