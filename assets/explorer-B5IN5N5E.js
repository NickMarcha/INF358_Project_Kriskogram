import{c as jn,r as b,j as o,s as he,o as as,a as xt,z as Is,i as Es,C as Ps,G as As,u as Vs,b as Ds,d as ks,K as Ts,e as Ls,f as zs,p as Gt,g as Tn,h as Hs,n as Ln}from"./main-Cd6FDwfp.js";import{p as hn,l as Dt}from"./csv-parser-BH7H656y.js";import{p as Os,g as ls,l as Gs}from"./gexf-parser-ChiJebeW.js";import{S as Us,a as zn}from"./stateMigrationFiles-CyfipyKt.js";/**
 * @license lucide-react v0.476.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bs=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],qs=jn("ChevronDown",Bs);/**
 * @license lucide-react v0.476.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ks=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],Ws=jn("ChevronUp",Ks);/**
 * @license lucide-react v0.476.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ys=[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],Hn=jn("Settings",Ys);function Xs(e,s){return e==null||s==null?NaN:s<e?-1:s>e?1:s>=e?0:NaN}var On=Math.abs,nn=Math.cos,sn=Math.sin,us=Math.PI,kt=us/2,Gn=us*2,Un=Math.max,on=1e-12;function Bn(e,s){return Array.from({length:s-e},(t,n)=>e+n)}function Zs(e){return function(s,t){return e(s.source.value+s.target.value,t.source.value+t.target.value)}}function Qs(){return Js(!1)}function Js(e,s){var t=0,n=null,r=null,i=null;function l(a){var u=a.length,c=new Array(u),d=Bn(0,u),p=new Array(u*u),f=new Array(u),g=0,w;a=Float64Array.from({length:u*u},(S,y)=>a[y/u|0][y%u]);for(let S=0;S<u;++S){let y=0;for(let h=0;h<u;++h)y+=a[S*u+h]+e*a[h*u+S];g+=c[S]=y}g=Un(0,Gn-t*u)/g,w=g?t:Gn/u;{let S=0;n&&d.sort((y,h)=>n(c[y],c[h]));for(const y of d){const h=S;{const v=Bn(0,u).filter(x=>a[y*u+x]||a[x*u+y]);r&&v.sort((x,_)=>r(a[y*u+x],a[y*u+_]));for(const x of v){let _;if(y<x?(_=p[y*u+x]||(p[y*u+x]={source:null,target:null}),_.source={index:y,startAngle:S,endAngle:S+=a[y*u+x]*g,value:a[y*u+x]}):(_=p[x*u+y]||(p[x*u+y]={source:null,target:null}),_.target={index:y,startAngle:S,endAngle:S+=a[y*u+x]*g,value:a[y*u+x]},y===x&&(_.source=_.target)),_.source&&_.target&&_.source.value<_.target.value){const N=_.source;_.source=_.target,_.target=N}}f[y]={index:y,startAngle:h,endAngle:S,value:c[y]}}S+=w}}return p=Object.values(p),p.groups=f,i?p.sort(i):p}return l.padAngle=function(a){return arguments.length?(t=Un(0,a),l):t},l.sortGroups=function(a){return arguments.length?(n=a,l):n},l.sortSubgroups=function(a){return arguments.length?(r=a,l):r},l.sortChords=function(a){return arguments.length?(a==null?i=null:(i=Zs(a))._=a,l):i&&i._},l}const xn=Math.PI,vn=2*xn,pt=1e-6,eo=vn-pt;function ds(e){this._+=e[0];for(let s=1,t=e.length;s<t;++s)this._+=arguments[s]+e[s]}function to(e){let s=Math.floor(e);if(!(s>=0))throw new Error(`invalid digits: ${e}`);if(s>15)return ds;const t=10**s;return function(n){this._+=n[0];for(let r=1,i=n.length;r<i;++r)this._+=Math.round(arguments[r]*t)/t+n[r]}}class Nn{constructor(s){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=s==null?ds:to(s)}moveTo(s,t){this._append`M${this._x0=this._x1=+s},${this._y0=this._y1=+t}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(s,t){this._append`L${this._x1=+s},${this._y1=+t}`}quadraticCurveTo(s,t,n,r){this._append`Q${+s},${+t},${this._x1=+n},${this._y1=+r}`}bezierCurveTo(s,t,n,r,i,l){this._append`C${+s},${+t},${+n},${+r},${this._x1=+i},${this._y1=+l}`}arcTo(s,t,n,r,i){if(s=+s,t=+t,n=+n,r=+r,i=+i,i<0)throw new Error(`negative radius: ${i}`);let l=this._x1,a=this._y1,u=n-s,c=r-t,d=l-s,p=a-t,f=d*d+p*p;if(this._x1===null)this._append`M${this._x1=s},${this._y1=t}`;else if(f>pt)if(!(Math.abs(p*u-c*d)>pt)||!i)this._append`L${this._x1=s},${this._y1=t}`;else{let g=n-l,w=r-a,S=u*u+c*c,y=g*g+w*w,h=Math.sqrt(S),v=Math.sqrt(f),x=i*Math.tan((xn-Math.acos((S+f-y)/(2*h*v)))/2),_=x/v,N=x/h;Math.abs(_-1)>pt&&this._append`L${s+_*d},${t+_*p}`,this._append`A${i},${i},0,0,${+(p*g>d*w)},${this._x1=s+N*u},${this._y1=t+N*c}`}}arc(s,t,n,r,i,l){if(s=+s,t=+t,n=+n,l=!!l,n<0)throw new Error(`negative radius: ${n}`);let a=n*Math.cos(r),u=n*Math.sin(r),c=s+a,d=t+u,p=1^l,f=l?r-i:i-r;this._x1===null?this._append`M${c},${d}`:(Math.abs(this._x1-c)>pt||Math.abs(this._y1-d)>pt)&&this._append`L${c},${d}`,n&&(f<0&&(f=f%vn+vn),f>eo?this._append`A${n},${n},0,1,${p},${s-a},${t-u}A${n},${n},0,1,${p},${this._x1=c},${this._y1=d}`:f>pt&&this._append`A${n},${n},0,${+(f>=xn)},${p},${this._x1=s+n*Math.cos(i)},${this._y1=t+n*Math.sin(i)}`)}rect(s,t,n,r){this._append`M${this._x0=this._x1=+s},${this._y0=this._y1=+t}h${n=+n}v${+r}h${-n}Z`}toString(){return this._}}function Rn(){return new Nn}Rn.prototype=Nn.prototype;var no=Array.prototype.slice;function _t(e){return function(){return e}}function so(e){return e.source}function oo(e){return e.target}function qn(e){return e.radius}function ro(e){return e.startAngle}function io(e){return e.endAngle}function ao(){return 0}function lo(e){var s=so,t=oo,n=qn,r=qn,i=ro,l=io,a=ao,u=null;function c(){var d,p=s.apply(this,arguments),f=t.apply(this,arguments),g=a.apply(this,arguments)/2,w=no.call(arguments),S=+n.apply(this,(w[0]=p,w)),y=i.apply(this,w)-kt,h=l.apply(this,w)-kt,v=+r.apply(this,(w[0]=f,w)),x=i.apply(this,w)-kt,_=l.apply(this,w)-kt;if(u||(u=d=Rn()),g>on&&(On(h-y)>g*2+on?h>y?(y+=g,h-=g):(y-=g,h+=g):y=h=(y+h)/2,On(_-x)>g*2+on?_>x?(x+=g,_-=g):(x-=g,_+=g):x=_=(x+_)/2),u.moveTo(S*nn(y),S*sn(y)),u.arc(0,0,S,y,h),(y!==x||h!==_)&&(u.quadraticCurveTo(0,0,v*nn(x),v*sn(x)),u.arc(0,0,v,x,_)),u.quadraticCurveTo(0,0,S*nn(y),S*sn(y)),u.closePath(),d)return u=null,d+""||null}return c.radius=function(d){return arguments.length?(n=r=typeof d=="function"?d:_t(+d),c):n},c.sourceRadius=function(d){return arguments.length?(n=typeof d=="function"?d:_t(+d),c):n},c.targetRadius=function(d){return arguments.length?(r=typeof d=="function"?d:_t(+d),c):r},c.startAngle=function(d){return arguments.length?(i=typeof d=="function"?d:_t(+d),c):i},c.endAngle=function(d){return arguments.length?(l=typeof d=="function"?d:_t(+d),c):l},c.padAngle=function(d){return arguments.length?(a=typeof d=="function"?d:_t(+d),c):a},c.source=function(d){return arguments.length?(s=d,c):s},c.target=function(d){return arguments.length?(t=d,c):t},c.context=function(d){return arguments.length?(u=d??null,c):u},c}function uo(){return lo()}function co(e){for(var s=e.length/6|0,t=new Array(s),n=0;n<s;)t[n]="#"+e.slice(n*6,++n*6);return t}const cs=co("1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf");function nt(e){return function(){return e}}const Kn=Math.abs,Ae=Math.atan2,mt=Math.cos,go=Math.max,rn=Math.min,Ze=Math.sin,jt=Math.sqrt,ke=1e-12,$t=Math.PI,Ut=$t/2,fo=2*$t;function mo(e){return e>1?0:e<-1?$t:Math.acos(e)}function Wn(e){return e>=1?Ut:e<=-1?-Ut:Math.asin(e)}function po(e){let s=3;return e.digits=function(t){if(!arguments.length)return s;if(t==null)s=null;else{const n=Math.floor(t);if(!(n>=0))throw new RangeError(`invalid digits: ${t}`);s=n}return e},()=>new Nn(s)}function ho(e){return e.innerRadius}function xo(e){return e.outerRadius}function vo(e){return e.startAngle}function yo(e){return e.endAngle}function bo(e){return e&&e.padAngle}function wo(e,s,t,n,r,i,l,a){var u=t-e,c=n-s,d=l-r,p=a-i,f=p*u-d*c;if(!(f*f<ke))return f=(d*(s-i)-p*(e-r))/f,[e+f*u,s+f*c]}function Tt(e,s,t,n,r,i,l){var a=e-t,u=s-n,c=(l?i:-i)/jt(a*a+u*u),d=c*u,p=-c*a,f=e+d,g=s+p,w=t+d,S=n+p,y=(f+w)/2,h=(g+S)/2,v=w-f,x=S-g,_=v*v+x*x,N=r-i,C=f*S-w*g,V=(x<0?-1:1)*jt(go(0,N*N*_-C*C)),I=(C*x-v*V)/_,E=(-C*v-x*V)/_,q=(C*x+v*V)/_,D=(-C*v+x*V)/_,W=I-y,M=E-h,L=q-y,X=D-h;return W*W+M*M>L*L+X*X&&(I=q,E=D),{cx:I,cy:E,x01:-d,y01:-p,x11:I*(r/N-1),y11:E*(r/N-1)}}function So(){var e=ho,s=xo,t=nt(0),n=null,r=vo,i=yo,l=bo,a=null,u=po(c);function c(){var d,p,f=+e.apply(this,arguments),g=+s.apply(this,arguments),w=r.apply(this,arguments)-Ut,S=i.apply(this,arguments)-Ut,y=Kn(S-w),h=S>w;if(a||(a=d=u()),g<f&&(p=g,g=f,f=p),!(g>ke))a.moveTo(0,0);else if(y>fo-ke)a.moveTo(g*mt(w),g*Ze(w)),a.arc(0,0,g,w,S,!h),f>ke&&(a.moveTo(f*mt(S),f*Ze(S)),a.arc(0,0,f,S,w,h));else{var v=w,x=S,_=w,N=S,C=y,V=y,I=l.apply(this,arguments)/2,E=I>ke&&(n?+n.apply(this,arguments):jt(f*f+g*g)),q=rn(Kn(g-f)/2,+t.apply(this,arguments)),D=q,W=q,M,L;if(E>ke){var X=Wn(E/f*Ze(I)),ee=Wn(E/g*Ze(I));(C-=X*2)>ke?(X*=h?1:-1,_+=X,N-=X):(C=0,_=N=(w+S)/2),(V-=ee*2)>ke?(ee*=h?1:-1,v+=ee,x-=ee):(V=0,v=x=(w+S)/2)}var le=g*mt(v),ie=g*Ze(v),_e=f*mt(N),j=f*Ze(N);if(q>ke){var k=g*mt(x),ge=g*Ze(x),Ce=f*mt(_),De=f*Ze(_),z;if(y<$t)if(z=wo(le,ie,Ce,De,k,ge,_e,j)){var fe=le-z[0],K=ie-z[1],B=k-z[0],be=ge-z[1],je=1/Ze(mo((fe*B+K*be)/(jt(fe*fe+K*K)*jt(B*B+be*be)))/2),$e=jt(z[0]*z[0]+z[1]*z[1]);D=rn(q,(f-$e)/(je-1)),W=rn(q,(g-$e)/(je+1))}else D=W=0}V>ke?W>ke?(M=Tt(Ce,De,le,ie,g,W,h),L=Tt(k,ge,_e,j,g,W,h),a.moveTo(M.cx+M.x01,M.cy+M.y01),W<q?a.arc(M.cx,M.cy,W,Ae(M.y01,M.x01),Ae(L.y01,L.x01),!h):(a.arc(M.cx,M.cy,W,Ae(M.y01,M.x01),Ae(M.y11,M.x11),!h),a.arc(0,0,g,Ae(M.cy+M.y11,M.cx+M.x11),Ae(L.cy+L.y11,L.cx+L.x11),!h),a.arc(L.cx,L.cy,W,Ae(L.y11,L.x11),Ae(L.y01,L.x01),!h))):(a.moveTo(le,ie),a.arc(0,0,g,v,x,!h)):a.moveTo(le,ie),!(f>ke)||!(C>ke)?a.lineTo(_e,j):D>ke?(M=Tt(_e,j,k,ge,f,-D,h),L=Tt(le,ie,Ce,De,f,-D,h),a.lineTo(M.cx+M.x01,M.cy+M.y01),D<q?a.arc(M.cx,M.cy,D,Ae(M.y01,M.x01),Ae(L.y01,L.x01),!h):(a.arc(M.cx,M.cy,D,Ae(M.y01,M.x01),Ae(M.y11,M.x11),!h),a.arc(0,0,f,Ae(M.cy+M.y11,M.cx+M.x11),Ae(L.cy+L.y11,L.cx+L.x11),h),a.arc(L.cx,L.cy,D,Ae(L.y11,L.x11),Ae(L.y01,L.x01),!h))):a.arc(0,0,f,N,_,h)}if(a.closePath(),d)return a=null,d+""||null}return c.centroid=function(){var d=(+e.apply(this,arguments)+ +s.apply(this,arguments))/2,p=(+r.apply(this,arguments)+ +i.apply(this,arguments))/2-$t/2;return[mt(p)*d,Ze(p)*d]},c.innerRadius=function(d){return arguments.length?(e=typeof d=="function"?d:nt(+d),c):e},c.outerRadius=function(d){return arguments.length?(s=typeof d=="function"?d:nt(+d),c):s},c.cornerRadius=function(d){return arguments.length?(t=typeof d=="function"?d:nt(+d),c):t},c.padRadius=function(d){return arguments.length?(n=d==null?null:typeof d=="function"?d:nt(+d),c):n},c.startAngle=function(d){return arguments.length?(r=typeof d=="function"?d:nt(+d),c):r},c.endAngle=function(d){return arguments.length?(i=typeof d=="function"?d:nt(+d),c):i},c.padAngle=function(d){return arguments.length?(l=typeof d=="function"?d:nt(+d),c):l},c.context=function(d){return arguments.length?(a=d??null,c):a},c}const _o="/INF358_Project_Kriskogram/assets/state_to_state_migration_table_2022_t13_updated_2024_06_27_2022-D7hzY5-5.csv",Co="/INF358_Project_Kriskogram/assets/state_to_state_migration_table_2023_t13_2023-Da-tSzHC.csv",jo="/INF358_Project_Kriskogram/assets/state_to_state_migrations_table_2005_2005-5D0dAV6T.csv",No="/INF358_Project_Kriskogram/assets/state_to_state_migrations_table_2005_2007_2005-2007-C2gBOjzD.csv",Ro="/INF358_Project_Kriskogram/assets/state_to_state_migrations_table_2005_2009_2005-2009-oSLcshdC.csv",Mo="/INF358_Project_Kriskogram/assets/state_to_state_migrations_table_2006_2006-C-EFanec.csv",Fo="/INF358_Project_Kriskogram/assets/state_to_state_migrations_table_2006_2008_2006-2008-Cp1NRBpc.csv",$o="/INF358_Project_Kriskogram/assets/state_to_state_migrations_table_2007_2007-BXoQRRMn.csv",Io="/INF358_Project_Kriskogram/assets/state_to_state_migrations_table_2007_2009_2007-2009-Qdd3KwND.csv",Eo="/INF358_Project_Kriskogram/assets/state_to_state_migrations_table_2008_2008--00JWAqc.csv",Po="/INF358_Project_Kriskogram/assets/state_to_state_migrations_table_2009_2009-5yGj8NCd.csv",Ao="/INF358_Project_Kriskogram/assets/state_to_state_migrations_table_2010_2010-CSB90FrU.csv",Vo="/INF358_Project_Kriskogram/assets/state_to_state_migrations_table_2011_2011-BzRnLs5h.csv",Do="/INF358_Project_Kriskogram/assets/state_to_state_migrations_table_2012_2012-DrbWwk1R.csv",ko="/INF358_Project_Kriskogram/assets/state_to_state_migrations_table_2013_2013-CTsYcw-F.csv",To="/INF358_Project_Kriskogram/assets/state_to_state_migrations_table_2014_2014-D8ze7hKk.csv",Lo="/INF358_Project_Kriskogram/assets/state_to_state_migrations_table_2015_2015-Sg6Ir2qO.csv",zo="/INF358_Project_Kriskogram/assets/state_to_state_migrations_table_2016_2016-C26kP0Bk.csv",Ho="/INF358_Project_Kriskogram/assets/state_to_state_migrations_table_2017_2017-BNMbL_en.csv",Oo="/INF358_Project_Kriskogram/assets/state_to_state_migrations_table_2018_2018-DTnLPVgj.csv",Go="/INF358_Project_Kriskogram/assets/state_to_state_migrations_table_2019_2019-Bd1nphS1.csv",Uo="/INF358_Project_Kriskogram/assets/State_to_State_Migrations_Table_2021-N7RTh5uH.csv";function ht(e){const s=new Set,t=new Set,n=new Set,r=new Set,i=new Set,l=new Set;return e.nodes.forEach(a=>{Object.keys(a).forEach(u=>{if(u!=="id"&&u!=="label"){s.add(u);const c=a[u];typeof c=="number"?n.add(u):typeof c=="string"&&i.add(u)}})}),e.edges.forEach(a=>{Object.keys(a).forEach(u=>{if(u!=="source"&&u!=="target"&&u!=="value"){t.add(u);const c=a[u];typeof c=="number"?r.add(u):typeof c=="string"&&l.add(u)}})}),{nodeProperties:Array.from(s),edgeProperties:Array.from(t),hasNumericProperties:{nodes:Array.from(n),edges:Array.from(r)},hasCategoricalProperties:{nodes:Array.from(i),edges:Array.from(l)}}}const Bo="kriskogram-db",qo=1,qe="datasets";function It(){return new Promise((e,s)=>{const t=indexedDB.open(Bo,qo);t.onupgradeneeded=()=>{const n=t.result;n.objectStoreNames.contains(qe)||n.createObjectStore(qe,{keyPath:"id"})},t.onsuccess=()=>e(t.result),t.onerror=()=>s(t.error)})}async function ot(e){const s=await It();return new Promise((t,n)=>{const r=s.transaction(qe,"readwrite");r.objectStore(qe).put(e),r.oncomplete=()=>t(),r.onerror=()=>n(r.error),r.onabort=()=>n(r.error)})}async function rt(e){const s=await It();return new Promise((t,n)=>{const l=s.transaction(qe,"readonly").objectStore(qe).get(e);l.onsuccess=()=>t(l.result),l.onerror=()=>n(l.error)})}async function Ko(){const e=await It();return new Promise((s,t)=>{const i=e.transaction(qe,"readonly").objectStore(qe).getAll();i.onsuccess=()=>s(i.result||[]),i.onerror=()=>t(i.error)})}async function yn(e){const s=await It();return new Promise((t,n)=>{const r=s.transaction(qe,"readwrite");r.objectStore(qe).delete(e),r.oncomplete=()=>t(),r.onerror=()=>n(r.error)})}async function Wo(e){const s=await rt(e);if(!s)throw new Error(`Dataset ${e} not found`);const t={...s,id:`${s.type}-${Date.now()}`,name:`${s.name} (Copy)`,createdAt:Date.now()};return await ot(t),t}async function Yo(){const e=await It();return new Promise((s,t)=>{const n=e.transaction(qe,"readwrite");n.objectStore(qe).clear(),n.oncomplete=()=>s(),n.onerror=()=>t(n.error)})}async function Xo(){if("storage"in navigator&&"persist"in navigator.storage)try{return await navigator.storage.persist()}catch{return!1}return!1}function Yn(e){const s=[];let t="",n=!1;for(let r=0;r<e.length;r++){const i=e[r];i==='"'?n=!n:i===","&&!n?(s.push(t),t=""):t+=i}return s.push(t),s}function Xn(e){const s=e.trim().split(`
`).filter(r=>r.trim());if(s.length===0)throw new Error("CSV file is empty");const t=Yn(s[0]).map(r=>r.trim()),n=s.slice(1).map(Yn);return{headers:t,rows:n}}function an(e){const s=e.replace(/[",]/g,"").trim(),t=Number.parseFloat(s);return Number.isNaN(t)?s:t}function gs(e){var N;const{headers:s,rows:t}=Xn(e.nodesFile.content),n=s.map(C=>C.toLowerCase().trim()),r=e.nodesFile.idField.toLowerCase().trim(),i=((N=e.nodesFile.labelField)==null?void 0:N.toLowerCase().trim())||r,l=n.indexOf(r),a=e.nodesFile.labelField?n.indexOf(i):l;if(l===-1)throw new Error(`ID field "${e.nodesFile.idField}" not found in nodes file. Available fields: ${s.join(", ")}`);const u=t.map(C=>{const V={id:String(C[l]||"").trim(),label:a>=0?String(C[a]||"").trim():String(C[l]||"").trim()},I=s[l],E=e.nodesFile.labelField?s[a]:I;return s.forEach((q,D)=>{var W;if(q!==I&&q!==E){const M=((W=C[D])==null?void 0:W.trim())||"";V[q]=an(M)}}),V}).filter(C=>C.id),c=new Map(u.map(C=>[C.id,C])),{headers:d,rows:p}=Xn(e.edgesFile.content),f=d.map(C=>C.toLowerCase().trim()),g=e.edgesFile.sourceField.toLowerCase().trim(),w=e.edgesFile.targetField.toLowerCase().trim(),S=e.edgesFile.valueField.toLowerCase().trim(),y=f.indexOf(g),h=f.indexOf(w),v=f.indexOf(S);if(y===-1)throw new Error(`Source field "${e.edgesFile.sourceField}" not found in edges file. Available fields: ${d.join(", ")}`);if(h===-1)throw new Error(`Target field "${e.edgesFile.targetField}" not found in edges file. Available fields: ${d.join(", ")}`);if(v===-1)throw new Error(`Value field "${e.edgesFile.valueField}" not found in edges file. Available fields: ${d.join(", ")}`);const x=p.map(C=>{const V=String(C[y]||"").trim(),I=String(C[h]||"").trim(),E=String(C[v]||"").trim(),q=an(E);if(!V||!I||typeof q!="number"||q<=0)return null;(!c.has(V)||!c.has(I))&&console.warn(`Edge references missing node: ${V} -> ${I}`);const D={source:V,target:I,value:q},W=d[y],M=d[h],L=d[v];return d.forEach((X,ee)=>{var le;if(X!==W&&X!==M&&X!==L){const ie=((le=C[ee])==null?void 0:le.trim())||"";D[X]=an(ie)}}),D}).filter(C=>C!==null&&c.has(C.source)&&c.has(C.target)),_=new Set;return x.forEach(C=>{_.add(C.source),_.add(C.target)}),_.forEach(C=>{c.has(C)||u.push({id:C,label:C})}),{nodes:u,edges:x}}function Zo({onClose:e,onImport:s,fileInputRef:t,onFilesSelected:n,existingFile:r}){const[i,l]=b.useState(""),[a,u]=b.useState(""),[c,d]=b.useState(!1),[p,f]=b.useState({}),[g,w]=b.useState(!1),[S,y]=b.useState(null),[h,v]=b.useState([]),[x,_]=b.useState([]),[N,C]=b.useState(null),V=b.useRef(null),I=b.useRef(null),[E,q]=b.useState(null),[D,W]=b.useState(null),[M,L]=b.useState([]),[X,ee]=b.useState([]),[le,ie]=b.useState(""),[_e,j]=b.useState(""),[k,ge]=b.useState(""),[Ce,De]=b.useState(""),[z,fe]=b.useState(""),[K,B]=b.useState(null);function be(R){let F=R.replace(/\.(csv|gexf)$/i,"");return F=F.replace(/([a-z])([A-Z])/g,"$1 $2").replace(/[_-]/g," ").replace(/[^a-zA-Z0-9\s]/g," ").replace(/\s+/g," ").trim(),F.split(" ").map(H=>H.charAt(0).toUpperCase()+H.slice(1).toLowerCase()).join(" ")}b.useEffect(()=>{var R;if(r!=null&&r.parsedData){B(r.parsedData);const F=((R=r.files[0])==null?void 0:R.name)||"";l(be(F)),u(r.files.map(H=>H.name).join(", "))}},[r]),b.useEffect(()=>{var R;if(!r&&h.length>0){if(!i||i===be(((R=h[0])==null?void 0:R.name)||"")){const F=h[0].name;l(be(F))}a||u(h.map(F=>F.name).join(", "))}},[h]);function je(R){const F=[];let H="",Q=!1;for(let Y=0;Y<R.length;Y++){const te=R[Y];te==='"'?Q=!Q:te===","&&!Q?(F.push(H),H=""):H+=te}return F.push(H),F}function $e(R){const F=R.trim().split(`
`);if(F.length===0)return[];const H=F[0];return je(H).map(Q=>Q.trim().replace(/^"|"$/g,""))}async function Te(R){const F=Array.from(R.target.files||[]);if(F.length===0)return;v(F);const H=await Promise.all(F.map(Y=>Y.text()));_(H);const Q=F[0].name.toLowerCase();if(Q.endsWith(".gexf")){C("gexf"),y("single");try{const Y=Os(H[0]),te=ls(Y);B({nodes:te.length>0?te[0].nodes:[],edges:te.length>0?te[0].edges:[],timeRange:Y.timeRange}),l(F[0].name.replace(".gexf",""))}catch(Y){f({general:Y instanceof Error?Y.message:"Failed to parse GEXF"})}}else if(Q.endsWith(".csv")){if(C("csv"),F.length===1){y("single");try{const Y=hn(H[0]);B({nodes:Y.nodes,edges:Y.edges,timeRange:{start:2021,end:2021}}),l(F[0].name.replace(".csv",""))}catch{y("two-file");const te=$e(H[0]);L(te),ee(te),q(0);const ae=te.find(xe=>xe.toLowerCase()==="id"||xe.toLowerCase()==="node"||xe.toLowerCase()==="name"),Ke=te.find(xe=>xe.toLowerCase()==="source"||xe.toLowerCase()==="origin"||xe.toLowerCase()==="from"),Je=te.find(xe=>xe.toLowerCase()==="target"||xe.toLowerCase()==="dest"||xe.toLowerCase()==="destination"||xe.toLowerCase()==="to"),Oe=te.find(xe=>xe.toLowerCase()==="value"||xe.toLowerCase()==="count"||xe.toLowerCase()==="weight");ae&&ie(ae),Ke&&ge(Ke),Je&&De(Je),Oe&&fe(Oe),f({general:"Could not parse as state migration format. Please select which file contains nodes and which contains edges."})}}else if(F.length===2){y("two-file");const Y=$e(H[0]),te=$e(H[1]);L(Y),ee(te),q(0),W(1);const ae=Y.find(se=>se.toLowerCase()==="id"),Ke=Y.find(se=>se.toLowerCase()==="name"||se.toLowerCase()==="label");ae&&ie(ae),Ke&&j(Ke);const Je=te.find(se=>se.toLowerCase()==="source"||se.toLowerCase()==="origin"||se.toLowerCase()==="from"),Oe=te.find(se=>se.toLowerCase()==="target"||se.toLowerCase()==="dest"||se.toLowerCase()==="destination"||se.toLowerCase()==="to"),xe=te.find(se=>se.toLowerCase()==="value"||se.toLowerCase()==="count"||se.toLowerCase()==="weight");Je&&ge(Je),Oe&&De(Oe),xe&&fe(xe),lt()}}t.current&&(t.current.value="")}function lt(){if(E===null||D===null||!le||!k||!Ce||!z){f({general:"Please select all required fields"}),B(null);return}try{const R=gs({nodesFile:{content:x[E],idField:le,labelField:_e||le},edgesFile:{content:x[D],sourceField:k,targetField:Ce,valueField:z}});B({nodes:R.nodes,edges:R.edges,timeRange:{start:2016,end:2016}}),f({})}catch(R){f({general:R instanceof Error?R.message:"Failed to parse two-file CSV"}),B(null)}}b.useEffect(()=>{S==="two-file"&&E!==null&&D!==null&&lt()},[le,_e,k,Ce,z,E,D]);function ut(){const R={},F=[];if(i.trim()||(R.name="Dataset name is required"),S==="two-file"&&(E===null&&(R.nodesFile="Please select which file contains nodes"),D===null&&(R.edgesFile="Please select which file contains edges"),E!==null&&!le&&(R.nodeIdField="Please select the ID field for nodes"),D!==null&&!k&&(R.edgeSourceField="Please select the source field for edges"),D!==null&&!Ce&&(R.edgeTargetField="Please select the target field for edges"),D!==null&&!z&&(R.edgeValueField="Please select the value field for edges")),!K)return R.general="Data parsing failed - please check file format and field selections",R;K.nodes.length===0&&F.push("No nodes found in dataset"),K.edges.length===0&&F.push("No edges found in dataset");const H=new Set(K.nodes.map(Y=>Y.id));H.size!==K.nodes.length&&F.push(`${K.nodes.length-H.size} duplicate node IDs found`);const Q=K.edges.filter(Y=>!H.has(Y.source)||!H.has(Y.target));return Q.length>0&&F.push(`${Q.length} edges reference non-existent nodes`),F.length>0&&(R.summary=F.join("; ")),R}function vt(){p.name&&V.current?(V.current.scrollIntoView({behavior:"smooth",block:"center"}),V.current.focus()):p.summary&&I.current&&I.current.scrollIntoView({behavior:"smooth",block:"center"})}async function Nt(){const R=ut();if(f(R),Object.keys(R).filter(H=>H!=="summary").length>0||!K){setTimeout(()=>vt(),100);return}d(!0);try{const H=K.timeRange||{start:2021,end:2021},Q={timestamp:H.start,nodes:K.nodes,edges:K.edges},Y=ht(Q),te=[Q],ae={name:i.trim(),filename:h.map(Ke=>Ke.name).join(", "),notes:a.trim()||void 0,type:S==="two-file"?"csv":N||"csv",timeRange:H,snapshots:te,metadata:Y};await s(ae,{nodes:K.nodes,edges:K.edges,snapshots:te,metadata:Y})}catch(H){console.error("Import error:",H),f({general:H instanceof Error?H.message:"Failed to import dataset"}),d(!1),setTimeout(()=>vt(),100)}}return o.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:o.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-4xl w-full mx-4 max-h-[90vh] flex flex-col",children:[o.jsxs("div",{className:"p-6 border-b flex items-center justify-between",children:[o.jsx("h2",{className:"text-2xl font-bold",children:"Import Dataset"}),o.jsx("button",{onClick:e,className:"text-gray-400 hover:text-gray-600 text-2xl",children:"×"})]}),o.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:o.jsxs("div",{className:"space-y-6",children:[!S&&o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Select Files ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsxs("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-6 text-center",children:[o.jsx("button",{onClick:()=>{var R;return(R=t.current)==null?void 0:R.click()},className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700",children:"Choose Files"}),o.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"Select 1 file (GEXF or CSV) or 2 files (CSV nodes + CSV edges)"}),o.jsx("input",{ref:t,type:"file",accept:".csv,.gexf",multiple:!0,onChange:Te,className:"hidden"})]})]}),h.length>0&&o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Selected Files"}),o.jsxs("div",{className:"space-y-2",children:[h.map((R,F)=>o.jsxs("div",{className:"flex items-center justify-between bg-gray-50 p-3 rounded",children:[o.jsx("span",{className:"text-sm",children:R.name}),o.jsx("button",{onClick:()=>{const H=[...h];H.splice(F,1),v(H);const Q=[...x];Q.splice(F,1),_(Q),S==="two-file"&&(E===F&&q(null),D===F&&W(null),E&&E>F&&q(E-1),D&&D>F&&W(D-1))},className:"text-red-600 text-sm hover:text-red-800",children:"Remove"})]},F)),o.jsx("button",{type:"button",onClick:()=>{const R=document.createElement("input");R.type="file",R.accept=".csv,.gexf",R.multiple=!0,R.onchange=async F=>{const H=F.target,Q=Array.from(H.files||[]);if(Q.length>0){const Y=await Promise.all(Q.map(ae=>ae.text()));v([...h,...Q]),_([...x,...Y]);const te=[...h,...Q];te.length===2&&te.every(ae=>ae.name.toLowerCase().endsWith(".csv"))&&(y("two-file"),C("csv"))}},R.click()},className:"text-sm text-blue-600 hover:text-blue-800",children:"+ Add More Files"})]})]}),S==="two-file"&&h.length>0&&o.jsxs("div",{className:"border-t pt-4 space-y-4","data-file-select":!0,children:[o.jsx("h3",{className:"font-semibold",children:"Map Files and Fields"}),o.jsxs("div",{"data-field-select":!0,children:[o.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Nodes File (Locations) ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsxs("select",{value:E??"",onChange:R=>{const F=parseInt(R.target.value);q(F);const H=$e(x[F]);L(H);const Q=H.find(Y=>Y.toLowerCase()==="id");if(Q&&ie(Q),p.nodesFile){const Y={...p};delete Y.nodesFile,f(Y)}},className:`w-full px-3 py-2 border rounded-md ${p.nodesFile?"border-red-500":"border-gray-300"}`,children:[o.jsx("option",{value:"",children:"Select file..."}),h.map((R,F)=>o.jsx("option",{value:F,children:R.name},F))]}),p.nodesFile&&o.jsx("p",{className:"mt-1 text-sm text-red-600",children:p.nodesFile}),E!==null&&M.length>0&&o.jsxs("div",{className:"mt-2 space-y-2",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"ID Field *"}),o.jsxs("select",{value:le,onChange:R=>{if(ie(R.target.value),p.nodeIdField){const F={...p};delete F.nodeIdField,f(F)}},className:`w-full px-2 py-1 border rounded text-sm ${p.nodeIdField?"border-red-500":"border-gray-300"}`,children:[o.jsx("option",{value:"",children:"Select field..."}),M.map(R=>o.jsx("option",{value:R,children:R},R))]}),p.nodeIdField&&o.jsx("p",{className:"mt-1 text-xs text-red-600",children:p.nodeIdField})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"Label Field (optional)"}),o.jsxs("select",{value:_e,onChange:R=>j(R.target.value),className:"w-full px-2 py-1 border border-gray-300 rounded text-sm",children:[o.jsx("option",{value:"",children:"Use ID field"}),M.map(R=>o.jsx("option",{value:R,children:R},R))]})]})]})]}),o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Edges File (Flows) ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsxs("select",{value:D??"",onChange:R=>{const F=parseInt(R.target.value);W(F);const H=$e(x[F]);ee(H);const Q=H.find(ae=>ae.toLowerCase()==="source"||ae.toLowerCase()==="origin"||ae.toLowerCase()==="from"),Y=H.find(ae=>ae.toLowerCase()==="target"||ae.toLowerCase()==="dest"||ae.toLowerCase()==="to"),te=H.find(ae=>ae.toLowerCase()==="value"||ae.toLowerCase()==="count"||ae.toLowerCase()==="weight");if(Q&&ge(Q),Y&&De(Y),te&&fe(te),p.edgesFile){const ae={...p};delete ae.edgesFile,f(ae)}},className:`w-full px-3 py-2 border rounded-md ${p.edgesFile?"border-red-500":"border-gray-300"}`,children:[o.jsx("option",{value:"",children:"Select file..."}),h.map((R,F)=>o.jsx("option",{value:F,children:R.name},F))]}),p.edgesFile&&o.jsx("p",{className:"mt-1 text-sm text-red-600",children:p.edgesFile}),D!==null&&X.length>0&&o.jsxs("div",{className:"mt-2 space-y-2",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"Source Field *"}),o.jsxs("select",{value:k,onChange:R=>{if(ge(R.target.value),p.edgeSourceField){const F={...p};delete F.edgeSourceField,f(F)}},className:`w-full px-2 py-1 border rounded text-sm ${p.edgeSourceField?"border-red-500":"border-gray-300"}`,children:[o.jsx("option",{value:"",children:"Select field..."}),X.map(R=>o.jsx("option",{value:R,children:R},R))]}),p.edgeSourceField&&o.jsx("p",{className:"mt-1 text-xs text-red-600",children:p.edgeSourceField})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"Target Field *"}),o.jsxs("select",{value:Ce,onChange:R=>{if(De(R.target.value),p.edgeTargetField){const F={...p};delete F.edgeTargetField,f(F)}},className:`w-full px-2 py-1 border rounded text-sm ${p.edgeTargetField?"border-red-500":"border-gray-300"}`,children:[o.jsx("option",{value:"",children:"Select field..."}),X.map(R=>o.jsx("option",{value:R,children:R},R))]}),p.edgeTargetField&&o.jsx("p",{className:"mt-1 text-xs text-red-600",children:p.edgeTargetField})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"Value Field *"}),o.jsxs("select",{value:z,onChange:R=>{if(fe(R.target.value),p.edgeValueField){const F={...p};delete F.edgeValueField,f(F)}},className:`w-full px-2 py-1 border rounded text-sm ${p.edgeValueField?"border-red-500":"border-gray-300"}`,children:[o.jsx("option",{value:"",children:"Select field..."}),X.map(R=>o.jsx("option",{value:R,children:R},R))]}),p.edgeValueField&&o.jsx("p",{className:"mt-1 text-xs text-red-600",children:p.edgeValueField})]})]})]})]}),o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Dataset Name ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsx("input",{ref:V,type:"text",value:i,onChange:R=>{if(l(R.target.value),p.name){const F={...p};delete F.name,f(F)}},className:`w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 ${p.name?"border-red-500 focus:ring-red-500":"border-gray-300 focus:ring-blue-500"}`,placeholder:"Enter a name for this dataset"}),p.name&&o.jsx("p",{className:"mt-1 text-sm text-red-600",children:p.name})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Notes (optional)"}),o.jsx("textarea",{value:a,onChange:R=>u(R.target.value),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Add any notes about this dataset..."})]}),p.general&&o.jsxs("div",{className:"bg-red-50 border border-red-200 rounded p-3",children:[o.jsx("h4",{className:"font-semibold text-red-800 mb-2",children:"Error:"}),o.jsx("p",{className:"text-sm text-red-700",children:p.general})]}),K&&o.jsxs("div",{ref:I,className:"bg-blue-50 border border-blue-200 rounded p-3",children:[o.jsx("h4",{className:"font-semibold text-blue-800 mb-2",children:"Data Summary"}),o.jsxs("div",{className:"text-sm text-blue-700 space-y-1",children:[o.jsxs("div",{children:[o.jsx("span",{className:"font-medium",children:"Nodes:"})," ",K.nodes.length]}),o.jsxs("div",{children:[o.jsx("span",{className:"font-medium",children:"Edges:"})," ",K.edges.length]}),K.timeRange&&o.jsxs("div",{children:[o.jsx("span",{className:"font-medium",children:"Time Range:"})," ",K.timeRange.start,K.timeRange.end!==K.timeRange.start?` – ${K.timeRange.end}`:""]}),K.nodes.length>0&&o.jsxs("div",{className:"mt-2 text-xs",children:[o.jsx("span",{className:"font-medium",children:"Sample node properties:"})," ",Object.keys(K.nodes[0]).slice(0,5).join(", "),Object.keys(K.nodes[0]).length>5&&"..."]}),p.summary&&o.jsxs("div",{className:"mt-2 pt-2 border-t border-blue-300",children:[o.jsx("span",{className:"font-medium text-orange-700",children:"Warnings:"})," ",o.jsx("span",{className:"text-orange-600",children:p.summary})]})]})]})]})}),o.jsxs("div",{className:"p-6 border-t flex justify-end gap-3",children:[o.jsx("button",{onClick:e,type:"button",disabled:c,className:"px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50 disabled:opacity-50 cursor-pointer transition-colors",children:"Cancel"}),o.jsx("button",{onClick:Nt,type:"button",disabled:c||(Object.keys(p).filter(F=>F!=="summary").length>0||!K),className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed cursor-pointer transition-colors",children:c?"Importing...":"Import Dataset"})]})]})})}/**
   * table-core
   *
   * Copyright (c) TanStack
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE.md file in the root directory of this source tree.
   *
   * @license MIT
   */function it(e,s){return typeof e=="function"?e(s):e}function He(e,s){return t=>{s.setState(n=>({...n,[e]:it(t,n[e])}))}}function Bt(e){return e instanceof Function}function Qo(e){return Array.isArray(e)&&e.every(s=>typeof s=="number")}function Jo(e,s){const t=[],n=r=>{r.forEach(i=>{t.push(i);const l=s(i);l!=null&&l.length&&n(l)})};return n(e),t}function O(e,s,t){let n=[],r;return i=>{let l;t.key&&t.debug&&(l=Date.now());const a=e(i);if(!(a.length!==n.length||a.some((d,p)=>n[p]!==d)))return r;n=a;let c;if(t.key&&t.debug&&(c=Date.now()),r=s(...a),t==null||t.onChange==null||t.onChange(r),t.key&&t.debug&&t!=null&&t.debug()){const d=Math.round((Date.now()-l)*100)/100,p=Math.round((Date.now()-c)*100)/100,f=p/16,g=(w,S)=>{for(w=String(w);w.length<S;)w=" "+w;return w};console.info(`%c⏱ ${g(p,5)} /${g(d,5)} ms`,`
            font-size: .6rem;
            font-weight: bold;
            color: hsl(${Math.max(0,Math.min(120-120*f,120))}deg 100% 31%);`,t==null?void 0:t.key)}return r}}function G(e,s,t,n){return{debug:()=>{var r;return(r=e==null?void 0:e.debugAll)!=null?r:e[s]},key:!1,onChange:n}}function er(e,s,t,n){const r=()=>{var l;return(l=i.getValue())!=null?l:e.options.renderFallbackValue},i={id:`${s.id}_${t.id}`,row:s,column:t,getValue:()=>s.getValue(n),renderValue:r,getContext:O(()=>[e,t,s,i],(l,a,u,c)=>({table:l,column:a,row:u,cell:c,getValue:c.getValue,renderValue:c.renderValue}),G(e.options,"debugCells"))};return e._features.forEach(l=>{l.createCell==null||l.createCell(i,t,s,e)},{}),i}function tr(e,s,t,n){var r,i;const a={...e._getDefaultColumnDef(),...s},u=a.accessorKey;let c=(r=(i=a.id)!=null?i:u?typeof String.prototype.replaceAll=="function"?u.replaceAll(".","_"):u.replace(/\./g,"_"):void 0)!=null?r:typeof a.header=="string"?a.header:void 0,d;if(a.accessorFn?d=a.accessorFn:u&&(u.includes(".")?d=f=>{let g=f;for(const S of u.split(".")){var w;g=(w=g)==null?void 0:w[S]}return g}:d=f=>f[a.accessorKey]),!c)throw new Error;let p={id:`${String(c)}`,accessorFn:d,parent:n,depth:t,columnDef:a,columns:[],getFlatColumns:O(()=>[!0],()=>{var f;return[p,...(f=p.columns)==null?void 0:f.flatMap(g=>g.getFlatColumns())]},G(e.options,"debugColumns")),getLeafColumns:O(()=>[e._getOrderColumnsFn()],f=>{var g;if((g=p.columns)!=null&&g.length){let w=p.columns.flatMap(S=>S.getLeafColumns());return f(w)}return[p]},G(e.options,"debugColumns"))};for(const f of e._features)f.createColumn==null||f.createColumn(p,e);return p}const Ve="debugHeaders";function Zn(e,s,t){var n;let i={id:(n=t.id)!=null?n:s.id,column:s,index:t.index,isPlaceholder:!!t.isPlaceholder,placeholderId:t.placeholderId,depth:t.depth,subHeaders:[],colSpan:0,rowSpan:0,headerGroup:null,getLeafHeaders:()=>{const l=[],a=u=>{u.subHeaders&&u.subHeaders.length&&u.subHeaders.map(a),l.push(u)};return a(i),l},getContext:()=>({table:e,header:i,column:s})};return e._features.forEach(l=>{l.createHeader==null||l.createHeader(i,e)}),i}const nr={createTable:e=>{e.getHeaderGroups=O(()=>[e.getAllColumns(),e.getVisibleLeafColumns(),e.getState().columnPinning.left,e.getState().columnPinning.right],(s,t,n,r)=>{var i,l;const a=(i=n==null?void 0:n.map(p=>t.find(f=>f.id===p)).filter(Boolean))!=null?i:[],u=(l=r==null?void 0:r.map(p=>t.find(f=>f.id===p)).filter(Boolean))!=null?l:[],c=t.filter(p=>!(n!=null&&n.includes(p.id))&&!(r!=null&&r.includes(p.id)));return Lt(s,[...a,...c,...u],e)},G(e.options,Ve)),e.getCenterHeaderGroups=O(()=>[e.getAllColumns(),e.getVisibleLeafColumns(),e.getState().columnPinning.left,e.getState().columnPinning.right],(s,t,n,r)=>(t=t.filter(i=>!(n!=null&&n.includes(i.id))&&!(r!=null&&r.includes(i.id))),Lt(s,t,e,"center")),G(e.options,Ve)),e.getLeftHeaderGroups=O(()=>[e.getAllColumns(),e.getVisibleLeafColumns(),e.getState().columnPinning.left],(s,t,n)=>{var r;const i=(r=n==null?void 0:n.map(l=>t.find(a=>a.id===l)).filter(Boolean))!=null?r:[];return Lt(s,i,e,"left")},G(e.options,Ve)),e.getRightHeaderGroups=O(()=>[e.getAllColumns(),e.getVisibleLeafColumns(),e.getState().columnPinning.right],(s,t,n)=>{var r;const i=(r=n==null?void 0:n.map(l=>t.find(a=>a.id===l)).filter(Boolean))!=null?r:[];return Lt(s,i,e,"right")},G(e.options,Ve)),e.getFooterGroups=O(()=>[e.getHeaderGroups()],s=>[...s].reverse(),G(e.options,Ve)),e.getLeftFooterGroups=O(()=>[e.getLeftHeaderGroups()],s=>[...s].reverse(),G(e.options,Ve)),e.getCenterFooterGroups=O(()=>[e.getCenterHeaderGroups()],s=>[...s].reverse(),G(e.options,Ve)),e.getRightFooterGroups=O(()=>[e.getRightHeaderGroups()],s=>[...s].reverse(),G(e.options,Ve)),e.getFlatHeaders=O(()=>[e.getHeaderGroups()],s=>s.map(t=>t.headers).flat(),G(e.options,Ve)),e.getLeftFlatHeaders=O(()=>[e.getLeftHeaderGroups()],s=>s.map(t=>t.headers).flat(),G(e.options,Ve)),e.getCenterFlatHeaders=O(()=>[e.getCenterHeaderGroups()],s=>s.map(t=>t.headers).flat(),G(e.options,Ve)),e.getRightFlatHeaders=O(()=>[e.getRightHeaderGroups()],s=>s.map(t=>t.headers).flat(),G(e.options,Ve)),e.getCenterLeafHeaders=O(()=>[e.getCenterFlatHeaders()],s=>s.filter(t=>{var n;return!((n=t.subHeaders)!=null&&n.length)}),G(e.options,Ve)),e.getLeftLeafHeaders=O(()=>[e.getLeftFlatHeaders()],s=>s.filter(t=>{var n;return!((n=t.subHeaders)!=null&&n.length)}),G(e.options,Ve)),e.getRightLeafHeaders=O(()=>[e.getRightFlatHeaders()],s=>s.filter(t=>{var n;return!((n=t.subHeaders)!=null&&n.length)}),G(e.options,Ve)),e.getLeafHeaders=O(()=>[e.getLeftHeaderGroups(),e.getCenterHeaderGroups(),e.getRightHeaderGroups()],(s,t,n)=>{var r,i,l,a,u,c;return[...(r=(i=s[0])==null?void 0:i.headers)!=null?r:[],...(l=(a=t[0])==null?void 0:a.headers)!=null?l:[],...(u=(c=n[0])==null?void 0:c.headers)!=null?u:[]].map(d=>d.getLeafHeaders()).flat()},G(e.options,Ve))}};function Lt(e,s,t,n){var r,i;let l=0;const a=function(f,g){g===void 0&&(g=1),l=Math.max(l,g),f.filter(w=>w.getIsVisible()).forEach(w=>{var S;(S=w.columns)!=null&&S.length&&a(w.columns,g+1)},0)};a(e);let u=[];const c=(f,g)=>{const w={depth:g,id:[n,`${g}`].filter(Boolean).join("_"),headers:[]},S=[];f.forEach(y=>{const h=[...S].reverse()[0],v=y.column.depth===w.depth;let x,_=!1;if(v&&y.column.parent?x=y.column.parent:(x=y.column,_=!0),h&&(h==null?void 0:h.column)===x)h.subHeaders.push(y);else{const N=Zn(t,x,{id:[n,g,x.id,y==null?void 0:y.id].filter(Boolean).join("_"),isPlaceholder:_,placeholderId:_?`${S.filter(C=>C.column===x).length}`:void 0,depth:g,index:S.length});N.subHeaders.push(y),S.push(N)}w.headers.push(y),y.headerGroup=w}),u.push(w),g>0&&c(S,g-1)},d=s.map((f,g)=>Zn(t,f,{depth:l,index:g}));c(d,l-1),u.reverse();const p=f=>f.filter(w=>w.column.getIsVisible()).map(w=>{let S=0,y=0,h=[0];w.subHeaders&&w.subHeaders.length?(h=[],p(w.subHeaders).forEach(x=>{let{colSpan:_,rowSpan:N}=x;S+=_,h.push(N)})):S=1;const v=Math.min(...h);return y=y+v,w.colSpan=S,w.rowSpan=y,{colSpan:S,rowSpan:y}});return p((r=(i=u[0])==null?void 0:i.headers)!=null?r:[]),u}const sr=(e,s,t,n,r,i,l)=>{let a={id:s,index:n,original:t,depth:r,parentId:l,_valuesCache:{},_uniqueValuesCache:{},getValue:u=>{if(a._valuesCache.hasOwnProperty(u))return a._valuesCache[u];const c=e.getColumn(u);if(c!=null&&c.accessorFn)return a._valuesCache[u]=c.accessorFn(a.original,n),a._valuesCache[u]},getUniqueValues:u=>{if(a._uniqueValuesCache.hasOwnProperty(u))return a._uniqueValuesCache[u];const c=e.getColumn(u);if(c!=null&&c.accessorFn)return c.columnDef.getUniqueValues?(a._uniqueValuesCache[u]=c.columnDef.getUniqueValues(a.original,n),a._uniqueValuesCache[u]):(a._uniqueValuesCache[u]=[a.getValue(u)],a._uniqueValuesCache[u])},renderValue:u=>{var c;return(c=a.getValue(u))!=null?c:e.options.renderFallbackValue},subRows:[],getLeafRows:()=>Jo(a.subRows,u=>u.subRows),getParentRow:()=>a.parentId?e.getRow(a.parentId,!0):void 0,getParentRows:()=>{let u=[],c=a;for(;;){const d=c.getParentRow();if(!d)break;u.push(d),c=d}return u.reverse()},getAllCells:O(()=>[e.getAllLeafColumns()],u=>u.map(c=>er(e,a,c,c.id)),G(e.options,"debugRows")),_getAllCellsByColumnId:O(()=>[a.getAllCells()],u=>u.reduce((c,d)=>(c[d.column.id]=d,c),{}),G(e.options,"debugRows"))};for(let u=0;u<e._features.length;u++){const c=e._features[u];c==null||c.createRow==null||c.createRow(a,e)}return a},or={createColumn:(e,s)=>{e._getFacetedRowModel=s.options.getFacetedRowModel&&s.options.getFacetedRowModel(s,e.id),e.getFacetedRowModel=()=>e._getFacetedRowModel?e._getFacetedRowModel():s.getPreFilteredRowModel(),e._getFacetedUniqueValues=s.options.getFacetedUniqueValues&&s.options.getFacetedUniqueValues(s,e.id),e.getFacetedUniqueValues=()=>e._getFacetedUniqueValues?e._getFacetedUniqueValues():new Map,e._getFacetedMinMaxValues=s.options.getFacetedMinMaxValues&&s.options.getFacetedMinMaxValues(s,e.id),e.getFacetedMinMaxValues=()=>{if(e._getFacetedMinMaxValues)return e._getFacetedMinMaxValues()}}},fs=(e,s,t)=>{var n,r;const i=t==null||(n=t.toString())==null?void 0:n.toLowerCase();return!!(!((r=e.getValue(s))==null||(r=r.toString())==null||(r=r.toLowerCase())==null)&&r.includes(i))};fs.autoRemove=e=>Xe(e);const ms=(e,s,t)=>{var n;return!!(!((n=e.getValue(s))==null||(n=n.toString())==null)&&n.includes(t))};ms.autoRemove=e=>Xe(e);const ps=(e,s,t)=>{var n;return((n=e.getValue(s))==null||(n=n.toString())==null?void 0:n.toLowerCase())===(t==null?void 0:t.toLowerCase())};ps.autoRemove=e=>Xe(e);const hs=(e,s,t)=>{var n;return(n=e.getValue(s))==null?void 0:n.includes(t)};hs.autoRemove=e=>Xe(e);const xs=(e,s,t)=>!t.some(n=>{var r;return!((r=e.getValue(s))!=null&&r.includes(n))});xs.autoRemove=e=>Xe(e)||!(e!=null&&e.length);const vs=(e,s,t)=>t.some(n=>{var r;return(r=e.getValue(s))==null?void 0:r.includes(n)});vs.autoRemove=e=>Xe(e)||!(e!=null&&e.length);const ys=(e,s,t)=>e.getValue(s)===t;ys.autoRemove=e=>Xe(e);const bs=(e,s,t)=>e.getValue(s)==t;bs.autoRemove=e=>Xe(e);const Mn=(e,s,t)=>{let[n,r]=t;const i=e.getValue(s);return i>=n&&i<=r};Mn.resolveFilterValue=e=>{let[s,t]=e,n=typeof s!="number"?parseFloat(s):s,r=typeof t!="number"?parseFloat(t):t,i=s===null||Number.isNaN(n)?-1/0:n,l=t===null||Number.isNaN(r)?1/0:r;if(i>l){const a=i;i=l,l=a}return[i,l]};Mn.autoRemove=e=>Xe(e)||Xe(e[0])&&Xe(e[1]);const Qe={includesString:fs,includesStringSensitive:ms,equalsString:ps,arrIncludes:hs,arrIncludesAll:xs,arrIncludesSome:vs,equals:ys,weakEquals:bs,inNumberRange:Mn};function Xe(e){return e==null||e===""}const rr={getDefaultColumnDef:()=>({filterFn:"auto"}),getInitialState:e=>({columnFilters:[],...e}),getDefaultOptions:e=>({onColumnFiltersChange:He("columnFilters",e),filterFromLeafRows:!1,maxLeafRowFilterDepth:100}),createColumn:(e,s)=>{e.getAutoFilterFn=()=>{const t=s.getCoreRowModel().flatRows[0],n=t==null?void 0:t.getValue(e.id);return typeof n=="string"?Qe.includesString:typeof n=="number"?Qe.inNumberRange:typeof n=="boolean"||n!==null&&typeof n=="object"?Qe.equals:Array.isArray(n)?Qe.arrIncludes:Qe.weakEquals},e.getFilterFn=()=>{var t,n;return Bt(e.columnDef.filterFn)?e.columnDef.filterFn:e.columnDef.filterFn==="auto"?e.getAutoFilterFn():(t=(n=s.options.filterFns)==null?void 0:n[e.columnDef.filterFn])!=null?t:Qe[e.columnDef.filterFn]},e.getCanFilter=()=>{var t,n,r;return((t=e.columnDef.enableColumnFilter)!=null?t:!0)&&((n=s.options.enableColumnFilters)!=null?n:!0)&&((r=s.options.enableFilters)!=null?r:!0)&&!!e.accessorFn},e.getIsFiltered=()=>e.getFilterIndex()>-1,e.getFilterValue=()=>{var t;return(t=s.getState().columnFilters)==null||(t=t.find(n=>n.id===e.id))==null?void 0:t.value},e.getFilterIndex=()=>{var t,n;return(t=(n=s.getState().columnFilters)==null?void 0:n.findIndex(r=>r.id===e.id))!=null?t:-1},e.setFilterValue=t=>{s.setColumnFilters(n=>{const r=e.getFilterFn(),i=n==null?void 0:n.find(d=>d.id===e.id),l=it(t,i?i.value:void 0);if(Qn(r,l,e)){var a;return(a=n==null?void 0:n.filter(d=>d.id!==e.id))!=null?a:[]}const u={id:e.id,value:l};if(i){var c;return(c=n==null?void 0:n.map(d=>d.id===e.id?u:d))!=null?c:[]}return n!=null&&n.length?[...n,u]:[u]})}},createRow:(e,s)=>{e.columnFilters={},e.columnFiltersMeta={}},createTable:e=>{e.setColumnFilters=s=>{const t=e.getAllLeafColumns(),n=r=>{var i;return(i=it(s,r))==null?void 0:i.filter(l=>{const a=t.find(u=>u.id===l.id);if(a){const u=a.getFilterFn();if(Qn(u,l.value,a))return!1}return!0})};e.options.onColumnFiltersChange==null||e.options.onColumnFiltersChange(n)},e.resetColumnFilters=s=>{var t,n;e.setColumnFilters(s?[]:(t=(n=e.initialState)==null?void 0:n.columnFilters)!=null?t:[])},e.getPreFilteredRowModel=()=>e.getCoreRowModel(),e.getFilteredRowModel=()=>(!e._getFilteredRowModel&&e.options.getFilteredRowModel&&(e._getFilteredRowModel=e.options.getFilteredRowModel(e)),e.options.manualFiltering||!e._getFilteredRowModel?e.getPreFilteredRowModel():e._getFilteredRowModel())}};function Qn(e,s,t){return(e&&e.autoRemove?e.autoRemove(s,t):!1)||typeof s>"u"||typeof s=="string"&&!s}const ir=(e,s,t)=>t.reduce((n,r)=>{const i=r.getValue(e);return n+(typeof i=="number"?i:0)},0),ar=(e,s,t)=>{let n;return t.forEach(r=>{const i=r.getValue(e);i!=null&&(n>i||n===void 0&&i>=i)&&(n=i)}),n},lr=(e,s,t)=>{let n;return t.forEach(r=>{const i=r.getValue(e);i!=null&&(n<i||n===void 0&&i>=i)&&(n=i)}),n},ur=(e,s,t)=>{let n,r;return t.forEach(i=>{const l=i.getValue(e);l!=null&&(n===void 0?l>=l&&(n=r=l):(n>l&&(n=l),r<l&&(r=l)))}),[n,r]},dr=(e,s)=>{let t=0,n=0;if(s.forEach(r=>{let i=r.getValue(e);i!=null&&(i=+i)>=i&&(++t,n+=i)}),t)return n/t},cr=(e,s)=>{if(!s.length)return;const t=s.map(i=>i.getValue(e));if(!Qo(t))return;if(t.length===1)return t[0];const n=Math.floor(t.length/2),r=t.sort((i,l)=>i-l);return t.length%2!==0?r[n]:(r[n-1]+r[n])/2},gr=(e,s)=>Array.from(new Set(s.map(t=>t.getValue(e))).values()),fr=(e,s)=>new Set(s.map(t=>t.getValue(e))).size,mr=(e,s)=>s.length,ln={sum:ir,min:ar,max:lr,extent:ur,mean:dr,median:cr,unique:gr,uniqueCount:fr,count:mr},pr={getDefaultColumnDef:()=>({aggregatedCell:e=>{var s,t;return(s=(t=e.getValue())==null||t.toString==null?void 0:t.toString())!=null?s:null},aggregationFn:"auto"}),getInitialState:e=>({grouping:[],...e}),getDefaultOptions:e=>({onGroupingChange:He("grouping",e),groupedColumnMode:"reorder"}),createColumn:(e,s)=>{e.toggleGrouping=()=>{s.setGrouping(t=>t!=null&&t.includes(e.id)?t.filter(n=>n!==e.id):[...t??[],e.id])},e.getCanGroup=()=>{var t,n;return((t=e.columnDef.enableGrouping)!=null?t:!0)&&((n=s.options.enableGrouping)!=null?n:!0)&&(!!e.accessorFn||!!e.columnDef.getGroupingValue)},e.getIsGrouped=()=>{var t;return(t=s.getState().grouping)==null?void 0:t.includes(e.id)},e.getGroupedIndex=()=>{var t;return(t=s.getState().grouping)==null?void 0:t.indexOf(e.id)},e.getToggleGroupingHandler=()=>{const t=e.getCanGroup();return()=>{t&&e.toggleGrouping()}},e.getAutoAggregationFn=()=>{const t=s.getCoreRowModel().flatRows[0],n=t==null?void 0:t.getValue(e.id);if(typeof n=="number")return ln.sum;if(Object.prototype.toString.call(n)==="[object Date]")return ln.extent},e.getAggregationFn=()=>{var t,n;if(!e)throw new Error;return Bt(e.columnDef.aggregationFn)?e.columnDef.aggregationFn:e.columnDef.aggregationFn==="auto"?e.getAutoAggregationFn():(t=(n=s.options.aggregationFns)==null?void 0:n[e.columnDef.aggregationFn])!=null?t:ln[e.columnDef.aggregationFn]}},createTable:e=>{e.setGrouping=s=>e.options.onGroupingChange==null?void 0:e.options.onGroupingChange(s),e.resetGrouping=s=>{var t,n;e.setGrouping(s?[]:(t=(n=e.initialState)==null?void 0:n.grouping)!=null?t:[])},e.getPreGroupedRowModel=()=>e.getFilteredRowModel(),e.getGroupedRowModel=()=>(!e._getGroupedRowModel&&e.options.getGroupedRowModel&&(e._getGroupedRowModel=e.options.getGroupedRowModel(e)),e.options.manualGrouping||!e._getGroupedRowModel?e.getPreGroupedRowModel():e._getGroupedRowModel())},createRow:(e,s)=>{e.getIsGrouped=()=>!!e.groupingColumnId,e.getGroupingValue=t=>{if(e._groupingValuesCache.hasOwnProperty(t))return e._groupingValuesCache[t];const n=s.getColumn(t);return n!=null&&n.columnDef.getGroupingValue?(e._groupingValuesCache[t]=n.columnDef.getGroupingValue(e.original),e._groupingValuesCache[t]):e.getValue(t)},e._groupingValuesCache={}},createCell:(e,s,t,n)=>{e.getIsGrouped=()=>s.getIsGrouped()&&s.id===t.groupingColumnId,e.getIsPlaceholder=()=>!e.getIsGrouped()&&s.getIsGrouped(),e.getIsAggregated=()=>{var r;return!e.getIsGrouped()&&!e.getIsPlaceholder()&&!!((r=t.subRows)!=null&&r.length)}}};function hr(e,s,t){if(!(s!=null&&s.length)||!t)return e;const n=e.filter(i=>!s.includes(i.id));return t==="remove"?n:[...s.map(i=>e.find(l=>l.id===i)).filter(Boolean),...n]}const xr={getInitialState:e=>({columnOrder:[],...e}),getDefaultOptions:e=>({onColumnOrderChange:He("columnOrder",e)}),createColumn:(e,s)=>{e.getIndex=O(t=>[Ft(s,t)],t=>t.findIndex(n=>n.id===e.id),G(s.options,"debugColumns")),e.getIsFirstColumn=t=>{var n;return((n=Ft(s,t)[0])==null?void 0:n.id)===e.id},e.getIsLastColumn=t=>{var n;const r=Ft(s,t);return((n=r[r.length-1])==null?void 0:n.id)===e.id}},createTable:e=>{e.setColumnOrder=s=>e.options.onColumnOrderChange==null?void 0:e.options.onColumnOrderChange(s),e.resetColumnOrder=s=>{var t;e.setColumnOrder(s?[]:(t=e.initialState.columnOrder)!=null?t:[])},e._getOrderColumnsFn=O(()=>[e.getState().columnOrder,e.getState().grouping,e.options.groupedColumnMode],(s,t,n)=>r=>{let i=[];if(!(s!=null&&s.length))i=r;else{const l=[...s],a=[...r];for(;a.length&&l.length;){const u=l.shift(),c=a.findIndex(d=>d.id===u);c>-1&&i.push(a.splice(c,1)[0])}i=[...i,...a]}return hr(i,t,n)},G(e.options,"debugTable"))}},un=()=>({left:[],right:[]}),vr={getInitialState:e=>({columnPinning:un(),...e}),getDefaultOptions:e=>({onColumnPinningChange:He("columnPinning",e)}),createColumn:(e,s)=>{e.pin=t=>{const n=e.getLeafColumns().map(r=>r.id).filter(Boolean);s.setColumnPinning(r=>{var i,l;if(t==="right"){var a,u;return{left:((a=r==null?void 0:r.left)!=null?a:[]).filter(p=>!(n!=null&&n.includes(p))),right:[...((u=r==null?void 0:r.right)!=null?u:[]).filter(p=>!(n!=null&&n.includes(p))),...n]}}if(t==="left"){var c,d;return{left:[...((c=r==null?void 0:r.left)!=null?c:[]).filter(p=>!(n!=null&&n.includes(p))),...n],right:((d=r==null?void 0:r.right)!=null?d:[]).filter(p=>!(n!=null&&n.includes(p)))}}return{left:((i=r==null?void 0:r.left)!=null?i:[]).filter(p=>!(n!=null&&n.includes(p))),right:((l=r==null?void 0:r.right)!=null?l:[]).filter(p=>!(n!=null&&n.includes(p)))}})},e.getCanPin=()=>e.getLeafColumns().some(n=>{var r,i,l;return((r=n.columnDef.enablePinning)!=null?r:!0)&&((i=(l=s.options.enableColumnPinning)!=null?l:s.options.enablePinning)!=null?i:!0)}),e.getIsPinned=()=>{const t=e.getLeafColumns().map(a=>a.id),{left:n,right:r}=s.getState().columnPinning,i=t.some(a=>n==null?void 0:n.includes(a)),l=t.some(a=>r==null?void 0:r.includes(a));return i?"left":l?"right":!1},e.getPinnedIndex=()=>{var t,n;const r=e.getIsPinned();return r?(t=(n=s.getState().columnPinning)==null||(n=n[r])==null?void 0:n.indexOf(e.id))!=null?t:-1:0}},createRow:(e,s)=>{e.getCenterVisibleCells=O(()=>[e._getAllVisibleCells(),s.getState().columnPinning.left,s.getState().columnPinning.right],(t,n,r)=>{const i=[...n??[],...r??[]];return t.filter(l=>!i.includes(l.column.id))},G(s.options,"debugRows")),e.getLeftVisibleCells=O(()=>[e._getAllVisibleCells(),s.getState().columnPinning.left],(t,n)=>(n??[]).map(i=>t.find(l=>l.column.id===i)).filter(Boolean).map(i=>({...i,position:"left"})),G(s.options,"debugRows")),e.getRightVisibleCells=O(()=>[e._getAllVisibleCells(),s.getState().columnPinning.right],(t,n)=>(n??[]).map(i=>t.find(l=>l.column.id===i)).filter(Boolean).map(i=>({...i,position:"right"})),G(s.options,"debugRows"))},createTable:e=>{e.setColumnPinning=s=>e.options.onColumnPinningChange==null?void 0:e.options.onColumnPinningChange(s),e.resetColumnPinning=s=>{var t,n;return e.setColumnPinning(s?un():(t=(n=e.initialState)==null?void 0:n.columnPinning)!=null?t:un())},e.getIsSomeColumnsPinned=s=>{var t;const n=e.getState().columnPinning;if(!s){var r,i;return!!((r=n.left)!=null&&r.length||(i=n.right)!=null&&i.length)}return!!((t=n[s])!=null&&t.length)},e.getLeftLeafColumns=O(()=>[e.getAllLeafColumns(),e.getState().columnPinning.left],(s,t)=>(t??[]).map(n=>s.find(r=>r.id===n)).filter(Boolean),G(e.options,"debugColumns")),e.getRightLeafColumns=O(()=>[e.getAllLeafColumns(),e.getState().columnPinning.right],(s,t)=>(t??[]).map(n=>s.find(r=>r.id===n)).filter(Boolean),G(e.options,"debugColumns")),e.getCenterLeafColumns=O(()=>[e.getAllLeafColumns(),e.getState().columnPinning.left,e.getState().columnPinning.right],(s,t,n)=>{const r=[...t??[],...n??[]];return s.filter(i=>!r.includes(i.id))},G(e.options,"debugColumns"))}};function yr(e){return e||(typeof document<"u"?document:null)}const zt={size:150,minSize:20,maxSize:Number.MAX_SAFE_INTEGER},dn=()=>({startOffset:null,startSize:null,deltaOffset:null,deltaPercentage:null,isResizingColumn:!1,columnSizingStart:[]}),br={getDefaultColumnDef:()=>zt,getInitialState:e=>({columnSizing:{},columnSizingInfo:dn(),...e}),getDefaultOptions:e=>({columnResizeMode:"onEnd",columnResizeDirection:"ltr",onColumnSizingChange:He("columnSizing",e),onColumnSizingInfoChange:He("columnSizingInfo",e)}),createColumn:(e,s)=>{e.getSize=()=>{var t,n,r;const i=s.getState().columnSizing[e.id];return Math.min(Math.max((t=e.columnDef.minSize)!=null?t:zt.minSize,(n=i??e.columnDef.size)!=null?n:zt.size),(r=e.columnDef.maxSize)!=null?r:zt.maxSize)},e.getStart=O(t=>[t,Ft(s,t),s.getState().columnSizing],(t,n)=>n.slice(0,e.getIndex(t)).reduce((r,i)=>r+i.getSize(),0),G(s.options,"debugColumns")),e.getAfter=O(t=>[t,Ft(s,t),s.getState().columnSizing],(t,n)=>n.slice(e.getIndex(t)+1).reduce((r,i)=>r+i.getSize(),0),G(s.options,"debugColumns")),e.resetSize=()=>{s.setColumnSizing(t=>{let{[e.id]:n,...r}=t;return r})},e.getCanResize=()=>{var t,n;return((t=e.columnDef.enableResizing)!=null?t:!0)&&((n=s.options.enableColumnResizing)!=null?n:!0)},e.getIsResizing=()=>s.getState().columnSizingInfo.isResizingColumn===e.id},createHeader:(e,s)=>{e.getSize=()=>{let t=0;const n=r=>{if(r.subHeaders.length)r.subHeaders.forEach(n);else{var i;t+=(i=r.column.getSize())!=null?i:0}};return n(e),t},e.getStart=()=>{if(e.index>0){const t=e.headerGroup.headers[e.index-1];return t.getStart()+t.getSize()}return 0},e.getResizeHandler=t=>{const n=s.getColumn(e.column.id),r=n==null?void 0:n.getCanResize();return i=>{if(!n||!r||(i.persist==null||i.persist(),cn(i)&&i.touches&&i.touches.length>1))return;const l=e.getSize(),a=e?e.getLeafHeaders().map(h=>[h.column.id,h.column.getSize()]):[[n.id,n.getSize()]],u=cn(i)?Math.round(i.touches[0].clientX):i.clientX,c={},d=(h,v)=>{typeof v=="number"&&(s.setColumnSizingInfo(x=>{var _,N;const C=s.options.columnResizeDirection==="rtl"?-1:1,V=(v-((_=x==null?void 0:x.startOffset)!=null?_:0))*C,I=Math.max(V/((N=x==null?void 0:x.startSize)!=null?N:0),-.999999);return x.columnSizingStart.forEach(E=>{let[q,D]=E;c[q]=Math.round(Math.max(D+D*I,0)*100)/100}),{...x,deltaOffset:V,deltaPercentage:I}}),(s.options.columnResizeMode==="onChange"||h==="end")&&s.setColumnSizing(x=>({...x,...c})))},p=h=>d("move",h),f=h=>{d("end",h),s.setColumnSizingInfo(v=>({...v,isResizingColumn:!1,startOffset:null,startSize:null,deltaOffset:null,deltaPercentage:null,columnSizingStart:[]}))},g=yr(t),w={moveHandler:h=>p(h.clientX),upHandler:h=>{g==null||g.removeEventListener("mousemove",w.moveHandler),g==null||g.removeEventListener("mouseup",w.upHandler),f(h.clientX)}},S={moveHandler:h=>(h.cancelable&&(h.preventDefault(),h.stopPropagation()),p(h.touches[0].clientX),!1),upHandler:h=>{var v;g==null||g.removeEventListener("touchmove",S.moveHandler),g==null||g.removeEventListener("touchend",S.upHandler),h.cancelable&&(h.preventDefault(),h.stopPropagation()),f((v=h.touches[0])==null?void 0:v.clientX)}},y=wr()?{passive:!1}:!1;cn(i)?(g==null||g.addEventListener("touchmove",S.moveHandler,y),g==null||g.addEventListener("touchend",S.upHandler,y)):(g==null||g.addEventListener("mousemove",w.moveHandler,y),g==null||g.addEventListener("mouseup",w.upHandler,y)),s.setColumnSizingInfo(h=>({...h,startOffset:u,startSize:l,deltaOffset:0,deltaPercentage:0,columnSizingStart:a,isResizingColumn:n.id}))}}},createTable:e=>{e.setColumnSizing=s=>e.options.onColumnSizingChange==null?void 0:e.options.onColumnSizingChange(s),e.setColumnSizingInfo=s=>e.options.onColumnSizingInfoChange==null?void 0:e.options.onColumnSizingInfoChange(s),e.resetColumnSizing=s=>{var t;e.setColumnSizing(s?{}:(t=e.initialState.columnSizing)!=null?t:{})},e.resetHeaderSizeInfo=s=>{var t;e.setColumnSizingInfo(s?dn():(t=e.initialState.columnSizingInfo)!=null?t:dn())},e.getTotalSize=()=>{var s,t;return(s=(t=e.getHeaderGroups()[0])==null?void 0:t.headers.reduce((n,r)=>n+r.getSize(),0))!=null?s:0},e.getLeftTotalSize=()=>{var s,t;return(s=(t=e.getLeftHeaderGroups()[0])==null?void 0:t.headers.reduce((n,r)=>n+r.getSize(),0))!=null?s:0},e.getCenterTotalSize=()=>{var s,t;return(s=(t=e.getCenterHeaderGroups()[0])==null?void 0:t.headers.reduce((n,r)=>n+r.getSize(),0))!=null?s:0},e.getRightTotalSize=()=>{var s,t;return(s=(t=e.getRightHeaderGroups()[0])==null?void 0:t.headers.reduce((n,r)=>n+r.getSize(),0))!=null?s:0}}};let Ht=null;function wr(){if(typeof Ht=="boolean")return Ht;let e=!1;try{const s={get passive(){return e=!0,!1}},t=()=>{};window.addEventListener("test",t,s),window.removeEventListener("test",t)}catch{e=!1}return Ht=e,Ht}function cn(e){return e.type==="touchstart"}const Sr={getInitialState:e=>({columnVisibility:{},...e}),getDefaultOptions:e=>({onColumnVisibilityChange:He("columnVisibility",e)}),createColumn:(e,s)=>{e.toggleVisibility=t=>{e.getCanHide()&&s.setColumnVisibility(n=>({...n,[e.id]:t??!e.getIsVisible()}))},e.getIsVisible=()=>{var t,n;const r=e.columns;return(t=r.length?r.some(i=>i.getIsVisible()):(n=s.getState().columnVisibility)==null?void 0:n[e.id])!=null?t:!0},e.getCanHide=()=>{var t,n;return((t=e.columnDef.enableHiding)!=null?t:!0)&&((n=s.options.enableHiding)!=null?n:!0)},e.getToggleVisibilityHandler=()=>t=>{e.toggleVisibility==null||e.toggleVisibility(t.target.checked)}},createRow:(e,s)=>{e._getAllVisibleCells=O(()=>[e.getAllCells(),s.getState().columnVisibility],t=>t.filter(n=>n.column.getIsVisible()),G(s.options,"debugRows")),e.getVisibleCells=O(()=>[e.getLeftVisibleCells(),e.getCenterVisibleCells(),e.getRightVisibleCells()],(t,n,r)=>[...t,...n,...r],G(s.options,"debugRows"))},createTable:e=>{const s=(t,n)=>O(()=>[n(),n().filter(r=>r.getIsVisible()).map(r=>r.id).join("_")],r=>r.filter(i=>i.getIsVisible==null?void 0:i.getIsVisible()),G(e.options,"debugColumns"));e.getVisibleFlatColumns=s("getVisibleFlatColumns",()=>e.getAllFlatColumns()),e.getVisibleLeafColumns=s("getVisibleLeafColumns",()=>e.getAllLeafColumns()),e.getLeftVisibleLeafColumns=s("getLeftVisibleLeafColumns",()=>e.getLeftLeafColumns()),e.getRightVisibleLeafColumns=s("getRightVisibleLeafColumns",()=>e.getRightLeafColumns()),e.getCenterVisibleLeafColumns=s("getCenterVisibleLeafColumns",()=>e.getCenterLeafColumns()),e.setColumnVisibility=t=>e.options.onColumnVisibilityChange==null?void 0:e.options.onColumnVisibilityChange(t),e.resetColumnVisibility=t=>{var n;e.setColumnVisibility(t?{}:(n=e.initialState.columnVisibility)!=null?n:{})},e.toggleAllColumnsVisible=t=>{var n;t=(n=t)!=null?n:!e.getIsAllColumnsVisible(),e.setColumnVisibility(e.getAllLeafColumns().reduce((r,i)=>({...r,[i.id]:t||!(i.getCanHide!=null&&i.getCanHide())}),{}))},e.getIsAllColumnsVisible=()=>!e.getAllLeafColumns().some(t=>!(t.getIsVisible!=null&&t.getIsVisible())),e.getIsSomeColumnsVisible=()=>e.getAllLeafColumns().some(t=>t.getIsVisible==null?void 0:t.getIsVisible()),e.getToggleAllColumnsVisibilityHandler=()=>t=>{var n;e.toggleAllColumnsVisible((n=t.target)==null?void 0:n.checked)}}};function Ft(e,s){return s?s==="center"?e.getCenterVisibleLeafColumns():s==="left"?e.getLeftVisibleLeafColumns():e.getRightVisibleLeafColumns():e.getVisibleLeafColumns()}const _r={createTable:e=>{e._getGlobalFacetedRowModel=e.options.getFacetedRowModel&&e.options.getFacetedRowModel(e,"__global__"),e.getGlobalFacetedRowModel=()=>e.options.manualFiltering||!e._getGlobalFacetedRowModel?e.getPreFilteredRowModel():e._getGlobalFacetedRowModel(),e._getGlobalFacetedUniqueValues=e.options.getFacetedUniqueValues&&e.options.getFacetedUniqueValues(e,"__global__"),e.getGlobalFacetedUniqueValues=()=>e._getGlobalFacetedUniqueValues?e._getGlobalFacetedUniqueValues():new Map,e._getGlobalFacetedMinMaxValues=e.options.getFacetedMinMaxValues&&e.options.getFacetedMinMaxValues(e,"__global__"),e.getGlobalFacetedMinMaxValues=()=>{if(e._getGlobalFacetedMinMaxValues)return e._getGlobalFacetedMinMaxValues()}}},Cr={getInitialState:e=>({globalFilter:void 0,...e}),getDefaultOptions:e=>({onGlobalFilterChange:He("globalFilter",e),globalFilterFn:"auto",getColumnCanGlobalFilter:s=>{var t;const n=(t=e.getCoreRowModel().flatRows[0])==null||(t=t._getAllCellsByColumnId()[s.id])==null?void 0:t.getValue();return typeof n=="string"||typeof n=="number"}}),createColumn:(e,s)=>{e.getCanGlobalFilter=()=>{var t,n,r,i;return((t=e.columnDef.enableGlobalFilter)!=null?t:!0)&&((n=s.options.enableGlobalFilter)!=null?n:!0)&&((r=s.options.enableFilters)!=null?r:!0)&&((i=s.options.getColumnCanGlobalFilter==null?void 0:s.options.getColumnCanGlobalFilter(e))!=null?i:!0)&&!!e.accessorFn}},createTable:e=>{e.getGlobalAutoFilterFn=()=>Qe.includesString,e.getGlobalFilterFn=()=>{var s,t;const{globalFilterFn:n}=e.options;return Bt(n)?n:n==="auto"?e.getGlobalAutoFilterFn():(s=(t=e.options.filterFns)==null?void 0:t[n])!=null?s:Qe[n]},e.setGlobalFilter=s=>{e.options.onGlobalFilterChange==null||e.options.onGlobalFilterChange(s)},e.resetGlobalFilter=s=>{e.setGlobalFilter(s?void 0:e.initialState.globalFilter)}}},jr={getInitialState:e=>({expanded:{},...e}),getDefaultOptions:e=>({onExpandedChange:He("expanded",e),paginateExpandedRows:!0}),createTable:e=>{let s=!1,t=!1;e._autoResetExpanded=()=>{var n,r;if(!s){e._queue(()=>{s=!0});return}if((n=(r=e.options.autoResetAll)!=null?r:e.options.autoResetExpanded)!=null?n:!e.options.manualExpanding){if(t)return;t=!0,e._queue(()=>{e.resetExpanded(),t=!1})}},e.setExpanded=n=>e.options.onExpandedChange==null?void 0:e.options.onExpandedChange(n),e.toggleAllRowsExpanded=n=>{n??!e.getIsAllRowsExpanded()?e.setExpanded(!0):e.setExpanded({})},e.resetExpanded=n=>{var r,i;e.setExpanded(n?{}:(r=(i=e.initialState)==null?void 0:i.expanded)!=null?r:{})},e.getCanSomeRowsExpand=()=>e.getPrePaginationRowModel().flatRows.some(n=>n.getCanExpand()),e.getToggleAllRowsExpandedHandler=()=>n=>{n.persist==null||n.persist(),e.toggleAllRowsExpanded()},e.getIsSomeRowsExpanded=()=>{const n=e.getState().expanded;return n===!0||Object.values(n).some(Boolean)},e.getIsAllRowsExpanded=()=>{const n=e.getState().expanded;return typeof n=="boolean"?n===!0:!(!Object.keys(n).length||e.getRowModel().flatRows.some(r=>!r.getIsExpanded()))},e.getExpandedDepth=()=>{let n=0;return(e.getState().expanded===!0?Object.keys(e.getRowModel().rowsById):Object.keys(e.getState().expanded)).forEach(i=>{const l=i.split(".");n=Math.max(n,l.length)}),n},e.getPreExpandedRowModel=()=>e.getSortedRowModel(),e.getExpandedRowModel=()=>(!e._getExpandedRowModel&&e.options.getExpandedRowModel&&(e._getExpandedRowModel=e.options.getExpandedRowModel(e)),e.options.manualExpanding||!e._getExpandedRowModel?e.getPreExpandedRowModel():e._getExpandedRowModel())},createRow:(e,s)=>{e.toggleExpanded=t=>{s.setExpanded(n=>{var r;const i=n===!0?!0:!!(n!=null&&n[e.id]);let l={};if(n===!0?Object.keys(s.getRowModel().rowsById).forEach(a=>{l[a]=!0}):l=n,t=(r=t)!=null?r:!i,!i&&t)return{...l,[e.id]:!0};if(i&&!t){const{[e.id]:a,...u}=l;return u}return n})},e.getIsExpanded=()=>{var t;const n=s.getState().expanded;return!!((t=s.options.getIsRowExpanded==null?void 0:s.options.getIsRowExpanded(e))!=null?t:n===!0||n!=null&&n[e.id])},e.getCanExpand=()=>{var t,n,r;return(t=s.options.getRowCanExpand==null?void 0:s.options.getRowCanExpand(e))!=null?t:((n=s.options.enableExpanding)!=null?n:!0)&&!!((r=e.subRows)!=null&&r.length)},e.getIsAllParentsExpanded=()=>{let t=!0,n=e;for(;t&&n.parentId;)n=s.getRow(n.parentId,!0),t=n.getIsExpanded();return t},e.getToggleExpandedHandler=()=>{const t=e.getCanExpand();return()=>{t&&e.toggleExpanded()}}}},bn=0,wn=10,gn=()=>({pageIndex:bn,pageSize:wn}),Nr={getInitialState:e=>({...e,pagination:{...gn(),...e==null?void 0:e.pagination}}),getDefaultOptions:e=>({onPaginationChange:He("pagination",e)}),createTable:e=>{let s=!1,t=!1;e._autoResetPageIndex=()=>{var n,r;if(!s){e._queue(()=>{s=!0});return}if((n=(r=e.options.autoResetAll)!=null?r:e.options.autoResetPageIndex)!=null?n:!e.options.manualPagination){if(t)return;t=!0,e._queue(()=>{e.resetPageIndex(),t=!1})}},e.setPagination=n=>{const r=i=>it(n,i);return e.options.onPaginationChange==null?void 0:e.options.onPaginationChange(r)},e.resetPagination=n=>{var r;e.setPagination(n?gn():(r=e.initialState.pagination)!=null?r:gn())},e.setPageIndex=n=>{e.setPagination(r=>{let i=it(n,r.pageIndex);const l=typeof e.options.pageCount>"u"||e.options.pageCount===-1?Number.MAX_SAFE_INTEGER:e.options.pageCount-1;return i=Math.max(0,Math.min(i,l)),{...r,pageIndex:i}})},e.resetPageIndex=n=>{var r,i;e.setPageIndex(n?bn:(r=(i=e.initialState)==null||(i=i.pagination)==null?void 0:i.pageIndex)!=null?r:bn)},e.resetPageSize=n=>{var r,i;e.setPageSize(n?wn:(r=(i=e.initialState)==null||(i=i.pagination)==null?void 0:i.pageSize)!=null?r:wn)},e.setPageSize=n=>{e.setPagination(r=>{const i=Math.max(1,it(n,r.pageSize)),l=r.pageSize*r.pageIndex,a=Math.floor(l/i);return{...r,pageIndex:a,pageSize:i}})},e.setPageCount=n=>e.setPagination(r=>{var i;let l=it(n,(i=e.options.pageCount)!=null?i:-1);return typeof l=="number"&&(l=Math.max(-1,l)),{...r,pageCount:l}}),e.getPageOptions=O(()=>[e.getPageCount()],n=>{let r=[];return n&&n>0&&(r=[...new Array(n)].fill(null).map((i,l)=>l)),r},G(e.options,"debugTable")),e.getCanPreviousPage=()=>e.getState().pagination.pageIndex>0,e.getCanNextPage=()=>{const{pageIndex:n}=e.getState().pagination,r=e.getPageCount();return r===-1?!0:r===0?!1:n<r-1},e.previousPage=()=>e.setPageIndex(n=>n-1),e.nextPage=()=>e.setPageIndex(n=>n+1),e.firstPage=()=>e.setPageIndex(0),e.lastPage=()=>e.setPageIndex(e.getPageCount()-1),e.getPrePaginationRowModel=()=>e.getExpandedRowModel(),e.getPaginationRowModel=()=>(!e._getPaginationRowModel&&e.options.getPaginationRowModel&&(e._getPaginationRowModel=e.options.getPaginationRowModel(e)),e.options.manualPagination||!e._getPaginationRowModel?e.getPrePaginationRowModel():e._getPaginationRowModel()),e.getPageCount=()=>{var n;return(n=e.options.pageCount)!=null?n:Math.ceil(e.getRowCount()/e.getState().pagination.pageSize)},e.getRowCount=()=>{var n;return(n=e.options.rowCount)!=null?n:e.getPrePaginationRowModel().rows.length}}},fn=()=>({top:[],bottom:[]}),Rr={getInitialState:e=>({rowPinning:fn(),...e}),getDefaultOptions:e=>({onRowPinningChange:He("rowPinning",e)}),createRow:(e,s)=>{e.pin=(t,n,r)=>{const i=n?e.getLeafRows().map(u=>{let{id:c}=u;return c}):[],l=r?e.getParentRows().map(u=>{let{id:c}=u;return c}):[],a=new Set([...l,e.id,...i]);s.setRowPinning(u=>{var c,d;if(t==="bottom"){var p,f;return{top:((p=u==null?void 0:u.top)!=null?p:[]).filter(S=>!(a!=null&&a.has(S))),bottom:[...((f=u==null?void 0:u.bottom)!=null?f:[]).filter(S=>!(a!=null&&a.has(S))),...Array.from(a)]}}if(t==="top"){var g,w;return{top:[...((g=u==null?void 0:u.top)!=null?g:[]).filter(S=>!(a!=null&&a.has(S))),...Array.from(a)],bottom:((w=u==null?void 0:u.bottom)!=null?w:[]).filter(S=>!(a!=null&&a.has(S)))}}return{top:((c=u==null?void 0:u.top)!=null?c:[]).filter(S=>!(a!=null&&a.has(S))),bottom:((d=u==null?void 0:u.bottom)!=null?d:[]).filter(S=>!(a!=null&&a.has(S)))}})},e.getCanPin=()=>{var t;const{enableRowPinning:n,enablePinning:r}=s.options;return typeof n=="function"?n(e):(t=n??r)!=null?t:!0},e.getIsPinned=()=>{const t=[e.id],{top:n,bottom:r}=s.getState().rowPinning,i=t.some(a=>n==null?void 0:n.includes(a)),l=t.some(a=>r==null?void 0:r.includes(a));return i?"top":l?"bottom":!1},e.getPinnedIndex=()=>{var t,n;const r=e.getIsPinned();if(!r)return-1;const i=(t=r==="top"?s.getTopRows():s.getBottomRows())==null?void 0:t.map(l=>{let{id:a}=l;return a});return(n=i==null?void 0:i.indexOf(e.id))!=null?n:-1}},createTable:e=>{e.setRowPinning=s=>e.options.onRowPinningChange==null?void 0:e.options.onRowPinningChange(s),e.resetRowPinning=s=>{var t,n;return e.setRowPinning(s?fn():(t=(n=e.initialState)==null?void 0:n.rowPinning)!=null?t:fn())},e.getIsSomeRowsPinned=s=>{var t;const n=e.getState().rowPinning;if(!s){var r,i;return!!((r=n.top)!=null&&r.length||(i=n.bottom)!=null&&i.length)}return!!((t=n[s])!=null&&t.length)},e._getPinnedRows=(s,t,n)=>{var r;return((r=e.options.keepPinnedRows)==null||r?(t??[]).map(l=>{const a=e.getRow(l,!0);return a.getIsAllParentsExpanded()?a:null}):(t??[]).map(l=>s.find(a=>a.id===l))).filter(Boolean).map(l=>({...l,position:n}))},e.getTopRows=O(()=>[e.getRowModel().rows,e.getState().rowPinning.top],(s,t)=>e._getPinnedRows(s,t,"top"),G(e.options,"debugRows")),e.getBottomRows=O(()=>[e.getRowModel().rows,e.getState().rowPinning.bottom],(s,t)=>e._getPinnedRows(s,t,"bottom"),G(e.options,"debugRows")),e.getCenterRows=O(()=>[e.getRowModel().rows,e.getState().rowPinning.top,e.getState().rowPinning.bottom],(s,t,n)=>{const r=new Set([...t??[],...n??[]]);return s.filter(i=>!r.has(i.id))},G(e.options,"debugRows"))}},Mr={getInitialState:e=>({rowSelection:{},...e}),getDefaultOptions:e=>({onRowSelectionChange:He("rowSelection",e),enableRowSelection:!0,enableMultiRowSelection:!0,enableSubRowSelection:!0}),createTable:e=>{e.setRowSelection=s=>e.options.onRowSelectionChange==null?void 0:e.options.onRowSelectionChange(s),e.resetRowSelection=s=>{var t;return e.setRowSelection(s?{}:(t=e.initialState.rowSelection)!=null?t:{})},e.toggleAllRowsSelected=s=>{e.setRowSelection(t=>{s=typeof s<"u"?s:!e.getIsAllRowsSelected();const n={...t},r=e.getPreGroupedRowModel().flatRows;return s?r.forEach(i=>{i.getCanSelect()&&(n[i.id]=!0)}):r.forEach(i=>{delete n[i.id]}),n})},e.toggleAllPageRowsSelected=s=>e.setRowSelection(t=>{const n=typeof s<"u"?s:!e.getIsAllPageRowsSelected(),r={...t};return e.getRowModel().rows.forEach(i=>{Sn(r,i.id,n,!0,e)}),r}),e.getPreSelectedRowModel=()=>e.getCoreRowModel(),e.getSelectedRowModel=O(()=>[e.getState().rowSelection,e.getCoreRowModel()],(s,t)=>Object.keys(s).length?mn(e,t):{rows:[],flatRows:[],rowsById:{}},G(e.options,"debugTable")),e.getFilteredSelectedRowModel=O(()=>[e.getState().rowSelection,e.getFilteredRowModel()],(s,t)=>Object.keys(s).length?mn(e,t):{rows:[],flatRows:[],rowsById:{}},G(e.options,"debugTable")),e.getGroupedSelectedRowModel=O(()=>[e.getState().rowSelection,e.getSortedRowModel()],(s,t)=>Object.keys(s).length?mn(e,t):{rows:[],flatRows:[],rowsById:{}},G(e.options,"debugTable")),e.getIsAllRowsSelected=()=>{const s=e.getFilteredRowModel().flatRows,{rowSelection:t}=e.getState();let n=!!(s.length&&Object.keys(t).length);return n&&s.some(r=>r.getCanSelect()&&!t[r.id])&&(n=!1),n},e.getIsAllPageRowsSelected=()=>{const s=e.getPaginationRowModel().flatRows.filter(r=>r.getCanSelect()),{rowSelection:t}=e.getState();let n=!!s.length;return n&&s.some(r=>!t[r.id])&&(n=!1),n},e.getIsSomeRowsSelected=()=>{var s;const t=Object.keys((s=e.getState().rowSelection)!=null?s:{}).length;return t>0&&t<e.getFilteredRowModel().flatRows.length},e.getIsSomePageRowsSelected=()=>{const s=e.getPaginationRowModel().flatRows;return e.getIsAllPageRowsSelected()?!1:s.filter(t=>t.getCanSelect()).some(t=>t.getIsSelected()||t.getIsSomeSelected())},e.getToggleAllRowsSelectedHandler=()=>s=>{e.toggleAllRowsSelected(s.target.checked)},e.getToggleAllPageRowsSelectedHandler=()=>s=>{e.toggleAllPageRowsSelected(s.target.checked)}},createRow:(e,s)=>{e.toggleSelected=(t,n)=>{const r=e.getIsSelected();s.setRowSelection(i=>{var l;if(t=typeof t<"u"?t:!r,e.getCanSelect()&&r===t)return i;const a={...i};return Sn(a,e.id,t,(l=n==null?void 0:n.selectChildren)!=null?l:!0,s),a})},e.getIsSelected=()=>{const{rowSelection:t}=s.getState();return Fn(e,t)},e.getIsSomeSelected=()=>{const{rowSelection:t}=s.getState();return _n(e,t)==="some"},e.getIsAllSubRowsSelected=()=>{const{rowSelection:t}=s.getState();return _n(e,t)==="all"},e.getCanSelect=()=>{var t;return typeof s.options.enableRowSelection=="function"?s.options.enableRowSelection(e):(t=s.options.enableRowSelection)!=null?t:!0},e.getCanSelectSubRows=()=>{var t;return typeof s.options.enableSubRowSelection=="function"?s.options.enableSubRowSelection(e):(t=s.options.enableSubRowSelection)!=null?t:!0},e.getCanMultiSelect=()=>{var t;return typeof s.options.enableMultiRowSelection=="function"?s.options.enableMultiRowSelection(e):(t=s.options.enableMultiRowSelection)!=null?t:!0},e.getToggleSelectedHandler=()=>{const t=e.getCanSelect();return n=>{var r;t&&e.toggleSelected((r=n.target)==null?void 0:r.checked)}}}},Sn=(e,s,t,n,r)=>{var i;const l=r.getRow(s,!0);t?(l.getCanMultiSelect()||Object.keys(e).forEach(a=>delete e[a]),l.getCanSelect()&&(e[s]=!0)):delete e[s],n&&(i=l.subRows)!=null&&i.length&&l.getCanSelectSubRows()&&l.subRows.forEach(a=>Sn(e,a.id,t,n,r))};function mn(e,s){const t=e.getState().rowSelection,n=[],r={},i=function(l,a){return l.map(u=>{var c;const d=Fn(u,t);if(d&&(n.push(u),r[u.id]=u),(c=u.subRows)!=null&&c.length&&(u={...u,subRows:i(u.subRows)}),d)return u}).filter(Boolean)};return{rows:i(s.rows),flatRows:n,rowsById:r}}function Fn(e,s){var t;return(t=s[e.id])!=null?t:!1}function _n(e,s,t){var n;if(!((n=e.subRows)!=null&&n.length))return!1;let r=!0,i=!1;return e.subRows.forEach(l=>{if(!(i&&!r)&&(l.getCanSelect()&&(Fn(l,s)?i=!0:r=!1),l.subRows&&l.subRows.length)){const a=_n(l,s);a==="all"?i=!0:(a==="some"&&(i=!0),r=!1)}}),r?"all":i?"some":!1}const Cn=/([0-9]+)/gm,Fr=(e,s,t)=>ws(at(e.getValue(t)).toLowerCase(),at(s.getValue(t)).toLowerCase()),$r=(e,s,t)=>ws(at(e.getValue(t)),at(s.getValue(t))),Ir=(e,s,t)=>$n(at(e.getValue(t)).toLowerCase(),at(s.getValue(t)).toLowerCase()),Er=(e,s,t)=>$n(at(e.getValue(t)),at(s.getValue(t))),Pr=(e,s,t)=>{const n=e.getValue(t),r=s.getValue(t);return n>r?1:n<r?-1:0},Ar=(e,s,t)=>$n(e.getValue(t),s.getValue(t));function $n(e,s){return e===s?0:e>s?1:-1}function at(e){return typeof e=="number"?isNaN(e)||e===1/0||e===-1/0?"":String(e):typeof e=="string"?e:""}function ws(e,s){const t=e.split(Cn).filter(Boolean),n=s.split(Cn).filter(Boolean);for(;t.length&&n.length;){const r=t.shift(),i=n.shift(),l=parseInt(r,10),a=parseInt(i,10),u=[l,a].sort();if(isNaN(u[0])){if(r>i)return 1;if(i>r)return-1;continue}if(isNaN(u[1]))return isNaN(l)?-1:1;if(l>a)return 1;if(a>l)return-1}return t.length-n.length}const Mt={alphanumeric:Fr,alphanumericCaseSensitive:$r,text:Ir,textCaseSensitive:Er,datetime:Pr,basic:Ar},Vr={getInitialState:e=>({sorting:[],...e}),getDefaultColumnDef:()=>({sortingFn:"auto",sortUndefined:1}),getDefaultOptions:e=>({onSortingChange:He("sorting",e),isMultiSortEvent:s=>s.shiftKey}),createColumn:(e,s)=>{e.getAutoSortingFn=()=>{const t=s.getFilteredRowModel().flatRows.slice(10);let n=!1;for(const r of t){const i=r==null?void 0:r.getValue(e.id);if(Object.prototype.toString.call(i)==="[object Date]")return Mt.datetime;if(typeof i=="string"&&(n=!0,i.split(Cn).length>1))return Mt.alphanumeric}return n?Mt.text:Mt.basic},e.getAutoSortDir=()=>{const t=s.getFilteredRowModel().flatRows[0];return typeof(t==null?void 0:t.getValue(e.id))=="string"?"asc":"desc"},e.getSortingFn=()=>{var t,n;if(!e)throw new Error;return Bt(e.columnDef.sortingFn)?e.columnDef.sortingFn:e.columnDef.sortingFn==="auto"?e.getAutoSortingFn():(t=(n=s.options.sortingFns)==null?void 0:n[e.columnDef.sortingFn])!=null?t:Mt[e.columnDef.sortingFn]},e.toggleSorting=(t,n)=>{const r=e.getNextSortingOrder(),i=typeof t<"u"&&t!==null;s.setSorting(l=>{const a=l==null?void 0:l.find(g=>g.id===e.id),u=l==null?void 0:l.findIndex(g=>g.id===e.id);let c=[],d,p=i?t:r==="desc";if(l!=null&&l.length&&e.getCanMultiSort()&&n?a?d="toggle":d="add":l!=null&&l.length&&u!==l.length-1?d="replace":a?d="toggle":d="replace",d==="toggle"&&(i||r||(d="remove")),d==="add"){var f;c=[...l,{id:e.id,desc:p}],c.splice(0,c.length-((f=s.options.maxMultiSortColCount)!=null?f:Number.MAX_SAFE_INTEGER))}else d==="toggle"?c=l.map(g=>g.id===e.id?{...g,desc:p}:g):d==="remove"?c=l.filter(g=>g.id!==e.id):c=[{id:e.id,desc:p}];return c})},e.getFirstSortDir=()=>{var t,n;return((t=(n=e.columnDef.sortDescFirst)!=null?n:s.options.sortDescFirst)!=null?t:e.getAutoSortDir()==="desc")?"desc":"asc"},e.getNextSortingOrder=t=>{var n,r;const i=e.getFirstSortDir(),l=e.getIsSorted();return l?l!==i&&((n=s.options.enableSortingRemoval)==null||n)&&(!(t&&(r=s.options.enableMultiRemove)!=null)||r)?!1:l==="desc"?"asc":"desc":i},e.getCanSort=()=>{var t,n;return((t=e.columnDef.enableSorting)!=null?t:!0)&&((n=s.options.enableSorting)!=null?n:!0)&&!!e.accessorFn},e.getCanMultiSort=()=>{var t,n;return(t=(n=e.columnDef.enableMultiSort)!=null?n:s.options.enableMultiSort)!=null?t:!!e.accessorFn},e.getIsSorted=()=>{var t;const n=(t=s.getState().sorting)==null?void 0:t.find(r=>r.id===e.id);return n?n.desc?"desc":"asc":!1},e.getSortIndex=()=>{var t,n;return(t=(n=s.getState().sorting)==null?void 0:n.findIndex(r=>r.id===e.id))!=null?t:-1},e.clearSorting=()=>{s.setSorting(t=>t!=null&&t.length?t.filter(n=>n.id!==e.id):[])},e.getToggleSortingHandler=()=>{const t=e.getCanSort();return n=>{t&&(n.persist==null||n.persist(),e.toggleSorting==null||e.toggleSorting(void 0,e.getCanMultiSort()?s.options.isMultiSortEvent==null?void 0:s.options.isMultiSortEvent(n):!1))}}},createTable:e=>{e.setSorting=s=>e.options.onSortingChange==null?void 0:e.options.onSortingChange(s),e.resetSorting=s=>{var t,n;e.setSorting(s?[]:(t=(n=e.initialState)==null?void 0:n.sorting)!=null?t:[])},e.getPreSortedRowModel=()=>e.getGroupedRowModel(),e.getSortedRowModel=()=>(!e._getSortedRowModel&&e.options.getSortedRowModel&&(e._getSortedRowModel=e.options.getSortedRowModel(e)),e.options.manualSorting||!e._getSortedRowModel?e.getPreSortedRowModel():e._getSortedRowModel())}},Dr=[nr,Sr,xr,vr,or,rr,_r,Cr,Vr,pr,jr,Nr,Rr,Mr,br];function kr(e){var s,t;const n=[...Dr,...(s=e._features)!=null?s:[]];let r={_features:n};const i=r._features.reduce((f,g)=>Object.assign(f,g.getDefaultOptions==null?void 0:g.getDefaultOptions(r)),{}),l=f=>r.options.mergeOptions?r.options.mergeOptions(i,f):{...i,...f};let u={...{},...(t=e.initialState)!=null?t:{}};r._features.forEach(f=>{var g;u=(g=f.getInitialState==null?void 0:f.getInitialState(u))!=null?g:u});const c=[];let d=!1;const p={_features:n,options:{...i,...e},initialState:u,_queue:f=>{c.push(f),d||(d=!0,Promise.resolve().then(()=>{for(;c.length;)c.shift()();d=!1}).catch(g=>setTimeout(()=>{throw g})))},reset:()=>{r.setState(r.initialState)},setOptions:f=>{const g=it(f,r.options);r.options=l(g)},getState:()=>r.options.state,setState:f=>{r.options.onStateChange==null||r.options.onStateChange(f)},_getRowId:(f,g,w)=>{var S;return(S=r.options.getRowId==null?void 0:r.options.getRowId(f,g,w))!=null?S:`${w?[w.id,g].join("."):g}`},getCoreRowModel:()=>(r._getCoreRowModel||(r._getCoreRowModel=r.options.getCoreRowModel(r)),r._getCoreRowModel()),getRowModel:()=>r.getPaginationRowModel(),getRow:(f,g)=>{let w=(g?r.getPrePaginationRowModel():r.getRowModel()).rowsById[f];if(!w&&(w=r.getCoreRowModel().rowsById[f],!w))throw new Error;return w},_getDefaultColumnDef:O(()=>[r.options.defaultColumn],f=>{var g;return f=(g=f)!=null?g:{},{header:w=>{const S=w.header.column.columnDef;return S.accessorKey?S.accessorKey:S.accessorFn?S.id:null},cell:w=>{var S,y;return(S=(y=w.renderValue())==null||y.toString==null?void 0:y.toString())!=null?S:null},...r._features.reduce((w,S)=>Object.assign(w,S.getDefaultColumnDef==null?void 0:S.getDefaultColumnDef()),{}),...f}},G(e,"debugColumns")),_getColumnDefs:()=>r.options.columns,getAllColumns:O(()=>[r._getColumnDefs()],f=>{const g=function(w,S,y){return y===void 0&&(y=0),w.map(h=>{const v=tr(r,h,y,S),x=h;return v.columns=x.columns?g(x.columns,v,y+1):[],v})};return g(f)},G(e,"debugColumns")),getAllFlatColumns:O(()=>[r.getAllColumns()],f=>f.flatMap(g=>g.getFlatColumns()),G(e,"debugColumns")),_getAllFlatColumnsById:O(()=>[r.getAllFlatColumns()],f=>f.reduce((g,w)=>(g[w.id]=w,g),{}),G(e,"debugColumns")),getAllLeafColumns:O(()=>[r.getAllColumns(),r._getOrderColumnsFn()],(f,g)=>{let w=f.flatMap(S=>S.getLeafColumns());return g(w)},G(e,"debugColumns")),getColumn:f=>r._getAllFlatColumnsById()[f]};Object.assign(r,p);for(let f=0;f<r._features.length;f++){const g=r._features[f];g==null||g.createTable==null||g.createTable(r)}return r}function Jn(){return e=>O(()=>[e.options.data],s=>{const t={rows:[],flatRows:[],rowsById:{}},n=function(r,i,l){i===void 0&&(i=0);const a=[];for(let c=0;c<r.length;c++){const d=sr(e,e._getRowId(r[c],c,l),r[c],c,i,void 0,l==null?void 0:l.id);if(t.flatRows.push(d),t.rowsById[d.id]=d,a.push(d),e.options.getSubRows){var u;d.originalSubRows=e.options.getSubRows(r[c],c),(u=d.originalSubRows)!=null&&u.length&&(d.subRows=n(d.originalSubRows,i+1,d))}}return a};return t.rows=n(s),t},G(e.options,"debugTable","getRowModel",()=>e._autoResetPageIndex()))}function Tr(e){const s=[],t=n=>{var r;s.push(n),(r=n.subRows)!=null&&r.length&&n.getIsExpanded()&&n.subRows.forEach(t)};return e.rows.forEach(t),{rows:s,flatRows:e.flatRows,rowsById:e.rowsById}}function es(e){return s=>O(()=>[s.getState().pagination,s.getPrePaginationRowModel(),s.options.paginateExpandedRows?void 0:s.getState().expanded],(t,n)=>{if(!n.rows.length)return n;const{pageSize:r,pageIndex:i}=t;let{rows:l,flatRows:a,rowsById:u}=n;const c=r*i,d=c+r;l=l.slice(c,d);let p;s.options.paginateExpandedRows?p={rows:l,flatRows:a,rowsById:u}:p=Tr({rows:l,flatRows:a,rowsById:u}),p.flatRows=[];const f=g=>{p.flatRows.push(g),g.subRows.length&&g.subRows.forEach(f)};return p.rows.forEach(f),p},G(s.options,"debugTable"))}function ts(){return e=>O(()=>[e.getState().sorting,e.getPreSortedRowModel()],(s,t)=>{if(!t.rows.length||!(s!=null&&s.length))return t;const n=e.getState().sorting,r=[],i=n.filter(u=>{var c;return(c=e.getColumn(u.id))==null?void 0:c.getCanSort()}),l={};i.forEach(u=>{const c=e.getColumn(u.id);c&&(l[u.id]={sortUndefined:c.columnDef.sortUndefined,invertSorting:c.columnDef.invertSorting,sortingFn:c.getSortingFn()})});const a=u=>{const c=u.map(d=>({...d}));return c.sort((d,p)=>{for(let g=0;g<i.length;g+=1){var f;const w=i[g],S=l[w.id],y=S.sortUndefined,h=(f=w==null?void 0:w.desc)!=null?f:!1;let v=0;if(y){const x=d.getValue(w.id),_=p.getValue(w.id),N=x===void 0,C=_===void 0;if(N||C){if(y==="first")return N?-1:1;if(y==="last")return N?1:-1;v=N&&C?0:N?y:-y}}if(v===0&&(v=S.sortingFn(d,p,w.id)),v!==0)return h&&(v*=-1),S.invertSorting&&(v*=-1),v}return d.index-p.index}),c.forEach(d=>{var p;r.push(d),(p=d.subRows)!=null&&p.length&&(d.subRows=a(d.subRows))}),c};return{rows:a(t.rows),flatRows:r,rowsById:t.rowsById}},G(e.options,"debugTable","getSortedRowModel",()=>e._autoResetPageIndex()))}/**
   * react-table
   *
   * Copyright (c) TanStack
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE.md file in the root directory of this source tree.
   *
   * @license MIT
   */function ns(e,s){return e?Lr(e)?b.createElement(e,s):e:null}function Lr(e){return zr(e)||typeof e=="function"||Hr(e)}function zr(e){return typeof e=="function"&&(()=>{const s=Object.getPrototypeOf(e);return s.prototype&&s.prototype.isReactComponent})()}function Hr(e){return typeof e=="object"&&typeof e.$$typeof=="symbol"&&["react.memo","react.forward_ref"].includes(e.$$typeof.description)}function ss(e){const s={state:{},onStateChange:()=>{},renderFallbackValue:null,...e},[t]=b.useState(()=>({current:kr(s)})),[n,r]=b.useState(()=>t.current.initialState);return t.current.setOptions(i=>({...i,...e,state:{...n,...e.state},onStateChange:l=>{r(l),e.onStateChange==null||e.onStateChange(l)}})),t.current}function Ss({nodes:e,edges:s,onNodesChange:t,onEdgesChange:n,onBlur:r,editable:i=!1}){const[l,a]=b.useState("nodes"),[u,c]=b.useState(e),[d,p]=b.useState(s),f=b.useRef(new Map),g=b.useRef(new Map);b.useEffect(()=>{c([...e]),p([...s]),f.current.clear(),g.current.clear()},[e,s]);const w=b.useMemo(()=>{if(e.length===0)return[];const x=new Set;e.forEach(C=>{Object.keys(C).forEach(V=>{V==="_totalIncoming"||V==="_totalOutgoing"||x.add(V)})});const _=Array.from(x);return[..._.includes("id")?["id"]:[],..._.includes("label")?["label"]:[],..._.filter(C=>C!=="id"&&C!=="label")].map(C=>({header:C.charAt(0).toUpperCase()+C.slice(1).replace(/_/g," "),accessorKey:C,cell:V=>{var E;const I=V.getValue();if(i&&C!=="id"){const D=V.row.original.id,W=u.findIndex(X=>X.id===D);if(W===-1)return o.jsx("span",{children:"-"});const M=((E=u[W])==null?void 0:E[C])??I,L=`${D}-${C}`;return o.jsx(pn,{id:L,type:typeof M=="number"?"number":"text",initialValue:M==null?"":String(M),isNumber:typeof M=="number",onBlur:X=>{const ee=[...u],le=typeof M=="number"?parseFloat(X)||0:X;ee[W]={...ee[W],[C]:le},c(ee),t==null||t(ee),r==null||r()}},L)}return I==null?"-":typeof I=="number"?I.toLocaleString():String(I)}}))},[e,i]),S=b.useMemo(()=>{if(s.length===0)return[];const x=new Set;s.forEach(C=>{Object.keys(C).forEach(V=>x.add(V))});const _=Array.from(x);return[..._.includes("source")?["source"]:[],..._.includes("target")?["target"]:[],..._.includes("value")?["value"]:[],..._.filter(C=>C!=="source"&&C!=="target"&&C!=="value")].map(C=>({header:C.charAt(0).toUpperCase()+C.slice(1).replace(/_/g," "),accessorKey:C,cell:V=>{var E,q;const I=V.getValue();if(i&&C!=="source"&&C!=="target"){const D=V.row.original,W=d.findIndex(X=>X.source===D.source&&X.target===D.target&&X.value===D.value);if(W===-1){const X=d.findIndex(ie=>ie.source===D.source&&ie.target===D.target);if(X===-1)return o.jsx("span",{children:"-"});const ee=((E=d[X])==null?void 0:E[C])??I,le=`${D.source}-${D.target}-${C}-fallback`;return o.jsx(pn,{id:le,type:typeof ee=="number"?"number":"text",initialValue:ee==null?"":String(ee),isNumber:typeof ee=="number",onBlur:ie=>{const _e=[...d],j=typeof ee=="number"?parseFloat(ie)||0:ie;_e[X]={..._e[X],[C]:j},p(_e),n==null||n(_e),r==null||r()}},le)}const M=((q=d[W])==null?void 0:q[C])??I,L=`${D.source}-${D.target}-${C}`;return o.jsx(pn,{id:L,type:typeof M=="number"?"number":"text",initialValue:M==null?"":String(M),isNumber:typeof M=="number",onBlur:X=>{const ee=[...d],le=typeof M=="number"?parseFloat(X)||0:X;ee[W]={...ee[W],[C]:le},p(ee),n==null||n(ee),r==null||r()}},L)}return I==null?"-":typeof I=="number"?I.toLocaleString():String(I)}}))},[s,i]),y=ss({data:i?u:e,columns:w,getCoreRowModel:Jn(),getSortedRowModel:ts(),getPaginationRowModel:es(),initialState:{pagination:{pageSize:25}}}),h=ss({data:i?d:s,columns:S,getCoreRowModel:Jn(),getSortedRowModel:ts(),getPaginationRowModel:es(),initialState:{pagination:{pageSize:25}}}),v=l==="nodes"?y:h;return o.jsxs("div",{className:"h-full w-full flex flex-col",style:{height:"100%",maxHeight:"100%"},children:[o.jsxs("div",{className:"flex border-b mb-4 flex-shrink-0",children:[o.jsxs("button",{onClick:()=>a("nodes"),className:`px-4 py-2 font-medium text-sm transition-colors ${l==="nodes"?"border-b-2 border-blue-600 text-blue-600":"text-gray-600 hover:text-gray-900"}`,children:["Nodes (",e.length,")"]}),o.jsxs("button",{onClick:()=>a("edges"),className:`px-4 py-2 font-medium text-sm transition-colors ${l==="edges"?"border-b-2 border-blue-600 text-blue-600":"text-gray-600 hover:text-gray-900"}`,children:["Edges (",s.length,")"]})]}),o.jsx("div",{className:"flex-1 flex flex-col min-h-0 overflow-hidden",children:o.jsxs("div",{className:"overflow-auto flex-1 min-h-0",children:[o.jsxs("table",{className:"min-w-full text-sm",children:[o.jsx("thead",{className:"bg-gray-50 border-b sticky top-0 z-10",children:v.getHeaderGroups().map(x=>o.jsx("tr",{children:x.headers.map(_=>o.jsx("th",{className:"px-4 py-2 text-left font-semibold text-gray-700 bg-gray-50",children:_.isPlaceholder?null:o.jsxs("div",{className:_.column.getCanSort()?"cursor-pointer select-none hover:text-blue-600":"",onClick:_.column.getToggleSortingHandler(),children:[ns(_.column.columnDef.header,_.getContext()),{asc:" ↑",desc:" ↓"}[_.column.getIsSorted()]??null]})},_.id))},x.id))}),o.jsx("tbody",{className:"divide-y divide-gray-200 bg-white",children:v.getRowModel().rows.map(x=>o.jsx("tr",{className:"hover:bg-gray-50",children:x.getVisibleCells().map(_=>o.jsx("td",{className:"px-4 py-2",children:ns(_.column.columnDef.cell,_.getContext())},_.id))},x.id))})]}),v.getRowModel().rows.length===0&&o.jsxs("div",{className:"text-center text-gray-500 py-8",children:["No ",l," to display"]})]})}),o.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-t border-gray-200 bg-white flex-shrink-0",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("span",{className:"text-sm text-gray-700",children:"Show"}),o.jsx("select",{value:v.getState().pagination.pageSize,onChange:x=>{v.setPageSize(Number(x.target.value))},className:"border border-gray-300 rounded px-2 py-1 text-sm",children:[10,25,50,100].map(x=>o.jsx("option",{value:x,children:x},x))}),o.jsx("span",{className:"text-sm text-gray-700",children:"entries"})]}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsxs("span",{className:"text-sm text-gray-700",children:["Page ",v.getState().pagination.pageIndex+1," of"," ",v.getPageCount()]}),o.jsxs("div",{className:"flex gap-1",children:[o.jsx("button",{onClick:()=>v.setPageIndex(0),disabled:!v.getCanPreviousPage(),className:"px-2 py-1 text-sm border border-gray-300 rounded disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-50",children:"<<"}),o.jsx("button",{onClick:()=>v.previousPage(),disabled:!v.getCanPreviousPage(),className:"px-2 py-1 text-sm border border-gray-300 rounded disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-50",children:"<"}),o.jsx("button",{onClick:()=>v.nextPage(),disabled:!v.getCanNextPage(),className:"px-2 py-1 text-sm border border-gray-300 rounded disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-50",children:">"}),o.jsx("button",{onClick:()=>v.setPageIndex(v.getPageCount()-1),disabled:!v.getCanNextPage(),className:"px-2 py-1 text-sm border border-gray-300 rounded disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-50",children:">>"})]})]})]})]})}function pn({id:e,type:s,initialValue:t,onBlur:n}){const r=b.useRef(null),[i,l]=b.useState(t);return b.useEffect(()=>{r.current&&document.activeElement!==r.current&&l(t)},[t]),o.jsx("input",{ref:r,id:e,type:s,value:i,onChange:a=>{l(a.target.value)},onBlur:a=>{n(a.target.value)},className:"w-full px-2 py-1 border border-gray-300 rounded text-sm focus:outline-none focus:ring-2 focus:ring-blue-500",autoComplete:"off"})}function Or({dataset:e,onClose:s,onSave:t,onDelete:n,onDuplicate:r}){const[i,l]=b.useState(e.name),[a,u]=b.useState(e.notes||""),[c,d]=b.useState(!1),[p,f]=b.useState(!1),[g,w]=b.useState(!1),[S,y]=b.useState("info"),[h,v]=b.useState(null),x=e.snapshots[0]||{timestamp:e.timeRange.start,nodes:[],edges:[]};b.useEffect(()=>{l(e.name),u(e.notes||""),v(null)},[e]);async function _(){d(!0);try{const I={...e,name:i.trim(),notes:a.trim()||void 0};if(h){I.snapshots=h.snapshots;const E=I.snapshots[0]||x;I.metadata=ht(E)}await t(I),s()}catch(I){console.error("Save error:",I),alert("Failed to save dataset: "+(I instanceof Error?I.message:"Unknown error"))}finally{d(!1)}}async function N(){f(!0);try{await n(),s()}catch(I){console.error("Delete error:",I),alert("Failed to delete dataset: "+(I instanceof Error?I.message:"Unknown error"))}finally{f(!1),w(!1)}}function C(I,E){const q={...x,nodes:I,edges:E};v({...e,snapshots:[q]})}const V=i!==e.name||a!==(e.notes||"")||h!==null;return o.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:o.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-6xl w-full mx-4 max-h-[90vh] flex flex-col",children:[o.jsxs("div",{className:"p-6 border-b flex items-center justify-between",children:[o.jsx("h2",{className:"text-2xl font-bold",children:"Edit Dataset"}),o.jsx("button",{onClick:s,type:"button",className:"text-gray-400 hover:text-gray-600 text-2xl cursor-pointer transition-colors",children:"×"})]}),o.jsxs("div",{className:"border-b flex",children:[o.jsx("button",{onClick:()=>y("info"),type:"button",className:`px-6 py-3 font-medium cursor-pointer transition-colors ${S==="info"?"border-b-2 border-blue-600 text-blue-600":"text-gray-600 hover:text-gray-900"}`,children:"Information"}),o.jsxs("button",{onClick:()=>y("data"),type:"button",className:`px-6 py-3 font-medium cursor-pointer transition-colors ${S==="data"?"border-b-2 border-blue-600 text-blue-600":"text-gray-600 hover:text-gray-900"}`,children:["Data (",x.nodes.length," nodes, ",x.edges.length," edges)"]})]}),o.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:S==="info"?o.jsxs("div",{className:"space-y-6 max-w-2xl",children:[o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Dataset Name ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsx("input",{type:"text",value:i,onChange:I=>l(I.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Enter a name for this dataset"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Notes"}),o.jsx("textarea",{value:a,onChange:I=>u(I.target.value),rows:5,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Add any notes about this dataset..."})]}),o.jsxs("div",{className:"bg-gray-50 p-4 rounded",children:[o.jsx("h3",{className:"font-medium text-gray-700 mb-2",children:"Dataset Information"}),o.jsxs("div",{className:"text-sm text-gray-600 space-y-1",children:[o.jsxs("div",{children:[o.jsx("span",{className:"font-medium",children:"Type:"})," ",e.type.toUpperCase()]}),o.jsxs("div",{children:[o.jsx("span",{className:"font-medium",children:"Time Range:"})," ",e.timeRange.start,e.timeRange.end!==e.timeRange.start?` – ${e.timeRange.end}`:""]}),o.jsxs("div",{children:[o.jsx("span",{className:"font-medium",children:"Snapshots:"})," ",e.snapshots.length]}),e.filename&&o.jsxs("div",{children:[o.jsx("span",{className:"font-medium",children:"Original File:"})," ",e.filename]}),o.jsxs("div",{children:[o.jsx("span",{className:"font-medium",children:"Created:"})," ",new Date(e.createdAt).toLocaleDateString()]})]})]}),o.jsxs("div",{className:"border-t pt-4 space-y-3",children:[o.jsx("button",{onClick:r,type:"button",className:"w-full px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50 cursor-pointer transition-colors",children:"Duplicate Dataset"}),o.jsx("button",{onClick:()=>w(!0),type:"button",className:"w-full px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 cursor-pointer transition-colors",children:"Delete Dataset"})]})]}):o.jsx("div",{className:"h-full",children:o.jsx(Gr,{nodes:x.nodes,edges:x.edges,onUpdate:C})})}),o.jsxs("div",{className:"p-6 border-t flex justify-end gap-3",children:[o.jsx("button",{onClick:s,type:"button",disabled:c||p,className:"px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50 disabled:opacity-50 cursor-pointer transition-colors",children:"Cancel"}),o.jsx("button",{onClick:_,type:"button",disabled:c||p||!V&&S==="info"||!i.trim(),className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed cursor-pointer transition-colors",children:c?"Saving...":h?"Save All Changes":"Save Changes"})]}),g&&o.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-60",children:o.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md mx-4",children:[o.jsx("h3",{className:"text-lg font-bold mb-2",children:"Delete Dataset?"}),o.jsxs("p",{className:"text-gray-600 mb-4",children:['Are you sure you want to delete "',e.name,'"? This action cannot be undone.']}),o.jsxs("div",{className:"flex justify-end gap-3",children:[o.jsx("button",{onClick:()=>w(!1),type:"button",disabled:p,className:"px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50 cursor-pointer transition-colors",children:"Cancel"}),o.jsx("button",{onClick:N,type:"button",disabled:p,className:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 disabled:opacity-50 cursor-pointer transition-colors",children:p?"Deleting...":"Delete"})]})]})})]})})}function Gr({nodes:e,edges:s,onUpdate:t}){const[n,r]=b.useState(e),[i,l]=b.useState(s);b.useEffect(()=>{r([...e]),l([...s])},[e,s]);const a=b.useRef(n),u=b.useRef(i);b.useEffect(()=>{a.current=n,u.current=i},[n,i]);const c=b.useCallback(g=>{r(g),a.current=g},[]),d=b.useCallback(g=>{l(g),u.current=g},[]),p=b.useRef(!1),f=b.useCallback(()=>{p.current&&(t(a.current,u.current),p.current=!1)},[t]);return o.jsx("div",{className:"h-full",children:o.jsx(Ss,{nodes:n,edges:i,onNodesChange:g=>{c(g),p.current=!0},onEdgesChange:g=>{d(g),p.current=!0},onBlur:f,editable:!0})})}class st extends b.Component{constructor(s){super(s),this.state={hasError:!1,error:null}}static getDerivedStateFromError(s){return{hasError:!0,error:s}}componentDidCatch(s,t){var n,r;console.error("ErrorBoundary caught an error:",s,t),(r=(n=this.props).onError)==null||r.call(n,s,t)}render(){var s;return this.state.hasError?this.props.fallback?this.props.fallback:o.jsxs("div",{className:"p-4 bg-red-50 border border-red-200 rounded-md",children:[o.jsx("h3",{className:"text-lg font-semibold text-red-800 mb-2",children:"Something went wrong"}),o.jsx("p",{className:"text-sm text-red-700 mb-2",children:((s=this.state.error)==null?void 0:s.message)||"An error occurred"}),o.jsx("button",{onClick:()=>this.setState({hasError:!1,error:null}),className:"px-3 py-1 bg-red-600 text-white text-sm rounded hover:bg-red-700 cursor-pointer transition-colors",children:"Try again"})]}):this.props.children}}function Ur({selectedId:e,onSelect:s,onRefresh:t}){const[n,r]=b.useState([]),[i,l]=b.useState(!1),[a,u]=b.useState(null),[c,d]=b.useState(!1),[p,f]=b.useState(null),g=b.useRef(null);b.useEffect(()=>{w()},[]);async function w(){const N=await Ko();r(N)}async function S(N,C){try{const I=`${N.type||"csv"}-${Date.now()}`,E={...N,id:I,snapshots:C.snapshots,metadata:C.metadata,createdAt:Date.now()};await ot(E),await w(),l(!1),f(null),s(I)}catch(V){throw console.error("Import error:",V),V}finally{g.current&&(g.current.value="")}}async function y(N,C){C.stopPropagation();const V=await rt(N);V&&u(V)}async function h(N){await ot(N),await w(),e===N.id&&(t==null||t())}async function v(){a&&(await yn(a.id),await w(),e===a.id&&s(""),u(null))}async function x(){if(!a)return;const N=await Wo(a.id);await w(),u(null),s(N.id)}async function _(){await Yo(),await w(),d(!1),s(""),window.location.reload()}return o.jsxs("aside",{className:"h-full overflow-y-auto flex flex-col",children:[o.jsxs("div",{className:"p-4 border-b",children:[o.jsx("h2",{className:"text-lg font-bold",children:"Datasets"}),o.jsx("p",{className:"text-xs text-gray-500",children:"Stored in your browser"}),o.jsx("button",{onClick:()=>l(!0),className:"mt-3 w-full px-3 py-2 bg-blue-600 text-white text-sm rounded hover:bg-blue-700",children:"Import Dataset"}),o.jsx("input",{ref:g,type:"file",accept:".csv,.gexf",multiple:!0,className:"hidden"}),i&&o.jsx(st,{fallback:o.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:o.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md mx-4",children:[o.jsx("h3",{className:"text-lg font-bold text-red-800 mb-2",children:"Import Panel Error"}),o.jsx("p",{className:"text-gray-600 mb-4",children:"The import panel encountered an error."}),o.jsx("button",{onClick:()=>l(!1),className:"px-4 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-700 cursor-pointer transition-colors",children:"Close"})]})}),children:o.jsx(Zo,{onClose:()=>{l(!1),f(null),g.current&&(g.current.value="")},onImport:S,fileInputRef:g,onFilesSelected:f,existingFile:p})})]}),o.jsxs("ul",{className:"divide-y flex-1 overflow-y-auto",children:[n.map(N=>o.jsx("li",{children:o.jsxs("div",{className:`flex items-center group ${e===N.id?"bg-blue-50":""}`,children:[o.jsxs("button",{className:"flex-1 text-left p-3 hover:bg-gray-50",onClick:()=>s(N.id),children:[o.jsx("div",{className:"flex items-center justify-between",children:o.jsxs("div",{children:[o.jsx("div",{className:"font-medium",children:N.name}),o.jsxs("div",{className:"text-xs text-gray-500",children:[N.type.toUpperCase()," · ",N.timeRange.start,N.timeRange.end!==N.timeRange.start?`–${N.timeRange.end}`:""]})]})}),N.notes&&o.jsx("div",{className:"text-xs text-gray-600 mt-1 line-clamp-2",children:N.notes})]}),o.jsx("button",{onClick:C=>y(N.id,C),className:"px-2 py-1 text-gray-400 hover:text-blue-600 hover:bg-gray-100 rounded transition-all mr-2 cursor-pointer",title:"Edit dataset",type:"button",children:o.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})})})]})},N.id)),n.length===0&&o.jsx("li",{className:"p-3 text-sm text-gray-500",children:"No datasets yet"})]}),o.jsxs("div",{className:"p-4 border-t",children:[o.jsx("button",{onClick:()=>d(!0),type:"button",className:"w-full px-3 py-2 bg-red-600 text-white text-sm rounded hover:bg-red-700 cursor-pointer transition-colors",children:"Reset All Data"}),o.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"Delete all datasets and reload defaults"})]}),a&&o.jsx(st,{fallback:o.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:o.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md mx-4",children:[o.jsx("h3",{className:"text-lg font-bold text-red-800 mb-2",children:"Edit Panel Error"}),o.jsx("p",{className:"text-gray-600 mb-4",children:"The edit panel encountered an error."}),o.jsx("button",{onClick:()=>u(null),className:"px-4 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-700 cursor-pointer transition-colors",children:"Close"})]})}),children:o.jsx(Or,{dataset:a,onClose:()=>u(null),onSave:h,onDelete:v,onDuplicate:x})}),c&&o.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-60",children:o.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md mx-4",children:[o.jsx("h3",{className:"text-lg font-bold mb-2",children:"Reset All Data?"}),o.jsx("p",{className:"text-gray-600 mb-4",children:"This will delete all datasets and reload the default test data. This action cannot be undone."}),o.jsxs("div",{className:"flex justify-end gap-3",children:[o.jsx("button",{onClick:()=>d(!1),type:"button",className:"px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50 cursor-pointer transition-colors",children:"Cancel"}),o.jsx("button",{onClick:_,type:"button",className:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 cursor-pointer transition-colors",children:"Reset All Data"})]})]})})]})}function Br({nodes:e,edges:s,width:t=1200,height:n=800}){const r=b.useRef(null),[i,l]=b.useState(null),[a,u]=b.useState(null);return b.useEffect(()=>{var ie,_e;if(!r.current||s.length===0||e.length===0){r.current&&he(r.current).selectAll("*").remove();return}he(r.current).selectAll("*").remove();const c=new Map;e.forEach(j=>{c.set(j.id,{id:j.id,label:j.label||j.id,outgoing:0,incoming:0})}),s.forEach(j=>{const k=c.get(j.source),ge=c.get(j.target);k&&(k.outgoing+=j.value),ge&&(ge.incoming+=j.value)});const d=Array.from(c.values()).filter(j=>j.outgoing>0||j.incoming>0);if(d.length===0){he(r.current).append("text").attr("x",t/2).attr("y",n/2).attr("text-anchor","middle").attr("font-size","14px").attr("fill","#666").text("No active nodes with flows");return}d.sort((j,k)=>k.outgoing+k.incoming-(j.outgoing+j.incoming));const p=50,f=t-50,g=20,w=15,S=2,y=5,h=d.reduce((j,k)=>j+k.outgoing,0),v=d.reduce((j,k)=>j+k.incoming,0),x=Math.max(n-2*g,400);let _=g;d.forEach(j=>{const k=h>0?Math.max(y,j.outgoing/h*x):Math.max(y,x/d.length);_+=k+S});let N=g;d.forEach(j=>{const k=v>0?Math.max(y,j.incoming/v*x):Math.max(y,x/d.length);N+=k+S});const C=Math.max(n,Math.max(_,N)+100),V=C-2*g,I=he(r.current).attr("width",t).attr("height",C).style("font","12px sans-serif");let E=g;const q=d.map((j,k)=>{const ge=h>0?Math.max(y,j.outgoing/h*V):Math.max(y,V/d.length),Ce=E;return E+=ge+S,{node:j,x:p,y:Ce,height:Math.max(y,ge-S),side:"left",index:k}});E=g;const D=d.map((j,k)=>{const ge=v>0?Math.max(y,j.incoming/v*V):Math.max(y,V/d.length),Ce=E;return E+=ge+S,{node:j,x:f,y:Ce,height:Math.max(y,ge-S),side:"right",index:k}});let W=[];i&&a&&(a==="left"?W=s.filter(j=>j.source===i&&j.source!==j.target):W=s.filter(j=>j.target===i&&j.source!==j.target));const M=as(cs);if(W.length>0){const j=W.map(z=>{const fe=q.find(je=>je.node.id===z.source),K=D.find(je=>je.node.id===z.target);if(!fe||!K)return null;const B=fe.y+fe.height/2,be=K.y+K.height/2;return{edge:z,sourceX:fe.x+w,sourceY:B,targetX:K.x,targetY:be,value:z.value,leftIndex:fe.index,rightIndex:K.index}}).filter(z=>z!==null),k=Math.max(...j.map(z=>z.value),1),ge=2,Ce=20,De=I.append("g").attr("class","links");j.forEach(z=>{const fe=ge+z.value/k*(Ce-ge),K=`gradient-${z.leftIndex}-${z.rightIndex}`,B=I.append("defs").append("linearGradient").attr("id",K).attr("gradientUnits","userSpaceOnUse").attr("x1",z.sourceX).attr("x2",z.targetX).attr("y1",z.sourceY).attr("y2",z.targetY);B.append("stop").attr("offset","0%").attr("stop-color",M(String(z.leftIndex))).attr("stop-opacity",.6),B.append("stop").attr("offset","100%").attr("stop-color",M(String(z.rightIndex))).attr("stop-opacity",.6);const be=Rn(),je=(z.sourceX+z.targetX)/2;be.moveTo(z.sourceX,z.sourceY),be.bezierCurveTo(je,z.sourceY,je,z.targetY,z.targetX,z.targetY),De.append("path").attr("d",be.toString()).attr("stroke",`url(#${K})`).attr("stroke-width",fe).attr("fill","none").attr("stroke-opacity",.6).style("cursor","pointer").on("mouseover",function($e){he(this).attr("stroke-opacity",1).attr("stroke-width",fe+2),he("body").append("div").attr("class","tooltip").style("position","absolute").style("background","rgba(0, 0, 0, 0.8)").style("color","white").style("padding","8px").style("border-radius","4px").style("pointer-events","none").style("opacity",0).html(`${z.edge.source} → ${z.edge.target}<br/>${z.value.toLocaleString()}`).style("opacity",1)}).on("mousemove",function($e){he(".tooltip").style("left",`${$e.pageX+10}px`).style("top",`${$e.pageY-10}px`)}).on("mouseout",function(){he(this).attr("stroke-opacity",.6).attr("stroke-width",fe),he(".tooltip").remove()})})}const X=I.append("g").attr("class","left-nodes").selectAll("g.node").data(q).join("g").attr("class","node").attr("transform",j=>`translate(${j.x}, ${j.y})`).style("cursor","pointer").on("click",function(j,k){j.stopPropagation(),i===k.node.id&&a==="left"?(l(null),u(null)):(l(k.node.id),u("left"))});X.append("rect").attr("width",w).attr("height",j=>j.height).attr("fill",(j,k)=>M(String(k))).attr("stroke",(j,k)=>xt(M(String(k))).darker().formatHex()).attr("stroke-width",j=>i===j.node.id&&a==="left"?3:1).attr("opacity",j=>i&&a==="left"&&i!==j.node.id?.3:1).on("mouseover",function(j,k){he(this).attr("fill",xt(M(String(k.index))).brighter(.5).formatHex())}).on("mouseout",function(j,k){he(this).attr("fill",M(String(k.index)))}),X.append("text").attr("x",w+6).attr("y",j=>j.height/2).attr("dy","0.35em").attr("text-anchor","start").text(j=>`${j.node.label} (${j.node.outgoing.toLocaleString()})`).style("font-size","11px").style("font-weight","500").style("fill","#333").attr("opacity",j=>i&&a==="left"&&i!==j.node.id?.3:1);const le=I.append("g").attr("class","right-nodes").selectAll("g.node").data(D).join("g").attr("class","node").attr("transform",j=>`translate(${j.x}, ${j.y})`).style("cursor","pointer").on("click",function(j,k){j.stopPropagation(),i===k.node.id&&a==="right"?(l(null),u(null)):(l(k.node.id),u("right"))});le.append("rect").attr("x",-w).attr("width",w).attr("height",j=>j.height).attr("fill",(j,k)=>M(String(k))).attr("stroke",(j,k)=>xt(M(String(k))).darker().formatHex()).attr("stroke-width",j=>i===j.node.id&&a==="right"?3:1).attr("opacity",j=>i&&a==="right"&&i!==j.node.id?.3:1).on("mouseover",function(j,k){he(this).attr("fill",xt(M(String(k.index))).brighter(.5).formatHex())}).on("mouseout",function(j,k){he(this).attr("fill",M(String(k.index)))}),le.append("text").attr("x",-w-6).attr("y",j=>j.height/2).attr("dy","0.35em").attr("text-anchor","end").text(j=>`${j.node.label} (${j.node.incoming.toLocaleString()})`).style("font-size","11px").style("font-weight","500").style("fill","#333").attr("opacity",j=>i&&a==="right"&&i!==j.node.id?.3:1),i?I.append("text").attr("x",t/2).attr("y",20).attr("text-anchor","middle").attr("font-size","14px").attr("fill","#333").text(a==="left"?`Showing outgoing flows from ${(ie=q.find(j=>j.node.id===i))==null?void 0:ie.node.label}`:`Showing incoming flows to ${(_e=D.find(j=>j.node.id===i))==null?void 0:_e.node.label}`):I.append("text").attr("x",t/2).attr("y",20).attr("text-anchor","middle").attr("font-size","14px").attr("fill","#666").text("Click a node to see its connections"),I.append("text").attr("x",p+w/2).attr("y",C-10).attr("text-anchor","middle").attr("font-size","12px").attr("font-weight","bold").attr("fill","#333").text("Outgoing"),I.append("text").attr("x",f-w/2).attr("y",C-10).attr("text-anchor","middle").attr("font-size","12px").attr("font-weight","bold").attr("fill","#333").text("Incoming"),I.on("click",function(j){(j.target===r.current||j.target.tagName==="svg")&&(l(null),u(null))})},[e,s,t,n,i,a]),o.jsxs("div",{className:"w-full h-full flex flex-col min-h-0",children:[o.jsxs("div",{className:"text-center text-xs text-gray-500 mb-2 flex-shrink-0",children:["Interaction design inspired by"," ",o.jsx("a",{href:"https://peoplemov.in/#f_AF",target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-800 underline",children:"peoplemov.in by Carlo Zapponi"})]}),o.jsx("div",{className:"flex-1 overflow-auto min-h-0",children:o.jsx("svg",{ref:r,className:"border border-gray-200 rounded bg-white"})})]})}function qr(e,s){const t=e.length,n=new Map;e.forEach((l,a)=>{n.set(l.id,a)});const r=Array(t).fill(null).map(()=>Array(t).fill(0));s.forEach(l=>{const a=n.get(l.source),u=n.get(l.target);a!==void 0&&u!==void 0&&(r[a][u]+=l.value)});const i=e.map(l=>l.label||l.id);return{matrix:r,labels:i,nodes:e}}function Kr(e,s,t){return!t||t==="all"?e:e.filter(n=>{const r=n[s];return Array.isArray(r)?r.includes(t):r===t})}function Wr(e,s){const t=new Set;return e.forEach(n=>{const r=n[s];r!=null&&(Array.isArray(r)?r.forEach(i=>t.add(i)):t.add(r))}),Array.from(t).sort((n,r)=>typeof n=="number"&&typeof r=="number"?n-r:String(n).localeCompare(String(r)))}function Yr({nodes:e,edges:s,width:t=1e3,height:n=800}){const r=b.useRef(null);return b.useEffect(()=>{if(!r.current||s.length===0||e.length===0){r.current&&he(r.current).selectAll("*").remove();return}he(r.current).selectAll("*").remove();const i=qr(e,s),l=he(r.current).attr("width","100%").attr("height","100%").attr("viewBox",`0 0 ${t} ${n}`).attr("preserveAspectRatio","xMidYMid meet"),a=Math.min(t,n)*.5-40,u=a-20,c=Is().scaleExtent([.1,4]).on("zoom",function(v){S.attr("transform",v.transform.toString())});l.call(c);const d=l.append("g").attr("class","reset-button").style("cursor","pointer").attr("transform",`translate(${t-120}, 10)`).on("click",function(){l.transition().duration(750).call(c.transform,Es)});d.append("rect").attr("width",110).attr("height",30).attr("rx",4).attr("fill","white").attr("stroke","#ccc").attr("stroke-width",1),d.append("text").attr("x",55).attr("y",20).attr("text-anchor","middle").attr("font-size","12px").attr("fill","#333").text("Reset View");const f=Qs().padAngle(.05).sortSubgroups(Xs)(i.matrix),g=uo().radius(u),w=as(cs),S=l.append("g").attr("class","zoom-group"),y=S.append("g").attr("transform",`translate(${t/2}, ${n/2})`),h=y.append("g").selectAll("g").data(f.groups).join("g");h.append("path").attr("fill",v=>w(String(v.index))).attr("stroke",v=>xt(w(String(v.index))).darker().formatHex()).attr("d",So().innerRadius(u).outerRadius(a)).on("mouseover",function(v,x){he(this).attr("fill",xt(w(String(x.index))).brighter(1).formatHex()),y.selectAll("path.chord").style("opacity",_=>_.source.index===x.index||_.target.index===x.index?1:.2)}).on("mouseout",function(){he(this).attr("fill",v=>w(String(v.index))),y.selectAll("path.chord").style("opacity",1)}),h.append("text").attr("dy",".35em").attr("transform",v=>`
        rotate(${(v.startAngle+v.endAngle)/2*180/Math.PI-90})
        translate(${a+10})
        ${(v.startAngle+v.endAngle)/2>Math.PI?"rotate(180)":""}
      `).attr("text-anchor",v=>(v.startAngle+v.endAngle)/2>Math.PI?"end":"start").text(v=>i.labels[v.index]).style("font-size","12px").style("font-weight","500"),y.append("g").attr("fill-opacity",.67).selectAll("path").data(f).join("path").attr("class","chord").attr("d",v=>g(v)??"").attr("fill",v=>w(String(v.source.index))).attr("stroke",v=>xt(w(String(v.source.index))).darker().formatHex()).style("stroke-width","1px").on("mouseover",function(v,x){he(this).attr("fill-opacity",1).style("stroke-width","2px"),he("body").append("div").attr("class","tooltip").style("position","absolute").style("background","rgba(0, 0, 0, 0.8)").style("color","white").style("padding","8px").style("border-radius","4px").style("pointer-events","none").style("opacity",0).style("transition","opacity 0.2s").html(`${i.labels[x.source.index]} → ${i.labels[x.target.index]}: ${x.source.value.toLocaleString()}`).style("opacity",1)}).on("mousemove",function(v){he(".tooltip").style("left",`${v.pageX+10}px`).style("top",`${v.pageY-10}px`)}).on("mouseout",function(){he(this).attr("fill-opacity",.67).style("stroke-width","1px"),he(".tooltip").remove()})},[e,s,t,n]),o.jsx("div",{className:"w-full h-full",children:o.jsx("svg",{ref:r,className:"border border-gray-200 rounded bg-white"})})}const Xr=200,Zr=600,Qr=384,os=4;function Jr({isCollapsed:e,onToggle:s,onResize:t,children:n,title:r="Settings",bottomContent:i}){const[l,a]=b.useState(Qr),[u,c]=b.useState(!1),d=b.useRef(null),p=b.useRef(null);return b.useEffect(()=>{if(!u)return;const f=w=>{var S;if(!e&&((S=d.current)==null?void 0:S.getBoundingClientRect())){const h=Math.max(Xr,Math.min(Zr,window.innerWidth-w.clientX));a(h),t==null||t(h)}},g=()=>{c(!1)};return document.addEventListener("mousemove",f),document.addEventListener("mouseup",g),()=>{document.removeEventListener("mousemove",f),document.removeEventListener("mouseup",g)}},[u,e,t]),o.jsxs("div",{ref:d,className:"bg-white border-l border-gray-200 flex flex-col transition-all duration-300  overflow-hidden relative",style:{minHeight:"100vh",width:e?`${os}px`:`${l}px`},children:[e&&o.jsxs(o.Fragment,{children:[o.jsx("div",{onClick:s,className:"w-full h-full bg-gray-100 hover:bg-blue-400 cursor-pointer transition-colors",style:{width:`${os}px`},title:"Click to expand settings"}),o.jsx("button",{onClick:s,className:"fixed bottom-4 right-4 z-50 p-3 bg-blue-600 hover:bg-blue-700 text-white rounded-full shadow-lg cursor-pointer transition-all hover:scale-110 flex items-center justify-center",style:{width:"48px",height:"48px"},title:"Open visualization settings","aria-label":"Open visualization settings",children:o.jsx(Hn,{className:"w-5 h-5"})})]}),!e&&o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:n}),i&&o.jsx("div",{className:"flex-shrink-0 border-t border-gray-200 bg-white",children:i}),o.jsxs("button",{onClick:s,className:"w-full flex items-center justify-between p-2 border-t border-gray-200 flex-shrink-0 bg-gray-50 hover:bg-gray-100 transition-colors cursor-pointer","aria-label":"Collapse settings",children:[o.jsxs("div",{className:"flex items-center gap-2 flex-1",children:[o.jsx(Hn,{className:"w-4 h-4 text-gray-600"}),o.jsx("span",{className:"text-sm font-medium text-gray-700",children:r})]}),o.jsx(Ps,{className:"w-4 h-4 text-gray-600 flex-shrink-0"})]}),o.jsx("div",{ref:p,onMouseDown:f=>{f.preventDefault(),c(!0)},className:"absolute top-0 left-0 w-1 h-full cursor-col-resize hover:bg-blue-400 bg-gray-300 transition-colors z-10",style:{touchAction:"none"},children:o.jsx("div",{className:"absolute top-1/2 left-0 transform -translate-y-1/2 -translate-x-0.5",children:o.jsx(As,{className:"w-3 h-6 text-gray-500"})})})]})]})}const _s=["Alabama","Alaska","Arizona","Arkansas","California","Colorado","Connecticut","Delaware","District of Columbia","Florida","Georgia","Hawaii","Idaho","Illinois","Indiana","Iowa","Kansas","Kentucky","Louisiana","Maine","Maryland","Massachusetts","Michigan","Minnesota","Mississippi","Missouri","Montana","Nebraska","Nevada","New Hampshire","New Jersey","New Mexico","New York","North Carolina","North Dakota","Ohio","Oklahoma","Oregon","Pennsylvania","Rhode Island","South Carolina","South Dakota","Tennessee","Texas","Utah","Vermont","Virginia","Washington","West Virginia","Wisconsin","Wyoming"],ei=new Set(_s),ti=_s.length,rs=Us.reduce((e,s)=>(e[s]=s===2020?"ACS 1-year state-to-state migration flows for 2020 were not released by the Census Bureau due to pandemic-related data quality concerns.":"State-to-state migration data is unavailable for this year in the ACS 1-year series.",e),{});function Ct({title:e,subtitle:s,children:t,defaultOpen:n=!1,onReset:r}){const[i,l]=b.useState(n);return o.jsxs("div",{className:"border border-gray-200 rounded-md",children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("button",{onClick:()=>l(!i),className:"flex-1 flex items-center justify-between p-3 hover:bg-gray-50 transition-colors text-left",children:[o.jsxs("div",{className:"flex-1",children:[o.jsx("div",{className:"font-semibold text-sm",children:e}),s&&o.jsx("div",{className:"text-xs text-gray-600 mt-0.5",children:s})]}),i?o.jsx(Ws,{className:"w-4 h-4 text-gray-600 flex-shrink-0"}):o.jsx(qs,{className:"w-4 h-4 text-gray-600 flex-shrink-0"})]}),r&&o.jsx("button",{type:"button",onClick:a=>{a.stopPropagation(),r()},className:"pr-3 text-[11px] font-medium text-blue-600 hover:text-blue-800 transition-colors",children:"Reset"})]}),i&&o.jsx("div",{className:"p-3 pt-0 border-t border-gray-200",children:t})]})}const is=Ls(["kriskogram","table","sankey","chord"]),Ot=e=>{const s=e!==void 0?Ln().default(e):Ln().optional();return Gt(t=>{if(t==null||t==="")return e;const n=typeof t=="string"?parseFloat(t):Number(t);return Number.isNaN(n)?e:n},s)},ni=e=>Gt(s=>{if(typeof s=="boolean")return s;if(typeof s=="string"){if(s.toLowerCase()==="true")return!0;if(s.toLowerCase()==="false")return!1}return e},Hs().default(e));zs({dataset:Tn().optional(),view:Gt(e=>typeof e=="string"&&is.safeParse(e).success?e:"kriskogram",is.default("kriskogram")),year:Ot(void 0),minThreshold:Ot(0),maxThreshold:Ot(2e5),maxEdges:Ot(500),edgeType:Gt(e=>e==="null"||e===""?null:typeof e=="string"?e:void 0,Tn().nullable().optional()),showAllNodes:ni(!1)});function ui(){const e=Vs({from:"/explorer"}),s=Ds(),{leftSidebarCollapsed:t,leftSidebarWidth:n,setSidebarContent:r}=ks(),[i,l]=b.useState(e.dataset),[a,u]=b.useState(void 0),[c,d]=b.useState(e.year),[p,f]=b.useState(!1),[g,w]=b.useState(null),[S,y]=b.useState(0),[h,v]=b.useState(e.minThreshold??0),[x,_]=b.useState(e.maxThreshold??2e5),[N,C]=b.useState(e.maxEdges??500),[V,I]=b.useState(e.edgeType??null),[E,q]=b.useState(e.view),[D,W]=b.useState(e.showAllNodes??!1),M=b.useRef(null),[L,X]=b.useState(!1),[ee,le]=b.useState(384),[ie,_e]=b.useState({width:typeof window<"u"?window.innerWidth:1200,height:typeof window<"u"?window.innerHeight:800});b.useEffect(()=>(r(o.jsx(st,{fallback:o.jsxs("div",{className:"p-4",children:[o.jsx("h2",{className:"text-lg font-bold text-red-800 mb-2",children:"Dataset Sidebar Error"}),o.jsx("p",{className:"text-sm text-red-700",children:"The dataset sidebar encountered an error."})]}),children:o.jsx(Ur,{selectedId:i,onSelect:m=>{l(m),we({dataset:m})},onRefresh:()=>y(m=>m+1)})})),()=>{r(null)}),[i,S]),b.useEffect(()=>{if(typeof window>"u")return;const m=()=>{_e({width:window.innerWidth,height:window.innerHeight})};return m(),window.addEventListener("resize",m),()=>window.removeEventListener("resize",m)},[]),b.useEffect(()=>{typeof window<"u"&&setTimeout(()=>{_e({width:window.innerWidth,height:window.innerHeight})},100)},[t,L,n,ee]);const[j,k]=b.useState("alphabetical"),[ge,Ce]=b.useState(.85),[De,z]=b.useState("weight"),[fe,K]=b.useState(!1),[B,be]=b.useState("direction"),[je,$e]=b.useState(null),[Te,lt]=b.useState("weight"),[ut,vt]=b.useState(null),[Nt,R]=b.useState(.6),[F,H]=b.useState(!0),[Q,Y]=b.useState("none"),[te,ae]=b.useState(2),[Ke,Je]=b.useState("single"),[Oe,xe]=b.useState(null),[se,In]=b.useState("fixed"),[Et,En]=b.useState(null),[et,Pt]=b.useState("pan"),[At,qt]=b.useState(80),[Pn,An]=b.useState({x:0,y:0}),we=b.useMemo(()=>m=>{s({to:"/explorer",search:$=>({view:$.view??"kriskogram",...$,...m}),replace:!0})},[s]),Cs=b.useMemo(()=>a&&a.timeRange.start!==a.timeRange.end,[a]),dt=b.useRef(!0);b.useEffect(()=>{Xo().catch(()=>{}),si().then(m=>{const $=e.dataset||m;$&&(l($),!e.dataset&&dt.current&&we({dataset:$})),dt.current=!1}).catch(m=>w(m instanceof Error?m.message:"Failed to preload datasets"))},[]),b.useEffect(()=>{if(!i){u(void 0);return}f(!0),w(null),rt(i).then(m=>{u(m),m&&(d(m.timeRange.start),v(0),C(500))}).catch(m=>w(m instanceof Error?m.message:"Failed to load dataset")).finally(()=>f(!1))},[i,S]);const Ne=b.useMemo(()=>{if(!(!a||c===void 0))return a.snapshots.find(m=>(typeof m.timestamp=="string"?parseInt(m.timestamp,10):m.timestamp)===c)},[a,c]),Re=b.useMemo(()=>{if(!a)return null;let m=1/0,$=-1/0,A=0;return a.snapshots.forEach(Z=>{const oe=Array.isArray(Z==null?void 0:Z.edges)?Z.edges:[];oe.length>A&&(A=oe.length),oe.forEach(me=>{const Me=Number(me==null?void 0:me.value);Number.isFinite(Me)&&(Me<m&&(m=Me),Me>$&&($=Me))})}),m===1/0||$===-1/0?{min:0,max:0,maxEdgesCount:A}:{min:m,max:$,maxEdgesCount:A}},[a]),yt=b.useMemo(()=>{if(!a)return null;let m=1/0,$=-1/0;return a.snapshots.forEach(A=>{const Z=new Map,oe=new Map;(Array.isArray(A==null?void 0:A.edges)?A.edges:[]).forEach(de=>{const Se=oe.get(de.source)||0;oe.set(de.source,Se+de.value);const Ie=Z.get(de.target)||0;Z.set(de.target,Ie+de.value)}),(Array.isArray(A==null?void 0:A.nodes)?A.nodes:[]).forEach(de=>{const Se=(Z.get(de.id)||0)-(oe.get(de.id)||0);Se<m&&(m=Se),Se>$&&($=Se)})}),m===1/0||$===-1/0?{min:0,max:0}:{min:m,max:$}},[a]),bt=b.useMemo(()=>{if(!a)return null;let m=0,$=0;return a.snapshots.forEach(A=>{const Z=new Map,oe=new Map;(Array.isArray(A==null?void 0:A.edges)?A.edges:[]).forEach(de=>{const Se=oe.get(de.source)||0;oe.set(de.source,Se+de.value);const Ie=Z.get(de.target)||0;Z.set(de.target,Ie+de.value)}),(Array.isArray(A==null?void 0:A.nodes)?A.nodes:[]).forEach(de=>{const Se=Z.get(de.id)||0,Ie=oe.get(de.id)||0;Se>m&&(m=Se),Ie>$&&($=Ie)})}),{maxIncoming:m,maxOutgoing:$}},[a]);b.useEffect(()=>{if(!Re)return;const{min:m,max:$,maxEdgesCount:A}=Re;if(!Number.isFinite(m)||!Number.isFinite($))return;const Z=(Se,Ie,U)=>U<Ie||!Number.isFinite(Se)||Se<Ie?Ie:Se>U?U:Se,oe=Z(h,m,$);let me=Z(x,m,$);me<oe&&(me=oe);const Me=Math.max(1,A),de=Math.max(1,Math.min(N,Me));oe!==h&&v(oe),me!==x&&_(me),de!==N&&C(de)},[Re,h,x,N]);const ct=b.useMemo(()=>{if(!Ne||!(a!=null&&a.metadata))return null;const $=["migration_type","type","category","edge_type"].find(Z=>{var oe,me;return((oe=a.metadata)==null?void 0:oe.edgeProperties.includes(Z))||((me=a.metadata)==null?void 0:me.hasCategoricalProperties.edges.includes(Z))});if(!$)return null;const A=Wr(Ne.edges,$);return{property:$,values:A.map(Z=>String(Z))}},[Ne,a]);b.useEffect(()=>{I(null)},[i]);const T=b.useMemo(()=>{if(!Ne)return{nodes:[],edges:[]};const m=new Map,$=new Map;Ne.edges.forEach(U=>{const ue=$.get(U.source)||0;$.set(U.source,ue+U.value);const ce=m.get(U.target)||0;m.set(U.target,ce+U.value)});let A=Kr(Ne.edges,(ct==null?void 0:ct.property)||"",V);if(Q!=="none"){const U=new Map(Ne.nodes.map(ue=>[ue.id,ue]));Q==="region"?A=A.filter(ue=>{const ce=U.get(ue.source),ve=U.get(ue.target);return ce&&ve&&ce.region&&ve.region&&ce.region===ve.region}):Q==="division"?A=A.filter(ue=>{const ce=U.get(ue.source),ve=U.get(ue.target);return ce&&ve&&ce.division&&ve.division&&ce.division===ve.division}):Q==="interRegion"?A=A.filter(ue=>{const ce=U.get(ue.source),ve=U.get(ue.target);return ce&&ve&&ce.region&&ve.region&&ce.region!==ve.region}):Q==="interDivision"&&(A=A.filter(ue=>{const ce=U.get(ue.source),ve=U.get(ue.target);return ce&&ve&&ce.division&&ve.division&&ce.division!==ve.division}))}const Z=A.filter(U=>U.value>=h&&U.value<=x).sort((U,ue)=>ue.value-U.value).slice(0,N),oe=new Set;Z.forEach(U=>{oe.add(U.source),oe.add(U.target)});const me=new Map,Me=new Map;return Z.forEach(U=>{const ue=Me.get(U.source)||0;Me.set(U.source,ue+U.value);const ce=me.get(U.target)||0;me.set(U.target,ce+U.value)}),{nodes:(E==="kriskogram"&&D?Ne.nodes:Ne.nodes.filter(U=>oe.has(U.id))).map(U=>{const ue=me.get(U.id)||0,ce=Me.get(U.id)||0,ve=m.get(U.id)||0,St=$.get(U.id)||0,Zt=ue-ce,Qt=ve-St;return{...U,_totalIncoming:ue,_totalOutgoing:ce,total_incoming_visible:ue,total_outgoing_visible:ce,total_incoming_year:ve,total_outgoing_year:St,net_flow_visible:Zt,net_flow_year:Qt}}),edges:Z}},[Ne,h,x,N,V,ct,Q,D,E]),Ge=b.useMemo(()=>{if(!Ne)return null;const m=Ne.edges.length,$=Ne.nodes.length,A=Ne.edges.reduce((me,Me)=>me+Me.value,0),Z=m>0?A/m:0,oe=m>0?Math.max(...Ne.edges.map(me=>me.value)):0;return{totalNodes:$,totalEdges:m,visibleNodes:T.nodes.length,visibleEdges:T.edges.length,avgValue:Z,maxValue:oe}},[Ne,T]),We=(Re==null?void 0:Re.min)??0,Rt=(Re==null?void 0:Re.max)??(Ge==null?void 0:Ge.maxValue)??We,wt=Math.max(We,Rt),js=Math.max(wt,1),Vn=Math.max(1,Math.floor(js/1e3)),Kt=(Re==null?void 0:Re.maxEdgesCount)??(Ge==null?void 0:Ge.totalEdges)??0,Wt=Math.max(500,Kt),Yt=b.useMemo(()=>{if(!(!T||T.edges.length===0))return Math.min(...T.edges.map(m=>m.value))},[T]),gt=b.useMemo(()=>T.nodes.some(m=>m&&m.region),[T]),ft=b.useMemo(()=>T.nodes.some(m=>m&&m.division),[T]);b.useEffect(()=>{!gt&&B==="region"&&be("direction"),!ft&&B==="division"&&be("direction")},[gt,ft,B]);const Xt=b.useMemo(()=>{if(!(!T||T.edges.length===0))return Math.max(...T.edges.map(m=>m.value))},[T]);b.useEffect(()=>{E==="kriskogram"&&T.nodes.length>0&&M.current&&M.current.updateData(T.nodes,T.edges)},[T,E]);const Ns=m=>{d(m),dt.current||we({year:m})};return b.useEffect(()=>{dt.current||we({minThreshold:h,maxThreshold:x,maxEdges:N})},[h,x,N]),b.useEffect(()=>{dt.current||we({view:E})},[E]),b.useEffect(()=>{dt.current||we({edgeType:V})},[V]),b.useEffect(()=>{!dt.current&&i&&we({dataset:i})},[i]),o.jsx(st,{fallback:o.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center",children:o.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-8 max-w-lg mx-4",children:[o.jsx("h2",{className:"text-2xl font-bold text-red-800 mb-4",children:"Explorer Error"}),o.jsx("p",{className:"text-gray-700 mb-4",children:"The explorer page encountered an error. Please refresh the page."}),o.jsx("button",{onClick:()=>window.location.reload(),className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 cursor-pointer transition-colors",children:"Reload Page"})]})}),children:o.jsxs("div",{className:"flex flex-1 h-full overflow-hidden",children:[o.jsxs("main",{className:"flex-1 flex flex-col overflow-hidden h-full relative",children:[p&&o.jsx("div",{className:"p-4 bg-yellow-50 text-yellow-800",children:"Loading…"}),g&&o.jsx("div",{className:"p-4 bg-red-50 text-red-600",children:g}),a?o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"flex-1 flex flex-col overflow-hidden bg-white",children:o.jsx("div",{className:`flex-1 overflow-hidden ${E==="table"?"":"p-4"}`,children:T.nodes.length>0&&T.edges.length>0?o.jsxs(o.Fragment,{children:[E==="kriskogram"&&o.jsx(st,{fallback:o.jsxs("div",{className:"p-4 bg-red-50 border border-red-200 rounded-md",children:[o.jsx("h3",{className:"text-lg font-semibold text-red-800 mb-2",children:"Kriskogram Error"}),o.jsx("p",{className:"text-sm text-red-700",children:"The Kriskogram visualization encountered an error."})]}),children:o.jsx("div",{className:"w-full h-full",children:o.jsx(Ts,{ref:M,nodes:T.nodes,edges:T.edges,width:Math.max(800,ie.width-(t?64:n)-(L?4:ee)-40),height:Math.max(600,ie.height-80),margin:{top:60,right:40,bottom:60,left:40},arcOpacity:ge,title:a.name,accessors:(()=>{const m=T.edges.map(P=>P.value),$=m.length>0?Math.min(...m):0,A=m.length>0?Math.max(...m):1,Z=(Re==null?void 0:Re.min)??$,me=((Re==null?void 0:Re.max)??A)-Z||1,Me=P=>{if(!Number.isFinite(P))return 0;const ye=(P-Z)/me;return Number.isFinite(ye)?Math.max(0,Math.min(1,ye)):0},de=T.nodes.map(P=>P.total_outgoing_visible||P._totalOutgoing||0),Se=T.nodes.map(P=>P.total_incoming_visible||P._totalIncoming||0),Ie=T.nodes.map(P=>P.total_outgoing_year||0),U=T.nodes.map(P=>P.total_incoming_year||0),ue=T.nodes.map(P=>P.net_flow_visible||0),ce=T.nodes.map(P=>P.net_flow_year||0),ve=de.length>0?Math.max(...de):1,St=Se.length>0?Math.max(...Se):1,Zt=Ie.length>0?Math.max(...Ie):1,Qt=U.length>0?Math.max(...U):1,Dn=ue.length>0?Math.max(...ue.map(P=>Math.abs(P))):1,kn=ce.length>0?Math.max(...ce.map(P=>Math.abs(P))):1,Jt=(bt==null?void 0:bt.maxOutgoing)??Zt,en=(bt==null?void 0:bt.maxIncoming)??Qt,Rs=(yt==null?void 0:yt.min)??-kn,Ms=(yt==null?void 0:yt.max)??kn,Vt=Math.max(Math.abs(Rs),Math.abs(Ms))||1,Fs=(P,ye,Ue)=>{const Be=Array.from(new Set(T.nodes.map(J=>J[P]).filter(J=>J!=null))),Ee=new Map;return Be.forEach((J,Pe)=>{Ee.set(J,Ue[Pe%Ue.length])}),Ee.get(ye)||Ue[0]},$s=["#3b82f6","#f59e0b","#ef4444","#10b981","#8b5cf6","#ec4899","#14b8a6","#f97316"];return{nodeOrder:P=>{if(j==="alphabetical")return P.label||P.id;const ye=P[j];return ye==null?`ZZZ_${P.label||P.id}`:typeof ye=="number"?`${String(1e6-ye).padStart(10,"0")}_${P.label||P.id}`:`${String(ye)}_${P.label||P.id}`},nodeColor:P=>{var Ee;const ye=(J,Pe)=>!Number.isFinite(J)||Pe<=0?0:Math.max(0,Math.min(1,J/Pe)),Ue=(J,Pe,Fe)=>{const ne=85-Math.max(0,Math.min(1,Fe))*45;return`hsl(${J}, ${Pe}%, ${ne}%)`},Be=J=>{if(!Number.isFinite(J)||Vt<=0)return"#6b7280";if(Math.abs(J)<1e-6)return"#9ca3af";const Fe=85-Math.max(0,Math.min(1,Math.abs(J)/Vt))*45;return J>=0?`hsl(0, 75%, ${Fe}%)`:`hsl(210, 75%, ${Fe}%)`};switch(Ke){case"single":return"#2563eb";case"outgoing":case"visible_outgoing":{const J=ye(P.total_outgoing_visible||P._totalOutgoing||0,ve);return Ue(24,85,J)}case"incoming":case"visible_incoming":{const J=ye(P.total_incoming_visible||P._totalIncoming||0,St);return Ue(160,70,J)}case"year_outgoing":{const J=ye(P.total_outgoing_year||0,Jt);return Ue(24,85,J)}case"year_incoming":{const J=ye(P.total_incoming_year||0,en);return Ue(160,70,J)}case"net_year":return Be(P.net_flow_year||0);case"attribute":{if(!Oe)return"#2563eb";const J=P[Oe];if(J==null)return"#9ca3af";if((Ee=a==null?void 0:a.metadata)!=null&&Ee.hasNumericProperties.nodes.includes(Oe)){const Pe=T.nodes.map(re=>re[Oe]).filter(re=>typeof re=="number");if(Pe.length===0)return"#2563eb";const Fe=Math.min(...Pe),ne=Math.max(...Pe)-Fe||1,pe=(Number(J)-Fe)/ne;return`hsl(${120-Math.max(0,Math.min(1,pe))*120}, 70%, 50%)`}return Fs(Oe,J,$s)}default:return"#2563eb"}},nodeRadius:P=>{const ye=P.total_outgoing_visible||P._totalOutgoing||0,Ue=P.total_incoming_visible||P._totalIncoming||0,Be=P.total_outgoing_year||0,Ee=P.total_incoming_year||0,J=Math.abs(P.net_flow_visible||0),Pe=Math.abs(P.net_flow_year||0),Fe=Le=>3+Math.max(0,Math.min(1,Le))*9;if(se==="fixed")return 6;if(se==="visible_outgoing"||se==="outgoing")return Fe(ve>0?ye/ve:0);if(se==="visible_incoming"||se==="incoming")return Fe(St>0?Ue/St:0);if(se==="year_outgoing")return Fe(Jt>0?Be/Jt:0);if(se==="year_incoming")return Fe(en>0?Ee/en:0);if(se==="net_visible"){const Le=Dn>0?Dn:1;return Fe(J/Le)}if(se==="net_year"){const Le=Vt>0?Vt:1;return Fe(Pe/Le)}if(se==="attribute"&&Et){const Le=P[Et];if(typeof Le!="number")return 6;const ne=T.nodes.map(tt=>tt[Et]).filter(tt=>typeof tt=="number");if(ne.length===0)return 6;const pe=Math.min(...ne),re=Math.max(...ne)-pe||1,Ye=(Le-pe)/re;return Fe(Ye)}return 6},edgeWidth:P=>De==="weight"?.5+Me(P.value)*15:te,edgeColor:(P,ye)=>{var Fe,Le;const Ue=Me(P.value),Be=["#3b82f6","#f59e0b","#ef4444","#10b981","#8b5cf6","#ec4899","#14b8a6","#f97316"];if(!fe&&B==="direction")return ye?"#1f77b4":"#d62728";let Ee="#2563eb";if(B==="direction")Ee=ye?"#1f77b4":"#d62728";else if(B==="region"){const ne=T.nodes.find(re=>re.id===P.source),pe=Array.from(new Set(T.nodes.map(re=>re.region).filter(Boolean))),ze=new Map(pe.map((re,Ye)=>[re,Be[Ye%Be.length]]));Ee=ne&&ne.region&&ze.get(ne.region)||"#2563eb"}else if(B==="division"){const ne=T.nodes.find(re=>re.id===P.source),pe=Array.from(new Set(T.nodes.map(re=>re.division).filter(Boolean))),ze=new Map(pe.map((re,Ye)=>[re,Be[Ye%Be.length]]));Ee=ne&&ne.division&&ze.get(ne.division)||"#2563eb"}else if(B==="attribute"&&je){const ne=P[je];if(ne!=null)if((Fe=a==null?void 0:a.metadata)!=null&&Fe.hasNumericProperties.edges.includes(je)){const pe=T.edges.map(tn=>tn[je]).filter(tn=>typeof tn=="number"),ze=Math.min(...pe),Ye=Math.max(...pe)-ze||1;Ee=`hsl(${120-(Number(ne)-ze)/Ye*120}, 70%, 50%)`}else{const pe=Array.from(new Set(T.edges.map(re=>re[je]).filter(re=>re!=null)));Ee=new Map(pe.map((re,Ye)=>[re,Be[Ye%Be.length]])).get(ne)||"#2563eb"}}else B==="single"&&(Ee="#2563eb");let J=.6;if(Te==="weight")J=Math.max(0,Math.min(1,Ue));else if(Te==="attribute"&&ut){const ne=P[ut];if(ne!=null&&((Le=a==null?void 0:a.metadata)!=null&&Le.hasNumericProperties.edges.includes(ut))){const pe=T.edges.map(tt=>tt[ut]).filter(tt=>typeof tt=="number"),ze=Math.min(...pe),Ye=Math.max(...pe)-ze||1;J=Math.max(0,Math.min(1,(Number(ne)-ze)/Ye))}}else Te==="constant"&&(J=Math.max(0,Math.min(1,Nt)));if(F&&(B==="region"||B==="division")){const ne=T.nodes.find(re=>re.id===P.source),pe=T.nodes.find(re=>re.id===P.target);if(!(B==="region"?(ne==null?void 0:ne.region)&&ne.region===(pe==null?void 0:pe.region):(ne==null?void 0:ne.division)&&ne.division===(pe==null?void 0:pe.division)))return`hsl(0, 0%, ${80-J*50}%)`}const Pe=80-J*55;return B==="direction"?`hsl(${ye?0:200}, 70%, ${Math.round(Pe)}%)`:B==="single"?`hsl(210, 70%, ${Math.round(Pe)}%)`:Ee}}})(),legend:(()=>{if(fe){if(B==="region"&&gt){const m=Array.from(new Set(T.nodes.map(Z=>Z.region).filter(Boolean))),$=["#3b82f6","#f59e0b","#ef4444","#10b981","#8b5cf6","#ec4899","#14b8a6","#f97316"];return{type:"categorical",title:"Regions",entries:m.slice(0,10).map((Z,oe)=>({label:Z,color:$[oe%$.length]})),interNote:F?"Inter edges: grayscale by intensity":void 0}}if(B==="division"&&ft){const m=Array.from(new Set(T.nodes.map(Z=>Z.division).filter(Boolean))),$=["#3b82f6","#f59e0b","#ef4444","#10b981","#8b5cf6","#ec4899","#14b8a6","#f97316"];return{type:"categorical",title:"Divisions",entries:m.slice(0,10).map((Z,oe)=>({label:Z,color:$[oe%$.length]})),interNote:F?"Inter edges: grayscale by intensity":void 0}}if(B==="single"&&Te==="weight")return{type:"weight",color:"#1f77b4"}}else{if(B==="direction")return{type:"direction"};if(B==="single"&&Te==="weight")return{type:"weight",color:"#1f77b4"}}})(),lens:{enabled:et==="lens",x:Pn.x,y:Pn.y,radius:At},onMouseMoveInCanvas:m=>{et==="lens"&&An(m)},onWheelInCanvas:m=>{et==="lens"&&qt($=>Math.max(20,Math.min(300,$+(m>0?-10:10))))}})})}),E==="table"&&o.jsx(st,{fallback:o.jsxs("div",{className:"p-4 bg-red-50 border border-red-200 rounded-md",children:[o.jsx("h3",{className:"text-lg font-semibold text-red-800 mb-2",children:"Table View Error"}),o.jsx("p",{className:"text-sm text-red-700",children:"The table view encountered an error."})]}),children:o.jsx("div",{className:"h-full w-full flex flex-col min-h-0",children:o.jsx(Ss,{nodes:T.nodes,edges:T.edges})})}),E==="sankey"&&o.jsx(st,{fallback:o.jsxs("div",{className:"p-4 bg-red-50 border border-red-200 rounded-md",children:[o.jsx("h3",{className:"text-lg font-semibold text-red-800 mb-2",children:"Sankey Diagram Error"}),o.jsx("p",{className:"text-sm text-red-700",children:"The Sankey diagram encountered an error."})]}),children:o.jsx("div",{className:"h-full min-h-0",children:o.jsx(Br,{nodes:T.nodes,edges:T.edges,width:Math.max(800,ie.width-(t?64:n)-(L?4:ee)-40),height:Math.max(600,ie.height-80)})})}),E==="chord"&&o.jsx(st,{fallback:o.jsxs("div",{className:"p-4 bg-red-50 border border-red-200 rounded-md",children:[o.jsx("h3",{className:"text-lg font-semibold text-red-800 mb-2",children:"Chord Diagram Error"}),o.jsx("p",{className:"text-sm text-red-700",children:"The chord diagram encountered an error."})]}),children:o.jsx(Yr,{nodes:T.nodes,edges:T.edges,width:Math.max(800,ie.width-(t?64:n)-(L?4:ee)-40),height:Math.max(600,ie.height-80)})})]}):Ne?o.jsxs("div",{className:"text-center text-gray-500 py-8",children:["No data meets the current threshold range (",h.toLocaleString()," - ",x.toLocaleString(),"). Try adjusting the filters."]}):o.jsx("div",{className:"px-6 py-8 text-center text-gray-600 space-y-3",children:typeof c=="number"&&rs[c]?o.jsxs(o.Fragment,{children:[o.jsxs("p",{className:"text-lg font-semibold text-gray-700",children:["No state-to-state migration snapshot for ",c]}),o.jsx("p",{className:"text-sm leading-relaxed",children:rs[c]})]}):o.jsx("p",{children:"No snapshot to display."})})})}),E==="kriskogram"&&o.jsxs("div",{className:"absolute bottom-4 right-4 flex items-center gap-2 bg-white/90 backdrop-blur px-3 py-2 rounded shadow border border-gray-200",children:[o.jsx("label",{className:"text-xs font-medium text-gray-700",children:"Mode:"}),o.jsx("button",{type:"button",onClick:()=>Pt("pan"),className:["text-xs px-2 py-1 rounded border",et==="pan"?"bg-blue-600 text-white border-blue-600":"bg-white text-gray-700 border-gray-300"].join(" "),children:"Pan"}),o.jsx("button",{type:"button",onClick:()=>Pt("lens"),className:["text-xs px-2 py-1 rounded border",et==="lens"?"bg-blue-600 text-white border-blue-600":"bg-white text-gray-700 border-gray-300"].join(" "),children:"Edge Lens"}),et==="lens"&&o.jsxs("span",{className:"text-[10px] text-gray-600",children:["Wheel: radius (",At,"px)"]})]})]}):o.jsx("div",{className:"flex-1 flex items-center justify-center text-gray-500",children:o.jsxs("div",{className:"text-center",children:[o.jsx("p",{className:"text-lg mb-2",children:"No dataset selected"}),o.jsx("p",{className:"text-sm",children:"Select a dataset from the sidebar to begin exploring"})]})})]}),a&&o.jsx(Jr,{isCollapsed:L,onToggle:()=>X(!L),onResize:le,title:"Visualization Settings",bottomContent:o.jsxs("div",{className:"p-3",children:[o.jsx("label",{className:"text-xs font-medium text-gray-600 block mb-2",children:"Visualization Type"}),o.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[o.jsx("button",{onClick:()=>{q("kriskogram"),we({view:"kriskogram"})},className:`px-3 py-2.5 rounded text-sm font-medium transition-colors ${E==="kriskogram"?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"Kriskogram"}),o.jsx("button",{onClick:()=>{q("table"),we({view:"table"})},className:`px-3 py-2.5 rounded text-sm font-medium transition-colors ${E==="table"?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"Table"}),o.jsx("button",{onClick:()=>{q("sankey"),we({view:"sankey"})},className:`px-3 py-2.5 rounded text-sm font-medium transition-colors ${E==="sankey"?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"Sankey"}),o.jsx("button",{onClick:()=>{q("chord"),we({view:"chord"})},className:`px-3 py-2.5 rounded text-sm font-medium transition-colors ${E==="chord"?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"Chord"})]})]}),children:o.jsxs("div",{className:"space-y-4",children:[o.jsxs(Ct,{title:a.name,defaultOpen:!0,subtitle:`${a.type.toUpperCase()} · ${a.timeRange.start}${a.timeRange.end!==a.timeRange.start?`–${a.timeRange.end}`:""}`,children:[a.notes&&o.jsx("div",{className:"text-xs text-gray-600 mt-2 whitespace-pre-wrap",children:a.notes}),!a.notes&&o.jsx("div",{className:"text-xs text-gray-500 italic mt-2",children:"No description available"})]}),Ge&&o.jsxs("div",{className:"p-3 bg-gray-50 rounded grid grid-cols-2 gap-3 text-sm",children:[o.jsxs("div",{children:[o.jsx("div",{className:"text-xs text-gray-600",children:"Nodes"}),o.jsxs("div",{className:"text-lg font-bold",children:[Ge.visibleNodes,"/",Ge.totalNodes]})]}),o.jsxs("div",{children:[o.jsx("div",{className:"text-xs text-gray-600",children:"Edges"}),o.jsxs("div",{className:"text-lg font-bold",children:[Ge.visibleEdges.toLocaleString(),"/",Ge.totalEdges.toLocaleString()]})]})]}),o.jsx(Ct,{title:"General Settings",defaultOpen:!0,onReset:()=>{const m=Math.max(1,Kt);I(null),Y("none"),v(We),_(Rt),C(m),we({edgeType:null,minThreshold:We,maxThreshold:Rt,maxEdges:m})},children:o.jsxs("div",{className:"space-y-4",children:[Cs&&c!==void 0&&o.jsxs("div",{className:"space-y-2",children:[o.jsxs("label",{className:"text-sm font-medium",children:["Year: ",c]}),o.jsx("input",{type:"range",min:a.timeRange.start,max:a.timeRange.end,value:c,onChange:m=>Ns(parseInt(m.target.value)),className:"w-full"})]}),ct&&o.jsxs("div",{className:"space-y-2",children:[o.jsxs("label",{className:"text-sm font-medium",children:["Edge Type (",ct.property,")"]}),o.jsxs("select",{value:V||"all",onChange:m=>{const $=m.target.value==="all"?null:m.target.value;I($),we({edgeType:$})},className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[o.jsx("option",{value:"all",children:"All Types"}),ct.values.map(m=>o.jsx("option",{value:m,children:m},m))]})]}),(gt||ft)&&o.jsxs("div",{className:"space-y-1",children:[o.jsx("label",{className:"text-sm font-medium",children:"Edge Scope"}),o.jsxs("select",{value:Q,onChange:m=>Y(m.target.value),className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[o.jsx("option",{value:"none",children:"All"}),gt&&o.jsx("option",{value:"region",children:"Intra Region"}),ft&&o.jsx("option",{value:"division",children:"Intra Division"}),gt&&o.jsx("option",{value:"interRegion",children:"Inter Region"}),ft&&o.jsx("option",{value:"interDivision",children:"Inter Division"})]})]}),Ne&&Ge&&o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{className:"space-y-2",children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("label",{className:"text-sm font-medium flex items-center gap-2",children:[o.jsxs("span",{children:["Min: ",h.toLocaleString()]}),Yt!==void 0&&Yt>h&&o.jsxs("span",{className:"text-xs text-gray-400",children:["(actual ",Yt.toLocaleString(),")"]})]}),(()=>{const m=Math.max(1,Kt),$=h>We||x<Rt||N<m;return o.jsx("button",{onClick:()=>{v(We),_(Rt),C(m)},disabled:!$,type:"button",className:`text-xs transition-colors ${$?"text-blue-600 hover:text-blue-800":"text-gray-400 cursor-not-allowed"}`,children:"Show All"})})()]}),o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("input",{type:"range",min:We,max:wt||1,step:Vn,value:h,onChange:m=>{const $=parseInt(m.target.value),A=Math.min($,x);v(A),we({minThreshold:A})},className:"w-full"}),o.jsx("input",{type:"number",min:We,max:wt||1,value:h,onChange:m=>{const $=Number.parseInt(m.target.value);if(Number.isNaN($))return;const A=Math.max(We,Math.min($,x));v(A),we({minThreshold:A})},className:"w-24 px-2 py-1 text-sm border border-gray-300 rounded-md"})]})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsxs("label",{className:"text-sm font-medium flex items-center gap-2",children:[o.jsxs("span",{children:["Max: ",x.toLocaleString()]}),Xt!==void 0&&Xt<x&&o.jsxs("span",{className:"text-xs text-gray-400",children:["(actual ",Xt.toLocaleString(),")"]})]}),o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("input",{type:"range",min:We,max:wt||1,step:Vn,value:x,onChange:m=>{const $=parseInt(m.target.value),A=Math.max($,h);_(A),we({maxThreshold:A})},className:"w-full"}),o.jsx("input",{type:"number",min:We,max:wt||1,value:x,onChange:m=>{const $=Number.parseInt(m.target.value);if(Number.isNaN($))return;const A=Math.min(wt||1,Math.max($,h));_(A),we({maxThreshold:A})},className:"w-24 px-2 py-1 text-sm border border-gray-300 rounded-md"})]})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsxs("label",{className:"text-sm font-medium",children:["Max Edges: ",N]}),o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("input",{type:"range",min:10,max:Wt,step:10,value:N,onChange:m=>{const $=parseInt(m.target.value);C($),we({maxEdges:$})},className:"w-full"}),o.jsx("input",{type:"number",min:1,max:Wt,value:N,onChange:m=>{const $=Number.parseInt(m.target.value);if(Number.isNaN($))return;const A=Math.max(1,Math.min($,Wt));C(A),we({maxEdges:A})},className:"w-24 px-2 py-1 text-sm border border-gray-300 rounded-md"})]}),o.jsxs("p",{className:"text-xs text-gray-600 italic",children:["After filtering by thresholds and edge type, edges are sorted by value (highest first) and the top ",N," edges are displayed."]})]})]})]})}),E==="kriskogram"&&o.jsx(Ct,{title:"Kriskogram Settings",defaultOpen:!0,onReset:()=>{W(!1),k("alphabetical"),Ce(.85),z("weight"),ae(2),Je("single"),xe(null),In("fixed"),En(null),K(!1),be("direction"),$e(null),H(!0),lt("weight"),vt(null),R(.6),Pt("pan"),qt(80),An({x:0,y:0}),we({showAllNodes:!1})},children:a!=null&&a.metadata?o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{className:"flex items-center justify-between p-2 bg-gray-50 rounded border border-gray-200",children:[o.jsxs("div",{children:[o.jsx("label",{htmlFor:"kriskogram-show-all-nodes",className:"text-sm font-medium text-gray-700",children:"Always show all nodes"}),o.jsx("p",{className:"text-xs text-gray-500",children:"Keeps every location visible even if its edges fall outside the filters."})]}),o.jsx("input",{id:"kriskogram-show-all-nodes",type:"checkbox",className:"w-4 h-4",checked:D,onChange:m=>{const $=m.target.checked;W($),we({showAllNodes:$})}})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsx("label",{className:"text-xs font-medium text-gray-700",children:"Node Ordering"}),o.jsxs("select",{value:j,onChange:m=>k(m.target.value),className:"w-full px-2 py-1.5 text-xs border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[o.jsx("option",{value:"alphabetical",children:"Alphabetical"}),a.metadata.hasCategoricalProperties.nodes.map(m=>o.jsxs("option",{value:m,children:["By ",m]},m)),a.metadata.hasNumericProperties.nodes.map(m=>o.jsxs("option",{value:m,children:["By ",m]},m))]})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsxs("label",{className:"text-xs font-medium text-gray-700",children:["Arc Opacity: ",Math.round(ge*100),"%"]}),o.jsx("input",{type:"range",min:0,max:1,step:.05,value:ge,onChange:m=>Ce(parseFloat(m.target.value)),className:"w-full"})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsx("label",{className:"text-xs font-medium text-gray-700",children:"Edge Width"}),o.jsxs("div",{className:"flex items-center gap-3 text-xs",children:[o.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[o.jsx("input",{type:"radio",name:"edgeWidthMode",value:"weight",checked:De==="weight",onChange:()=>z("weight"),className:"w-3.5 h-3.5"}),o.jsx("span",{children:"By Weight"})]}),o.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[o.jsx("input",{type:"radio",name:"edgeWidthMode",value:"fixed",checked:De==="fixed",onChange:()=>z("fixed"),className:"w-3.5 h-3.5"}),o.jsx("span",{children:"Fixed"})]})]}),De==="fixed"&&o.jsxs("div",{className:"mt-2",children:[o.jsxs("label",{className:"text-xs font-medium text-gray-700",children:["Base Edge Width: ",te.toFixed(1),"px"]}),o.jsx("input",{type:"range",min:.5,max:8,step:.1,value:te,onChange:m=>ae(parseFloat(m.target.value)),className:"w-full"})]})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("label",{className:"text-xs font-medium text-gray-700",children:"Edge Color"}),o.jsxs("label",{className:"flex items-center gap-1 text-[11px] text-gray-600 cursor-pointer",children:[o.jsx("input",{type:"checkbox",className:"w-3.5 h-3.5",checked:fe,onChange:m=>{const $=m.target.checked;K($),$||(be("direction"),$e(null),H(!0),lt("weight"),vt(null),R(.6))}}),"Advanced"]})]}),!fe&&o.jsxs("div",{className:"flex flex-col gap-1.5 text-xs",children:[o.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[o.jsx("input",{type:"radio",name:"edgeColorHueSimple",value:"direction",checked:B==="direction",onChange:()=>be("direction"),className:"w-3.5 h-3.5"}),o.jsx("span",{children:"By Direction (Above/Below)"})]}),o.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[o.jsx("input",{type:"radio",name:"edgeColorHueSimple",value:"weight",checked:Te==="weight"&&B==="single",onChange:()=>{be("single"),lt("weight")},className:"w-3.5 h-3.5"}),o.jsx("span",{children:"By Weight Intensity"})]})]}),fe&&o.jsxs("div",{className:"space-y-3 border border-gray-200 rounded-md p-3 bg-gray-50/60",children:[o.jsxs("div",{className:"space-y-1",children:[o.jsx("label",{className:"text-xs font-medium text-gray-700",children:"Hue Source"}),o.jsxs("select",{value:B,onChange:m=>{const $=m.target.value;be($)},className:"w-full px-2 py-1.5 text-xs border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[o.jsx("option",{value:"direction",children:"Direction (above/below)"}),o.jsx("option",{value:"region",disabled:!gt,children:"Region"}),o.jsx("option",{value:"division",disabled:!ft,children:"Division"}),o.jsx("option",{value:"attribute",children:"Attribute"}),o.jsx("option",{value:"single",children:"Single Color"})]}),B==="attribute"&&(a==null?void 0:a.metadata)&&o.jsxs("div",{className:"mt-2",children:[o.jsx("label",{className:"text-xs text-gray-600",children:"Hue Attribute"}),o.jsxs("select",{className:"w-full px-2 py-1.5 text-xs border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",value:je||"",onChange:m=>$e(m.target.value||null),children:[o.jsx("option",{value:"",children:"Select attribute…"}),[...a.metadata.hasNumericProperties.edges,...a.metadata.hasCategoricalProperties.edges].filter((m,$,A)=>A.indexOf(m)===$).map(m=>o.jsx("option",{value:m,children:m},m))]})]}),(B==="region"||B==="division")&&o.jsxs("label",{className:"flex items-center gap-2 mt-2 text-[11px] text-gray-600 cursor-pointer",children:[o.jsx("input",{type:"checkbox",className:"w-3.5 h-3.5",checked:F,onChange:m=>H(m.target.checked)}),"Inter edges grayscale by intensity"]})]}),o.jsxs("div",{className:"space-y-1",children:[o.jsx("label",{className:"text-xs font-medium text-gray-700",children:"Intensity Source"}),o.jsxs("select",{value:Te,onChange:m=>lt(m.target.value),className:"w-full px-2 py-1.5 text-xs border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[o.jsx("option",{value:"weight",children:"Weight"}),o.jsx("option",{value:"constant",children:"Constant"}),o.jsx("option",{value:"attribute",children:"Attribute"})]}),Te==="constant"&&o.jsxs("div",{className:"mt-2",children:[o.jsxs("label",{className:"text-xs text-gray-600",children:["Constant Intensity: ",(Nt*100).toFixed(0),"%"]}),o.jsx("input",{type:"range",min:0,max:1,step:.01,value:Nt,onChange:m=>R(parseFloat(m.target.value)),className:"w-full"})]}),Te==="attribute"&&(a==null?void 0:a.metadata)&&o.jsxs("div",{className:"mt-2",children:[o.jsx("label",{className:"text-xs text-gray-600",children:"Intensity Attribute"}),o.jsxs("select",{className:"w-full px-2 py-1.5 text-xs border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",value:ut||"",onChange:m=>vt(m.target.value||null),children:[o.jsx("option",{value:"",children:"Select attribute…"}),a.metadata.hasNumericProperties.edges.map(m=>o.jsx("option",{value:m,children:m},m))]})]})]})]})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsx("label",{className:"text-xs font-medium text-gray-700",children:"Node Color"}),o.jsxs("select",{value:Ke,onChange:m=>Je(m.target.value),className:"w-full px-2 py-1.5 text-xs border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[o.jsx("option",{value:"single",children:"Single Color"}),o.jsx("option",{value:"visible_outgoing",children:"Visible Outgoing Flow"}),o.jsx("option",{value:"visible_incoming",children:"Visible Incoming Flow"}),o.jsx("option",{value:"year_outgoing",children:"Year Outgoing Flow"}),o.jsx("option",{value:"year_incoming",children:"Year Incoming Flow"}),o.jsx("option",{value:"net_year",children:"Net Flow (year)"}),o.jsx("option",{value:"attribute",children:"By Attribute"})]}),Ke==="attribute"&&o.jsxs("select",{value:Oe||"",onChange:m=>xe(m.target.value||null),className:"w-full px-2 py-1.5 text-xs border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[o.jsx("option",{value:"",children:"Select..."}),a.metadata.hasCategoricalProperties.nodes.map(m=>o.jsx("option",{value:m,children:m},m)),a.metadata.hasNumericProperties.nodes.map(m=>o.jsx("option",{value:m,children:m},m))]})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsx("label",{className:"text-xs font-medium text-gray-700",children:"Node Size"}),o.jsxs("select",{value:se,onChange:m=>In(m.target.value),className:"w-full px-2 py-1.5 text-xs border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[o.jsx("option",{value:"fixed",children:"Fixed"}),o.jsx("option",{value:"visible_outgoing",children:"Visible Outgoing Flow"}),o.jsx("option",{value:"visible_incoming",children:"Visible Incoming Flow"}),o.jsx("option",{value:"year_outgoing",children:"Year Outgoing Flow"}),o.jsx("option",{value:"year_incoming",children:"Year Incoming Flow"}),o.jsx("option",{value:"net_visible",children:"Net Flow (visible)"}),o.jsx("option",{value:"net_year",children:"Net Flow (year)"}),o.jsx("option",{value:"attribute",children:"By Attribute"})]}),se==="attribute"&&o.jsxs("select",{value:Et||"",onChange:m=>En(m.target.value||null),className:"w-full px-2 py-1.5 text-xs border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[o.jsx("option",{value:"",children:"Select..."}),a.metadata.hasNumericProperties.nodes.map(m=>o.jsx("option",{value:m,children:m},m))]})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsx("label",{className:"text-xs font-medium text-gray-700",children:"Interaction Mode"}),o.jsxs("select",{value:et,onChange:m=>Pt(m.target.value),className:"w-full px-2 py-1.5 text-xs border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[o.jsx("option",{value:"pan",children:"Pan"}),o.jsx("option",{value:"lens",children:"Edge Lens"})]}),et==="lens"&&o.jsxs("div",{className:"space-y-1",children:[o.jsxs("label",{className:"text-[11px] text-gray-600",children:["Lens Radius: ",At,"px"]}),o.jsx("input",{type:"range",min:20,max:300,step:5,value:At,onChange:m=>qt(parseInt(m.target.value)),className:"w-full"}),o.jsx("p",{className:"text-[10px] text-gray-500",children:"Scroll over the visualization to adjust while lens mode is active."})]})]})]}):o.jsx("div",{className:"text-xs text-gray-500 italic",children:"No dataset metadata available"})}),E==="table"&&o.jsx(Ct,{title:"Table Settings",defaultOpen:!1,children:o.jsx("div",{className:"text-xs text-gray-500 italic",children:"Settings to be added"})}),E==="sankey"&&o.jsx(Ct,{title:"Sankey Settings",defaultOpen:!1,children:o.jsx("div",{className:"text-xs text-gray-500 italic",children:"Settings to be added"})}),E==="chord"&&o.jsx(Ct,{title:"Chord Settings",defaultOpen:!1,children:o.jsx("div",{className:"text-xs text-gray-500 italic",children:"Settings to be added"})})]})})]})})}async function si(){const e="csv-usa-pre-2020",s="csv-usa-post-2020",t="csv-2021",n="gexf-sample",r="swiss-2016";let i=await rt(e),l=await rt(s);const a=y=>y?y.snapshots.every(h=>{const v=new Set(h.nodes.map(x=>x.label));if(v.size!==ti)return!1;for(const x of v)if(!ei.has(x))return!1;return!0}):!1;(i?!a(i):!1)&&(await yn(e).catch(()=>{}),i=void 0),(l?!a(l):!1)&&(await yn(s).catch(()=>{}),l=void 0);let d=!!i,p=!!l;const f=await rt(t),g=await rt(n),w=await rt(r),S=async y=>{const h=[];for(const v of y)try{const x=new URL(Object.assign({"../data/StateToStateMigrationUSCSV/state_to_state_migration_table_2022_t13_updated_2024_06_27_2022.csv":_o,"../data/StateToStateMigrationUSCSV/state_to_state_migration_table_2023_t13_2023.csv":Co,"../data/StateToStateMigrationUSCSV/state_to_state_migrations_table_2005_2005.csv":jo,"../data/StateToStateMigrationUSCSV/state_to_state_migrations_table_2005_2007_2005-2007.csv":No,"../data/StateToStateMigrationUSCSV/state_to_state_migrations_table_2005_2009_2005-2009.csv":Ro,"../data/StateToStateMigrationUSCSV/state_to_state_migrations_table_2006_2006.csv":Mo,"../data/StateToStateMigrationUSCSV/state_to_state_migrations_table_2006_2008_2006-2008.csv":Fo,"../data/StateToStateMigrationUSCSV/state_to_state_migrations_table_2007_2007.csv":$o,"../data/StateToStateMigrationUSCSV/state_to_state_migrations_table_2007_2009_2007-2009.csv":Io,"../data/StateToStateMigrationUSCSV/state_to_state_migrations_table_2008_2008.csv":Eo,"../data/StateToStateMigrationUSCSV/state_to_state_migrations_table_2009_2009.csv":Po,"../data/StateToStateMigrationUSCSV/state_to_state_migrations_table_2010_2010.csv":Ao,"../data/StateToStateMigrationUSCSV/state_to_state_migrations_table_2011_2011.csv":Vo,"../data/StateToStateMigrationUSCSV/state_to_state_migrations_table_2012_2012.csv":Do,"../data/StateToStateMigrationUSCSV/state_to_state_migrations_table_2013_2013.csv":ko,"../data/StateToStateMigrationUSCSV/state_to_state_migrations_table_2014_2014.csv":To,"../data/StateToStateMigrationUSCSV/state_to_state_migrations_table_2015_2015.csv":Lo,"../data/StateToStateMigrationUSCSV/state_to_state_migrations_table_2016_2016.csv":zo,"../data/StateToStateMigrationUSCSV/state_to_state_migrations_table_2017_2017.csv":Ho,"../data/StateToStateMigrationUSCSV/state_to_state_migrations_table_2018_2018.csv":Oo,"../data/StateToStateMigrationUSCSV/state_to_state_migrations_table_2019_2019.csv":Go,"../data/StateToStateMigrationUSCSV/state_to_state_migrations_table_2021_2021.csv":Uo})[`../data/StateToStateMigrationUSCSV/${v.filename}`],import.meta.url),_=await Dt(x.toString()),N=hn(_);h.push({timestamp:v.year,nodes:N.nodes,edges:N.edges})}catch(x){console.warn(`⚠️ Failed to load snapshot for ${v.filename}:`,x)}return h.sort((v,x)=>{const _=typeof v.timestamp=="string"?Number.parseInt(v.timestamp,10):v.timestamp,N=typeof x.timestamp=="string"?Number.parseInt(x.timestamp,10):x.timestamp;return _-N}),h};if(!i){const y=zn.filter(v=>v.year<=2019),h=await S(y);if(h.length>0){const v=h[0],x=h[h.length-1],_=ht(v),N={id:e,name:"US State-to-State Migration (2005-2019)",notes:"Tidy ACS 1-year state-to-state migration flows from 2005 through 2019. The Census Bureau did not release 2020 1-year migration flows, so the series stops before the pandemic.",type:"csv",timeRange:{start:typeof v.timestamp=="string"?Number.parseInt(v.timestamp,10):v.timestamp,end:typeof x.timestamp=="string"?Number.parseInt(x.timestamp,10):x.timestamp},snapshots:h,metadata:_,createdAt:Date.now()};await ot(N),d=!0}}if(!l){const y=zn.filter(v=>v.year>=2021),h=await S(y);if(h.length>0){const v=h[0],x=h[h.length-1],_=ht(v),N={id:s,name:"US State-to-State Migration (2021-2023)",notes:"Post-2020 ACS 1-year state-to-state migration flows. The 2022 release includes revised Connecticut flows per Census errata guidance.",type:"csv",timeRange:{start:typeof v.timestamp=="string"?Number.parseInt(v.timestamp,10):v.timestamp,end:typeof x.timestamp=="string"?Number.parseInt(x.timestamp,10):x.timestamp},snapshots:h,metadata:_,createdAt:Date.now()};await ot(N),p=!0}}if(!f){const y=new URL("/INF358_Project_Kriskogram/assets/State_to_State_Migrations_Table_2021-N7RTh5uH.csv",import.meta.url),h=await Dt(y.toString()),v=hn(h),x={timestamp:2021,nodes:v.nodes,edges:v.edges},_=ht(x),N={id:t,name:"US State-to-State Migration (2021)",notes:"Real U.S. Census Bureau data showing migration flows between all 50 states from the American Community Survey 1-Year Estimates.",type:"csv",timeRange:{start:2021,end:2021},snapshots:[x],metadata:_,createdAt:Date.now()};await ot(N)}if(!g){const y=new URL("/INF358_Project_Kriskogram/assets/sample-migration-data-Dify6Mt1.gexf",import.meta.url),h=await Gs(y.toString()),v=ls(h),x=v.length>0?ht(v[0]):void 0,_={id:n,name:"Sample Migration (GEXF)",notes:"AI-generated sample network dataset in GEXF format demonstrating temporal migration patterns with multiple time slices. This example dataset includes economic, geographic, and migration type attributes for demonstration purposes.",type:"gexf",timeRange:h.timeRange,snapshots:v,metadata:x,createdAt:Date.now()};await ot(_)}if(!w){const y="/INF358_Project_Kriskogram/",h=`${y}data/Swiss_Relocations_2016_locations.csv`,v=`${y}data/Swiss_Relocations_2016_flows.csv`,x=await Dt(h),_=await Dt(v),N=gs({nodesFile:{content:x,idField:"id",labelField:"name"},edgesFile:{content:_,sourceField:"origin",targetField:"dest",valueField:"count"}}),C={timestamp:2016,nodes:N.nodes,edges:N.edges},V=ht(C),I={id:r,name:"Swiss Relocations (2016)",notes:"Relocations between Swiss cantons in 2016. This dataset contains 521,510 trips and uses a two-file CSV format with separate files for locations (cantons) and flows (relocations). Created by Ilya Boyandin.",type:"csv-two-file",timeRange:{start:2016,end:2016},snapshots:[C],metadata:V,createdAt:Date.now()};await ot(I)}if(d)return e;if(p)return s;if(f)return t}export{ui as component};
